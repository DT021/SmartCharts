!function(){var t,e=["127.0.0.1","localhost","binary.com"];if(t=new Date("2019/01/01").getTime()){var i=(new Date).getTime();if(t<=i)console.error("This license has expired!");else;}if(e&&e.length>2){for(var r=document.location.href,n=!1,a=0;a<e.length;a++)if(r.indexOf(e[a])>-1){n=!0;break}n||(alert("ERROR: Not licensed for domain "+r),console.error("ERROR: Not licensed for domain "+r))}}(),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():e(t)}(this,function(_exports){var __drawing_=function(t){var e=t.CIQ,i=t.timezoneJS;return e.Drawing=function(){this.chartsOnly=!1,this.penDown=!1},e.Drawing.getDrawingParameters=function(t,i){var r;try{r=new e.Drawing[i]}catch(t){}if(!r)return null;r.stx=t,r.copyConfig();for(var n={},a=r.configs,s=0;s<a.length;s++)n[a[s]]=r[a[s]];return n},e.Drawing.prototype.copyConfig=function(){e.Drawing.copyConfig(this)},e.Drawing.copyConfig=function(t){for(var i=t.configs,r=0;r<i.length;r++){var n=i[r],a=t.stx.currentVectorParameters;"color"==n?t.color=a.currentColor:"parameters"==n?t.parameters=a.fibonacci:"font"==n?t.font=e.clone(a.annotation.font):t[n]=a[n]}},e.Drawing.prototype.dragToDraw=!1,e.Drawing.prototype.abort=function(t){},e.Drawing.prototype.measure=function(){},e.Drawing.prototype.construct=function(t,e){this.stx=t,this.panelName=e.name},e.Drawing.prototype.render=function(t){alert("must implement render function!")},e.Drawing.prototype.click=function(t,e,i){alert("must implement click function!")},e.Drawing.prototype.move=function(t,e,i){alert("must implement move function!")},e.Drawing.prototype.reposition=function(t,e,i,r){},e.Drawing.prototype.intersected=function(t,e,i){alert("must implement intersected function!")},e.Drawing.prototype.reconstruct=function(t,e){alert("must implement reconstruct function!")},e.Drawing.prototype.serialize=function(){alert("must implement serialize function!")},e.Drawing.prototype.adjust=function(){alert("must implement adjust function!")},e.Drawing.prototype.highlight=function(t){return t&&!this.highlighted?this.highlighted=t:!t&&this.highlighted&&(this.highlighted=t),this.highlighted},e.Drawing.prototype.littleCircleRadius=function(){return 6},e.Drawing.prototype.littleCircle=function(t,i,r,n){var a=this.stx.defaultColor,s=e.chooseForegroundColor(a);t.beginPath(),t.lineWidth=1,t.arc(i,r,this.littleCircleRadius(),0,2*Math.PI,!1),t.fillStyle=n?a:s,t.strokeStyle=a,t.fill(),t.stroke(),t.closePath()},e.Drawing.prototype.rotator=function(t,e,i,r){var n=this.littleCircleRadius(),a=this.stx.defaultColor;t.beginPath(),t.lineWidth=2,r||(t.globalAlpha=.5);var s=4+n;t.arc(e,i,s,0,3*Math.PI/2,!1),t.moveTo(e+2+s,i+2),t.lineTo(e+s,i),t.lineTo(e-2+s,i+2),t.moveTo(e-2,i+2-s),t.lineTo(e,i-s),t.lineTo(e-2,i-2-s),t.strokeStyle=a,t.stroke(),t.closePath(),t.globalAlpha=1},e.Drawing.prototype.mover=function(t,e,i,r){var n=this.littleCircleRadius(),a=this.stx.defaultColor,s=n+1;t.save(),t.lineWidth=2,t.strokeStyle=a,t.translate(e,i),r||(t.globalAlpha=.5);for(var o=0;o<4;o++)t.rotate(Math.PI/2),t.beginPath(),t.moveTo(0,s),t.lineTo(0,s+5),t.moveTo(-2,s+5-2),t.lineTo(0,s+5),t.lineTo(2,s+5-2),t.closePath(),t.stroke();t.globalAlpha=1,t.restore()},e.Drawing.prototype.resizer=function(t,e,i,r){var n=this.littleCircleRadius(),a=this.stx.defaultColor,s=5*Math.sqrt(2),o=n+1;t.save(),t.lineWidth=2,t.strokeStyle=a,t.translate(e,i),t.rotate(-e*i/Math.abs(e*i)*Math.PI/4),r||(t.globalAlpha=.5);for(var l=0;l<2;l++)t.rotate(Math.PI),t.beginPath(),t.moveTo(0,o),t.lineTo(0,o+s),t.moveTo(-2,o+s-2),t.lineTo(0,o+s),t.lineTo(2,o+s-2),t.closePath(),t.stroke();t.globalAlpha=1,t.restore()},e.Drawing.prototype.pointIntersection=function(t,e,i){return!!this.stx.panels[this.panelName]&&t>=i.x0&&t<=i.x1&&e>=i.y1&&e<=i.y0},e.Drawing.prototype.setPoint=function(t,i,r,n){var a=null,s=null;"number"==typeof i?a=i:i.length>=8?s=i:a=Number(i),(r||0===r)&&(this["v"+t]=r);var o;if(null!==a)o=this.stx.dateFromTick(a,n,!0),this["tzo"+t]=o.getTimezoneOffset(),this["d"+t]=e.yyyymmddhhmmssmmm(o),this["p"+t]=[a,r];else if(null!==s){o=e.strToDateTime(s),this["tzo"+t]||0===this["tzo"+t]||(this["tzo"+t]=o.getTimezoneOffset()),this["d"+t]=s;var l=this["tzo"+t]-o.getTimezoneOffset();o.setMinutes(o.getMinutes()+l);var h=!1;"freeform"==this.name||e.ChartEngine.isDailyInterval(this.stx.layout.interval)||o.getHours()||o.getMinutes()||o.getSeconds()||o.getMilliseconds()||(h=!0),this["p"+t]=[this.stx.tickFromDate(e.yyyymmddhhmmssmmm(o),n,null,h),r]}},e.Drawing.prototype.setLineColor=function(t){t||(t=this.color);var i=t;return("auto"==i||e.isTransparent(i))&&(i=this.stx.defaultColor),this.highlighted&&(i=this.stx.getCanvasColor("stx_highlight_vector")),i},e.Drawing.BaseTwoPoint=function(){this.p0=null,this.p1=null,this.color=""},e.Drawing.BaseTwoPoint.ciqInheritsFrom(e.Drawing),e.Drawing.BaseTwoPoint.prototype.configs=[],e.Drawing.BaseTwoPoint.prototype.lineIntersection=function(t,i,r,n){var a=this.p0,s=this.p1,o=this.stx.layout;return a&&s&&e.boxIntersects(r.x0,r.y0,r.x1,r.y1,a[0],a[1],s[0],s[1],n,o.semiLog||"log"==o.chartScale)},e.Drawing.BaseTwoPoint.prototype.boxIntersection=function(t,e){return!(!this.p0||!this.p1)&&(!(t>Math.max(this.p0[0],this.p1[0])||t<Math.min(this.p0[0],this.p1[0]))&&!(e>Math.max(this.p0[1],this.p1[1])||e<Math.min(this.p0[1],this.p1[1])))},e.Drawing.BaseTwoPoint.prototype.accidentalClick=function(t,e){var i=this.stx.panels[this.panelName],r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(t,i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,t,e),o=Math.abs(n-r),l=Math.abs(s-a);if(Math.sqrt(o*o+l*l)<10)return this.penDown=!1,this.dragToDraw&&this.stx.undo(),!0},e.Drawing.BaseTwoPoint.prototype.click=function(t,e,i){this.copyConfig();var r=this.stx.panels[this.panelName];return this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,r.chart),this.penDown=!1,!0):(this.setPoint(0,e,i,r.chart),this.penDown=!0,!1)},e.Drawing.BaseTwoPoint.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart))},e.Drawing.BaseTwoPoint.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),this.p1=[e,i],this.render(t))},e.Drawing.BaseTwoPoint.prototype.measure=function(){this.p0&&this.p1&&this.stx.setMeasure(this.p0[1],this.p1[1],this.p0[0],this.p1[0],!0,this.name)},e.Drawing.BaseTwoPoint.prototype.reposition=function(t,e,i,r){if(e){var n=this.stx.panels[this.panelName],a=e.tick-i,s=e.value-r;"move"==e.action?(this.setPoint(0,e.p0[0]-a,e.p0[1]-s,n.chart),this.setPoint(1,e.p1[0]-a,e.p1[1]-s,n.chart),this.render(t)):"drag"==e.action&&(this[e.point]=[i,r],this.setPoint(0,this.p0[0],this.p0[1],n.chart),this.setPoint(1,this.p1[0],this.p1[1],n.chart),this.render(t))}},e.Drawing.annotation=function(){this.name="annotation",this.arr=[],this.w=0,this.h=0,this.padding=4,this.text="",this.ta=null,this.fontSize=0,this.font={}},e.Drawing.annotation.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.annotation.prototype.getFontString=function(){this.fontDef={style:null,weight:null,size:"12px",family:null};var t=this.stx.canvasStyle("stx_annotation");t&&(t.fontStyle&&(this.fontDef.style=t.fontStyle),t.fontWeight&&(this.fontDef.weight=t.fontWeight),t.fontSize&&(this.fontDef.size=t.fontSize),t.fontFamily&&(this.fontDef.family=t.fontFamily)),this.font.style&&(this.fontDef.style=this.font.style),this.font.weight&&(this.fontDef.weight=this.font.weight),this.font.size&&(this.fontDef.size=this.font.size),this.font.family&&(this.fontDef.family=this.font.family),this.fontString="";var e=!0;for(var i in this.fontDef)this.fontDef[i]&&(e?e=!1:this.fontString+=" ",this.fontString+=this.fontDef[i])},e.Drawing.annotation.prototype.configs=["color","font"],e.Drawing.annotation.prototype.measure=function(){},e.Drawing.annotation.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.stx.pixelFromTick(this.p0[0],e.chart),r=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]);t.font=this.fontString,t.textBaseline="top";var n=i,a=r,s=this.w,o=this.h,l=this.setLineColor();if(this.stem){var h,c,u,d;this.stem.d?(h=this.stx.pixelFromTick(this.stem.t),u=this.stx.pixelFromValueAdjusted(e,this.stem.t,this.stem.v),c=n+s/2,d=a+o/2):this.stem.x&&(h=n,u=a,n+=this.stem.x,a+=this.stem.y,c=n+s/2,d=a+o/2),t.beginPath(),this.borderColor?t.strokeStyle=this.borderColor:t.strokeStyle=l,t.moveTo(h,u),t.lineTo(c,d),t.stroke()}this.highlighted?(this.stx.canvasColor("stx_annotation_highlight_bg",t),t.fillRect(n,a,s,o)):this.fillColor?(t.fillStyle=this.fillColor,t.fillRect(n,a,s,o)):this.stem&&(t.fillStyle=this.stx.containerColor,t.fillRect(n,a,s,o)),this.borderColor&&(t.beginPath(),t.strokeStyle=this.borderColor,t.rect(n,a,s,o),t.stroke()),this.highlighted?this.stx.canvasColor("stx_annotation_highlight",t):t.fillStyle=l,a+=this.padding;for(var p=0;p<this.arr.length;p++)t.fillText(this.arr[p],n+this.padding,a),a+=this.fontSize;t.textBaseline="alphabetic"}},e.Drawing.annotation.prototype.onChange=function(t){},e.Drawing.annotation.prototype.edit=function(t){function i(t){return function(i){if(i){switch(window.event?event.keyCode:i.keyCode){case 27:return void t.stx.undo()}}var r=t.stx,n=t.ta,a=r.controls.annotationSave,s=r.controls.annotationCancel,o=n.value.split("\n"),l=0;r.chart.context.font=t.fontString;for(var h=0;h<o.length;h++){var c=r.chart.context.measureText(o[h]).width;c>l&&(l=c)}var u=(o.length+1)*(t.fontSize+3);l<50&&(l=50),n.style.width=l+30+"px",n.style.height=u+"px";var d=parseInt(e.stripPX(n.style.top),10),p=e.stripPX(n.style.left);l=n.clientWidth,u=n.clientHeight,p+l+100<t.stx.chart.canvasWidth?(a.style.top=d+"px",s.style.top=d+"px",a.style.left=p+l+10+"px",s.style.left=p+l+60+"px"):d+u+30<t.stx.chart.canvasHeight?(a.style.top=d+u+10+"px",s.style.top=d+u+10+"px",a.style.left=p+"px",s.style.left=p+50+"px"):(a.style.top=d-35+"px",s.style.top=d-35+"px",a.style.left=p+"px",s.style.left=p+50+"px")}}var r=this.stx.panels[this.panelName];if(r){this.stx.editingAnnotation=!0,this.stx.undisplayCrosshairs(),this.stx.openDialog="annotation",this.ta||(this.ta=document.createElement("TEXTAREA"),this.ta.className="stx_annotation",this.ta.onkeyup=i(this),this.ta.onmouseup=function(t){return function(i){t.manageTouchAndMouse&&e.ChartEngine.drawingLine&&t.mouseup(i)}}(this.stx),this.ta.setAttribute("wrap","hard"),e.isIOS7or8&&this.ta.setAttribute("placeholder","Enter Text"),this.stx.chart.container.appendChild(this.ta),this.ta.style.position="absolute",this.ta.style.width="100px",this.ta.style.height="20px",(e.ipad||e.iphone)&&(this.ta.ontouchstart=function(t){t.stopPropagation()}));var n=this;if(this.ta.oninput=function(t){n.onChange(t)},this.ta.style.font=this.fontString,this.color)if("transparent"==this.color||"auto"==this.color){var a=getComputedStyle(this.ta);a&&e.isTransparent(a.backgroundColor)?this.ta.style.color=this.stx.defaultColor:this.ta.style.color="#000"}else this.ta.style.color=this.color;var s=this.stx.pixelFromTick(this.p0[0],r.chart),o=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]);if(this.ta.style.left=s+140<this.stx.chart.canvasRight?s+"px":this.stx.chart.canvasRight-200+"px",this.ta.style.top=o+60<this.stx.chart.canvasHeight?o+"px":o-60+"px","callout"==this.name&&(this.ta.style.left=s-(isNaN(this.w)?this.defaultWidth:this.w/2)+"px",this.ta.style.top=o-(isNaN(this.h)?this.defaultHeight:this.h/2)+"px"),this.stx.controls.annotationSave.style.display="inline-block",this.stx.controls.annotationCancel.style.display="inline-block",e.safeClickTouch(this.stx.controls.annotationSave,function(t){return function(e){""!==t.ta.value&&(t.stx.editingAnnotation=!1,t.text=t.ta.value,t.adjust(),t.stx.addDrawing(t),t.stx.changeOccurred("vector"),t.stx.undo(),t.stx.cancelTouchSingleClick=!0)}}(this)),e.safeClickTouch(this.stx.controls.annotationCancel,function(t){return function(e){t.stx.editingAnnotation=!1,t.stx.undo(),t.stx.cancelTouchSingleClick=!0}}(this)),i(this)(),this.ta.focus(),e.isAndroid&&!e.is_chrome){this.priorBottom=this.stx.chart.container.style.bottom;var l=this.stx.resolveY(o)+100;if(l>e.pageHeight()-400){var h=e.pageHeight()-l,c=400-h;this.stx.chart.container.style.bottom=c+"px"}}}},e.Drawing.annotation.prototype.click=function(t,e,i){if(!this.stx.overXAxis&&!this.stx.overYAxis){var r=this.stx.panels[this.panelName];return this.copyConfig(),this.setPoint(0,e,i,r.chart),this.adjust(),this.edit(t),!1}},e.Drawing.annotation.prototype.reposition=function(t,e,i,r){if(e){var n=this.stx.panels[this.panelName],a=e.tick-i,s=e.value-r;this.setPoint(0,e.p0[0]-a,e.p0[1]-s,n.chart),this.render(t)}},e.Drawing.annotation.prototype.intersected=function(t,i,r){var n=this.stx.panels[this.panelName];if(!this.p0)return null;var a=this.stx.pixelFromTick(this.p0[0],n.chart),s=this.stx.pixelFromValueAdjusted(n,this.p0[0],this.p0[1]),o=a+this.w,l=s+this.h;this.stem&&this.stem.x&&(a+=this.stem.x,o+=this.stem.x,s+=this.stem.y,l+=this.stem.y);var h=this.stx.pixelFromTick(t,n.chart),c=this.stx.pixelFromValueAdjusted(n,t,i);return h>=a&&h<=o&&c>=s&&c<=l&&(this.highlighted=!0,{p0:e.clone(this.p0),tick:t,value:i})},e.Drawing.annotation.prototype.abort=function(){this.stx.controls.annotationSave.style.display="none",this.stx.controls.annotationCancel.style.display="none",this.ta&&this.stx.chart.container.removeChild(this.ta),this.ta=null,this.stx.openDialog="",this.stx.showCrosshairs(),this.stx.editingAnnotation=!1,e.clearCanvas(this.stx.chart.tempCanvas,this.stx),e.isAndroid&&!e.is_chrome&&(this.stx.chart.container.style.bottom=this.priorBottom),e.fixScreen()},e.Drawing.annotation.prototype.reconstruct=function(t,i){this.stx=t,this.color=i.col,this.panelName=i.pnl,this.d0=i.d0,this.tzo0=i.tzo0,this.v0=i.v0,this.text=t.escapeOnSerialize?decodeURIComponent(i.text):i.text,this.stem=i.stem,this.borderColor=i.bc,this.fillColor=i.bg,this.lineWidth=i.lw,this.pattern=i.ptrn,this.font=e.replaceFields(i.fnt,{st:"style",sz:"size",wt:"weight",fl:"family"}),this.font||(this.font={}),this.adjust()},e.Drawing.annotation.prototype.serialize=function(){var t={name:this.name,pnl:this.panelName,col:this.color,d0:this.d0,tzo0:this.tzo0,v0:this.v0,text:this.stx.escapeOnSerialize?encodeURIComponent(this.text):this.text};if(this.font){var i=e.removeNullValues(e.replaceFields(this.font,{style:"st",size:"sz",weight:"wt",family:"fl"}));e.isEmpty(i)||(t.fnt=i)}return this.stem&&(t.stem={d:this.stem.d,v:this.stem.v,x:this.stem.x,y:this.stem.y}),this.borderColor&&(t.bc=this.borderColor),this.fillColor&&(t.bg=this.fillColor),this.lineWidth&&(t.lw=this.lineWidth),this.pattern&&(t.ptrn=this.pattern),t},e.Drawing.annotation.prototype.renderText=function(){this.getFontString();var t=this.stx.panels[this.panelName];if(t){this.arr=this.text.split("\n");var i=0;this.stx.chart.context.font=this.fontString;for(var r=0;r<this.arr.length;r++){var n=this.stx.chart.context.measureText(this.arr[r]).width;n>i&&(i=n)}0===i&&(i=2*this.defaultWidth),this.fontSize=e.stripPX(this.fontDef.size);var a=this.arr.length*this.fontSize;e.touchDevice&&(a+=5),this.w=i+2*this.padding,this.h=a+2*this.padding;var s=this.stx.pixelFromTick(this.p0[0],t.chart)+i,o=this.stx.pixelFromValueAdjusted(t,this.p0[0],this.p0[1])+a;this.p1=[this.stx.tickFromPixel(s,t.chart),this.stx.valueFromPixel(o,t)],this.stem&&this.stem.d&&(this.stem.t=this.stx.tickFromDate(this.stem.d,t.chart))}},e.Drawing.annotation.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.renderText())},e.Drawing.segment=function(){this.name="segment"},e.Drawing.segment.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.segment.prototype.render=function(t){var r=this.stx.panels[this.panelName];if(r){var n=this.stx.pixelFromTick(this.p0[0],r.chart),a=this.stx.pixelFromTick(this.p1[0],r.chart),s=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(r,this.p1[0],this.p1[1]),l=this.lineWidth,h=this.setLineColor(),c={pattern:this.pattern,lineWidth:l};if(this.stx.plotLine(n,a,s,o,h,this.name,t,r,c),this.axisLabel&&!this.highlighted)if("horizontal"==this.name){this.stx.endClip();var u=this.p0[1];r.chart.transformFunc&&(u=r.chart.transformFunc(this.stx,r.chart,u)),u=r.yAxis.priceFormatter?r.yAxis.priceFormatter(this.stx,r,u):this.stx.formatYAxisPrice(u,r),this.stx.createYAxisLabel(r,u,s,h),this.stx.startClip(r.name)}else if("vertical"==this.name&&this.p0[0]>=0&&!e.ChartEngine.hideDates()){var d,p;if(d=this.stx.dateFromTick(this.p0[0],r.chart,!0),e.ChartEngine.isDailyInterval(this.stx.layout.interval))d.setHours(0,0,0,0);else{var f=1e3*d.getSeconds()+d.getMilliseconds();this.stx.dataZone&&(p=new i.Date(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),this.stx.dataZone),d=new Date(p.getTime()+f)),this.stx.displayZone&&(p=new i.Date(d.getTime(),this.stx.displayZone),d=new Date(p.getFullYear(),p.getMonth(),p.getDate(),p.getHours(),p.getMinutes()),d=new Date(d.getTime()+f))}var m=e.mmddhhmm(e.yyyymmddhhmm(d));if(r.chart.xAxis.formatter)m=r.chart.xAxis.formatter(d);else if(this.stx.internationalizer){var g;0!==d.getHours()||0!==d.getMinutes()?(g=this.stx.internationalizer.monthDay.format(d),g+=" "+this.stx.internationalizer.hourMinute.format(d)):g=this.stx.internationalizer.yearMonthDay.format(d),m=g}this.stx.endClip(),this.stx.createXAxisLabel(r,m,n,h,null,!0),this.stx.startClip(r.name)}if(this.highlighted&&"horizontal"!=this.name&&"vertical"!=this.name){var v="p0"==this.highlighted,y="p1"==this.highlighted;this.littleCircle(t,n,s,v),this.littleCircle(t,a,o,y)}}},e.Drawing.segment.prototype.abort=function(){this.stx.setMeasure(null,null,null,null,!1)},e.Drawing.segment.prototype.intersected=function(t,i,r){if(!this.p0||!this.p1)return null;if("horizontal"!=this.name&&"vertical"!=this.name&&"gartley"!=this.name){if(this.pointIntersection(this.p0[0],this.p0[1],r))return this.highlighted="p0",{action:"drag",point:"p0"};if(this.pointIntersection(this.p1[0],this.p1[1],r))return this.highlighted="p1",{action:"drag",point:"p1"}}return this.lineIntersection(t,i,r,this.name)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},e.Drawing.segment.prototype.configs=["color","lineWidth","pattern"],e.Drawing.segment.prototype.copyConfig=function(){e.Drawing.copyConfig(this),"none"==this.pattern&&(this.pattern="solid")},e.Drawing.segment.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.segment.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.continuous=function(){this.name="continuous",this.dragToDraw=!1,this.maxSegments=null},e.Drawing.continuous.ciqInheritsFrom(e.Drawing.segment),e.Drawing.continuous.prototype.click=function(t,i,r){var n=this.stx.panels[this.panelName];if(n){if(this.copyConfig(),!this.penDown)return this.setPoint(0,i,r,n.chart),this.penDown=!0,!1;if(this.accidentalClick(i,r))return this.stx.undo(),!0;this.setPoint(1,i,r,n.chart);var a=e.Drawing.segment,s=new a,o=this.serialize(this.stx);return s.reconstruct(this.stx,o),(this.stx.addDrawing(s),this.stx.changeOccurred("vector"),this.stx.draw(),this.segment++,this.maxSegments&&this.segment>this.maxSegments)?!0:(this.setPoint(0,i,r,n.chart),!1)}},e.Drawing.line=function(){this.name="line"},e.Drawing.line.prototype.dragToDraw=!1,e.Drawing.line.ciqInheritsFrom(e.Drawing.segment),e.Drawing.line.prototype.calculateOuterSet=function(t){if(this.p0[0]!=this.p1[0]&&this.p0[1]!=this.p1[1]&&!e.ChartEngine.isDailyInterval(this.stx.layout.interval)){var i={x0:this.p0[0],y0:this.p0[1],x1:this.p1[0],y1:this.p1[1]};i.x0>i.x1&&(i={x0:this.p1[0],y0:this.p1[1],x1:this.p0[0],y1:this.p0[1]});var r=i.x0-1e3,n=i.x1+1e3;this.v0B=e.yIntersection(i,r),this.v1B=e.yIntersection(i,n),this.d0B=this.stx.dateFromTick(r,t.chart),this.d1B=this.stx.dateFromTick(n,t.chart)}},e.Drawing.line.prototype.click=function(t,e,i){var r=this.stx.panels[this.panelName];if(r)return this.copyConfig(),this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,r.chart),this.calculateOuterSet(r),this.penDown=!1,!0):(this.setPoint(0,e,i,r.chart),this.penDown=!0,!1)},e.Drawing.line.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.v0=e.v0,this.v1=e.v1,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,e.d0B&&(this.d0B=e.d0B,this.d1B=e.d1B,this.v0B=e.v0B,this.v1B=e.v1B),this.adjust()},e.Drawing.line.prototype.serialize=function(){var t={name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1};return this.d0B&&(t.d0B=this.d0B,t.d1B=this.d1B,t.v0B=this.v0B,t.v1B=this.v1B),t},e.Drawing.line.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),e.ChartEngine.isDailyInterval(this.stx.layout.interval)&&this.d0B&&(this.setPoint(0,this.d0B,this.v0B,t.chart),this.setPoint(1,this.d1B,this.v1B,t.chart)))},e.Drawing.ray=function(){this.name="ray"},e.Drawing.ray.ciqInheritsFrom(e.Drawing.line),e.Drawing.ray.prototype.calculateOuterSet=function(t){if(this.p0[0]!=this.p1[0]&&this.p0[1]!=this.p1[1]&&!e.ChartEngine.isDailyInterval(this.stx.layout.interval)){var i={x0:this.p0[0],y0:this.p0[1],x1:this.p1[0],y1:this.p1[1]},r=i.x1+1e3;i.x0>i.x1&&(r=i.x1-1e3),this.v0B=this.v0,this.v1B=e.yIntersection(i,r),this.d0B=this.d0,this.d1B=this.stx.dateFromTick(r,t.chart)}},e.Drawing.ray.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),e.ChartEngine.isDailyInterval(this.stx.layout.interval)&&this.d0B&&this.setPoint(1,this.d1B,this.v1B,t.chart))},e.Drawing.horizontal=function(){this.name="horizontal"},e.Drawing.horizontal.prototype.dragToDraw=!1,e.Drawing.horizontal.ciqInheritsFrom(e.Drawing.segment),e.Drawing.horizontal.prototype.measure=function(){},e.Drawing.horizontal.prototype.click=function(t,e,i){var r=this.stx.panels[this.panelName];if(r)return this.copyConfig(),this.setPoint(0,e,i,r.chart),!0},e.Drawing.horizontal.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.v0=e.v0,this.d0=e.d0,this.tzo0=e.tzo0,this.axisLabel=e.al,this.adjust()},e.Drawing.horizontal.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,v0:this.v0,d0:this.d0,tzo0:this.tzo0,al:this.axisLabel}},e.Drawing.horizontal.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=[this.p0[0]+100,this.p0[1]])},e.Drawing.horizontal.prototype.configs=["color","lineWidth","pattern","axisLabel"],e.Drawing.horizontal.prototype.copyConfig=function(){e.Drawing.copyConfig(this),"none"==this.pattern&&(this.pattern="solid")},e.Drawing.vertical=function(){this.name="vertical"},e.Drawing.vertical.ciqInheritsFrom(e.Drawing.horizontal),e.Drawing.vertical.prototype.measure=function(){},e.Drawing.vertical.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=[this.p0[0],this.p0[1]+1])},e.Drawing.measure=function(){this.name="measure"},e.Drawing.measure.ciqInheritsFrom(e.Drawing.segment),e.Drawing.measure.prototype.click=function(t,e,i){return this.copyConfig(),this.penDown?(this.stx.undo(),this.penDown=!1,!0):(this.p0=[e,i],this.penDown=!0,!1)},e.Drawing.rectangle=function(){this.name="rectangle"},e.Drawing.rectangle.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.rectangle.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=Math.round(Math.min(r,n))+.5,l=Math.min(a,s),h=Math.max(r,n)-o,c=Math.max(a,s)-l,u=this.color;this.highlighted&&(u=this.stx.getCanvasColor("stx_highlight_vector"));var d=this.fillColor;d&&!e.isTransparent(d)&&"auto"!=d&&(t.beginPath(),t.rect(o,l,h,c),t.fillStyle=d,t.globalAlpha=.2,t.fill(),t.closePath(),t.globalAlpha=1);var p={pattern:this.pattern,lineWidth:this.lineWidth};if(this.highlighted&&"none"==p.pattern&&(p.pattern="solid",.1==p.lineWidth&&(p.lineWidth=1)),this.stx.plotLine(r,n,a,a,u,"segment",t,i,p),this.stx.plotLine(n,n,a-.5,s+.5,u,"segment",t,i,p),this.stx.plotLine(n,r,s,s,u,"segment",t,i,p),this.stx.plotLine(r,r,s+.5,a-.5,u,"segment",t,i,p),this.highlighted){var f="p0"==this.highlighted,m="p1"==this.highlighted;this.littleCircle(t,r,a,f),this.littleCircle(t,n,s,m)}}},e.Drawing.rectangle.prototype.intersected=function(t,i,r){return this.p0&&this.p1?this.pointIntersection(this.p0[0],this.p0[1],r)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(this.p1[0],this.p1[1],r)?(this.highlighted="p1",{action:"drag",point:"p1"}):this.boxIntersection(t,i)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null:null},e.Drawing.rectangle.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.rectangle.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.rectangle.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.ellipse=function(){this.name="ellipse"},e.Drawing.ellipse.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.ellipse.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=r-(n-r),l=n,h=a,c=s,u=a-(s-a),d=(c-u)/6,p=this.lineWidth;p||(p=1.1);var f=this.color;("auto"==f||e.isTransparent(f))&&(f=this.stx.defaultColor),this.highlighted&&(f=this.stx.getCanvasColor("stx_highlight_vector"),.1==p&&(p=1.1));var m=this.fillColor;if(t.beginPath(),t.moveTo(o,h),t.bezierCurveTo(o,c+d,l,c+d,l,h),t.bezierCurveTo(l,u-d,o,u-d,o,h),m&&!e.isTransparent(m)&&"auto"!=m&&(t.fillStyle=m,t.globalAlpha=.2,t.fill(),t.globalAlpha=1),f&&"none"!=this.pattern&&(t.strokeStyle=f,t.lineWidth=p,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(p,this.pattern)),t.lineDashOffset=0),t.stroke()),t.closePath(),this.highlighted){var g="p1"==this.highlighted;this.littleCircle(t,n,s,g)}}},e.Drawing.ellipse.prototype.intersected=function(t,i,r){if(!this.p0||!this.p1)return null;if(this.pointIntersection(this.p1[0],this.p1[1],r))return this.highlighted="p1",{action:"drag",point:"p1"};var n=this.p0[0]-(this.p1[0]-this.p0[0]),a=this.p1[0],s=this.p1[1],o=this.p0[1]-(this.p1[1]-this.p0[1]);return!(t>Math.max(n,a)||t<Math.min(n,a))&&(!(i>Math.max(o,s)||i<Math.min(o,s))&&(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}))},e.Drawing.ellipse.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.ellipse.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},e.Drawing.ellipse.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}},e.Drawing.fibonacci=function(){this.name="fibonacci",this.configurator="fibonacci"},e.Drawing.fibonacci.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.fibonacci.mapping={trend:"t",color:"c",parameters:"p",pattern:"pt",opacity:"o",lineWidth:"lw",level:"l",extendLeft:"e",printLevels:"pl",printValues:"pv",timezone:"tz"},e.Drawing.fibonacci.prototype.configs=["color","fillColor","lineWidth","pattern","parameters"],e.Drawing.fibonacci.prototype.setOuter=function(){this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};for(var t=this.p0[1],i=this.p1[1],r=this.p0[0],n=this.p1[0],a=0,s=1,o=0;o<this.parameters.fibs.length;o++){var l=this.parameters.fibs[o];if(!(l.level>=a&&l.level<=s)&&l.display){var h=i-(i-t)*l.level,c=e.xIntersection({x0:r,x1:n,y0:t,y1:i},h);l.level<a?(a=l.level,this.outer.p1[1]=h,this.outer.p1[0]=c):l.level>s&&(s=l.level,this.outer.p0[1]=h,this.outer.p0[0]=c)}}},e.Drawing.fibonacci.prototype.click=function(t,i,r){var n=this.stx.panels[this.panelName];if(n)return this.copyConfig(),this.penDown?this.accidentalClick(i,r)?this.dragToDraw:(this.setPoint(1,i,r,n.chart),this.setOuter(),this.parameters=e.clone(this.parameters),this.penDown=!1,!0):(this.setPoint(0,i,r,n.chart),this.penDown=!0,!1)},e.Drawing.fibonacci.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var r=i.yAxis;if(this.p1){var n=Math.max(this.p0[1],this.p1[1]),a=Math.min(this.p0[1],this.p1[1]),s=n-a,o=this.stx.pixelFromTick(this.p0[0],i.chart),l=this.stx.pixelFromTick(this.p1[0],i.chart),h=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),c=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),u=Math.min(c,h),d=Math.max(c,h),p=d-u,f=(c-h)/(l-o)>0,m={color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}};this.parameters.trend||(this.parameters.trend=m);var g=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var v=t.measureText("161.8%").width+10,y=Number.MAX_VALUE,x=Number.MAX_VALUE,b=-1*Number.MAX_VALUE,C=-1*Number.MAX_VALUE,S=this.color;("auto"==S||e.isTransparent(S))&&(S=this.stx.defaultColor);for(var w=0;w<this.parameters.fibs.length;w++){t.textAlign="left",t.fillStyle=S;var M=this.parameters.fibs[w];if(M.display){var T=this.stx.pixelFromValueAdjusted(i,this.p0[0],c<h?n-s*M.level:a+s*M.level),B=e.xIntersection({x0:o,x1:l,y0:h,y1:c},T),k=this.parameters.extendLeft?0:B,D=this.stx.chart.left+this.stx.chart.width;if(this.parameters.printLevels){var A=Math.round(1e3*M.level)/10+"%";D-=v,this.parameters.printValues&&(t.fillStyle=S,this.stx.canvasFont("stx_yaxis",t)),D<k&&(t.textAlign="right"),t.fillText(A,D,T),D<k?D+=5:D-=5}if(this.parameters.printValues&&B<this.stx.chart.width){var F=this.stx.transformedPriceFromPixel(T,i);F=r.priceFormatter?r.priceFormatter(this.stx,i,F):this.stx.formatYAxisPrice(F,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,F,T,S,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var _=M.color;("auto"==_||e.isTransparent(_))&&(_=this.color),("auto"==_||e.isTransparent(_))&&(_=this.stx.defaultColor);var P=M.color;("auto"==P||e.isTransparent(P))&&(P=this.fillColor),("auto"==P||e.isTransparent(P))&&(P=this.stx.defaultColor),t.fillStyle=P,this.stx.plotLine(k,D,T,T,_,"segment",t,i,M.parameters),t.globalAlpha=.05,t.beginPath(),t.moveTo(D,T),t.lineTo(k,T),k?t.lineTo(l,c):t.lineTo(k,c),t.lineTo(D,c),void 0!==P&&t.fill(),t.globalAlpha=1,T<x&&(y=B,x=T),T>C&&(b=B,C=T)}}for(var E in{0:0,1:1}){var L=f?d-p*E:u+p*E;L=Math.round(L),L<x&&(y=e.xIntersection({x0:o,x1:l,y0:h,y1:c},L),x=L),L>C&&(b=e.xIntersection({x0:o,x1:l,y0:h,y1:c},L),C=L)}if(this.stx.plotLine(y,b,x,C,g,"segment",t,i,this.parameters.trend.parameters),this.highlighted){
var N="p0"==this.highlighted,O="p1"==this.highlighted;this.littleCircle(t,o,h,N),this.littleCircle(t,l,c,O)}}}},e.Drawing.fibonacci.prototype.reposition=function(t,i,r,n){i&&(e.Drawing.BaseTwoPoint.prototype.reposition.apply(this,arguments),this.adjust())},e.Drawing.fibonacci.prototype.intersected=function(t,i,r){var n=this.p0,a=this.p1,s=this.outer,o=this.stx.layout;return n&&a&&e.boxIntersects(r.x0,r.y0,r.x1,r.y1,s.p0[0],s.p0[1],s.p1[0],s.p1[1],"segment",o.semiLog||"log"==o.chartScale)?this.pointIntersection(n[0],n[1],r)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(a[0],a[1],r)?(this.highlighted="p1",{action:"drag",point:"p1"}):(this.highlighted=!0,{action:"move",p0:e.clone(n),p1:e.clone(a),tick:t,value:i}):null},e.Drawing.fibonacci.prototype.reconstruct=function(t,i){i=e.replaceFields(i,e.reverseObject(e.Drawing.fibonacci.mapping)),this.stx=t,this.parameters=i.parameters,this.parameters||(this.parameters=e.clone(this.stx.currentVectorParameters.fibonacci)),this.color=i.col,this.fillColor=i.fc,this.panelName=i.pnl,this.d0=i.d0,this.d1=i.d1,this.tzo0=i.tzo0,this.tzo1=i.tzo1,this.v0=i.v0,this.v1=i.v1,this.adjust()},e.Drawing.fibonacci.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setOuter())},e.Drawing.fibonacci.prototype.serialize=function(){var t={name:this.name,parameters:this.parameters,pnl:this.panelName,col:this.color,fc:this.fillColor,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1};return e.replaceFields(t,e.Drawing.fibonacci.mapping)},e.Drawing.retracement=function(){this.name="retracement"},e.Drawing.retracement.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.getDrawingToolList=function(t){var i={},r={ciqInheritsFrom:!0,stxInheritsFrom:!0,copyConfig:!0,getDrawingParameters:!0,getDrawingToolList:!0,BaseTwoPoint:!0,shape:!0};e.extend(r,t);for(var n in e.Drawing)r[n]||(i[(new e.Drawing[n]).name]=n);return i},t},__i18n_=function(t){var e=t.CIQ,i=t.$$;return e.I18N=function(){},e.I18N.hereDoc=function(t){return t.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")},e.I18N.language="en",e.I18N.longMonths={zh:!0},e.I18N.reverseColorsByLocale={zh:!0,ja:!0},e.I18N.findAllTextNodes=function(t){if(t||(t=document.body),t==document.body&&!i("stashedTextNodes")){var r=document.createElement("div");r.id="stashedTextNodes",r.style.display="none",t.appendChild(r);for(var n=document.querySelectorAll("input,textarea,.editable_content"),a=0;a<n.length;a++){var s=n[a].getAttribute("placeholder");if(s){var o=r.appendChild(document.createElement("translate"));o.setAttribute("original",s),o.placeholderFor=n[a],o.appendChild(document.createTextNode(s))}}}for(var l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),h=l.nextNode(),c=new RegExp("^\\s*$"),u=new RegExp("\n|\t|\f","g"),d={},p={SCRIPT:!0,STYLE:!0,TEXTAREA:!0};h;){var f=h.nodeValue;if(!c.test(f)){var m=h.parentNode,g=m.tagName;if(!p[g]){if("TRANSLATE"!=g){var v=m.insertBefore(document.createElement("translate"),h);v.setAttribute("original",f),v.appendChild(h)}else f=m.getAttribute("original");u.test(f)&&(f=f.replace(u,"")),d[f]||(d[f]=[]),d[f].push(h)}}h=l.nextNode()}if(t==document.body){var y=e.Studies?e.Studies.studyLibrary:null;if(y)for(var x in y){null===d[x]&&(d[x]=[]);var b=y[x];if(b.inputs)for(var C in b.inputs)d[C]||(d[C]=[]);if(b.outputs)for(var S in b.outputs)d[S]||(d[S]=[])}}return d},e.I18N.missingWordList=function(t){t||(t=e.I18N.language);var i=e.I18N.findAllTextNodes(),r={},n=e.I18N.wordLists[t];n||(n={});var a=function(t){void 0===n[t]&&(r[t]="")};for(var s in i)a(s);if(!e.Studies||!e.Studies.studyLibrary)return r;var o,l;for(var h in e.Studies.studyLibrary){o=e.Studies.studyLibrary[h],a(o.name);for(var c in o.inputs)switch(a(c),l=o.inputs[c],Object.prototype.toString.call(l)){case"[object String]":a(l);break;case"[object Array]":for(var u=0;u<l.length;++u)a(l[u])}for(var d in o.outputs)a(d)}return a("Show Zones"),a("OverBought"),a("OverSold"),r},e.I18N.printableMissingWordList=function(t){var i=JSON.stringify(e.I18N.missingWordList(t));return i=i.replace(/","/g,'",\n"')},e.I18N.translateUI=function(t,i){if("pu"==t&&(t="pt"),e.I18N.wordLists){t||(t=e.I18N.language);var r=e.I18N.findAllTextNodes(i),n=e.I18N.wordLists[t];if(n)for(var a in r)for(var s=e.I18N.translateSections(a,n),o=r[a],l=0;l<o.length;l++){var h=o[l],c=h.parentNode,u=c.getAttribute("original");","!==s&&s||(s=u);var d=c.placeholderFor;d?d.placeholder=s:h.data=s}}},e.I18N.translate=function(t,i){if(i||(i=e.I18N.language),!e.I18N.wordLists)return console.log("Must include translations.js in order to use CIQ.I18N.translate()"),t;var r=e.I18N.wordLists[i],n=null;return r&&(n=e.I18N.translateSections(t,r)||t),","===n?t:n},e.I18N.translateSections=function(t,e){if("string"==typeof t&&-1!=t.indexOf("‌")){t=t.replace(/([(),])/g,"‌$1‌");var i=t.split("‌");return i.forEach(function(t,i,r){var n=t.match(/^(\s*).*\S(\s*)$/),a=e[t.trim()];a&&(n&&(a=n[1]+a+n[2]),r[i]=a)}),i.join("")}return e[t]},e.I18N.convertCSV=function(t){var i=new RegExp("[“”]|[‘’]","g"),r=new RegExp('^("+)|("(?="))',"g"),n=e.I18N.wordLists;t||(t=e.I18N.csv);for(var a=t.split("\n"),s=a[0],o=s.split(","),l=0;l<o.length;l++){var h=o[l];n[h]||(n[h]={})}for(var c=1;c<a.length;c++){var u=a[c].match(/(".*?"|[^",]+)(?=\s*,|\s*$)|(,(?=,))/g)||[],d=u[0];r.test(d)&&(d=d.replace(r,"")),i.test(d)&&(d=d.replace(i,'"'));for(var p=1;p<u.length;p++){var f=u[p];r.test(f)&&(f=f.replace(r,"")),n[o[p]][d]=f}}},e.I18N.setLanguage=function(t,i,r,n,a){"pu"==i&&(i="pt"),e.I18N.convertCSV(n),e.I18N.language=i,e.I18N.translateUI(i,a),r||(r=e.I18N.translate),t.translationCallback=r},e.I18N.setLocale=function(t,e,i,r,n){if(!Intl.__addLocaleData)return t.setLocale(e,n),void(i&&i(null));r=void 0===r?"locale-data/jsonp":r;var a=r+"/"+e+".js",s=document.createElement("SCRIPT");s.async=!0,s.src=a;var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(s,o.nextSibling),s.onload=function(){t.setLocale(e,n),i&&i(null)},s.onerror=function(){i&&i("cannot load script")}},e.I18N.createMonthArrays=function(t,i,r){t.monthAbv=[],t.monthLetters=[];var n=new Date,a=!0;e.I18N.longMonths&&e.I18N.longMonths[r]&&(a=!1);for(var s=0;s<12;s++){n.setDate(1),n.setMonth(s);var o=i.format(n);if(a){for(var l="",h=0;h<o.length;h++){var c=o.charAt(h);c.charCodeAt(0)<65||(l+=c)}t.monthAbv[s]=l,t.monthLetters[s]=l[0]}else t.monthAbv[s]=o,t.monthLetters[s]=o}},e.I18N.localize=function(t,e){var i=t.locale,r=this.reverseColorsByLocale[e],n=this.reverseColorsByLocale[i];this.setLocale(t,e),this.setLanguage(t,e),r&&n||(r||n)&&this.reverseCandles(t)},e.I18N.reverseCandles=function(t){var e=t.styles,i=t.cloneStyle(e.stx_candle_down),r=t.cloneStyle(e.stx_candle_up);e.stx_candle_up=i,e.stx_candle_down=r},t},__markers_=function(t){var e=t.CIQ;return e.ChartEngine.prototype.makeMarkerHelper=function(){this.markerHelper={chartMap:{},classMap:{}}},e.ChartEngine.prototype.addToHolder=function(t){var i=this.panels[t.params.panelName];if(i){e.derivedFrom(t.params.node,e.Marker.NodeCreator)?(t.stxNodeCreator=t.params.node,t.node=t.stxNodeCreator.node):t.node=t.params.node,this.markerHelper||this.makeMarkerHelper(),t.params.chartContainer?this.container.appendChild(t.node):t.params.includeAxis?i.holder.appendChild(t.node):i.subholder.appendChild(t.node);var r=t.params.label;this.markers[r]||(this.markers[r]=[]),this.markers[r].push(t),t.chart=i.chart,this.markerHelper.chartMap[t.chart.name]||(this.markerHelper.chartMap[t.chart.name]={dataSetLength:0,markers:[]}),this.markerHelper.chartMap[t.chart.name].markers.push(t),t.className||console.log("Marker objects must have a member className");var n=this.markerHelper.classMap[t.className];n||(n=this.markerHelper.classMap[t.className]={}),n[t.params.panelName]||(n[t.params.panelName]=[]),n[t.params.panelName].push(t),this.setMarkerTick(t)}},e.ChartEngine.prototype.getMarkerArray=function(t,e){var i=[];for(var r in this.markers)for(var n=0;n<this.markers[r].length;n++){var a=this.markers[r][n];"panelName"==t?a.params.panelName==e&&i.push(a):"label"==t?r==e&&i.push(a):"all"==t&&i.push(a)}return i},e.ChartEngine.prototype.removeFromHolder=function(t){var e=this.panels[t.params.panelName];e&&(t.node.parentNode==e.holder?e.holder.removeChild(t.node):t.node.parentNode==e.subholder?e.subholder.removeChild(t.node):t.node.parentNode==this.container&&this.container.removeChild(t.node));var i=this.markers[t.params.label];if(i){var r;for(r=0;r<i.length;r++)if(i[r]===t){i.splice(r,1);break}var n=this.markerHelper.chartMap[t.chart.name];if(n)for(r=0;r<n.markers.length;r++)if(n.markers[r]===t){n.markers.splice(r,1);break}var a=this.markerHelper.classMap[t.className];if(a){var s=a[t.params.panelName];if(s)for(r=0;r<s.length;r++)if(s[r]===t){s.splice(r,1);break}}}},e.ChartEngine.prototype.moveMarkers=function(t,e){for(var i=this.getMarkerArray("panelName",t),r=0;r<i.length;r++)i[r].params.panelName=e;for(var n in this.markerHelper.classMap){var a=this.markerHelper.classMap[n][t];a&&(this.markerHelper.classMap[n][e]=a,delete this.markerHelper.classMap[n][t])}},e.ChartEngine.prototype.establishMarkerTicks=function(){this.markerHelper||this.makeMarkerHelper();var t=this.markerHelper.chartMap;for(var e in t){var i=t[e];if(i.dataSetLength!=this.charts[e].dataSet.length)for(var r=0;r<i.markers.length;r++)this.setMarkerTick(i.markers[r])}},e.ChartEngine.prototype.futureTickIfDisplayed=function(t){var e=t.chart;if(!(e.dataSet.length<1)){var i=e.xaxis[e.xaxis.length-1].DT;if(i=new Date(i.getTime()-6e4*this.timeZoneOffset),!(t.params.x>i))for(var r,n,a=e.maxTicks-e.dataSegment.length,s=e.dataSet.length+a,o=new Date(+e.dataSet[e.dataSet.length-1].DT),l=this.standardMarketIterator(o,null,e),h=t.params.x.getTime(),c=e.dataSet.length;c<s;c++){if(r=o.getTime(),o=l.next(),(n=o.getTime())==h)return void(t.tick=c);if(n>h&&r<h)return void(t.tick=Math.max(c-1,0))}}},e.ChartEngine.prototype.setMarkerTick=function(t){var e=t.chart;if("master"==t.params.xPositioner&&t.params.x)return void(t.tick=Math.floor(t.params.x/this.layout.periodicity));if("date"==t.params.xPositioner&&t.params.x){for(var i,r,n=t.params.x.getTime(),a=0;a<e.dataSet.length;a++){if(r=e.dataSet[a].DT.getTime(),i=r,a>0&&(i=e.dataSet[a-1].DT.getTime()),r==n)return void(t.tick=a);if(r>n&&i<n)return void(t.tick=Math.max(a-1,0));if(n<r)return void(t.tick=null)}if(e.dataSet.length<1)return;new Date(+e.dataSet[a-1].DT).getTime()<n&&(t.params.future=!0),t.tick=null}},e.ChartEngine.prototype.positionMarkers=function(){function t(){if(!e.runPrepend("positionMarkers",arguments)){e.markerTimeout=null;for(var t in e.markerHelper.classMap)for(var i in e.markerHelper.classMap[t]){var r=e.markerHelper.classMap[t][i],n=e.panels[i];if(r.length){var a={stx:e,arr:r,panel:n};a.firstTick=n.chart.dataSet.length-n.chart.scroll,a.lastTick=a.firstTick+n.chart.dataSegment.length;var s=r[0].constructor.placementFunction;s?s(a):e.defaultMarkerPlacement(a)}}e.runAppend("positionMarkers",arguments)}}var e=this;e.markerHelper&&(this.markerDelay||0===this.markerDelay?this.markerTimeout||(this.markerTimeout=setTimeout(t,this.markerDelay)):t())},e.Marker=function(t){if(this.params={xPositioner:"date",yPositioner:"value",panelName:"chart",permanent:!1,label:"generic",includeAxis:!1},e.extend(this.params,t),this.params.node||(this.params.node=document.createElement("DIV")),!this.params.stx)return void console.log("Marker created without specifying stx");this.className||(this.className="CIQ.Marker"),this.params.stx.addToHolder(this)},e.Marker.prototype.remove=function(){this.params.stx.removeFromHolder(this)},e.Marker.prototype.render=function(){var t=[this],e={stx:this.params.stx,arr:t,panel:this.params.stx.panels[this.params.panelName],showClass:this.showClass};this.constructor.placementFunction(e)},e.Marker.removeByLabel=function(t,e){for(var i=t.getMarkerArray("label",e),r=0;r<i.length;r++)t.removeFromHolder(i[r])},e.Marker.positionContentVerticalAndHorizontal=function(t){var e=t.querySelectorAll(".stx-marker-expand")[0];if(e){var i=e.offsetWidth,r=e.offsetHeight;if(!i||!r)return;var n=e.style;n.left=n.right="",n.bottom=n.top="";var a=getComputedStyle(e).left,s=getComputedStyle(e).bottom,o=getComputedStyle(e).height,l=t.offsetLeft+parseInt(a,10),h=parseInt(s,10),c=parseInt(o,10),u=t.offsetTop+h-c,d=t.parentNode.offsetWidth,p=t.parentNode.offsetHeight;l+i>d&&(n.right=a,n.left="auto"),t.offsetTop-c<p&&(t.offsetTop-t.offsetHeight<0?(n.top=s,n.bottom="auto"):u+r>p&&(n.top="auto",n.bottom=3*h+"px"))}},e.ChartEngine.prototype.getBarBounds=function(t){var e,i=(this.layout.chartType,this.layout.aggregationType);return e="pandf"==i?{high:Math.max(t.pfOpen,t.pfClose),low:Math.min(t.pfOpen,t.pfClose)}:{high:t.High,low:t.Low},t.markerHigh&&(e.high=markerHigh),t.markerLow&&(e.low=markerLow),e},e.ChartEngine.prototype.defaultMarkerPlacement=function(t){var i=t.panel,r=t.yAxis?t.yAxis:t.panel.yAxis,n=i.chart,a=t.stx,s=a.chart.highLowBars||a.highLowBars[a.layout.chartType],o=n.defaultPlotField;o&&!s||(o="Close");for(var l={},h=0;h<t.arr.length;h++){var c=t.arr[h],u=c.params,d=c.node;c.clientWidth||(c.clientWidth=d.clientWidth),c.clientHeight||(c.clientHeight=d.clientHeight);var p=null,f=u.xPositioner,m=u.yPositioner,g=c.tick,v=n.dataSet,y=c.clientWidth;if("none"!=f){if("bar"==f&&u.x){if(u.x<n.xaxis.length){var x=n.xaxis[u.x];x&&(p=x.data)}d.style.left=Math.round(a.pixelFromBar(u.x,n)-y/2)+1+"px"}else{if(!g&&0!==g){if(!(u.future&&n.scroll<n.maxTicks)){d.style.left="-1000px";continue}if(a.futureTickIfDisplayed(c),!(g=c.tick)&&0!==g){d.style.left="-1000px";continue}}if(g<v.length&&(p=v[g]),c.leftpx=Math.round(a.pixelFromTick(g,n)-n.left-y/2),c.rightEdge=c.leftpx+y,g<t.firstTick&&c.rightEdge<n.left-50)continue;d.style.left=c.leftpx+"px"}p||(p=v[v.length-1])}else if(m.indexOf("candle")>-1&&(left=getComputedStyle(d).left,left)){var b=a.barFromPixel(parseInt(left,10),n);b>=0&&((p=n.xaxis[b].data)||(p=v[v.length-1]))}var C,S=u.y,w=d.clientHeight;if("none"!=m){var M=u.chartContainer?a.height:i.yAxis.bottom,T=0,B=0;void 0===l[d.style.left]&&(l[d.style.left]=0),B=l[d.style.left],l[d.style.left]+=w,"value"==m&&S?T=Math.round(M-a.pixelFromPrice(S,i,r)-w/2)+"px":"under_candle"==m&&p?(C=p[o],s&&(C=a.getBarBounds(p).low),T=Math.round(M-a.pixelFromPrice(C,i,r)-w-B)+"px"):"on_candle"==m&&p?(C=p[o],s&&(C=(p.Low+p.High)/2),T=Math.round(M-a.pixelFromPrice(C,i,r)-w/2-B)+"px"):"top"==m?T=Math.round(M-w-B)+"px":"bottom"==m?T=Math.round(B)+"px":p&&(C=p[o],s&&(C=a.getBarBounds(p).high),T=Math.round(M-a.pixelFromPrice(C,i,r)+B)+"px"),d.style.bottom!=T&&(d.style.bottom=T)}e.Marker.positionContentVerticalAndHorizontal(d)}},e.Marker.NodeCreator=function(){},e.Marker.NodeCreator.toNode=function(){return this.node},e.Marker.Simple=function(t){function i(){e.Marker.positionContentVerticalAndHorizontal(r)}var r=this.node=document.createElement("div");r.className="stx-marker",e.appendClassName(r,t.type),t.category&&e.appendClassName(r,t.category);var n=e.newChild(r,"div","stx-visual");e.newChild(r,"div","stx-stem");var a;if("callout"==t.type){var s=e.newChild(n,"div","stx-marker-content");e.newChild(s,"h4",null,t.headline),a=e.newChild(s,"div","stx-marker-expand"),e.newChild(a,"p",null,t.story)}else a=e.newChild(r,"div","stx-marker-expand"),e.newChild(a,"h4",null,t.headline),e.newChild(a,"p",null,t.story),e.safeClickTouch(a,function(t){e.toggleClassName(r,"highlight")});e.safeClickTouch(n,function(t){e.toggleClassName(r,"highlight"),setTimeout(i,10)})},e.Marker.Simple.ciqInheritsFrom(e.Marker.NodeCreator,!1),t},__quoteFeed_=function(t){function e(){}var i=t.CIQ;return e.fetchInitialData=function(t,e,i,r,n){},e.fetchUpdateData=function(t,e,i,r){},e.fetchPaginationData=function(t,e,i,r,n){},e.subscribe=function(t){},e.unsubscribe=function(t){},i.QuoteFeed=function(){},i.QuoteFeed.prototype.fetch=function(t,e){this.v2QuoteFeed||console.log("You must implement CIQ.QuoteFeed.[yourfeedname].prototype.fetch()")},i.QuoteFeed.prototype.announceError=function(t,e){t.suppressErrors||e.suppressAlert||t.startDate||t.endDate||e.error&&i.alert("Error fetching quote:"+e.error)},i.QuoteFeed.prototype.multiFetch=function(t,e){function r(t,e,i){return function(r){if(e.results.push({dataCallback:r,params:t}),++e.counter>=e.finished){var n=e.results;e.results=[],i(n)}}}0===t.length&&e([]);for(var n={counter:0,finished:t.length,results:[]},a=0;a<t.length;a++){var s=t[a];s.stx.isEquationChart(s.symbol)?i.fetchEquationChart(s,r(s,n,e)):i.ChartEngine.Driver.fetchData(i.QuoteFeed.SERIES,this,s,r(s,n,e))}},i.QuoteFeed.Subscriptions=function(){this.subscriptions=[]},i.QuoteFeed.Subscriptions.ciqInheritsFrom(i.QuoteFeed),i.QuoteFeed.Subscriptions.prototype.checkSubscriptions=function(t){for(var e,i,r=t.getSymbols(),n=0;n<this.subscriptions.length;n++)this.subscriptions[n].match=!1;for(var a=0;a<r.length;a++){i=r[a];var s=i.interval;for("month"!=s&&"week"!=s||t.dontRoll||(s="day"),i.interval=s,i.period=1,i.match=!1,isNaN(i.interval)||(i.period=i.interval,i.interval=i.timeUnit,i.interval||(i.interval="minute")),delete i.periodicity,delete i.timeUnit,delete i.setSpan,n=0;n<this.subscriptions.length;n++){if(e=this.subscriptions[n],e.symbol==i.symbol&&e.period==i.period&&e.interval==i.interval){i.match=!0,e.match=!0;break}e.symbol!=i.symbol?("period"!=i.reason&&(i.reason="symbol"),e.reason="symbol"):(i.reason="period",e.reason="period")}}var o=this;this.subscriptions=this.subscriptions.filter(function(e){return e.match||(e.stx||(e.stx=t),o.unsubscribe(e)),e.match}),r.forEach(function(e){e.match||(e.stx||(e.stx=t),e.reason||(e.reason="initialize"),o.subscribe(e),o.subscriptions.push(e))})},i.QuoteFeed.Subscriptions.prototype.fetch=function(t,e){var i=this;this.fetchFromSource(t,function(r){r.error||i.checkSubscriptions(t.stx),e(r)})},i.QuoteFeed.Subscriptions.prototype.subscribe=function(t){console.log("subscribe",t)},i.QuoteFeed.Subscriptions.prototype.unsubscribe=function(t){console.log("unsubscribe",t)},i.QuoteFeed.Subscriptions.prototype.fetchFromSource=function(t,e){console.log("Please provide implementation of fetchFromSource")},i.QuoteFeed.prototype.requiresImmediateRefresh=function(t){return!1},i.ChartEngine.prototype.attachQuoteFeed=function(t,e){if(e||(e={}),this.quoteDriver&&this.quoteDriver.die(),"function"!=typeof t.fetchInitialData&&"function"!=typeof t.fetchUpdateData&&"function"!=typeof t.fetchPaginationData)return void(this.quoteDriver=new i.ChartEngine.Driver(this,t,e));"function"!=typeof t.fetchPaginationData&&"function"!=typeof t.fetchUpdateData&&(e.noLoadMore=!0),t.v2QuoteFeed=!0,["multiFetch","announceError","requiresImmediateRefresh"].forEach(function(e){t[e]||(t[e]=i.QuoteFeed.prototype[e])}),"function"==typeof t.subscribe&&(t.checkSubscriptions=i.QuoteFeed.Subscriptions.prototype.checkSubscriptions,t.subscriptions=[]),this.quoteDriver=new i.ChartEngine.Driver(this,t,e)},i.ChartEngine.prototype.attachEngineQuoteFeed=function(t,e){console.log("CIQ.ChartEngine.attachEngineQuoteFeed is now Deprecated. Use CIQ.ChartEngine.attachQuoteFeed instead"),this.attachQuoteFeed(t,e)},i.ChartEngine.prototype.attachTagAlongQuoteFeed=function(t){if(!t.label)return void console.log("Attempt to attachTagAlongQuoteFeed without assigning a label");this.quoteDriver.attachTagAlongQuoteFeed(t)},i.ChartEngine.prototype.detachTagAlongQuoteFeed=function(t){if(!t.label)return void console.log("Attempt to detachTagAlongQuoteFeed without assigning a label");this.quoteDriver.detachTagAlongQuoteFeed(t)},i.ChartEngine.Driver=function(t,e,i){this.tagalongs={},this.stx=t,this.quoteFeed=e,i.maximumTicks||(i.maximumTicks=e.maxTicks?e.maxTicks:2e4),this.behavior=i,this.loadingNewChart=!1,this.intervalTimer=null,this.updatingChart=!1,this.updateChartLoop()},i.ChartEngine.Driver.prototype.die=function(){this.intervalTimer&&(window.clearInterval(this.intervalTimer),this.intervalTimer=-1)},i.ChartEngine.Driver.prototype.updateSubscriptions=function(){this.quoteFeed.checkSubscriptions&&this.quoteFeed.checkSubscriptions(this.stx)},i.ChartEngine.Driver.prototype.attachTagAlongQuoteFeed=function(t){t.label&&(this.tagalongs[t.label]||(this.tagalongs[t.label]={label:t.label,quoteFeed:t.quoteFeed,behavior:t.behavior?t.behavior:{},count:0}),this.tagalongs[t.label].count++)},i.ChartEngine.Driver.prototype.detachTagAlongQuoteFeed=function(t){if(t.label){var e=this.tagalongs[t.label];e.count--,e.count||(this.tagalongs[t.label]=null)}},i.ChartEngine.Driver.prototype.loadDependents=function(t,e){var r,n,a,s=t.stx,o=t.chart,l=o.series,h=s.masterData,c=[],u=t.originalState.update;for(r in l)if(n=l[r],u||!1!==n.moreAvailable){var d=n.parameters;if(a=d.symbolObject,a.symbol&&!1!==d.loadData&&(!d.data||d.data.useDefaultQuoteFeed)){for(var p=!0,f=0;f<c.length;f++)i.symbolEqual(c[f],a)&&(p=!1);p&&c.push(a)}}for(var m=[],g=0;g<c.length;g++){a=c[g];var v=i.shallowClone(t.originalState);v.symbol=a.symbol,v.symbolObject=a,n=l[r],v.update?v.startDate=function(e){for(var r=h.length-1;r>=0;r--)if(h[r]&&void 0!==h[r][e])return i.strToDateTime(h[r].Date);return t.startDate}(r):(v.startDate||(v.startDate=t.startDate),v.endDate||(v.endDate=s.convertToDataZone(new Date)),v.ticks=t.ticks),m.push(v)}if(!m.length)return s.createDataSet(null,null,{appending:t.originalState.update}),t.nodraw||s.draw(),void(e&&e(null));this.quoteFeed.multiFetch(m,function(r){return function(a){for(var o=null,l=0;l<a.length;l++){var h=a[l],c=h.dataCallback.error;if(!c&&0!==c){for(var u=h.params.symbolObject,d=h.dataCallback,p=d.quotes,f=d.moreAvailable,m=s.getSeries({symbolObject:u}),g={},v=0;v<m.length;v++)n=m[v],r||(n.moreAvailable=!1!==f&&(f||p.length>(h.params.endDate?1:0))),g=n.parameters;i.addMemberToMasterdata({stx:s,label:u.symbol,data:p,fieldForLabel:g.field,fillGaps:g.fillGaps,createObject:!0}),p&&p.length&&(!o||o>p[0].DT)&&(o=p[0].DT)}}s.createDataSet(null,null,{appending:t.originalState.update,appendToDate:o}),t.nodraw||s.draw(),e&&e(null)}}(u))},i.ChartEngine.Driver.prototype.executeTagAlongs=function(t){var e={count:i.objLength(this.taglongs)},r=this;for(var n in this.tagalongs){var a=this.tagalongs[n],s=i.shallowClone(a.behavior);i.extend(s,t,!0),i.ChartEngine.Driver.fetchData(null,a.quoteFeed,s,function(t,e,n){return function(a){if(n.count--,!a.error){var s=t.fields;s||(s=null),i.addMemberToMasterdata(r.stx,e.label,a.quotes,s)}-1==n.count&&(r.stx.createDataSet(null,null,{appending:t.originalState.update}),r.stx.draw())}}(s,a,e))}},i.ChartEngine.Driver.prototype.updateChart=function(){if(!this.updatingChart&&!this.loadingNewChart){var t=i.objLength(this.stx.charts),e=0,r=this.stx.layout.interval,n=this.stx.layout.timeUnit;for(var a in this.stx.charts){var s=this.stx.charts[a];if(s.symbol){var o=this.makeParams(s.symbol,s.symbolObject,s);s.masterData&&s.masterData.length&&(o.startDate=s.masterData[s.masterData.length-1].DT),o.update=!0,o.originalState=i.shallowClone(o),this.updatingChart=!0;var l=function(i,a,s){return i.behavior.prefetchAction&&i.behavior.prefetchAction("updateChart"),function(o){e++;var l=i.stx,h=a.chart,c=h.masterData;if(s==h.symbol&&r==l.layout.interval&&n==l.layout.timeUnit){if(o.error)i.quoteFeed.announceError(a.originalState,o);else{var u=o.quotes;l.doCleanupDates(o.quotes,r);var d=!1;if(!a.missingBarsCreated){if(c&&c.length&&u&&u.length>0){var p=c[c.length-1],f=u[0];(f.DT&&p.DT<f.DT||f.Date&&p.Date<f.Date)&&(u.unshift(p),d=!0)}o.quotes=u=l.doCleanupGaps(u,h),d&&u.shift()}l.updateChartData(u,h,{noCreateDataSet:!0}),h.attribution=o.attribution}e==t&&(i.updatingChart=!1),i.executeTagAlongs(a),i.behavior.callback&&i.behavior.callback(a),i.loadDependents(a)}}}(this,o,s.symbol);this.stx.isEquationChart(o.symbol)?i.fetchEquationChart(o,l):i.ChartEngine.Driver.fetchData(i.QuoteFeed.UPDATE,this.quoteFeed,o,l)}}}},i.ChartEngine.Driver.prototype.updateChartLoop=function(t){-1!=this.intervalTimer&&(this.intervalTimer&&window.clearInterval(this.intervalTimer),this.behavior.noUpdate||(t||0===t||(t=this.behavior.refreshInterval),t&&(this.intervalTimer=window.setInterval(function(t){return function(){t.behavior.noUpdate||t.updateChart()}}(this),1e3*t))))},i.ChartEngine.Driver.prototype.resetRefreshInterval=function(t){this.behavior.refreshInterval=t,this.updateChartLoop()},i.ChartEngine.Driver.prototype.loadAll=function(t,e){function i(){return function(a){a?e(a):t.moreAvailable?t.loadingMore?e(null):++n>20?e("error, moreAvailable not implemented correctly in QuoteFeed"):r.checkLoadMore(t,!0,!0,i()):e(null)}}var r=this,n=0;i()()},i.ChartEngine.Driver.prototype.checkLoadMore=function(t,e,r,n,a){function s(e){t.loadingMore=!1,n&&n(e)}if(t.loadingMore)return t.initialScroll=t.scroll,void(n&&n(null));var o,l=this.stx;if(!t.moreAvailable){if(t.dataSet.length>0&&t.scroll>=t.dataSet.length||e)for(var h in t.series)if(!1!==t.series[h].moreAvailable)return o=this.makeParams(t.symbol,t.symbolObject,t),t.masterData&&t.masterData.length?o.endDate=t.masterData[0].DT:o.endDate=l.convertToDataZone(new Date),o.originalState=i.shallowClone(o),o.nodraw=a,t.loadingMore=!0,void this.loadDependents(o,s);return void(n&&n(null))}var c=l.layout.interval,u=l.layout.timeUnit,d=!1;if(!this.behavior.noLoadMore&&(!l.maxDataSetSize||t.dataSet.length<l.maxDataSetSize)){var p=t.dataSet.length-(this.behavior.bufferSize||0);if(p<0&&(p=0),t.scroll>=p||e){t.initialScroll=t.scroll,t.loadingMore=!0,o=this.makeParams(t.symbol,t.symbolObject,t),t.masterData&&t.masterData.length?o.endDate=function(){for(var e=0;e<t.masterData.length;e++)if(t.masterData[e]&&void 0!==t.masterData[e][t.defaultPlotField])return t.masterData[e].DT;return t.masterData[0].DT}():o.endDate=l.convertToDataZone(new Date),o.originalState=i.shallowClone(o),o.nodraw=a,l.fetchMaximumBars[l.layout.aggregationType]&&(r=!0),r&&(o.fetchMaximumBars=!0,!l.maxMasterDataSize||this.behavior.maximumTicks<l.maxMasterDataSize?o.ticks=this.behavior.maximumTicks:o.ticks=l.maxMasterDataSize);var f=function(t,e){return t.behavior.prefetchAction&&t.behavior.prefetchAction("checkLoadMore"),function(r){var s=t.stx,o=e.chart;if(e.symbol==o.symbol&&c==s.layout.interval&&u==s.layout.timeUnit)if(e.loadMore||(e.chart.loadingMore=!1),r.error)t.quoteFeed.announceError(e.originalState,r),e.chart.loadingMore=!1,n&&n(r.error);else{if(r.quotes||(r.quotes=[]),s.doCleanupDates(r.quotes,c),r.quotes.length){var l=r.quotes[r.quotes.length-1];!l.DT&&l.Date&&(l.DT=i.strToDateTime(l.Date)),l.DT&&+l.DT==+o.masterData[0].DT&&r.quotes.pop()}e.missingBarsCreated||(r.quotes.push(o.masterData[0]),r.quotes=s.doCleanupGaps(r.quotes,o),r.quotes.pop()),r.moreAvailable?o.moreAvailable=!0:!1!==r.moreAvailable&&r.quotes.length?o.moreAvailable=!0:o.moreAvailable=!1,t.tickMultiplier=r.quotes.length?2:2*t.tickMultiplier,o.loadingMore=!1,e.loadMoreReplace?s.setMasterData(r.quotes,o):i.addMemberToMasterdata({stx:s,chart:o,data:r.quotes,fields:["*"]}),s.createDataSet(),a||s.draw(),t.executeTagAlongs(e),t.behavior.callback&&t.behavior.callback(e),t.loadDependents(e,n)}}}(this,o);l.isEquationChart(o.symbol)?i.fetchEquationChart(o,f):i.ChartEngine.Driver.fetchData(i.QuoteFeed.PAGINATION,this.quoteFeed,o,f),d=!0}}!d&&n&&n(null)},i.ChartEngine.Driver.prototype.barsToFetch=function(t){if(t.isSeries)return t.stx.masterData.length;var e=this.stx.layout.interval,i=t.stx.layout.periodicity;return"month"!=e&&"week"!=e||this.stx.dontRoll||(i*="week"==e?7:30),t.stx.chart.maxTicks*i*this.tickMultiplier},i.ChartEngine.Driver.determineStartDate=function(t,e,r){var n=t.interval,a=t.stx.layout.periodicity,s=i.Market.Symbology.isForexSymbol?1.3:4;n="millisecond"===n||"second"===n?i.SECOND*a*s:"minute"===n?i.MINUTE*a*s:i.DAY*s;return t.fetchMaximumBars?new Date(Date.now()-r*n):t.startDate?t.startDate:e.previous(r)},i.ChartEngine.Driver.prototype.makeParams=function(t,e,r){var n=this.stx.layout.interval,a=this.barsToFetch({stx:this.stx});"month"!=n&&"week"!=n||this.stx.dontRoll||(n="day");var s=i.shallowClone(this.behavior);return i.extend(s,{stx:this.stx,symbol:t,symbolObject:e,chart:r,interval:n,extended:this.stx.layout.extended,period:1,feed:"delayed",ticks:a},!0),s.symbolObject||(s.symbolObject={symbol:t}),isNaN(s.interval)||(s.period=parseInt(s.interval,10),s.interval=this.stx.layout.timeUnit,s.interval||(s.interval="minute")),s},i.ChartEngine.Driver.prototype.newChart=function(t,e){var r=this.stx,n=t.symbol,a=r.layout.interval,s=r.layout.timeUnit,o=t.chart;o.moreAvailable=null,o.attribution=null,this.tickMultiplier=2;var l=this.makeParams(n,t.symbolObject,o);i.extend(l,t,!0),(r.fetchMaximumBars[r.layout.aggregationType]||t.fetchMaximumBars)&&(!r.maxMasterDataSize||this.behavior.maximumTicks<r.maxMasterDataSize?l.ticks=this.behavior.maximumTicks:l.ticks=r.maxMasterDataSize,l.fetchMaximumBars=!0),this.loadingNewChart=!0,this.updatingChart=!1,l.originalState=i.shallowClone(l);var h=function(i,o){return i.behavior.prefetchAction&&i.behavior.prefetchAction("newChart"),function(l){var h=o.chart,c=l.quotes;if(n!=h.symbol||a!=r.layout.interval||s!=r.layout.timeUnit)return void(e&&e("orphaned"));l.error?i.quoteFeed.announceError(o.originalState,l):(r.doCleanupDates(c,a),o.missingBarsCreated||(c=r.doCleanupGaps(c,h)),r.setMasterData(c,h),h.moreAvailable=!!c&&!1!==l.moreAvailable,h.attribution=l.attribution,t.initializeChart&&r.initializeChart(),r.createDataSet(),o.nodraw||r.home());for(var u in h.series)h.series[u].moreAvailable=null;i.loadingNewChart=!1;var d=h.masterData;d&&d.length&&(o.startDate=d[0].DT,o.endDate=d[d.length-1].DT),i.executeTagAlongs(o),i.behavior.callback&&i.behavior.callback(o),i.loadDependents(o,function(){e&&e(l.error),i.stx.dispatch("newChart",{stx:i.stx,symbol:i.stx.chart.symbol,symbolObject:i.stx.chart.symbolObject,moreAvailable:i.stx.chart.moreAvailable,quoteDriver:i}),i.resetRefreshInterval(i.behavior.refreshInterval)})}}(this,l);this.stx.isEquationChart(l.symbol)?i.fetchEquationChart(l,h):i.ChartEngine.Driver.fetchData(i.QuoteFeed.INITIAL,this.quoteFeed,l,h)},i.QuoteFeed.INITIAL=1,i.QuoteFeed.UPDATE=2,i.QuoteFeed.PAGINATION=3,i.QuoteFeed.SERIES=4,i.ChartEngine.Driver.fetchData=function(t,e,r,n){e.v2QuoteFeed?"function"!=typeof e.subscribe?i.ChartEngine.Driver.fetchDataInContext(t,e,r,n):i.ChartEngine.Driver.fetchDataInContext(t,e,r,function(t){t.error||e.checkSubscriptions(r.stx),n(t)}):e.fetch(r,n)},i.ChartEngine.Driver.fetchDataInContext=function(t,e,r,n){var a,s,o,l;switch(t===i.QuoteFeed.SERIES&&(r.series=!0,t=i.QuoteFeed.INITIAL,r.endDate&&!r.startDate?t=i.QuoteFeed.PAGINATION:r.startDate&&!r.endDate&&(t=i.QuoteFeed.UPDATE)),t){case i.QuoteFeed.UPDATE:var h;r.startDate?h=r.startDate:(h=new Date,h.setHours(0,0,0,0)),"function"==typeof e.fetchUpdateData&&e.fetchUpdateData(r.symbol,h,r,n);break;case i.QuoteFeed.INITIAL:l=new Date,l.setMilliseconds(0),a={begin:l,interval:"tick"==r.interval?1:r.interval,periodicity:"tick"==r.interval?r.stx.chart.xAxis.futureTicksInterval:r.period,inZone:r.stx.dataZone,outZone:r.stx.dataZone},s=r.stx.chart.market.newIterator(a),o=i.ChartEngine.Driver.determineStartDate(r,s,r.ticks),l=r.endDate?r.endDate:l,"function"==typeof e.fetchInitialData&&e.fetchInitialData(r.symbol,o,l,r,n);break;case i.QuoteFeed.PAGINATION:a={begin:r.endDate,interval:"tick"==r.interval?1:r.interval,periodicity:"tick"==r.interval?r.stx.chart.xAxis.futureTicksInterval:r.period,inZone:r.stx.dataZone,outZone:r.stx.dataZone},s=r.stx.chart.market.newIterator(a);var c=Math.min(r.ticks,r.stx.quoteDriver.behavior.maximumTicks);if(o=i.ChartEngine.Driver.determineStartDate(r,s,c),"function"==typeof e.fetchPaginationData){if(r.stx.maxMasterDataSize&&r.stx.maxMasterDataSize<=r.stx.masterData.length)return;e.fetchPaginationData(r.symbol,o,r.endDate,r,n)}break;default:console.error("Illegal fetchData constant")}},t},__span_=function(t){var e=t.CIQ;return e.ChartEngine.prototype.setRange=function(t,i){function r(e){void 0===e&&(e=null);var r=0,n=0,a=new Date,h=t.base,u=t.periodicity,d=c.layout;if(t.goIntoFuture&&(!s.masterData.length||o>s.masterData[s.masterData.length-1].DT)){
var p=s.masterData.length?s.masterData.pop():{DT:o},f=c.doCleanupGaps([p,{DT:l}],s,{cleanupGaps:"gap"});c.setMasterData(s.masterData.concat(f)),c.createDataSet(null,null,{appending:!0})}var m=s.dataSet,g=m.length;if(!m||0===g)return void(i&&i(e));if("day"===h&&u&&"day"===u.interval){var v=t.multiplier;r=g<v?0:g-v,n=g-1}else if("today"===h&&m[g-1].DT.getDate()!=a.getDate()){for(var y=new Date(m[g-1].DT.getTime()),x=new Date(y.getTime()),b=g-1;b>=0;b--)if(m[b]&&m[b].DT.getDate()!=y.getDate()){y=new Date(+m[b+1].DT);break}x.getTime()==y.getTime()&&(y=new Date(+m[0].DT)),r=c.tickFromDate(y,s,null,!0),n=c.tickFromDate(x,s)}else r=o.getTime()>=m[0].DT.getTime()||t.goIntoPast?c.tickFromDate(o,s,null,!0):0,n=l.getTime()<=m[g-1].DT.getTime()||t.goIntoFuture?c.tickFromDate(l,s):g-1;var C=n-r+1;if(C<1)return void(i&&i(e));var S=c.getLabelOffsetInPixels(c,s,d.chartType),w=Math.max(S,t.padding);n<g-1&&(w=0);var M=(s.width-w)/C;c.setCandleWidth(M,s),s.scroll=C-(n-g)-1,c.micropixels=1;for(var T in c.panels)c.calculateYAxisMargins(c.panels[T].yAxis);t.dontSaveRangeToLayout?delete d.range:(delete t.chart,delete d.setSpan,d.range=t),c.draw(),c.changeOccurred("layout"),i&&i(e)}function n(t){return t&&0===u?(s.scroll=k,c.setCandleWidth(D),c.layout.interval=A,c.layout.periodicity=F,c.layout.timeUnit=_,void(i&&i(t))):++u>10?(console.log("CIQ.ChartEngine.setRange(): Too many loads (10) from server. Stopping. Check periodicity logic."),void r()):void(s.moreAvailable&&s.masterData[0]&&s.masterData[0].DT>o?c.quoteDriver.checkLoadMore(s,!0,!1,function(t){t?r(t):n()},!0):r())}e.isEmpty(t)&&(t={dtLeft:arguments[0],dtRight:arguments[1],padding:arguments[2],chart:arguments[3]},i=arguments[4]),this.staticRange&&(t.goIntoPast=t.goIntoFuture=!0),t.chart||(t.chart=this.chart),void 0===t.padding&&(t.padding=0);var a=!1,s=t.chart,o="string"==typeof t.dtLeft?new Date(t.dtLeft):t.dtLeft,l=this.convertToDataZone(new Date);if(t.dtRight&&(l="string"==typeof t.dtRight?new Date(t.dtRight):t.dtRight),!o){var h=this.standardMarketIterator(l,null,s);o=h.previous(s.maxTicks),t.periodicity||(a=!0)}s.inflectionPoint=o;var c=this,u=0;if(this.quoteDriver){var d,p,f;if(a)d=this.layout.interval,f=this.layout.timeUnit,p=this.layout.periodicity;else if(t.periodicity){var m=e.cleanPeriodicity(t.periodicity.period,t.periodicity.interval,t.periodicity.timeUnit);d=m.interval,f=m.timeUnit,p=m.period}else{var g=l.getTime()-o.getTime();if(this.autoPickCandleWidth.turnOn){var v=0;v=this.autoPickCandleWidth.candleWidth?this.autoPickCandleWidth.candleWidth:this.barsHaveWidth[this.layout.chartType]?5:2;var y=s.width/v,x=this.dynamicRangePeriodicityMap;d=x[0].interval,p=1;for(var b,C=0;C<x.length;C++){var S=g/x[C].rangeInMS;if(S<y){x[C-1]?(d=x[C-1].interval,f=x[C-1].timeUnit,p=Math.ceil(b/y)):(d=x[C].interval,f=x[C].timeUnit,p=1);break}b=S}}else{for(var w=this.staticRangePeriodicityMap,M=null,T=0;T<w.length;T++){var B=w[T];if(g/B.rangeInMS<1.001){M=B;break}}d=M.interval,p=M.periodicity,f=M.timeUnit}}var k=this.chart.scroll,D=this.layout.candleWidth,A=this.layout.interval,F=this.layout.periodicity,_=this.layout.timeUnit;this.chart.scroll=this.chart.maxTicks=function(t,i,r,n,a,s){var o=0,l=t-i;return e.ChartEngine.isDailyInterval(r)?o="month"==r?l/e.MONTH/n:"week"==r?l/e.WEEK/n:l/e.DAY/n:isNaN(r)||(o="millisecond"==a?l/(n*r):"second"==a?l/e.SECOND/(n*r):l/e.MINUTE/(n*r)),Math.round(o)}(l.getTime(),o.getTime(),d,p,f,this.dontRoll),this.layout.candleWidth=this.chart.width/this.chart.maxTicks;var P=this.needDifferentData({period:p,interval:d,timeUnit:f});if(this.chart.masterData&&this.chart.masterData.length&&this.chart.masterData[0].DT>o&&(P=!0),!this.chart.masterData||!this.chart.masterData.length||P||t.forceLoad){this.layout.interval=d,this.layout.periodicity=p,this.layout.timeUnit=f,this.layout.timeUnit||(e.ChartEngine.isDailyInterval(this.layout.interval)?this.layout.timeUnit=null:"second"==this.layout.interval?this.layout.timeUnit="second":"tick"!=this.layout.interval&&(this.layout.timeUnit="minute"));var E={symbol:s.symbol,symbolObject:s.symbolObject,chart:s,nodraw:!0};"tick"==this.layout.interval&&(E.startDate=o,E.endDate=l),this.displayInitialized||(E.initializeChart=!0),E.startDate=new Date(2*o-l),E.startDate.setHours(0,0,0,0),this.quoteDriver.newChart(E,n)}else this.layout.interval==d&&this.layout.periodicity==p&&this.layout.timeUnit==f&&this.chart.dataSegment&&this.chart.dataSegment[0]&&this.chart.dataSegment[0].DT==s.inflectionPoint||(this.layout.interval=d,this.layout.periodicity=p,this.layout.timeUnit=f,this.createDataSet()),n()}else r()},e.ChartEngine.prototype.setSpan=function(t,i){function r(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}var n=arguments[0],a=arguments[1],s=arguments[2],o=arguments[3];if("object"==typeof t?(n=t.period?t.period:t.multiplier?t.multiplier:1,a=t.interval?t.interval:t.base?t.base:t.span?t.span:t.period,s=t.padding,o=t.chart):(t={period:n,interval:a,padding:s,chart:o},i=arguments[5]),o||(o=this.chart),"all"==(a=a.toLowerCase()))return void this.displayAll(t,i);var l=a,h=1;"today"==a?l="day":"year"==a&&(l="month",h=12);var c,u=e.shallowClone(t),d={begin:new Date,interval:l,period:h,outZone:this.dataZone};"ytd"!==a&&(c=o.market.newIterator(d));var p=this.convertToDataZone(new Date);if("ytd"===a)p=r(p),p.setMonth(0),p.setDate(1);else if("today"===a)c.next(),(p=c.previous())>d.begin&&(p=c.previous());else if("month"===a)p=r(new Date),p.setMonth(p.getMonth()-n);else if("year"===a)p=r(new Date),p.setFullYear(p.getFullYear()-n);else if("week"===a)p=r(new Date),p.setDate(p.getDate()-7*n);else if("day"===a&&1==n&&this.chart.market.isMarketDay()){var f=p.getHours(),m=p.getMinutes(),g=p.getSeconds(),v=p.getMilliseconds();p=c.previous(),p.setHours(f),p.setMinutes(m),p.setSeconds(g),p.setMilliseconds(v)}else 1==n&&n++,p=c.previous(n-1);u.dtLeft=p,"today"===a&&(u.goIntoFuture=!0,u.dtRight=new Date(+p),u.dtRight.setDate(p.getDate()+1),u.dtRight=o.market._convertFromMarketTZ(u.dtRight,this.dataZone),u.dtLeft.setHours(c.market.zopen_hour),u.dtLeft.setMinutes(c.market.zopen_minute),u.dtLeft.setSeconds(0),u.dtLeft=o.market._convertFromMarketTZ(u.dtLeft,this.dataZone)),u.maintainPeriodicity&&(u.periodicity={},u.periodicity.interval=this.layout.interval,u.periodicity.period=this.layout.periodicity),o.spanLock=!1,u.dontSaveRangeToLayout=!0;var y=this;this.setRange(u,function(e){y.layout.setSpan=t,y.changeOccurred("layout"),"today"==a&&(o.spanLock=!0),i&&i(e)})},e.ChartEngine.prototype.getSpanCandleWidth=function(t){if(t&&t.base&&t.multiplier){var e=parseFloat(t.multiplier),i=t.base,r=new Date,n=new Date;"year"==i?n.setFullYear(n.getFullYear()-e):"month"==i?n.setMonth(n.getMonth()-e):"day"==i?n.setDate(n.getDate()-e):"week"==i?n.setDate(n.getDate()-7*e):"YTD"==i&&(n.setMonth(0),n.setDate(1));var a=(r.getTime()-n.getTime())/1e3/60/60/24;a=5*a/7;return this.chart.width/a}},e.ChartEngine.prototype.displayAll=function(t,i){function r(){if(a.masterData&&a.masterData.length){var r=e.clone(t);r.dtLeft=a.masterData[0].DT,r.dtRight=a.masterData[a.masterData.length-1].DT,t.maintainPeriodicity?(r.periodicity={},r.periodicity.interval=s.layout.interval,r.periodicity.period=s.layout.periodicity):t.periodicity&&(r.periodicity=t.periodicity),s.setRange(r,function(e){t.maintainPeriodicity||(s.layout.setSpan={base:t.base,multiplier:t.multiplier},s.changeOccurred("layout"));for(var r in s.panels)s.calculateYAxisMargins(s.panels[r].yAxis);s.draw(),i&&i(e)})}}function n(){s.quoteDriver.loadAll(a,r)}var a=this.chart;t&&t.chart&&(a=t.chart);var s=this;if(!this.quoteDriver)return void r();var o=t.maintainPeriodicity?{periodicity:this.layout.periodicity,interval:this.layout.interval}:{periodicity:1,interval:"month"};o=t.periodicity?t.periodicity:o,o.period&&(o.periodicity=o.period);var l=this.needDifferentData(o);this.layout.periodicity=o.periodicity,this.layout.interval=o.interval,this.layout.timeUnit=o.timeUnit,t.forceLoad||l?this.quoteDriver.newChart({noDraw:!0,symbol:this.chart.symbol,symbolObject:this.chart.symbolObject,chart:this.chart,initializeChart:!0,fetchMaximumBars:!0},n):a.moreAvailable?n():(this.createDataSet(),r())},t},__studies_=function(t){var e=t.CIQ;return e.Studies=function(){},e.Studies.DEFAULT_INPUTS={Period:14},e.Studies.DEFAULT_OUTPUTS={Result:"auto"},e.Studies.actualOutputs=[],e.Studies.studyPanelMap={},e.Studies.colorPickerDiv=null,e.Studies.StudyDescriptor=function(t,i,r,n,a,s){this.name=t,this.type=i,this.panel=r,this.inputs=n,this.outputs=a,this.parameters=s,this.outputMap={},this.min=null,this.max=null,this.startFrom=0;var o=e.Studies.studyLibrary[i];o||(o={},("chart"==r||!r&&s&&"chart"==s.chartName)&&(this.overlay=!0)),void 0===o.inputs&&(o.inputs=e.clone(e.Studies.DEFAULT_INPUTS)),void 0===o.outputs&&(o.outputs=e.clone(e.Studies.DEFAULT_OUTPUTS)),this.study=o,this.libraryEntry=o},e.Studies.generateID=function(t,i,r,n,a){var s=e.Studies.studyLibrary[i];if(s&&(s.customRemoval||e.isEmpty(r)))return a||i;var o="‌"+(a||i)+"‌",l=o+" (",h=!1;for(var c in r)if("id"!=c&&"display"!=c&&"Shading"!=c){var u=r[c];"field"!=u&&(u=u.toString(),void 0!==e.Studies.prettify[u]&&(u=e.Studies.prettify[u]),h?u&&(l+=","):h=!0,l+=u)}if(l+=")",n&&0===n.indexOf(l))return n;if(t.layout.studies&&t.layout.studies[l])for(var d=2;d<50;d++){var p=l+"-"+d;if(!t.layout.studies[p]){l=p;break}}return l},e.Studies.DialogHelper=function(t){var i=this.stx=t.stx,r=this.sd=t.sd;this.name=r?r.type:t.name,this.inputs=[],this.outputs=[],this.parameters=[];var n=this.libraryEntry=r?r.study:e.Studies.studyLibrary[t.name];void 0===n.inputs&&(n.inputs=e.clone(e.Studies.DEFAULT_INPUTS)),void 0===n.outputs&&(n.outputs=e.clone(e.Studies.DEFAULT_OUTPUTS));var a=r&&i.panels[r.panel]?i.panels[r.panel]:{chart:i.chart},s=a.chart;this.title=i.translateIf(n.name),this.attributes=n.attributes,this.attributes||(this.attributes={});for(var o in n.inputs){var l={};this.inputs.push(l),l.name=o,l.heading=i.translateIf(o);var h=n.inputs[o];if(r&&r.inputs&&void 0!==r.inputs[o]&&null!==r.inputs[o]?l.value=r.inputs[o]:l.value=n.inputs[o],l.defaultInput=n.inputs[o],this.attributes[o]||(this.attributes[o]=e.Studies.inputAttributeDefaultGenerator(l.defaultInput)),h.constructor==Number)l.type="number";else if(h.constructor==String){var c=e.Studies.movingAverageHelper(i,l.defaultInput);if(c){l.type="select",l.defaultInput=c;var u=e.Studies.movingAverageHelper(i,l.value);u||(u=l.value),l.value=u,l.options=e.Studies.movingAverageHelper(i,"options")}else if("field"==h){l.type="select",l.options={};t:for(var d in s.dataSet[s.dataSet.length-1]){if(-1==["Open","High","Low","Close","Adj_Close","hl/2","hlc/3","hlcc/4","ohlc/4",s.defaultPlotField].indexOf(d)){if(-1==e.Studies.actualOutputs.indexOf(d))continue;if(t.sd)for(var p in t.sd.outputMap)if(-1!=d.indexOf(p)&&-1==d.indexOf(p+"-"))continue t}l.options[d]=i.translateIf(d)}"field"==l.value&&(l.value="Close"),"field"==l.defaultInput&&(l.defaultInput="Close")}else l.type="text"}else if(h.constructor==Boolean)l.type="checkbox",!0!==l.value&&"true"!=l.value&&"on"!=l.value||(l.value=!0);else if(h.constructor==Array){l.type="select",l.options={};for(var f=0;f<h.length;f++)l.options[h[f]]=i.translateIf(h[f]);l.value.constructor==Array&&(l.value=l.value[0]),l.defaultInput=h[0]}}for(o in n.outputs){var m={name:o,heading:i.translateIf(o)};this.outputs.push(m),m.color=m.defaultOutput=n.outputs[o],r&&r.outputs&&r.outputs[o]&&(m.color=r.outputs[o]),"auto"==m.color&&(m.color=i.defaultColor)}if(n.parameters&&"studyOverZones"==n.parameters.template){var g=n.parameters.init;if(g){var v;v={name:"studyOverZones",heading:i.translateIf("Show Zones"),defaultValue:g.studyOverZonesEnabled,value:g.studyOverZonesEnabled};var y=r?r.parameters:null;y&&(y.studyOverZonesEnabled||!1===y.studyOverZonesEnabled)&&(v.value=y.studyOverZonesEnabled),this.parameters.push(v),v={name:"studyOverBought",heading:i.translateIf("OverBought"),defaultValue:g.studyOverBoughtValue,value:g.studyOverBoughtValue,defaultColor:g.studyOverBoughtColor,color:g.studyOverBoughtColor},y&&y.studyOverBoughtValue&&(v.value=y.studyOverBoughtValue),y&&y.studyOverBoughtColor&&(v.color=y.studyOverBoughtColor),"auto"==v.color&&(v.color=i.defaultColor),this.parameters.push(v),v={name:"studyOverSold",heading:i.translateIf("OverSold"),defaultValue:g.studyOverSoldValue,value:g.studyOverSoldValue,defaultColor:g.studyOverSoldColor,color:g.studyOverSoldColor},y&&y.studyOverSoldValue&&(v.value=y.studyOverSoldValue),y&&y.studyOverSoldColor&&(v.color=y.studyOverSoldColor),"auto"==v.color&&(v.color=i.defaultColor),this.parameters.push(v),this.attributes.studyOverBoughtValue||(this.attributes.studyOverBoughtValue={}),this.attributes.studyOverSoldValue||(this.attributes.studyOverSoldValue={})}}},e.Studies.DialogHelper.prototype.updateStudy=function(t){var i={},r=this.sd,n=this.libraryEntry;n||(n={}),r||(r=n),i.inputs=e.shallowClone(r.inputs),i.outputs=e.clone(r.outputs),i.parameters=e.shallowClone(r.parameters),e.extend(i,t),i.parameters||(i.parameters={}),i.inputs&&i.inputs.id?this.sd=e.Studies.replaceStudy(this.stx,i.inputs.id,this.name,i.inputs,i.outputs,i.parameters,null,r.study):this.sd=e.Studies.addStudy(this.stx,this.name,i.inputs,i.outputs,i.parameters,null,r.study)},e.Studies.prepareStudy=function(t,i,r,n){if(void 0===i.calculateFN&&(i.useRawValues=!0),n&&n.replaceID&&(e.Studies.rejiggerDerivedStudies(t,n.replaceID,r.inputs.id,r.panel),delete n.replaceID),e.isEmpty(r.outputMap))for(var a in r.outputs)i.useRawValues?r.outputMap[a]=a:r.outputMap[a+" "+r.name]=a;(r.overlay||r.underlay)&&(t.overlays[r.name]=r),i.feed?t.attachTagAlongQuoteFeed(i.feed):t.currentlyImporting||(r.chart.dataSet&&t.createDataSet(),t.draw())},e.Studies.rejiggerDerivedStudies=function(t,i,r,n){var a=t.layout.studies;t.overlays;for(var s in a){var o=a[s],l=o.inputs,h=l.id;if(-1!=l.id.indexOf(i)&&-1==l.id.indexOf(i+"-")){for(var c=(l.id.replace(i,r),!1),u=e.Studies.getFieldInputs(o),d=0;d<u.length;d++)if(-1!=l[u[d]].indexOf(i)){o.name;l[u[d]]=l[u[d]].replace(i,r),l.id=l.id.replace(i,r),l.display=l.display.replace(i,r),o.name=o.name.replace(i,r),o.outputMap={};for(var p in o.outputs)o.study.useRawValues?o.outputMap[p]=p:o.outputMap[p+" "+o.name]=p;c=!0}c&&e.Studies.replaceStudy(t,h,o.type,o.inputs,o.outputs,o.parameters)}}},e.Studies.removeStudySymbols=function(t,e){t.series&&e.deleteSeries(t.series,null,{action:"remove-study"})},e.Studies.replaceStudy=function(t,i,r,n,a,s,o,l){s||(s={}),i&&(s.replaceID=i),n.id==n.display&&delete n.display,delete n.id;var h=t.layout.studies[s.replaceID];return e.Studies.removeStudySymbols(h,t),t.quoteDriver&&t.quoteDriver.updateSubscriptions(),e.Studies.addStudy(t,r,n,a,s,o,l)},e.Studies.addStudy=function(t,i,r,n,a,s,o){var l=o||e.Studies.studyLibrary[i];if(a||(a={}),l){if(l.inputs){var h=e.shallowClone(l.inputs);for(var c in h)h[c]instanceof Array&&(h[c]=h[c][0]);r=e.extend(h,r)}l.outputs&&(n=e.extend(e.clone(l.outputs),n));var u=l.parameters;u&&u.init&&(a=e.extend(e.shallowClone(u.init),a)),u&&!a.display&&(a.display=u.display)}r||(r=e.clone(e.Studies.DEFAULT_INPUTS)),n||(n=e.clone(e.Studies.DEFAULT_OUTPUTS)),a.chartName||(a.chartName="chart"),r.Period<1&&(r.Period=1),r.id||(r.id=e.Studies.generateID(t,i,r,a.replaceID,a.display));var d=null;if(!(d=l&&l.initializeFN?l.initializeFN(t,i,r,n,a,s,o):e.Studies.initializeFN(t,i,r,n,a,s,o)))return void console.log("CIQ.Studies.addStudy: initializeFN() returned null for "+i);o=d.study,d.chart=t.charts[a.chartName],t.layout.studies||(t.layout.studies={}),t.layout.studies[d.inputs.id]=d,d.type=i,d.permanent=o.permanent,d.customLegend=o.customLegend;var p=t.panels[d.panel];e.Studies.prepareStudy(t,o,d,a),t.quoteDriver&&t.quoteDriver.updateSubscriptions(),t.changeOccurred("layout");var f=!1,m=!(d.overlay||d.underlay);if(m&&o.horizontalCrosshairFieldFN&&(p.horizontalCrosshairField=o.horizontalCrosshairFieldFN(t,d)),t.editCallback?f=!0:m?(t.callbacks.studyPanelEdit||t.callbackListeners.studyPanelEdit&&t.callbackListeners.studyPanelEdit.length)&&(f=!0):(t.callbacks.studyOverlayEdit||t.callbackListeners.studyOverlayEdit&&t.callbackListeners.studyOverlayEdit.length)&&(f=!0),f){a.editMode=!0;var g=!1;for(var v in d.inputs)if("id"!=v&&"display"!=v){g=!0;break}if(!g)for(var y in d.outputs){g=!0;break}if(g){var x;void 0!==d.study.edit?d.study.edit&&(x=function(t,i,r,n){return function(){e.clearCanvas(t.chart.tempCanvas,t),i.study.edit(i,{stx:t,inputs:r,outputs:n,parameters:a})}}(t,d,r,n),t.setPanelEdit(p,x),d.editFunction=x):!m&&t.callbacks.studyOverlayEdit?(x=function(t,i,r,n,a){return function(s){e.clearCanvas(t.chart.tempCanvas,t),t.dispatch("studyOverlayEdit",{stx:t,sd:i,inputs:r,outputs:n,parameters:a,forceEdit:s})}}(t,d,r,n,a),d.editFunction=x):t.editCallback?(x=function(t,r,n,s){return function(){var o=t.editCallback(t,r);e.clearCanvas(t.chart.tempCanvas,t),e.Studies.studyDialog(t,i,o,{inputs:n,outputs:s,parameters:a})}}(t,d,r,n),"chart"!=p.name&&t.setPanelEdit(p,x)):(x=function(t,i,r,n,a){return function(){e.clearCanvas(t.chart.tempCanvas,t),t.dispatch("studyPanelEdit",{stx:t,sd:i,inputs:r,outputs:n,parameters:a})}}(t,d,r,n,a),"chart"!=p.name&&(t.setPanelEdit(p,x),d.editFunction=x))}}return d},e.Studies.quickAddStudy=e.Studies.addStudy,e.Studies.removeStudy=function(t,e){if(e.overlay||e.underlay)t.removeOverlay(e.name),t.draw();else{var i=t.panels[e.panel];i&&t.panelClose(i)}},e.Studies.displayStudies=function(t,i,r){var n=t.layout.studies;if(n){r&&(e.Studies.actualOutputs=[]);var a={};a[i.name]=!0;for(var s in n){var o=n[s],l=o.study;if(l){if(r){if(!o.underlay&&!l.underlay)continue}else if(o.underlay||l.underlay)continue;var h=t.panels[o.panel];if(h){if(h.chart==i&&("bypass"!=o.study.range&&(h.min=null),!h.hidden)){if(!a[h.name]){var c=o.permanent;h.closeX?h.closeX.style.display=c?"none":"":h.close.style.display=c?"none":"",a[h.name]=c}var u=o.chart.dataSegment;for(var d in o.outputMap)e.Studies.actualOutputs.push(d);for(var p=e.Studies.getFieldInputs(o),f=0;f<p.length;f++)if(o.panel==o.parameters.chartName&&o.inputs[p[f]]){var m=e.Studies.studyPanelMap[o.inputs[p[f]]];if(m){o.panel=m.panel;break}}void 0===l.seriesFN?(e.Studies.displaySeriesAsLine(t,o,u),h&&e.Studies.displayError(t,o)):l.seriesFN&&h&&(l.seriesFN(t,o,u),e.Studies.displayError(t,o))}}else delete n[s]}}}},e.Studies.displayError=function(t,e,i){var r=i&&i.panel?i.panel:e.panel,n=t.panels[r].state;n.studyError||!e.error||"undefined"!=typeof practiceMode&&practiceMode||(i=i||{h:"center",v:"bottom"},i.text=n.studyError=!0===e.error?t.translateIf("Not enough data to compute ")+t.translateIf(e.study.name):t.translateIf(e.error),t.watermark(r,i))},e.Studies.calculateMinMaxForDataPoint=function(t,e,i){for(var r=Number.MAX_VALUE,n=-1*Number.MAX_VALUE,a=0;a<i.length;a++){var s=i[a][e];null!==s&&void 0!==s&&(isNaN(s)||(r=Math.min(s,r),n=Math.max(s,n)))}return{min:r,max:n}},e.Studies.determineMinMax=function(t,e,i){function r(t,e){if(t){var i=t[e];null===i||void 0===i||isNaN(i)||(n.min=Math.min(i,n.min),n.max=Math.max(i,n.max))}}var n=t.panels[e.panel];if(n){if(!n.min&&0!==n.min){var a=e.study;if(e.min||0===e.min)n.min=e.min,n.max=e.max;else{if("0 to 100"==a.range)n.min=0,n.max=100;else if("-1 to 1"==a.range)n.min=-1,n.max=1;else if("bypass"!=a.range){n.min=Number.MAX_VALUE,n.max=-1*Number.MAX_VALUE;for(var s,o,l,h=0;h<i.length;h++){var c=i[h];if(c){for(o in e.outputMap)r(c,o);for(s=0;s<=2;s++)l=e.name+"_hist"+(s||""),r(c,l)}}if(n.min==Number.MAX_VALUE||n.min==n.max){for(o in e.outputMap)r(t.getPreviousBar(n.chart,o,0),o),r(t.getNextBar(n.chart,o,i.length-1),o);for(s=0;s<=2;s++)l=e.name+"_hist"+(s||""),r(t.getPreviousBar(n.chart,l,0),l),r(t.getNextBar(n.chart,l,i.length-1),l)}}"0 to max"==a.range&&(n.min=Math.min(0,n.min))}}(n.highValue||0===n.highValue)&&n.highValue>n.max&&(n.max=n.highValue),(n.lowValue||0===n.lowValue)&&n.lowValue<n.min&&(n.min=n.lowValue);var u=n.yAxis;(u.max||0===u.max)&&(n.max=u.max),(u.min||0===u.min)&&(n.min=u.min),n.max==n.min&&(n.max=2*n.max,n.min=0),n.shadow=n.max-n.min,n.max>0&&n.min<0&&(n.shadow=n.max+-1*n.min),u.high=n.max,u.low=n.min,u.shadow=u.high-u.low}},e.Studies.createYAxis=function(t,i,r,n){if(!n.axisDrawn){n.height=n.bottom-n.top,e.Studies.determineMinMax(t,i,r);var a,s=i.study;s.yaxis||s.yAxisFN?(a={noDraw:!0},t.createYAxis(n,a),t.drawYAxis(n,a),s.yaxis&&s.yaxis(t,i),s.yAxisFN&&s.yAxisFN(t,i)):(a={noDraw:i.parameters&&i.parameters.studyOverZonesEnabled},"0 to 100"==s.range?a.range=[0,100]:"-1 to 1"==s.range&&(a.range=[-1,1]),s.yAxis&&s.yAxis.ground&&(a.ground=!0),t.createYAxis(n,a),t.drawYAxis(n,a)),i.error||(s.centerline?e.Studies.drawHorizontal(t,i,r,s.centerline):n.min<0&&n.max>0&&e.Studies.drawHorizontal(t,i,r,0)),n.axisDrawn=!0}},e.Studies.displaySeriesAsLine=function(t,i,r){if(r.length){var n=t.panels[i.panel];if(n&&!n.hidden){n.name==i.chart.name||i.underlay||e.Studies.createYAxis(t,i,r,n),e.Studies.drawZones(t,i,r);for(var a in i.outputMap)e.Studies.studyPanelMap[a]=i,e.Studies.displayIndividualSeriesAsLine(t,i,n,a,r)}}},e.Studies.displaySeriesAsHistogram=function(t,i,r){if(r.length){var n=t.panels[i.panel];if(n&&!n.hidden){var a=[];for(var s in i.outputMap){var o=i.outputs[i.outputMap[s]],l={field:s,fill_color_up:o,border_color_up:o,fill_color_down:o,border_color_down:o};a.push(l)}var h=i.inputs,c={name:i.name,type:h.HistogramType?h.HistogramType:"overlaid",panel:i.panel,heightPercentage:h.HeightPercentage?h.HeightPercentage:.25,widthFactor:h.WidthFactor?h.WidthFactor:.5};i.study&&i.study.parameters&&i.study.parameters.excludeYAxis||e.Studies.createYAxis(t,i,i.chart.dataSegment,t.panels[i.panel]),t.drawHistogram(c,a)}}},e.Studies.displayIndividualSeriesAsLine=function(t,i,r,n,a){r.height||(r.height=r.bottom-r.top);var s=t.chart.context,o=i.outputs[i.outputMap[n]];if(o){t.chart.context.save(),"string"==typeof o&&(o={color:o,width:1});var l=o.width||1;s.lineWidth=i.highlight?l+2:l;var h=o.color;"auto"==h&&(h=t.defaultColor),s.strokeStyle=h;var c=o.pattern;s.setLineDash(e.borderPatternToArray(s.lineWidth,c)),s.lineDashOffset=0;var u=0,d=i.study,p=r.yAxis;p.shadow<1e3&&(u=2),p.shadow<5&&(u=4),(i.overlay||i.underlay)&&(u=null),(p.decimalPlaces||0===p.decimalPlaces)&&(u=p.decimalPlaces);var f=null;i.parameters&&(f=i.parameters.label);var m=d.parameters;m||(m={});var g=!!i.series&&(i.series.parameters.type?"step"==i.series.parameters.type:"step"==m.plotType);m.noLabels&&(f=!1),i.noSlopes||!1===i.noSlopes||(i.noSlopes=m.noSlopes),i.extendToEnd||!1===i.extendToEnd||(i.extendToEnd=m.extendToEnd);var v=f||t.preferences.labels&&!1!==f,y=i.gaplines,x=i.inputs.Symbol,b=y?t.getGapColorFunction(x,n,o,y):null;t.plotDataSegmentAsLine(n,r,{skipTransform:t.panels[i.panel].name!=i.chart.name,label:v,labelDecimalPlaces:u,noSlopes:i.noSlopes,step:g,extendToEndOfDataSet:i.extendToEnd,gaps:y},b),d.appendDisplaySeriesAsLine&&d.appendDisplaySeriesAsLine(t,i,a,n,r),t.chart.context.restore()}},e.Studies.drawHorizontal=function(t,e,i,r){var n=t.panels[e.panel];if(n){var a=t.pixelFromPrice(r,n);a>n.top&&a<n.yAxis.bottom&&t.plotLine(n.left,n.right,a,a,"#DDDDDD","segment",t.chart.context,!1,{})}},e.Studies.displayHistogramWithSeries=function(t,i,r){var n=t.panels[i.panel];e.Studies.createYAxis(t,i,r,n),e.Studies.createHistogram(t,i,r,!1,.4),e.Studies.displaySeriesAsLine(t,i,r)},e.Studies.drawZones=function(t,i,r){if(i.parameters&&i.parameters.studyOverZonesEnabled){var n=parseFloat(i.parameters.studyOverSoldValue),a=parseFloat(i.parameters.studyOverBoughtValue),s=i.parameters.studyOverSoldColor,o=i.parameters.studyOverBoughtColor,l=i.zoneOutput;l||(l="Result");var h=e.Studies.determineColor(i.outputs[l]);h&&"auto"!=h&&!e.isTransparent(h)||(h=t.defaultColor),s||(s=h),s&&"auto"!=s&&!e.isTransparent(s)||(s=t.defaultColor),o||(o=h),o&&"auto"!=o&&!e.isTransparent(o)||(o=t.defaultColor);var c=t.panels[i.panel],u=c.yAxis.displayBorder;!1===t.axisBorders&&(u=!1),!0===t.axisBorders&&(u=!0);var d=Math.round(c.right)+.5,p=u?d-.5:c.right,f=u?3:0,m=t.chart.context,g=m.fillStyle;t.chart.context.globalAlpha=.2,t.startClip(c.name,!0);var v=c.yAxis,y=v.yAxisPlotter=new e.Plotter;y.newSeries("border","stroke",t.canvasStyle("stx_grid_border")),m.beginPath();var x=Math.round(t.pixelFromPrice(a,c))+.5;m.strokeStyle=o,m.moveTo(c.left,x),m.lineTo(p,x),m.stroke(),m.closePath(),t.chart.context.beginPath();var b=Math.round(t.pixelFromPrice(n,c))+.5;m.strokeStyle=s,m.moveTo(c.left,b),m.lineTo(p,b),m.stroke(),m.closePath(),u&&(y.moveTo("border",d-.5,x),y.lineTo("border",d+f,x),y.moveTo("border",d-.5,b),y.lineTo("border",d+f,b)),m.fillStyle=g;var C={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:l+" "+i.name};if(e.preparePeakValleyFill(t,e.extend(C,{threshold:a,direction:1,color:o})),e.preparePeakValleyFill(t,e.extend(C,{threshold:n,direction:-1,color:s})),m.globalAlpha=1,!i.study||!i.study.yaxis){if(u){var S=Math.round(v.bottom)+.5;y.moveTo("border",d,v.top),y.lineTo("border",d,S),y.draw(t.chart.context,"border")}t.canvasFont("stx_yaxis"),t.canvasColor("stx_yaxis");var w=v.left+f+3;m.fillText(a,w,x),m.fillText(n,w,b),c.axisDrawn=!0}t.endClip(),m.globalAlpha=1}},e.Studies.createHistogram=function(t,i,r,n,a){var s=t.panels[i.panel];t.startClip(s.name);var o=t.layout.candleWidth-2;o<2&&(o=1);var l=t.pixelFromPrice(0,s);s.min>0&&(l=t.pixelFromPrice(s.min,s)),n&&(l=Math.floor(s.top+s.height/2));var h=t.chart.context,c=i.name+"_hist";i.outputs["Decreasing Bar"]||i.outputs["Negative Bar"]?h.globalAlpha=a||1:t.canvasColor("stx_histogram");for(var u=null,d=null,p=i.outputs,f=0;f<r.length;f++){var m=r[f];if(m){m.candleWidth&&(o=Math.floor(Math.max(1,m.candleWidth-2)));var g=Math.floor(t.pixelFromBar(f,s.chart)-o/2),v=Math.floor(o);if(null===u){var y=t.tickFromPixel(g,s.chart)-1;u=y<0?d:t.pixelFromPrice(t.chart.dataSet[y][c],s)-l}else u=d;d=t.pixelFromPrice(m[c],s)-l;var x=e.Studies.determineColor(p["Decreasing Bar"]),b=e.Studies.determineColor(p["Increasing Bar"]),C=e.Studies.determineColor(p["Positive Bar"]),S=e.Studies.determineColor(p["Negative Bar"]);x&&d>u?h.fillStyle=x:b&&d<u?h.fillStyle=b:C&&d<0?h.fillStyle=C:S&&d>0&&(h.fillStyle=S),h.fillRect(g,l,v,Math.floor(d))}}h.globalAlpha=1,t.endClip()},e.Studies.volumeChart=function(t,e,i,r){var n,a,s=-1*Number.MAX_VALUE;for(n in i)for(var o=0;o<i[n].length;o++)(a=i[n][o])&&a>s&&(s=a);var l=t.panels[e.panel],h=Math.floor(l.yAxis.bottom)+.5,c=Math.floor(l.yAxis.top)+.5,u=h-c,d=t.layout.candleWidth,p=null;e.parameters&&e.parameters.displayBorder||(r=null);var f=0;r||(f=(d-t.chart.tmpWidth)/2);var m=t.chart.context;m.lineWidth=1,t.startClip(e.panel);for(n in i){r&&(p=r[n]),m.fillStyle=n,p&&(m.strokeStyle=p),m.beginPath();for(var g,v=h+.5,y=Math.floor(t.pixelFromBar(0,l.chart)),x=0;x<i[n].length;x++)if(t.chart.dataSegment[x]&&t.chart.dataSegment[x].candleWidth?(d=t.chart.dataSegment[x].candleWidth,r||(f=d/4)):(d=t.layout.candleWidth,r||(f=(d-t.chart.tmpWidth)/2)),0===x&&(y-=d/2,g=y),a=i[n][x]){var b,C,S=a*(u/s),w=Math.min(Math.floor(h-u+(u-S))+.5,h);b=Math.floor(g+f),C=Math.floor(g+d-f),b=Math.max(b,y),m.moveTo(b,h),m.lineTo(C,h),m.lineTo(C,w),m.lineTo(b,w),r?(v>w||0===x)&&m.lineTo(b,v):m.lineTo(b,h),v=w,g+=d}else v=h,g+=d;m.fill(),m.strokeStyle=p,r&&t.layout.candleWidth>=2&&m.stroke(),m.closePath()}t.endClip()},e.Studies.prettify={Close:"C",Open:"O",High:"H",Low:"L",simple:"ma",exponential:"ema","time series":"tsma",triangular:"tma",variable:"vma",VIDYA:"vdma",weighted:"wma","welles wilder":"smma",true:"y",false:"n"},e.Studies.prettyRE=/^.*\((.*?)\).*$/,e.Studies.prettyDisplay=function(t){var i=e.Studies.prettyRE.exec(t);if(!i)return t;var r=i[1];if(r){for(var n in e.Studies.prettify)r=r.replace(n,e.Studies.prettify[n]);t=t.replace(i[1],r)}return t},e.Studies.getFieldInputs=function(t){var e=[],i=t.study.inputs;for(var r in i)"field"==i[r]&&e.push(r);return e},e.Studies.initializeFN=function(t,i,r,n,a,s,o){function l(i,r,n){for(var a=null,s=e.Studies.getFieldInputs(h),o=t.chart.highLowBars||t.highLowBars[t.layout.chartType],l=0;l<s.length;l++){var c=e.Studies.studyPanelMap[i[s[l]]];if(c){a=c.panel;break}"Volume"!=i[s[l]]||"Volume"==t.chart.defaultPlotField&&!o||(a=n.vchart?"vchart":"volume")}return a||(a=r.chartName),a}r||(r={id:i}),a||(a={}),r.display||(r.display=r.id);var h=new e.Studies.StudyDescriptor(r.id,i,r.id,r,n,a);r.Period&&(h.days=Math.max(1,parseInt(h.inputs.Period,10))),o?(o.inputs||(o.inputs=h.study.inputs),o.outputs||(o.outputs=h.study.outputs),h.study=o):o=h.study,o.display&&(r.display=o.display),s||(s=r.id);var c=h.overlay||o.overlay||r.Overlay,u=h.underlay||o.underlay||r.Underlay;u&&(h.underlay=!0),c&&(h.overlay=!0);var d=a.replaceID?t.layout.studies[a.replaceID]:null;if(d&&(t.panelExists(a.replaceID)||c||u))if(c||u)h.panel=l(r,a,t.panels),a.replaceID!=h.inputs.id&&(delete t.layout.studies[a.replaceID],delete t.overlays[a.replaceID],e.deleteRHS(e.Studies.studyPanelMap,d),t.panelExists(a.replaceID)&&t.panelClose(t.panels[a.replaceID]));else{h.panel=s;var p={};for(var f in t.panels)if(f==a.replaceID){var m=t.panels[f];m.name=s,m.display=r.display,p[s]=m,a.replaceID!=s&&e.deleteRHS(e.Studies.studyPanelMap,d),t.moveMarkers&&t.moveMarkers(a.replaceID,s)}else p[f]=t.panels[f];t.panels=p,a.replaceID!=h.inputs.id&&delete t.layout.studies[a.replaceID]}else if(t.panelExists(s))h.panel=s,h.underlay||h.panel!=t.chart.name||(h.overlay=!0);else if(c||u)h.panel=l(r,a,t.panels);else{var g=o.panelHeight?o.panelHeight:null;t.createPanel(r.display,r.id,g,a.chartName),o.yAxis||(t.panels[r.id].yAxis.displayGridLines=t.displayGridLinesInStudies),d&&a.replaceID!=h.inputs.id&&e.Studies.removeStudy(t,d)}var v=t.panels[h.panel];if(v&&v.chart.name!=v.name){var y=o?o.yAxis:null,x=o?o.parameters:null;y?(e.extend(v.yAxis,y),y.ground&&(v.yAxis.initialMarginBottom=0),(y.ground||y.initialMarginTop||0===y.initialMarginTop||y.initialMarginBottom||0===y.initialMarginBottom)&&t.calculateYAxisMargins(v.yAxis)):x&&(x.zoom||0===x.zoom)?v.yAxis.zoom=x.zoom:v.yAxis.zoom=10}return h},e.Studies.overZones=function(t,i,r){if(r.length){var n=t.panels[i.panel];if(n&&!n.hidden){e.Studies.displaySeriesAsLine(t,i,r);var a=i.parameters;if(a&&a.studyOverZonesEnabled){var s=t.chart.context,o=parseFloat(a.studyOverBoughtValue),l=parseFloat(a.studyOverSoldValue),h=n.height/n.shadow,c=n.bottom-h*o,u=n.bottom-h*l,d={lineWidth:1};if(s.globalAlpha=.2,t.plotLine(n.left,n.right-5,c,c,a.studyOverBoughtColor,"segment",s,!1,d),s.globalAlpha=.2,t.plotLine(n.left,n.right-5,u,u,a.studyOverSoldColor,"segment",s,!1,d),!i.study||!i.study.yaxis){var p=t.getCanvasFontSize("stx_yaxis");t.canvasFont("stx_yaxis"),t.canvasColor("stx_yaxis"),s.fillText(o,n.yAxis.left,c+p/2),s.fillText(l,n.yAxis.left,u+p/2),n.axisDrawn=!0}}}}},e.Studies.displayPSAR2=function(t,i,r){var n=t.panels[i.panel],a=n.name==n.chart.name;t.startClip(n.name);var s=t.chart.context,o="squarewave"==i.inputs["Plot Type"];for(var l in i.outputs){var h=l+" "+i.name;s.beginPath();for(var c=t.layout.candleWidth,u=Math.max(3,Math.floor(t.chart.tmpWidth/2)),d=0;d<r.length;d++){var p=r[d];if(p&&(p[h]||0===p[h])){p.candleWidth&&(c=p.candleWidth),a&&p.transform&&(p=p.transform);var f=t.pixelFromBar(d,n.chart);o&&(f-=c/2);var m=t.pixelFromTransformedValue(p[h],n);if(0!==d&&r[d-1]&&(r[d-1][h]||0===r[d-1][h])||s.moveTo(f,m),o){if(s.lineTo(f,m),s.lineTo(f+c,m),r[d+1]){var g=r[d+1];a&&g.transform&&(g=g.transform),g[h]||0===g[h]||s.lineTo(f+c,t.pixelFromTransformedValue(g[i.referenceOutput+" "+i.name],t.panels[i.panel]))}}else s.moveTo(f-u/2,m),s.lineTo(f+u/2,m)}}s.lineWidth=1,i.highlight&&(s.lineWidth=3);var v=e.Studies.determineColor(i.outputs[l]);"auto"==v&&(v=t.defaultColor),s.strokeStyle=v,s.stroke(),s.closePath(),s.lineWidth=1}t.endClip()},e.Studies.initializeStochastics=function(t,i,r,n){return r.display=t.translateIf("Stoch")+" ("+r.Period+")",e.Studies.initializeFN.apply(null,arguments)},e.Studies.calculateVolume=function(t,i){var r=i.outputs,n=e.Studies.determineColor(r["Up Volume"]),a=e.Studies.determineColor(r["Down Volume"]);if("vchart"==i.name||"volume"==i.name)t.setStyle("stx_volume_up","color",n),
t.setStyle("stx_volume_down","color",a);else{if(!t||!t.chart.dataSet)return;var s=t.layout,o=i.parameters.removeStudy,l=s.volumeUnderlay;s.volumeUnderlay=!o,l!=s.volumeUnderlay&&t.changeOccurred("layout"),o?e.Studies.removeStudy(t,i):(t.setStyle("stx_volume_underlay_up","color",n),t.setStyle("stx_volume_underlay_down","color",a))}},e.Studies.MA=function(t,i,r,n,a,s,o,l){var h=new e.Studies.StudyDescriptor(a+" "+o.name,"ma",o.panel);h.chart=o.chart,h.days=parseInt(i,10),h.startFrom=o.startFrom,h.subField=l,h.inputs={},t&&(h.inputs.Type=t),r&&(h.inputs.Field=r),n&&(h.inputs.Offset=parseInt(n,10)),e.Studies.calculateMovingAverage(s,h)},e.Studies.movingAverage={conversions:{ma:"simple",sma:"simple",ema:"exponential",tsma:"time series",tma:"triangular",vma:"variable",vdma:"vidya",wma:"weighted",smma:"welles wilder"},translations:{simple:"Simple",exponential:"Exponential","time series":"Time Series",triangular:"Triangular",variable:"Variable",vidya:"VIDYA",weighted:"Weighted","welles wilder":"Welles Wilder"},typeMap:{ema:"Exponential",exponential:"Exponential",tsma:"TimeSeries","time series":"TimeSeries",tma:"Triangular",triangular:"Triangular",vma:"Variable",variable:"Variable",vdma:"Variable",vidya:"Variable",wma:"Weighted",weighted:"Weighted",smma:"Exponential","welles wilder":"Exponential"}},e.Studies.movingAverageHelper=function(t,i){if("options"==i){var r={};for(var n in e.Studies.movingAverage.translations)r[n]=t.translateIf(e.Studies.movingAverage.translations[n]);return r}return e.Studies.movingAverage.conversions[i]},e.Studies.volUnderlay=function(t,i,r){e.Studies.createVolumeChart(t,i,r)},e.Studies.createVolumeChart=function(t,i,r){var n=i.panel,a=i.inputs,s=i.underlay,o=i.overlay,l=s||o,h=l?"stx_volume_underlay":"stx_volume",c=[{field:"Volume",fill_color_up:t.canvasStyle(h+"_up").color,border_color_up:t.canvasStyle(h+"_up").borderLeftColor,opacity_up:t.canvasStyle(h+"_up").opacity,fill_color_down:t.canvasStyle(h+"_down").color,border_color_down:t.canvasStyle(h+"_down").borderLeftColor,opacity_down:t.canvasStyle(h+"_down").opacity}],u=c[0];l||"rgb(184, 44, 12)"!==u.border_color_down||(u.border_color_down="#000000",u.border_color_up="#000000");var d={name:"Volume",panel:n,heightPercentage:l?.25:null,widthFactor:1,bindToYAxis:!l};e.extend(d,i.study.parameters),e.extend(d,i.parameters),t.colorByCandleDirection&&(u.color_function=function(t){var e=t.Open,i=t.Close;return{fill_color:e>i?u.fill_color_down:u.fill_color_up,border_color:e>i?u.border_color_down:u.border_color_up,opacity:e>i?u.opacity_down:u.opacity_up}}),l||(i.outputMap.Volume="transparent",e.Studies.createYAxis(t,i,i.chart.dataSegment,t.panels[n])),a.HeightPercentage&&(d.heightPercentage=a.HeightPercentage),t.drawHistogram(d,c)},e.Studies.calculateRSI=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);for(var r=e.startFrom;r<i.length;r++)if(r){var n=i[r],a=i[r-1],s=n.Close-a.Close,o=Math.min(r,e.days),l=a["_avgG "+e.name];l||(l=0),l-=l/o;var h=a["_avgL "+e.name];h||(h=0),h-=h/o,s>0?l+=s/o:h-=s/o,r>=e.days&&(n["RSI "+e.name]=function(t,e){return 0===e?100:100-100/(1+t/e)}(l,h)),n["_avgG "+e.name]=l,n["_avgL "+e.name]=h}e.zoneOutput="RSI"},e.Studies.calculateMACD=function(t,i){var r=i.chart.scrubbed,n=i.inputs,a=i.name;if(i.macd1Days||(i.macd1Days=parseFloat(n["Fast MA Period"])),i.macd2Days||(i.macd2Days=parseFloat(n["Slow MA Period"])),i.signalDays||(i.signalDays=parseFloat(n["Signal Period"])),i.days||(i.days=Math.max(i.macd1Days,i.macd2Days,i.signalDays)),r.length<i.days+1)return void(i.error=!0);var s=i.inputs.Field;s&&"field"!=s||(s="Close");var o=n["Moving Average Type"];o||(o="exponential"),e.Studies.MA(o,i.macd1Days,s,0,"_MACD1",t,i),e.Studies.MA(o,i.macd2Days,s,0,"_MACD2",t,i);var l,h,c=Math.max(i.startFrom,i.days-1);for(l=c;l<r.length;l++)h=r[l],h["MACD "+a]=h["_MACD1 "+a]-h["_MACD2 "+a];var u=n["Signal MA Type"];u||(u="exponential"),e.Studies.MA(u,i.signalDays,"MACD "+a,0,"Signal",t,i);var d=a+"_hist";for(l=c;l<r.length;l++){h=r[l];var p=h["Signal "+a];(p||0===p)&&(h[d]=h["MACD "+a]-h["Signal "+a])}},e.Studies.calculateStandardDeviation=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close");var a=i.inputs["Moving Average Type"];a||(a=i.inputs.Type),e.Studies.MA(a,i.days,n,i.inputs.Offset,"_MA",t,i);var s=0,o=0,l=0,h=Number(i.inputs["Standard Deviations"]);h<0&&(h=2);var c=i.name;for(var u in i.outputs)c=u+" "+c;var d,p,f;for(d=i.startFrom-1,f=0;d>=0&&f<i.days;d--,f++)p=r[d][n],isNaN(p)&&(p=0),s+=Math.pow(p,2),o+=p;for(d=i.startFrom;d<r.length;d++){var m=r[d];if(p=m[n],isNaN(p)&&(p=0),s+=Math.pow(p,2),o+=p,!(d<i.days-1)){if(d>=i.days){var g=r[d-i.days][n];isNaN(g)&&(g=0),s-=Math.pow(g,2),o-=g}l=m["_MA "+i.name],m[c]=Math.sqrt((s+i.days*Math.pow(l,2)-2*l*o)/i.days)*h}}},e.Studies.calculateMovingAverage=function(t,i){if(i.chart.scrubbed){var r=i.inputs.Type;"ma"!=r&&r||(r="simple");var n=e.Studies.movingAverage.typeMap;if(r in n)return e.Studies["calculateMovingAverage"+n[r]](t,i);if("simple"===r){var a=i.chart.scrubbed,s=0,o=[],l=i.name;for(var h in i.outputs)l=h+" "+l;var c=i.inputs.Field;c&&"field"!=c||(c="Close");var u=parseInt(i.inputs.Offset,10);isNaN(u)&&(u=0);var d,p,f=i.startFrom,m=u;for(d=i.startFrom-1;d>=0;d--)if((p=a[d][c])||0===p)if(m>0)m--,f=d;else{if(o.length==i.days-1)break;s+=p,o.unshift(p)}for(o.length<i.days-1&&(o=[],f=0),d=f;d<a.length;d++){if((p=a[d][c])&&"object"==typeof p){p=p[i.subField||"Close"]}var g=d+u>=0&&d+u<a.length,v=g?a[d+u]:null;p||0===p?(s+=p,o.push(p),o.length>i.days&&(s-=o.shift()),v&&(v[l]=o.length==i.days?s/i.days:null)):v&&(v[l]=null)}}}},e.Studies.calculateMovingAverageExponential=function(t,e){var i=e.inputs.Type,r=e.chart.scrubbed,n=0,a=0,s=0,o=2/(e.days+1);"welles wilder"==i&&(o=1/e.days);var l=null,h=e.name;for(var c in e.outputs)h=c+" "+h;var u=e.inputs.Field;u&&"field"!=u||(u="Close");var d=parseInt(e.inputs.Offset,10);isNaN(d)&&(d=0);var p,f,m=e.startFrom,g=d;for(p=e.startFrom-1;p>=0;p--)if((f=r[p][h])||0===f){if(null===l&&(l=f),s=e.days,g<=0)break;g--,m=p}for(null===l&&(l=m=0),p=m;p<r.length;p++){f=r[p][u];var v=p+d>=0&&p+d<r.length,y=v?r[p+d]:null;f||0===f?(s==e.days-1?(n+=f,a=n/e.days,y&&(y[h]=a)):s<e.days-1?(n+=f,a=n/(s+1),y&&(y[h]=null)):0===s?(n+=f,a=n,y&&(y[h]=null)):(l||0===l)&&(a=(f-l)*o+l,y&&(y[h]=a)),l=a,s++):y&&(y[h]=null)}},e.Studies.calculateMovingAverageVariable=function(t,i){var r=i.inputs.Type,n=i.chart.scrubbed,a=2/(i.days+1),s=null,o=i.name;for(var l in i.outputs)o=l+" "+o;var h=i.inputs.Field;h&&"field"!=h||(h="Close"),"vidya"==r?(i.std=new e.Studies.StudyDescriptor(i.name,"sdev",i.panel),i.std.chart=i.chart,i.std.days=5,i.std.startFrom=i.startFrom,i.std.inputs={Field:h,"Standard Deviations":1,Type:"ma"},i.std.outputs={_STD:null},e.Studies.calculateStandardDeviation(t,i.std),e.Studies.MA("ma",20,"_STD "+i.name,0,"_MASTD",t,i)):(i.cmo=new e.Studies.StudyDescriptor(i.name,"cmo",i.panel),i.cmo.chart=i.chart,i.cmo.days=9,i.cmo.startFrom=i.startFrom,i.cmo.outputs={_CMO:null},e.Studies.calculateChandeMomentum(t,i.cmo));var c=parseInt(i.inputs.Offset,10);isNaN(c)&&(c=0);var u,d,p=i.startFrom,f=c;for(u=i.startFrom-1;u>=0;u--)if((d=n[u][o])||0===d){if(null===s&&(s=d),f<=0)break;f--,p=u}for(null===s&&(s=p=0),u=p;u<n.length;u++){var m=n[u];d=m[h];var g=u+c>=0&&u+c<n.length,v=g?n[u+c]:null;if(d||0===d){var y;if("vidya"==r){if(!m["_MASTD "+i.name]&&0!==m["_MASTD "+i.name])continue;y=m["_STD "+i.name]/m["_MASTD "+i.name]}else{if(!m["_CMO "+i.name]&&0!==m["_CMO "+i.name])continue;y=Math.abs(m["_CMO "+i.name])/100}var x=a*y*d+(1-a*y)*s;s=x,u<i.days&&(x=null),v&&(v[o]=x)}else v&&(v[o]=null)}},e.Studies.calculateMovingAverageTimeSeries=function(t,i){i.ma=new e.Studies.StudyDescriptor(i.name,"ma",i.panel),i.ma.chart=i.chart,i.ma.days=i.days,i.ma.startFrom=i.startFrom,i.ma.inputs=i.inputs,e.Studies.calculateLinearRegressionIndicator(t,i.ma);var r=i.name;for(var n in i.outputs)r=n+" "+r;var a=parseInt(i.inputs.Offset,10);isNaN(a)&&(a=0);for(var s=i.chart.scrubbed,o=a,l=i.startFrom-1;l>=0;l--){var h=s[l][r];if(h||0===h){if(!(o>0))break;o--}}for(l++;l<s.length;l++){var c=s[l];l+a>=0&&l+a<s.length&&(s[l+a][r]=c["Forecast "+i.name])}},e.Studies.calculateMovingAverageTriangular=function(t,i){var r=i.chart.scrubbed,n=i.inputs.Field;n&&"field"!=n||(n="Close");var a=Math.ceil(i.days/2);e.Studies.MA("simple",a,i.inputs.Field,0,"TRI1",t,i),i.days%2==0&&a++,e.Studies.MA("simple",a,"TRI1 "+i.name,0,"TRI2",t,i);var s=i.name;for(var o in i.outputs)s=o+" "+s;var l=parseInt(i.inputs.Offset,10);isNaN(l)&&(l=0);for(var h=l,c=i.startFrom-1;c>=0;c--){var u=r[c][s];if(u||0===u){if(!(h>0))break;h--}}for(c++;c<r.length;c++)c+l>=0&&c+l<r.length&&(r[c+l][s]=r[c]["TRI2 "+i.name])},e.Studies.calculateMovingAverageWeighted=function(t,e){var i=e.chart.scrubbed,r=0,n=0,a=e.inputs.Field;a&&"field"!=a||(a="Close");var s=e.days*(e.days+1)/2,o=e.name;for(var l in e.outputs)o=l+" "+o;var h=parseInt(e.inputs.Offset,10);isNaN(h)&&(h=0);var c,u,d=[],p=e.startFrom,f=h;for(c=e.startFrom-1;c>=0;c--)if((u=i[c][a])||0===u)if(f>0)f--,p=c;else{if(d.length==e.days-1)break;d.unshift(u)}for(d.length<e.days-1&&(d=[],p=0),c=0;c<d.length;c++)r+=(c+1)*d[c],n+=d[c];for(c=p;c<i.length;c++){u=i[c][a];var m=c+h>=0&&c+h<i.length,g=m?i[c+h]:null;u||0===u?(d.push(u),d.length>e.days&&(r-=n,n-=d.shift()),r+=d.length*u,n+=u,c<e.days-1?g&&(g[o]=null):g&&(g[o]=r/s)):g&&(g[o]=null)}},e.Studies.calculateKlinger=function(t,i){var r=i.chart.scrubbed,n=Number(i.inputs["Short Cycle"]),a=Number(i.inputs["Long Cycle"]);if(r.length<Math.max(n,a)+1)return void(i.error=!0);var s,o=i.name+"_hist",l="Klinger "+i.name,h="KlingerSignal "+i.name,c="_SV "+i.name,u="_EMA-S "+i.name,d="_EMA-L "+i.name;for(s=Math.max(1,i.startFrom);s<r.length;s++){var p=r[s].Volume;r[s]["hlc/3"]<r[s-1]["hlc/3"]&&(p*=-1),r[s][c]=p}for(e.Studies.MA("exponential",n,c,0,"_EMA-S",t,i),e.Studies.MA("exponential",a,c,0,"_EMA-L",t,i),s=Math.max(a,i.startFrom);s<r.length;s++)r[s][l]=r[s][u]-r[s][d];for(e.Studies.MA("exponential",Number(i.inputs["Signal Periods"]),l,0,"KlingerSignal",t,i),s=i.startFrom;s<r.length;s++)r[s][o]=r[s][l]-r[s][h]},e.Studies.calculateStochastics=function(t,i){i.smooth||(i.smooth=i.inputs.Smooth);var r=i.inputs.Field;r&&"field"!=r||(r="Close");var n=i.inputs["%K Periods"];n||(n=i.days);var a=i.chart.scrubbed;if(a.length<Math.max(n,i.days)+1)return void(i.error=!0);var s=i.inputs["%K Smoothing Periods"];s?i.smooth=!0:i.smooth&&(s=3);var o=i.inputs["%D Periods"];o||(o=3),i.outputMap={},i.outputMap["%K "+i.name]="Fast",i.outputMap["%D "+i.name]="Slow";for(var l=Math.max(n,i.startFrom);l<a.length;l++)a[l][i.name]=function(t,e,i){for(var r=t-i+1,n=-1*Number.MAX_VALUE,s=Number.MAX_VALUE,o=r;o<=t;o++)s=Math.min(s,a[o].Low),n=Math.max(n,a[o].High);return n==s?0:(a[t][e]-s)/(n-s)*100}(l,r,n);e.Studies.MA("simple",i.smooth?s:1,i.name,0,"%K",t,i),e.Studies.MA("simple",o,"%K "+i.name,0,"%D",t,i)},e.Studies.calculateStudyATR=function(t,e){var i=e.chart.scrubbed,r=e.days;if(i.length<r+1)return void(e.error=!0);for(var n=0,a=e.name,s=Math.max(e.startFrom,1);s<i.length;s++){var o=i[s],l=i[s-1],h=o.trueRange;l["Sum True Range "+a]&&(n=l["Sum True Range "+a]),n+=h,s>r&&(n-=i[s-r]["True Range "+a]),o["True Range "+a]=h,o["Sum True Range "+a]=n,s==r?o["ATR "+a]=n/r:s>r&&(o["ATR "+a]=(l["ATR "+a]*(r-1)+h)/r)}},e.Studies.calculatePSAR=function(t,e){function i(){n=0,a=null,s=!s}var r=e.chart.scrubbed,n=0,a=null,s=!1,o=0,l=parseFloat(e.inputs["Minimum AF"]),h=parseFloat(e.inputs["Maximum AF"]);if(e.startFrom>0){o=r[e.startFrom-1]["Result "+e.name];var c=r[e.startFrom-1]["_state "+e.name];c&&3==c.length&&(n=c[0],a=c[1],s=c[2])}for(var u=e.startFrom-1;u<r.length-1;u++)if(!(u<0)){var d=o;if(s){(!a||a<r[u].High)&&(a=r[u].High,n=Math.min(n+l,h)),o=d+n*(a-d);var p=Math.min(r[Math.max(1,u)-1].Low,r[u].Low);o>r[u+1].Low?(o=a,i()):o>p&&(o=p)}else{(!a||a>r[u].Low)&&(a=r[u].Low,n=Math.min(n+l,h)),o=d+n*(a-d);var f=Math.max(r[Math.max(1,u)-1].High,r[u].High);o<r[u+1].High?(o=a,i()):o<f&&(o=f)}r[u+1]["Result "+e.name]=o,r[u+1]["_state "+e.name]=[n,a,s]}},e.Studies.calculateTRIX=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);for(var n=i.name,a=["Close","_MA1 "+n,"_MA2 "+n,"_MA3 "+n],s=0;s<a.length-1;s++)e.Studies.MA("exponential",i.days,a[s],0,"_MA"+(s+1).toString(),t,i);for(var o=a[3],l=Math.max(1,i.startFrom);l<r.length;l++){var h=r[l-1][o];h&&(r[l]["Result "+n]=100*(r[l][o]/h-1))}},e.Studies.calculateIntradayMomentum=function(t,e){var i=e.chart.scrubbed,r=e.days;if(i.length<r+1)return void(e.error=!0);var n=0,a=0;e.startFrom>1&&(n=i[e.startFrom-1]["_totUp "+e.name],a=i[e.startFrom-1]["_totDn "+e.name]);for(var s=e.startFrom;s<i.length;s++){var o=i[s].Close-i[s].Open;if(o>0?n+=o:a-=o,s>=r){var l=i[s-r].Close-i[s-r].Open;l>0?n-=l:a+=l}i[s]["Result "+e.name]=100*n/(n+a),i[s]["_totUp "+e.name]=n,i[s]["_totDn "+e.name]=a}},e.Studies.calculateQStick=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);for(var n=i.startFrom;n<r.length;n++)r[n]["_Close-Open "+i.name]=r[n].Close-r[n].Open;e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_Close-Open "+i.name,0,"Result",t,i)},e.Studies.calculateSchaff=function(t,i){function r(t,e,r){for(var a=null,s=null,o=e-t+1;o<=e;o++){var l=n[o][r+" "+i.name];l&&(a=null===a?l:Math.min(a,l),s=null===s?l:Math.max(s,l))}return[a,s]}var n=i.chart.scrubbed,a=i.days,s=Number(i.inputs["Short Cycle"]),o=Number(i.inputs["Long Cycle"]);if(n.length<Math.max(a,s,o)+1)return void(i.error=!0);var l=i.inputs.Field;l&&"field"!=l||(l="Close");e.Studies.MA(i.inputs["Moving Average Type"],s,l,0,"_MACD1",t,i),e.Studies.MA(i.inputs["Moving Average Type"],o,l,0,"_MACD2",t,i);for(var h=0,c=0,u=i.startFrom;u<n.length;u++){var d=n[u];if(d["Result "+i.name]=c,!(u<o-1||(d["_MACD "+i.name]=d["_MACD1 "+i.name]-d["_MACD2 "+i.name],u<o+(a-1)))){var p=r(a,u,"_MACD");h=p[1]>p[0]?100*(d["_MACD "+i.name]-p[0])/(p[1]-p[0]):h,d["_PF "+i.name]=n[u-1]["_PF "+i.name]?n[u-1]["_PF "+i.name]+.5*(h-n[u-1]["_PF "+i.name]):h,u<o+2*(a-1)||(p=r(a,u,"_PF"),c=p[1]>p[0]?100*(d["_PF "+i.name]-p[0])/(p[1]-p[0]):c,d["Result "+i.name]=n[u-1]["Result "+i.name]?n[u-1]["Result "+i.name]+.5*(c-n[u-1]["Result "+i.name]):c)}}},e.Studies.calculateStochMomentum=function(t,i){var r=Number(i.inputs["%K Periods"]),n=Number(i.inputs["%K Smoothing Periods"]),a=Number(i.inputs["%K Double Smoothing Periods"]),s=Number(i.inputs["%D Periods"]),o=i.chart.scrubbed;if(o.length<r+n+a-1||o.length<s)return void(i.error=!0);var l;for(l=Math.max(r,i.startFrom)-1;l<o.length;l++){var h=o[l],c=function(t,e){for(var i=null,r=null,n=e-t+1;n<=e;n++)i=null===i?o[n].Low:Math.min(i,o[n].Low),r=null===r?o[n].High:Math.max(r,o[n].High);return[i,r]}(r,l);h["_H "+i.name]=h.Close-(c[0]+c[1])/2,h["_DHL "+i.name]=c[1]-c[0]}for(e.Studies.MA("exponential",n,"_H "+i.name,0,"_HS1",t,i),e.Studies.MA("exponential",a,"_HS1 "+i.name,0,"_HS2",t,i),e.Studies.MA("exponential",n,"_DHL "+i.name,0,"_DHL1",t,i),e.Studies.MA("exponential",a,"_DHL1 "+i.name,0,"_DHL2",t,i),l=r-1;l<o.length;l++)o[l]["%K "+i.name]=o[l]["_HS2 "+i.name]/(.5*o[l]["_DHL2 "+i.name])*100;e.Studies.MA(i.inputs["%D Moving Average Type"],s,"%K "+i.name,0,"%D",t,i),i.zoneOutput="%K"},e.Studies.calculateEhlerFisher=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var r=0;e.startFrom>1&&(r=i[e.startFrom-1]["_n "+e.name]);for(var n=e.startFrom;n<i.length;n++){var a=i[n];if(n<e.days-1)a["EF "+e.name]=a["EF Trigger "+e.name]=r;else{var s=function(t,e){for(var r=Number.MAX_VALUE,n=-1*Number.MAX_VALUE,a=e-t+1;a<=e;a++){var s=(i[a].High+i[a].Low)/2;r=Math.min(r,s),n=Math.max(n,s)}return[r,n]}(e.days,n);r=.66*(((i[n].High+i[n].Low)/2-s[0])/Math.max(1e-6,s[1]-s[0])-.5)+.67*r,r>0?r=Math.min(r,.9999):r<0&&(r=Math.max(r,-.9999));var o=n?i[n-1]["EF "+e.name]:0;a["EF "+e.name]=.5*Math.log((1+r)/(1-r))+.5*o,a["EF Trigger "+e.name]=o,a["_n "+e.name]=r}}},e.Studies.calculatePrettyGoodOscillator=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);e.Studies.MA("exponential",i.days,"trueRange",0,"_EMA",t,i),e.Studies.MA("simple",i.days,"Close",0,"_SMA",t,i);for(var n=Math.max(1,i.startFrom);n<r.length;n++)r[n]["_SMA "+i.name]&&r[n]["_EMA "+i.name]&&(r[n]["Result "+i.name]=(r[n].Close-r[n]["_SMA "+i.name])/r[n]["_EMA "+i.name])},e.Studies.calculateUltimateOscillator=function(t,e){var i=e.chart.scrubbed,r=[e.inputs["Cycle 1"],e.inputs["Cycle 2"],e.inputs["Cycle 3"]],n=Math.max(r[0],r[1],r[2]);if(i.length<n+1)return void(e.error=!0);var a=r[0]*r[1],s=r[0]*r[2],o=r[1]*r[2],l=[0,0,0],h=[0,0,0];e.startFrom&&(i[e.startFrom-1]["_accbp "+e.name]&&(l=i[e.startFrom-1]["_accbp "+e.name].slice()),i[e.startFrom-1]["_acctr "+e.name]&&(h=i[e.startFrom-1]["_acctr "+e.name].slice()));for(var c=Math.max(1,e.startFrom);c<i.length;c++){for(var u=Math.min(i[c].Low,i[c-1].Close),d=i[c].Close-u,p=Math.max(i[c].High,i[c-1].Close)-u,f=0;f<r.length;f++)if(l[f]+=d,h[f]+=p,c>r[f]){var m=Math.min(i[c-r[f]].Low,i[c-r[f]-1].Close),g=i[c-r[f]].Close-m,v=Math.max(i[c-r[f]].High,i[c-r[f]-1].Close)-m;l[f]-=g,h[f]-=v}if(i[c]["_accbp "+e.name]=l.slice(),i[c]["_acctr "+e.name]=h.slice(),!(c<n)){var y=o*l[0]/h[0]+s*l[1]/h[1]+a*l[2]/h[2],x=o+s+a;i[c]["Result "+e.name]=100*y/x}}},e.Studies.calculatePriceVolumeTrend=function(t,e){var i=e.inputs.Field;i&&"field"!=i||(i="Close");var r=e.chart.scrubbed,n=0;e.startFrom>1&&(n=r[e.startFrom-1]["Result "+e.name]);for(var a=Math.max(1,e.startFrom);a<r.length;a++)r[a][i]&&r[a-1][i]&&(n+=r[a].Volume*(r[a][i]-r[a-1][i])/r[a-1][i],r[a]["Result "+e.name]=n)},e.Studies.calculateOnBalanceVolume=function(t,e){var i=e.inputs.Field;i&&"field"!=i||(i="Close");var r=e.inputs["Min Tick Value"],n=!1;r||0===r||(n=!0,r=0);for(var a,s,o=e.chart.scrubbed,l=0,h=e.startFrom;h<o.length;h++)if(a=o[h],h&&a[i]&&(o[h-1][i]&&(s=o[h-1]),s)){a[i]-s[i]>r?l=1:s[i]-a[i]>r?l=-1:n&&(l=0);var c=s["Result "+e.name];c||(c=0),c+=a.Volume*l,a["Result "+e.name]=c}},e.Studies.calculateVolumeIndex=function(t,i){var r=i.inputs.Field;r&&"field"!=r||(r="Close");var n=i.chart.scrubbed;if(n.length<i.days+1)return void(i.error=!0);var a=100;i.startFrom>1&&(a=n[i.startFrom-1]["Index "+i.name]);for(var s=Math.max(1,i.startFrom);s<n.length;s++)n[s][r]&&n[s-1][r]&&(("Pos Vol"==i.type&&n[s].Volume>n[s-1].Volume||"Neg Vol"==i.type&&n[s].Volume<n[s-1].Volume)&&(a*=n[s][r]/n[s-1][r]),n[s]["Index "+i.name]=a);e.Studies.MA(i.inputs["Moving Average Type"],i.days,"Index "+i.name,0,"MA",t,i)},e.Studies.calculateHistoricalVolatility=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var r=e.inputs.Field;r&&"field"!=r||(r="Close");var n=e.inputs["Standard Deviations"];n<0&&(n=1);var a=100*Math.sqrt(function(e){return isNaN(e)&&(e=365),"day"==t.layout.interval?e:"week"==t.layout.interval?52:"month"==t.layout.interval?12:e}(e.inputs["Days Per Year"]))*n,s=[],o=0;e.startFrom>1&&(o=i[e.startFrom-1]["_state "+e.name][0],s=i[e.startFrom-1]["_state "+e.name][1].slice());for(var l=Math.max(1,e.startFrom);l<i.length;l++){var h=i[l-1][r];if(h){var c=Math.log(i[l][r]/h);if(s.push(c),o+=c,l>=e.days){var u=0;o/=e.days;for(var d=0;d<s.length;d++)u+=Math.pow(s[d]-o,2);o*=e.days,o-=s.shift(),i[l]["Result "+e.name]=Math.sqrt(u/e.days)*a}}i[l]["_state "+e.name]=[o,s.slice()]}},e.Studies.calculateSwingIndex=function(t,e){var i=e.inputs["Limit Move Value"];(null===i||isNaN(i))&&(i=99999);var r=e.chart.scrubbed,n=0;e.startFrom>1&&(n=r[e.startFrom-1]["Result "+e.name]);for(var a=Math.max(1,e.startFrom);a<r.length;a++){var s=Math.abs(r[a].High-r[a-1].Close),o=Math.abs(r[a].Low-r[a-1].Close),l=Math.abs(r[a].High-r[a].Low),h=Math.abs(r[a-1].Close-r[a-1].Open),c=Math.max(s,o),u=Math.max(l,c),d=u+.25*h;u==s?d-=.5*o:u==o&&(d-=.5*s);var p=50*(r[a].Close-r[a-1].Close+.5*(r[a].Close-r[a].Open)+.25*(r[a-1].Close-r[a-1].Open))/d*(c/i);0!==d&&0!==i||(p=0),"Swing"==e.type&&(n=0),n+=p,r[a]["Result "+e.name]=n}},e.Studies.calculateADX=function(t,i){e.Studies.calculateStudyATR(t,i);var r=i.chart.scrubbed,n=i.days,a=parseInt(i.inputs["Smoothing Period"],10);if(a||0===a||(a=n),r.length<i.days+1)return void(i.error=!0);for(var s,o=0,l=0,h=0,c=0,u=Math.max(1,i.startFrom);u<r.length;u++){s=r[u];var d=Math.max(0,s.High-r[u-1].High),p=Math.max(0,r[u-1].Low-s.Low);if(d>p?p=0:d=p>d?0:p=0,u<=n?(l+=d,h+=p,o+=s["True Range "+i.name]):(l=r[u-1]["_sm+DM "+i.name]*(n-1)/n+d,h=r[u-1]["_sm-DM "+i.name]*(n-1)/n+p,o=r[u-1]["_smTR "+i.name]*(n-1)/n+s["True Range "+i.name]),s["_sm+DM "+i.name]=l,s["_sm-DM "+i.name]=h,s["_smTR "+i.name]=o,!(u<n)){var f=100*l/o,m=100*h/o,g=100*Math.abs(f-m)/(f+m);if(s["+DI "+i.name]=f,s["-DI "+i.name]=m,!1!==i.inputs.Series&&a)if(u<n+a-1){if(u==i.startFrom)for(var v=n;v<i.startFrom;v++)c+=100*Math.abs(r[v]["+DI "+i.name]-r[v]["-DI "+i.name])/(r[v]["+DI "+i.name]+r[v]["-DI "+i.name]);c+=g}else s["ADX "+i.name]=u==n+a-1?c/a:(r[u-1]["ADX "+i.name]*(a-1)+g)/a;if(i.inputs.Histogram){var y=i.name+"_hist";if(!s["+DI "+i.name]&&0!==s["+DI "+i.name])continue;if(!s["-DI "+i.name]&&0!==s["-DI "+i.name])continue;s[y]=s["+DI "+i.name]-s["-DI "+i.name],!1===i.inputs.Series&&(s["+DI "+i.name]=null,s["-DI "+i.name]=null)}}}},e.Studies.calculateRandomWalk=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);for(var r=Math.max(2,e.startFrom);r<i.length;r++){for(var n=0,a=i[r].High,s=i[r].Low,o=0,l=0,h=1;h<=e.days;h++){if(r<=h){o=l=0;break}n+=i[r-h].trueRange;var c=n/h*Math.sqrt(h);if(c){var u=(a-i[r-h].Low)/c,d=(i[r-h].High-s)/c;o=Math.max(o,u),l=Math.max(l,d)}}i[r]["Random Walk High "+e.name]=o,i[r]["Random Walk Low "+e.name]=l}},e.Studies.calculateRateOfChange=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var r=e.inputs.Field;"Vol ROC"==e.type?r="Volume":r&&"field"!=r||(r="Close");var n=e.name;for(var a in e.outputs)n=a+" "+n;var s=e.inputs["Center Line"];s=s?parseInt(s,10):0;for(var o=Math.max(e.startFrom,e.days);o<i.length;o++)if("Momentum"==e.type)i[o][n]=i[o][r]-i[o-e.days][r]+s;else{var l=i[o-e.days][r];l&&(i[o][n]=100*(i[o][r]/l-1)+s)}},e.Studies.calculateTypicalPrice=function(t,e){var i=e.chart.scrubbed,r=e.days;if(i.length<r+1)return void(e.overlay||(e.error=!0));var n=e.name;for(var a in e.outputs)n=a+" "+n;var s="hlc/3";"Med Price"==e.type?s="hl/2":"Weighted Close"==e.type&&(s="hlcc/4");var o=0;e.startFrom<=r&&(e.startFrom=0);for(var l=e.startFrom;l<i.length;l++)l&&i[l-1][n]&&(o=i[l-1][n]*r),o+=i[l][s],l>=r&&(o-=i[l-r][s],i[l][n]=o/r)},e.Studies.calculateElderRay=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days)return void(i.error=!0);e.Studies.MA("exponential",i.days,"Close",0,"_EMA",t,i);for(var n=Math.max(i.startFrom,i.days-1);n<r.length;n++)r[n][i.name+"_hist1"]=r[n].High-r[n]["_EMA "+i.name],r[n][i.name+"_hist2"]=r[n].Low-r[n]["_EMA "+i.name]},e.Studies.calculateElderForce=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days)return void(i.error=!0);for(var n=Math.max(1,i.startFrom);n<r.length;n++)r[n]["_EF1 "+i.name]=r[n].Volume*(r[n].Close-r[n-1].Close);e.Studies.MA("exponential",i.days,"_EF1 "+i.name,0,"Result",t,i)},e.Studies.calculateCenterOfGravity=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)return void(e.error=!0);var r=e.inputs.Field;r&&"field"!=r||(r="Close");for(var n=Math.max(e.startFrom,e.days-1);n<i.length;n++){for(var a=0,s=0,o=0;o<e.days;o++)a-=(o+1)*i[n-o][r],s+=i[n-o][r];s&&(i[n]["Result "+e.name]=a/s)}},e.Studies.calculateEaseOfMovement=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days)return void(i.error=!0);for(var n=Math.max(1,i.startFrom);n<r.length;n++){var a=(r[n].High+r[n].Low)/2,s=(r[n-1].High+r[n-1].Low)/2,o=a-s,l=r[n].Volume/1e8/(r[n].High-r[n].Low),h=o/l;isFinite(h)?r[n]["_EOM1 "+i.name]=h:r[n]["_EOM1 "+i.name]=NaN}e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_EOM1 "+i.name,0,"Result",t,i)},e.Studies.calculateChaikinVolatility=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days)return void(i.error=!0);var n;for(n=i.startFrom;n<r.length;n++)r[n]["_High-Low "+i.name]=r[n].High-r[n].Low;e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_High-Low "+i.name,0,"_MA",t,i);var a=i.inputs["Rate Of Change"];for(a||(a=i.days),n=Math.max(i.startFrom,a);n<r.length;n++)r[n-a]["_MA "+i.name]&&(r[n]["Result "+i.name]=100*(r[n]["_MA "+i.name]/r[n-a]["_MA "+i.name]-1))},e.Studies.calculateChaikinMoneyFlow=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)return void(e.error=!0);var r=0,n=0,a=i[e.startFrom-1];a&&(a["_sumMF "+e.name]&&(r=a["_sumMF "+e.name]),a["_sumV "+e.name]&&(n=a["_sumV "+e.name]));for(var s=e.startFrom;s<i.length;s++)i[s].High==i[s].Low?i[s]["_MFV "+e.name]=0:i[s]["_MFV "+e.name]=i[s].Volume*(2*i[s].Close-i[s].High-i[s].Low)/(i[s].High-i[s].Low),r+=i[s]["_MFV "+e.name],n+=i[s].Volume,s>e.days-1&&(r-=i[s-e.days]["_MFV "+e.name],(n-=i[s-e.days].Volume)&&(i[s]["Result "+e.name]=r/n)),i[s]["_sumMF "+e.name]=r,i[s]["_sumV "+e.name]=n},e.Studies.calculateTwiggsMoneyFlow=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days)return void(e.error=!0);var r=0,n=0,a=i[e.startFrom-1];a&&(a["_sumMF "+e.name]&&(r=a["_sumMF "+e.name]),a["_sumV "+e.name]&&(n=a["_sumV "+e.name]));for(var s=Math.max(1,e.startFrom);s<i.length;s++){var o=Math.max(i[s-1].Close,i[s].High),l=Math.min(i[s-1].Close,i[s].Low);i[s]["_MFV "+e.name]=i[s].Volume*(2*i[s].Close-o-l)/(o-l==0?999999:o-l),s>e.days-1&&(r*=(e.days-1)/e.days,n*=(e.days-1)/e.days),r+=i[s]["_MFV "+e.name],n+=i[s].Volume,s>e.days-1&&n&&(i[s]["Result "+e.name]=r/(n>0?n:999999)),i[s]["_sumMF "+e.name]=r,i[s]["_sumV "+e.name]=n}},e.Studies.calculateMassIndex=function(t,i){var r=i.chart.scrubbed;if(r.length<Math.max(9,i.days+1))return void(i.error=!0);for(var n=i.startFrom;n<r.length;n++)r[n]["_High-Low "+i.name]=r[n].High-r[n].Low;e.Studies.MA("exponential",9,"_High-Low "+i.name,0,"_EMA",t,i),e.Studies.MA("exponential",9,"_EMA "+i.name,0,"_EMA2",t,i);var a=0;r[i.startFrom-1]&&r[i.startFrom-1]["_total "+i.name]&&(a=r[i.startFrom-1]["_total "+i.name]);for(var s=Math.max(17,i.startFrom);s<r.length;s++)a+=r[s]["_EMA "+i.name]/r[s]["_EMA2 "+i.name],s>=17+i.days-1&&(r[s]["Result "+i.name]=a,a-=r[s-i.days+1]["_EMA "+i.name]/r[s-i.days+1]["_EMA2 "+i.name]),r[s]["_total "+i.name]=a},e.Studies.calculateMoneyFlowIndex=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var r=0,n=0,a=i[e.startFrom-1],s="_rawMF "+e.name,o="_cumMF "+e.name,l="Result "+e.name;a&&a[o]&&(r=a[o][0],n=a[o][1]);for(var h=e.startFrom;h<i.length;h++){var c=i[h]["hlc/3"];if(h>0){var u=i[h-1]["hlc/3"],d=c*i[h].Volume;if(c>u?r+=d:c<u?(d*=-1,n-=d):d=0,h>e.days){var p=i[h-e.days][s];p>0?r-=p:n+=p,i[h][l]=0===n?100:100-100/(1+r/n)}i[h][s]=d,i[h][o]=[r,n]}}},e.Studies.calculateChandeMomentum=function(t,e){var i=e.name;for(var r in e.outputs)i=r+" "+i;var n=e.chart.scrubbed;if(n.length<e.days+1)return void(e.error=!0);for(var a=0,s=0,o=[],l=e.startFrom-e.days+1;l<n.length;l++)if(!(l<1)){var h=n[l].Close-n[l-1].Close;if(o.push(h),a+=h,s+=Math.abs(h),o.length==e.days){n[l][i]=100*a/s;var c=o.shift();a-=c,s-=Math.abs(c)}}},e.Studies.calculateChandeForecast=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA("time series",i.days,n,0,"MA",t,i);for(var a=Math.max(1,i.startFrom);a<r.length;a++)r[a]["Result "+i.name]=100*(1-r[a]["MA "+i.name]/r[a][n])},e.Studies.calculateDetrendedPrice=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,n,0,"MA",t,i);for(var a=Math.max(i.startFrom,Math.floor(i.days/2+1));a<r.length;a++)r[a]["Result "+i.name]=r[a-Math.floor(i.days/2+1)][n]-r[a]["MA "+i.name]},e.Studies.calculateAroon=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var r=0,n=0,a=null,s=null;if(e.startFrom>0){var o=i[e.startFrom-1]["_state "+e.name];o&&(r=o[0],n=o[1],a=o[2],s=o[3])}for(var l,h=e.startFrom;h<i.length;h++){if(null===a&&(a=i[h].High),null===s&&(s=i[h].Low),(a=Math.max(a,i[h].High))==i[h].High)r=0;else if(++r>e.days)for(a=i[h].High,r=0,l=1;l<=e.days;l++)(a=Math.max(a,i[h-l].High))==i[h-l].High&&(r=l);if((s=Math.min(s,i[h].Low))==i[h].Low)n=0;else if(++n>e.days)for(s=i[h].Low,n=0,l=1;l<=e.days;l++)(s=Math.min(s,i[h-l].Low))==i[h-l].Low&&(n=l);i[h]["Aroon Up "+e.name]=100*(1-r/e.days),i[h]["Aroon Down "+e.name]=100*(1-n/e.days),i[h]["Aroon Oscillator "+e.name]=i[h]["Aroon Up "+e.name]-i[h]["Aroon Down "+e.name],i[h]["_state "+e.name]=[r,n,a,s]}},e.Studies.calculatePrimeNumber=function(t,e){function i(t){if(t<=0)return!1;if(t!=Math.floor(t))return!1;if(!0===r[t]||!1===r[t])return r[t];for(var e=parseInt(Math.sqrt(t),10),i=2;i<=e;i++)if(t%i==0)return r[t]=!1,!1;return r[t]=!0,!0}for(var r=[],n=e.chart.scrubbed,a=e.startFrom;a<n.length;a++){var s=n[a];if(s){for(var o=s.High,l=0;o>0&&o<=10;l++)o*=10;for(i(o)&&(o+=2),o=Math.ceil(o),o%2==0&&o++;!i(o);)o+=2;o/=Math.pow(10,l);for(var h=s.Low,c=0;h>0&&h<=10;c++)h*=10;if(i(h)&&(h-=2),h=Math.floor(h),h%2==0&&h--,h>0){for(;!i(h);)h-=2;h/=Math.pow(10,c)}if("Prime Number Bands"==e.type)s["Prime Bands Top "+e.name]=o,s["Prime Bands Bottom "+e.name]=Math.max(0,h);else{var u=0,d=e.inputs["Tolerance Percentage"]*(o-h)/100,p=o+h-2*s.Close;p<d?u=1:p>d&&(u=-1),u&&(s["Result "+e.name]=u)}}}},e.Studies.calculateVerticalHorizontalFilter=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);i.mhml=new e.Studies.StudyDescriptor(i.name,i.type,i.panel),i.mhml.chart=i.chart,i.mhml.days=i.days,i.mhml.startFrom=i.startFrom,i.mhml.inputs={},i.mhml.outputs={_MHML:null},e.Studies.calculateMaxHighMinLow(t,i.mhml);for(var n=0,a=[],s=Math.max(1,i.startFrom-i.days);s<r.length;s++){var o=Math.abs(r[s].Close-r[s-1].Close);a.push(o),n+=o,a.length==i.days&&(r[s]["Result "+i.name]=r[s]["_MHML "+i.name]/n,n-=a.shift())}},e.Studies.calculatePriceOscillator=function(t,i){var r=i.chart.scrubbed,n=Number(i.inputs["Short Cycle"]),a=Number(i.inputs["Long Cycle"]);if(r.length<Math.max(n,a)+1)return void(i.error=!0);var s=i.inputs.Field,o=i.inputs["Moving Average Type"];o||(o="simple"),s&&"field"!=s||(i.parameters.isVolume?(s="Volume",o="exponential"):s="Close");var l=i.inputs["Points Or Percent"];l||(l="Percent"),e.Studies.MA(o,n,s,0,"_Short MA",t,i),e.Studies.MA(o,a,s,0,"_Long MA",t,i);for(var h=Math.max(a,i.startFrom);h<r.length;h++){var c=r[h];c&&(c["Result "+i.name]="Points"==l?c["_Short MA "+i.name]-c["_Long MA "+i.name]:100*(c["_Short MA "+i.name]/c["_Long MA "+i.name]-1),i.outputs["Increasing Bar"]&&(c[i.name+"_hist"]=c["Result "+i.name]))}},e.Studies.calculateKeltner=function(t,i){e.Studies.MA(i.inputs["Moving Average Type"],i.days,"Close",0,"MA",t,i),e.Studies.calculateStudyATR(t,i),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Shift,"MA "+i.name,"ATR "+i.name)},e.Studies.calculateCoppock=function(t,i){var r=i.chart.scrubbed,n=i.inputs.Field;n&&"field"!=n||(n="Close");var a=parseInt(i.inputs["Long RoC"],10);a||(a=14);var s=parseInt(i.inputs["Short RoC"],10);s||(s=11);var o=i.days;if(o||(o=10),!(a<s)){if(r.length<Math.max(s,a,o)+1)return void(i.error=!0);for(var l=Math.max(i.startFrom,a);l<r.length;l++){var h=r[l-s][n],c=r[l-a][n];h&&c&&(r[l]["_Sum "+i.name]=100*(r[l][n]/h+r[l][n]/c-2))}e.Studies.MA("weighted",o,"_Sum "+i.name,0,"Result",t,i)}},e.Studies.calculateLinearRegressionIndicator=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);var r=e.inputs.Field;r&&"field"!=r||(r="Close");var n=e.days*(e.days+1)/2,a=Math.pow(n,2),s=n*(2*e.days+1)/3,o=0,l=0,h=0;if(e.startFrom){var c=i[e.startFrom-1]["_sums "+e.name];c&&(l=c[0],o=c[1],h=c[2])}for(var u=e.startFrom;u<i.length;u++)if((i[u][r]||0===i[u][r])&&(l+=e.days*i[u][r]-o,o+=i[u][r],h+=Math.pow(i[u][r],2),!(u<e.days-1))){if(u>e.days-1){if(!i[u-e.days][r]&&0!==i[u-e.days][r])continue;o-=i[u-e.days][r],h-=Math.pow(i[u-e.days][r],2)}var d=(e.days*l-n*o)/(e.days*s-a);i[u]["Slope "+e.name]=d;var p=(o-d*n)/e.days
;i[u]["Intercept "+e.name]=p,i[u]["Forecast "+e.name]=p+d*e.days;var f=(e.days*s-a)/(e.days*h-Math.pow(o,2));i[u]["RSquared "+e.name]=d*d*f,i[u]["_sums "+e.name]=[l,o,h]}},e.Studies.calculateBollinger=function(t,i){var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,r,0,"_MA",t,i),i.std=new e.Studies.StudyDescriptor(i.name,"STD Dev",i.panel),i.std.chart=i.chart,i.std.startFrom=i.startFrom,i.std.days=i.days,i.std.inputs={Field:r,"Standard Deviations":1,Type:i.inputs["Moving Average Type"]},i.std.outputs={"_STD Dev":null},e.Studies.calculateStandardDeviation(t,i.std),e.Studies.calculateGenericEnvelope(t,i,i.inputs["Standard Deviations"],"_MA "+i.name,"_STD Dev "+i.name),"Boll %b"==i.type&&(i.zoneOutput="%b")},e.Studies.calculateMAEnvelope=function(t,i){var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,r,0,"MA",t,i);var n=i.inputs["Shift Type"],a=i.inputs.Shift;n||(n="percent",a=i.inputs["Shift Percentage"]),"percent"==n?e.Studies.calculateGenericEnvelope(t,i,a/100,"MA "+i.name):"points"==n&&e.Studies.calculateGenericEnvelope(t,i,null,"MA "+i.name,null,Number(a))},e.Studies.calculateGenericEnvelope=function(t,e,i,r,n,a){i||(i=0),a||(a=0),r||(r="Close"),n||(n=r);for(var s=e.chart.scrubbed,o=e.startFrom;s&&o<s.length;o++){var l=s[o];if(l&&l[r]){var h=i*l[n]+a;l[e.type+" Top "+e.name]=l[r]+h,l[e.type+" Bottom "+e.name]=l[r]-h,l[e.type+" Median "+e.name]=l[r],l["Bandwidth "+e.name]=200*h/l[r],l["%b "+e.name]=50*((l.Close-l[r])/h+1)}}},e.Studies.calculateMaxHighMinLow=function(t,e){var i=e.chart.scrubbed,r=e.days,n=e.days;if(e.inputs["High Period"]&&(r=e.inputs["High Period"]),e.inputs["Low Period"]&&(n=e.inputs["Low Period"]),i.length<Math.max(r,n)+1)return void(e.error=!0);var a,s=Number.MAX_VALUE,o=-1*Number.MAX_VALUE;if(e.startFrom>1){for(a=1;a<r;a++)o=Math.max(o,i[e.startFrom-a].High);for(a=1;a<n;a++)s=Math.min(s,i[e.startFrom-a].Low)}for(var l=Math.max(0,e.startFrom-1);l<i.length;l++){if(o=Math.max(o,i[l].High),s=Math.min(s,i[l].Low),l>=r&&i[l-r].High==o)for(o=i[l].High,a=1;a<r;a++)o=Math.max(o,i[l-a].High);if(l>=n&&i[l-n].Low==s)for(s=i[l].Low,a=1;a<n;a++)s=Math.min(s,i[l-a].Low);var h=0;if("HHV"==e.type)h=o;else if("LLV"==e.type)h=s;else if("Donchian Width"==e.type)h=o-s;else if("GAPO"==e.type||"Gopala"==e.type)h=Math.log(o-s)/Math.log(n);else{if("VT HZ Filter"==e.type){h=o-s,i[l]["_MHML "+e.name]=h;continue}if("Williams %R"==e.type){h=-100*(o-i[l].Close)/(o-s),i[l]["Result "+e.name]=h;continue}}if(l==i.length-1)break;"Donchian Channel"==e.type?(i[l+1]["Donchian High "+e.name]=o,i[l+1]["Donchian Low "+e.name]=s,i[l+1]["Donchian Median "+e.name]=(o+s)/2):i[l+1]["Result "+e.name]=h}},e.Studies.calculateAccumulationDistribution=function(t,e){for(var i=e.chart.scrubbed,r=e.startFrom;r<i.length;r++)if(r){var n=i[r],a=i[r-1],s=0;n.Close>a.Close?s=n.Close-Math.min(n.Low,a.Close):n.Close<a.Close&&(s=n.Close-Math.max(n.High,a.Close)),e.inputs["Use Volume"]&&(s*=n.Volume);var o=a["Result "+e.name];o||(o=0),o+=s,n["Result "+e.name]=o}},e.Studies.calculateCCI=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);e.Studies.MA("simple",i.days,"hlc/3",0,"MA",t,i);for(var n=Math.max(i.startFrom,i.days-1);n<r.length;n++){var a=r[n];if(a){for(var s=0,o=0;o<i.days;o++)s+=Math.abs(r[n-o]["hlc/3"]-a["MA "+i.name]);s/=i.days,Math.abs(s)<1e-8?a["Result "+i.name]=0:a["Result "+i.name]=(a["hlc/3"]-a["MA "+i.name])/(.015*s)}}},e.Studies.calculateFractalChaos=function(t,e){var i=e.chart.scrubbed,r=0,n=0,a=0;e.startFrom&&"Fractal Chaos Bands"==e.type&&(r=i[e.startFrom-1]["Fractal High "+e.name],n=i[e.startFrom-1]["Fractal Low "+e.name]);for(var s=Math.max(4,e.startFrom);s<i.length;s++){i[s]["Result "+e.name]=0;var o;for(a=0,o=0;o<=s&&i[s-o]&&!(i[s-o].High>i[s-2].High)&&!(o<2&&i[s-o].High==i[s-2].High);o++)if(i[s-o].High<i[s-2].High&&a++,4==a){r=i[s-2].High;break}for("Fractal Chaos Bands"==e.type?i[s]["Fractal High "+e.name]=r>0?r:null:4==a&&(i[s]["Result "+e.name]=1),a=0,o=0;o<=s&&i[s-o]&&!(i[s-o].Low<i[s-2].Low)&&!(o<2&&i[s-o].Low==i[s-2].Low);o++)if(i[s-o].Low>i[s-2].Low&&a++,4==a){n=i[s-2].Low;break}"Fractal Chaos Bands"==e.type?i[s]["Fractal Low "+e.name]=n>0?n:null:4==a&&(i[s]["Result "+e.name]=-1)}},e.Studies.displayPrettyGoodOscillator=function(t,i,r){e.Studies.displaySeriesAsLine(t,i,r);var n=t.panels[i.panel],a=t.chart.context.strokeStyle;t.chart.context.globalAlpha=.2,t.chart.context.strokeStyle=i.outputs.Result,t.chart.context.beginPath();var s=t.pixelFromPrice(3,n);t.chart.context.moveTo(0,s),t.chart.context.lineTo(t.chart.width,s);var o=t.pixelFromPrice(-3,n);t.chart.context.moveTo(0,o),t.chart.context.lineTo(t.chart.width,o),t.chart.context.stroke(),t.chart.context.closePath();var l={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:3,direction:1,color:i.outputs.Result};e.preparePeakValleyFill(t,l),e.preparePeakValleyFill(t,e.extend(l,{threshold:-3,direction:-1})),t.chart.context.strokeStyle=a,t.chart.context.globalAlpha=1},e.Studies.displayRAVI=function(t,i,r){var n;e.Studies.determineMinMax(t,i,r);var a=t.panels[i.panel];a.yAxis.low=a.min=Math.min(0,a.min),a.yAxis.high=a.max=Math.max(0,a.max),e.Studies.displaySeriesAsLine(t,i,r);var s=t.pixelFromPrice(0,a),o=t.layout.candleWidth-2;o<2&&(o=1);var l=e.Studies.determineColor(i.outputs["Increasing Bar"]),h=e.Studies.determineColor(i.outputs["Decreasing Bar"]);for(t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.startClip(i.panel),n=0;n<r.length;n++){var c=r[n];if(c&&r[n-1]){var u=0,d=0;i.parameters&&i.parameters.studyOverZonesEnabled&&(u=parseFloat(i.parameters.studyOverBoughtValue),d=parseFloat(i.parameters.studyOverSoldValue)),0===n?t.chart.context.fillStyle="#CCCCCC":c[i.name+"_hist"]>u&&r[n-1][i.name+"_hist"]<c[i.name+"_hist"]?t.chart.context.fillStyle=l:c[i.name+"_hist"]<d&&r[n-1][i.name+"_hist"]>c[i.name+"_hist"]?t.chart.context.fillStyle=h:t.chart.context.fillStyle="#CCCCCC",c.candleWidth&&(o=Math.floor(Math.max(1,c.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(n,a.chart)-o/2),Math.floor(s),Math.floor(o),Math.floor(t.pixelFromPrice(c[i.name+"_hist"],a)-s))}}t.endClip()},e.Studies.displayElderForce=function(t,i,r){e.Studies.displaySeriesAsLine(t,i,r);var n={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:0,color:i.outputs.Result};n.direction=1,e.preparePeakValleyFill(t,n),n.direction=-1,e.preparePeakValleyFill(t,n)},e.Studies.displayElderRay=function(t,i,r){function n(r,n,l,h){t.chart.context.fillStyle=e.Studies.determineColor(i.outputs[l]),t.chart.context.fillRect(Math.floor(t.pixelFromBar(r,a.chart)-o/2+o*n),Math.floor(s),Math.floor(o*(1-2*n)),Math.floor(t.pixelFromPrice(c[i.name+h],a)-s))}e.Studies.determineMinMax(t,i,r);var a=t.panels[i.panel];a.yAxis.low=a.min=Math.min(0,a.min),a.yAxis.high=a.max=Math.max(0,a.max),e.Studies.displaySeriesAsLine(t,i,r);var s=t.pixelFromPrice(0,a),o=t.layout.candleWidth-2;o<2&&(o=1),t.canvasColor("stx_histogram");var l=t.chart.context.fillStyle;t.chart.context.globalAlpha=1,t.startClip(i.panel);for(var h=0;h<r.length;h++){var c=r[h];c&&(c.candleWidth&&(o=Math.floor(Math.max(1,c.candleWidth-2))),c[i.name+"_hist1"]>0&&n(h,0,"Elder Bull Power","_hist1"),c[i.name+"_hist2"]<0&&n(h,0,"Elder Bear Power","_hist2"),c[i.name+"_hist1"]<0&&n(h,.1,"Elder Bull Power","_hist1"),c[i.name+"_hist2"]>0&&n(h,.1,"Elder Bear Power","_hist2"))}t.endClip(),t.chart.context.fillStyle=l},e.Studies.displayADX=function(t,i,r){if(e.Studies.createYAxis(t,i,r,t.panels[i.panel]),i.inputs.Series&&i.inputs.Shading){var n="+DI "+i.name,a="-DI "+i.name,s=e.Studies.determineColor(i.outputs[i.outputMap[n]]),o=e.Studies.determineColor(i.outputs[i.outputMap[a]]),l={topBand:n,bottomBand:a,topColor:s,bottomColor:o,skipTransform:t.panels[i.panel].name!=i.chart.name};e.fillIntersecting(t,i.panel,l)}var h=i.inputs.Series?.4:1;i.inputs.Histogram&&e.Studies.createHistogram(t,i,r,!1,h),!1!==i.inputs.Series?e.Studies.displaySeriesAsLine(t,i,r):i.inputs.Series||i.inputs.Histogram||t.watermark(i.panel,"center","bottom",t.translateIf("Nothing to display"))},e.Studies.displayMassIndex=function(t,i,r){e.Studies.displaySeriesAsLine(t,i,r);var n=i.inputs["Bulge Threshold"],a=t.panels[i.panel],s=t.chart.context.strokeStyle;t.chart.context.globalAlpha=.2,t.chart.context.strokeStyle=i.outputs.Result,t.chart.context.beginPath();var o=t.pixelFromPrice(n,a);t.chart.context.moveTo(0,o),t.chart.context.lineTo(t.chart.width,o),t.chart.context.stroke(),t.chart.context.closePath(),e.preparePeakValleyFill(t,{skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:n,direction:1,color:i.outputs.Result}),t.chart.context.strokeStyle=s,t.chart.context.globalAlpha=1},e.Studies.displayChannel=function(t,i,r){if(i.inputs["Channel Fill"]){var n={panelName:i.panel};for(var a in i.outputs){var s=a.split(" ").pop();"Top"==s||"High"==s?n.topBand=a+" "+i.name:"Bottom"==s||"Low"==s?n.bottomBand=a+" "+i.name:"Median"!=s&&"Channel"!=s||(n.color=e.Studies.determineColor(i.outputs[a]))}i.parameters&&i.parameters.opacity&&(n.opacity=i.parameters.opacity),n.skipTransform=t.panels[i.panel].name!=i.chart.name,e.prepareChannelFill(t,n)}e.Studies.displaySeriesAsLine(t,i,r)},e.Studies.inputAttributeDefaultGenerator=function(t){return(t||0===t)&&t.constructor==Number?Math.floor(t)==t?t>0?{min:1,step:1}:{step:1}:t>0?{min:0,step:.01}:{step:.01}:{}},e.Studies.getStudyList=function(t){var i={},r={Directional:!0,Gopala:!0,vchart:!0};e.extend(r,t);for(var n in e.Studies.studyLibrary)r[n]||(i[e.Studies.studyLibrary[n].name]=n);return i},e.Studies.determineColor=function(t){return t?"object"==typeof t?t.color:t:null},e.Studies.studyLibrary={rsi:{name:"RSI",inputs:{Period:14},calculateFN:e.Studies.calculateRSI,range:"0 to 100",outputs:{RSI:"auto"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},ma:{name:"Moving Average",overlay:!0,range:"bypass",calculateFN:e.Studies.calculateMovingAverage,inputs:{Period:50,Field:"field",Type:"ma",Offset:0,Underlay:!1},outputs:{MA:"#FF0000"}},macd:{name:"MACD",calculateFN:e.Studies.calculateMACD,seriesFN:e.Studies.displayHistogramWithSeries,inputs:{"Fast MA Period":12,"Slow MA Period":26,"Signal Period":9},outputs:{MACD:"auto",Signal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},stochastics:{name:"Stochastics",range:"0 to 100",initializeFN:e.Studies.initializeStochastics,calculateFN:e.Studies.calculateStochastics,inputs:{Period:14,Smooth:!0},outputs:{Fast:"auto",Slow:"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},Aroon:{name:"Aroon",range:"0 to 100",calculateFN:e.Studies.calculateAroon,outputs:{"Aroon Up":"#00DD00","Aroon Down":"#FF0000"}},"Aroon Osc":{name:"Aroon Oscillator",calculateFN:e.Studies.calculateAroon,outputs:{"Aroon Oscillator":"auto"}},"Lin R2":{name:"Linear Reg R2",calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{RSquared:"auto"}},"Lin Fcst":{name:"Linear Reg Forecast",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Forecast:"auto"}},"Lin Incpt":{name:"Linear Reg Intercept",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Intercept:"auto"}},"Time Fcst":{name:"Time Series Forecast",overlay:!0,calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Forecast:"auto"}},"VT HZ Filter":{name:"Vertical Horizontal Filter",calculateFN:e.Studies.calculateVerticalHorizontalFilter,inputs:{Period:28}},TRIX:{name:"TRIX",calculateFN:e.Studies.calculateTRIX},"STD Dev":{name:"Standard Deviation",calculateFN:e.Studies.calculateStandardDeviation,inputs:{Period:14,Field:"field","Standard Deviations":2,"Moving Average Type":"ma"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Trade Vol":{name:"Trade Volume Index",calculateFN:e.Studies.calculateOnBalanceVolume,inputs:{"Min Tick Value":.5}},Swing:{name:"Swing Index",calculateFN:e.Studies.calculateSwingIndex,inputs:{"Limit Move Value":.5}},"Acc Swing":{name:"Accumulative Swing Index",calculateFN:e.Studies.calculateSwingIndex,inputs:{"Limit Move Value":.5}},"Price ROC":{name:"Price Rate of Change",calculateFN:e.Studies.calculateRateOfChange,inputs:{Field:"field",Period:14}},"Vol ROC":{name:"Volume Rate of Change",calculateFN:e.Studies.calculateRateOfChange},Momentum:{name:"Momentum Indicator",calculateFN:e.Studies.calculateRateOfChange,inputs:{Period:14},centerline:0},"Price Vol":{name:"Price Volume Trend",calculateFN:e.Studies.calculatePriceVolumeTrend,inputs:{Field:"field"}},"Pos Vol":{name:"Positive Volume Index",calculateFN:e.Studies.calculateVolumeIndex,inputs:{Field:"field","Moving Average Type":"ma",Period:255},outputs:{Index:"auto",MA:"#FF0000"}},"Neg Vol":{name:"Negative Volume Index",calculateFN:e.Studies.calculateVolumeIndex,inputs:{Field:"field","Moving Average Type":"ma",Period:255},outputs:{Index:"auto",MA:"#FF0000"}},"On Bal Vol":{name:"On Balance Volume",calculateFN:e.Studies.calculateOnBalanceVolume,inputs:{}},"Stch Mtm":{name:"Stochastic Momentum Index",calculateFN:e.Studies.calculateStochMomentum,inputs:{"%K Periods":10,"%K Smoothing Periods":3,"%K Double Smoothing Periods":3,"%D Periods":10,"%D Moving Average Type":"ema"},outputs:{"%K":"auto","%D":"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:40,studyOverBoughtColor:"auto",studyOverSoldValue:-40,studyOverSoldColor:"auto"}}},"Hist Vol":{name:"Historical Volatility",calculateFN:e.Studies.calculateHistoricalVolatility,inputs:{Field:"field",Period:10,"Days Per Year":[252,365],"Standard Deviations":1},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Pretty Good":{name:"Pretty Good Oscillator",seriesFN:e.Studies.displayPrettyGoodOscillator,calculateFN:e.Studies.calculatePrettyGoodOscillator},Ultimate:{name:"Ultimate Oscillator",calculateFN:e.Studies.calculateUltimateOscillator,inputs:{"Cycle 1":7,"Cycle 2":14,"Cycle 3":28},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},"Vol Osc":{name:"Volume Oscillator",calculateFN:e.Studies.calculatePriceOscillator,inputs:{"Short Cycle":12,"Long Cycle":26,"Points Or Percent":["Points","Percent"]},parameters:{init:{isVolume:!0}}},Twiggs:{name:"Twiggs Money Flow",calculateFN:e.Studies.calculateTwiggsMoneyFlow,inputs:{Period:21}},"Chaikin MF":{name:"Chaikin Money Flow",calculateFN:e.Studies.calculateChaikinMoneyFlow,inputs:{Period:20}},"Chaikin Vol":{name:"Chaikin Volatility",calculateFN:e.Studies.calculateChaikinVolatility,inputs:{Period:14,"Rate Of Change":2,"Moving Average Type":"ma"}},"Price Osc":{name:"Price Oscillator",calculateFN:e.Studies.calculatePriceOscillator,inputs:{Field:"field","Long Cycle":26,"Short Cycle":12,"Moving Average Type":"ema","Points Or Percent":["Points","Percent"]}},EOM:{name:"Ease of Movement",calculateFN:e.Studies.calculateEaseOfMovement,inputs:{Period:14,"Moving Average Type":"ma"}},CCI:{name:"Commodity Channel Index",calculateFN:e.Studies.calculateCCI,inputs:{Period:20},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:100,studyOverBoughtColor:"auto",studyOverSoldValue:-100,studyOverSoldColor:"auto"}},attributes:{Period:{min:2}}},Detrended:{name:"Detrended Price Oscillator",calculateFN:e.Studies.calculateDetrendedPrice,inputs:{Field:"field",Period:14,"Moving Average Type":"ma"}},"True Range":{name:"True Range",calculateFN:e.Studies.calculateStudyATR,inputs:{},outputs:{"True Range":"auto"}},ATR:{name:"Average True Range",calculateFN:e.Studies.calculateStudyATR,outputs:{ATR:"auto"}},"Ehler Fisher":{name:"Ehler Fisher Transform",calculateFN:e.Studies.calculateEhlerFisher,inputs:{Period:10},outputs:{EF:"auto","EF Trigger":"#FF0000"}},Schaff:{name:"Schaff Trend Cycle",range:"0 to 100",calculateFN:e.Studies.calculateSchaff,inputs:{Field:"field",Period:10,"Short Cycle":23,"Long Cycle":50,"Moving Average Type":"ema"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:75,studyOverBoughtColor:"auto",studyOverSoldValue:25,studyOverSoldColor:"auto"}}},QStick:{name:"QStick",calculateFN:e.Studies.calculateQStick,inputs:{Period:8,"Moving Average Type":"ma"}},Coppock:{name:"Coppock Curve",calculateFN:e.Studies.calculateCoppock,inputs:{Field:"field","Short RoC":11,"Long RoC":14,Period:10}},"Chande Mtm":{name:"Chande Momentum Oscillator",calculateFN:e.Studies.calculateChandeMomentum,inputs:{Period:9},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:50,studyOverBoughtColor:"auto",studyOverSoldValue:-50,studyOverSoldColor:"auto"}}},"Chande Fcst":{name:"Chande Forecast Oscillator",calculateFN:e.Studies.calculateChandeForecast,inputs:{Field:"field",Period:14}},"Intraday Mtm":{name:"Intraday Momentum Index",calculateFN:e.Studies.calculateIntradayMomentum,inputs:{Period:20},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},RAVI:{name:"RAVI",seriesFN:e.Studies.displayRAVI,calculateFN:e.Studies.calculatePriceOscillator,inputs:{Field:"field","Moving Average Type":"vdma","Short Cycle":7,"Long Cycle":65},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:3,studyOverBoughtColor:"auto",studyOverSoldValue:-3,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:0,step:"0.1"},studyOverSoldValue:{max:0,step:"0.1"}}},"Random Walk":{name:"Random Walk Index",calculateFN:e.Studies.calculateRandomWalk,outputs:{"Random Walk High":"#FF0000","Random Walk Low":"#0000FF"}},ADX:{name:"ADX/DMS",calculateFN:e.Studies.calculateADX,seriesFN:e.Studies.displayADX,inputs:{Period:14,"Smoothing Period":14,Series:!0,Shading:!1,Histogram:!1},outputs:{"+DI":"#00FF00","-DI":"#FF0000",ADX:"auto","Positive Bar":"#00DD00","Negative Bar":"#FF0000"}},"High Low":{name:"High Low Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:function(t,i){i.inputs["Moving Average Type"]="triangular",e.Studies.calculateMAEnvelope(t,i)},inputs:{Field:"field",Period:10,"Shift Percentage":5,"Channel Fill":!0},outputs:{"High Low Top":"auto","High Low Median":"auto","High Low Bottom":"auto"},attributes:{"Shift Percentage":{min:.1,step:.1}}},"High-Low":{name:"High Minus Low",calculateFN:function(t,e){for(var i=e.chart.scrubbed,r=e.startFrom;r<i.length;r++)i[r]["Result "+e.name]=i[r].High-i[r].Low},inputs:{}},"Med Price":{name:"Median Price",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14,Overlay:!1}},"MA Env":{name:"Moving Average Envelope",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateMAEnvelope,inputs:{Field:"field",Period:50,"Shift Type":["percent","points"],Shift:5,"Moving Average Type":"ma","Channel Fill":!0},outputs:{"MA Env Top":"auto","MA Env Median":"auto","MA Env Bottom":"auto"},attributes:{Shift:{min:.1,step:.1}}},"Fractal Chaos Bands":{name:"Fractal Chaos Bands",overlay:!0,calculateFN:e.Studies.calculateFractalChaos,seriesFN:e.Studies.displayChannel,inputs:{"Channel Fill":!0},outputs:{"Fractal High":"auto","Fractal Low":"auto","Fractal Channel":"auto"}},"Fractal Chaos":{name:"Fractal Chaos Oscillator",range:"-1 to 1",calculateFN:e.Studies.calculateFractalChaos,inputs:{},centerline:20},GAPO:{name:"Gopalakrishnan Range Index",calculateFN:e.Studies.calculateMaxHighMinLow},"Prime Number Bands":{name:"Prime Number Bands",overlay:!0,calculateFN:e.Studies.calculatePrimeNumber,seriesFN:e.Studies.displayChannel,inputs:{"Channel Fill":!0},outputs:{"Prime Bands Top":"auto","Prime Bands Bottom":"auto","Prime Bands Channel":"auto"}},"Prime Number":{name:"Prime Number Oscillator",range:"-1 to 1",calculateFN:e.Studies.calculatePrimeNumber,inputs:{"Tolerance Percentage":5},attributes:{"Tolerance Percentage":{min:.1,step:.1}}},"Bollinger Bands":{name:"Bollinger Bands",overlay:!0,calculateFN:e.Studies.calculateBollinger,seriesFN:e.Studies.displayChannel,inputs:{Field:"field",Period:20,"Standard Deviations":2,"Moving Average Type":"ma","Channel Fill":!0},outputs:{"Bollinger Bands Top":"auto","Bollinger Bands Median":"auto","Bollinger Bands Bottom":"auto"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Donchian Channel":{name:"Donchian Channel",overlay:!0,calculateFN:e.Studies.calculateMaxHighMinLow,seriesFN:e.Studies.displayChannel,inputs:{"High Period":20,"Low Period":20,"Channel Fill":!0},outputs:{"Donchian High":"auto","Donchian Median":"auto","Donchian Low":"auto"}},HHV:{name:"Highest High Value",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14}},LLV:{name:"Lowest Low Value",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14}},"Mass Idx":{name:"Mass Index",seriesFN:e.Studies.displayMassIndex,calculateFN:e.Studies.calculateMassIndex,inputs:{Period:25,"Bulge Threshold":27},attributes:{"Bulge Threshold":{min:20,max:35,step:.1}}},Keltner:{name:"Keltner Channel",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateKeltner,inputs:{Period:50,Shift:5,"Moving Average Type":"ema","Channel Fill":!0},outputs:{"Keltner Top":"auto","Keltner Median":"auto","Keltner Bottom":"auto"},attributes:{Shift:{min:.1,step:.1}}},PSAR:{name:"Parabolic SAR",overlay:!0,calculateFN:e.Studies.calculatePSAR,seriesFN:e.Studies.displayPSAR2,inputs:{"Minimum AF":.02,"Maximum AF":.2}},Klinger:{name:"Klinger Volume Oscillator",seriesFN:e.Studies.displayHistogramWithSeries,calculateFN:e.Studies.calculateKlinger,inputs:{"Signal Periods":13,"Short Cycle":34,"Long Cycle":55},outputs:{Klinger:"auto",KlingerSignal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"Elder Ray":{name:"Elder Ray Index",seriesFN:e.Studies.displayElderRay,calculateFN:e.Studies.calculateElderRay,inputs:{Period:13},outputs:{"Elder Bull Power":"#00DD00","Elder Bear Power":"#FF0000"}},"Elder Force":{name:"Elder Force Index",calculateFN:e.Studies.calculateElderForce,seriesFN:e.Studies.displayElderForce,inputs:{Period:13}},"LR Slope":{name:"Linear Reg Slope",calculateFN:e.Studies.calculateLinearRegressionIndicator,inputs:{Period:14,Field:"field"},outputs:{Slope:"auto"}},COG:{name:"Center Of Gravity",calculateFN:e.Studies.calculateCenterOfGravity,inputs:{Period:10,Field:"field"}},"Typical Price":{name:"Typical Price",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14,Overlay:!1}},"Weighted Close":{name:"Weighted Close",calculateFN:e.Studies.calculateTypicalPrice,inputs:{Period:14,Overlay:!1}},"M Flow":{name:"Money Flow Index",range:"0 to 100",calculateFN:e.Studies.calculateMoneyFlowIndex,inputs:{Period:14},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},"Williams %R":{name:"Williams %R",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{Period:14},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:-20,studyOverBoughtColor:"auto",studyOverSoldValue:-80,studyOverSoldColor:"auto"}}},"W Acc Dist":{name:"Accumulation/Distribution",calculateFN:e.Studies.calculateAccumulationDistribution,inputs:{"Use Volume":!1}},volume:{name:"Volume Chart",range:"0 to max",yAxis:{ground:!0,initialMarginTop:0},seriesFN:e.Studies.createVolumeChart,calculateFN:e.Studies.calculateVolume,inputs:{},outputs:{"Up Volume":"#8cc176","Down Volume":"#b82c0c"},parameters:{zoom:0,widthFactor:1}},"vol undr":{name:"Volume Underlay",underlay:!0,seriesFN:e.Studies.createVolumeChart,calculateFN:e.Studies.calculateVolume,inputs:{},outputs:{"Up Volume":"#8cc176","Down Volume":"#b82c0c"},customRemoval:!0,removeFN:function(t,e){t.layout.volumeUnderlay=!1,t.changeOccurred("layout")},parameters:{init:{heightPercentage:.25},widthFactor:1}}},t},__drawingAdvanced_=function(t){var e=t.CIQ,i=t.timezoneJS;return e.Drawing.channel=function(){this.name="channel",this.dragToDraw=!1,this.p2=null},e.Drawing.channel.ciqInheritsFrom(e.Drawing.segment),e.Drawing.channel.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.channel.prototype.move=function(t,e,i){if(this.penDown){if(this.copyConfig(),null===this.p2)this.p1=[e,i];else{var r=i-(this.p1[1]-this.p0[1])/(this.p1[0]-this.p0[0])*(e-this.p1[0]);this.p2=[this.p1[0],r]}this.render(t)}},e.Drawing.channel.prototype.click=function(t,e,i){var r=this.stx.panels[this.panelName];if(r)return this.copyConfig(),this.penDown?this.accidentalClick(e,i)?(this.stx.undo(),!0):null!==this.p2?(this.setPoint(2,this.p2[0],this.p2[1],r.chart),!0):(this.setPoint(1,e,i,r.chart),this.p0[0]==this.p1[0]?(this.p1=null,!1):(this.p2=[this.p1[0],this.p1[1]],!1)):(this.setPoint(0,e,i,r.chart),this.penDown=!0,!1)},e.Drawing.channel.prototype.boxIntersection=function(t,e){return!!(this.p0&&this.p1&&this.p2)&&(!(t>Math.max(this.p0[0],this.p1[0])||t<Math.min(this.p0[0],this.p1[0]))&&((this.p1[0]-this.p0[0])*(e-this.p0[1])-(this.p1[1]-this.p0[1])*(t-this.p0[0]))*((this.p2[0]-this.p0[0])*(e-(this.p0[1]+this.p2[1]-this.p1[1]))-(this.p1[1]-this.p0[1])*(t-this.p0[0]))<0)},e.Drawing.channel.prototype.intersected=function(t,i,r){return this.p0&&this.p1&&this.p2?this.pointIntersection(this.p0[0],this.p0[1],r)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(this.p1[0],this.p1[1],r)?(this.highlighted="p1",{action:"drag",point:"p1"}):this.pointIntersection(this.p2[0],this.p2[1],r)?(this.highlighted="p2",{action:"drag",point:"p2"}):this.boxIntersection(t,i)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),p2:e.clone(this.p2),tick:t,value:i}):null:null},e.Drawing.channel.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=null;this.p2&&(o=this.stx.pixelFromValueAdjusted(i,this.p2[0],this.p2[1]));var l=this.lineWidth,h=this.setLineColor(),c=this.fillColor;this.p2&&c&&!e.isTransparent(c)&&"auto"!=c&&(t.beginPath(),t.moveTo(r,a),t.lineTo(n,s),t.lineTo(n,o),t.lineTo(r,a+(o-s)),t.closePath(),t.globalAlpha=.2,t.fillStyle=c,t.fill(),t.globalAlpha=1);var u={pattern:this.pattern,lineWidth:l};if(this.stx.plotLine(r,n,a,s,h,"segment",t,i,u),this.p2&&this.stx.plotLine(r,n,a+(o-s),o,h,"segment",t,i,u),this.highlighted){var d="p0"==this.highlighted,p="p1"==this.highlighted,f="p2"==this.highlighted;this.littleCircle(t,r,a,d),this.littleCircle(t,n,s,p),this.littleCircle(t,n,o,f)}}},e.Drawing.channel.prototype.reposition=function(t,e,i,r){if(e){var n=this.stx.panels[this.panelName],a=e.tick-i,s=e.value-r;"move"==e.action?(this.setPoint(0,e.p0[0]-a,e.p0[1]-s,n.chart),this.setPoint(1,e.p1[0]-a,e.p1[1]-s,n.chart),this.setPoint(2,e.p2[0]-a,e.p2[1]-s,n.chart),this.render(t)):"drag"==e.action&&(this[e.point]=[i,r],this.setPoint(0,this.p0[0],this.p0[1],n.chart),this.setPoint(1,this.p1[0],this.p1[1],n.chart),this.setPoint(2,this.p2[0],this.p2[1],n.chart),this.render(t))}},e.Drawing.channel.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setPoint(2,this.d1,this.v2,t.chart))},e.Drawing.channel.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.v2=e.v2,this.adjust()},e.Drawing.channel.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,v2:this.v2}},e.Drawing.pitchfork=function(){this.name="pitchfork",this.dragToDraw=!1,this.p2=null},e.Drawing.pitchfork.ciqInheritsFrom(e.Drawing.channel),e.Drawing.pitchfork.prototype.configs=["color","lineWidth","pattern"],e.Drawing.pitchfork.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),null===this.p2?this.p1=[e,i]:this.p2=[e,i],this.render(t))},e.Drawing.pitchfork.prototype.lineIntersection=function(t,i,r,n){var a=this.p0,s=this.p1,o=this.p2,l=this.stx.layout;return a&&s&&o&&e.boxIntersects(r.x0,r.y0,r.x1,r.y1,a[0],a[1],(s[0]+o[0])/2,(s[1]+o[1])/2,n,l.semiLog||"log"==l.chartScale)},e.Drawing.pitchfork.prototype.intersected=function(t,i,r){return this.p0&&this.p1&&this.p2?this.pointIntersection(this.p0[0],this.p0[1],r)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(this.p1[0],this.p1[1],r)?(this.highlighted="p1",{action:"drag",point:"p1"}):this.pointIntersection(this.p2[0],this.p2[1],r)?(this.highlighted="p2",{action:"drag",point:"p2"}):this.lineIntersection(t,i,r,"ray")?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),p2:e.clone(this.p2),tick:t,value:i}):null:null},e.Drawing.pitchfork.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.p2;i||(i=this.p1);var r=this.stx.pixelFromTick(this.p0[0],e.chart),n=this.stx.pixelFromTick(this.p1[0],e.chart),a=this.stx.pixelFromTick(i[0],e.chart),s=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(e,this.p1[0],this.p1[1]),l=this.stx.pixelFromValueAdjusted(e,i[0],i[1]),h=this.lineWidth,c=this.setLineColor(),u={pattern:this.pattern,lineWidth:h},d=50,p=2*s-o-l,f=2*r-n-a;if(f<0&&(d*=-1),p=d*p/f,this.stx.plotLine(r,(n+a)/2,s,(o+l)/2,c,"ray",t,e,u),this.stx.plotLine(n,a,o,l,c,"segment",t,e,u),n==a&&o==l||(this.stx.plotLine(n,n-d,o,o-p,c,"ray",t,e,u),this.stx.plotLine(a,a-d,l,l-p,c,"ray",t,e,u)),this.highlighted){var m="p0"==this.highlighted,g="p1"==this.highlighted,v="p2"==this.highlighted;this.littleCircle(t,r,s,m),this.littleCircle(t,n,o,g),this.littleCircle(t,a,l,v)}}},e.Drawing.pitchfork.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.setPoint(1,this.d1,this.v1,t.chart),this.setPoint(2,this.d2,this.v2,t.chart))},e.Drawing.pitchfork.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.d2=e.d2,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.tzo2=e.tzo2,this.v0=e.v0,this.v1=e.v1,this.v2=e.v2,this.adjust()},e.Drawing.pitchfork.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,d2:this.d2,tzo0:this.tzo0,tzo1:this.tzo1,tzo2:this.tzo2,v0:this.v0,v1:this.v1,v2:this.v2}},e.Drawing.gartley=function(){this.name="gartley",this.dragToDraw=!1,this.maxSegments=4,this.shape=null,this.points=[]},e.Drawing.gartley.ciqInheritsFrom(e.Drawing.continuous),e.Drawing.gartley.prototype.check=function(t,e){if(!e)return!0;if(t[0]>=e[0]||t[1]==e[1])return!1;if(1==this.segment)t[1]<e[1]?this.shape="M":this.shape="W";else if(2==this.segment){if("M"==this.shape&&t[1]<e[1])return!1;if("W"==this.shape&&t[1]>e[1])return!1;if((e[1]-t[1])/(this.points[0][1]-t[1])<.618)return!1;if((e[1]-t[1])/(this.points[0][1]-t[1])>=.786)return!1}else if(3==this.segment){if("M"==this.shape&&t[1]>e[1])return!1;if("W"==this.shape&&t[1]<e[1])return!1;if((e[1]-t[1])/(this.points[1][1]-t[1])<.618)return!1;if((e[1]-t[1])/(this.points[1][1]-t[1])>=.786)return!1}else if(4==this.segment){if("M"==this.shape&&(t[1]<e[1]||e[1]<this.points[0][1]))return!1
;if("W"==this.shape&&(t[1]>e[1]||e[1]>this.points[0][1]))return!1;if((this.points[1][1]-e[1])/(this.points[1][1]-this.points[2][1])<1.27)return!1;if((this.points[1][1]-e[1])/(this.points[1][1]-this.points[2][1])>=1.618)return!1}return!0},e.Drawing.gartley.prototype.click=function(t,e,i){var r=this.stx.panels[this.panelName];if(r){if(this.copyConfig(),!this.penDown)return this.setPoint(0,e,i,r.chart),this.pts=[],this.penDown=!0,this.segment=1,!1;if(this.accidentalClick(e,i))return this.penDown=!0,!1;if(this.check(this.p0,this.p1)){if(1==this.segment&&this.points.push(this.p0),this.points.push(this.p1),this.drawDropZones=!0,this.setPoint(1,e,i,r.chart),++this.segment>this.maxSegments)return this.setPoint(0,this.points[0][0],this.points[0][1],r.chart),!0;this.pts.push(this.d1,this.tzo1,this.v1),this.setPoint(0,e,i,r.chart)}return!1}},e.Drawing.gartley.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);if(2==this.segment)this.drawDropZone(t,.618*this.points[0][1]+.382*this.p0[1],.786*this.points[0][1]+.214*this.p0[1],this.p0[0]);else if(3==this.segment)this.drawDropZone(t,.618*this.points[1][1]+.382*this.p0[1],.786*this.points[1][1]+.214*this.p0[1],this.p0[0]);else if(4==this.segment){var o=1.618*this.points[2][1]-.618*this.points[1][1];o="M"==this.shape?Math.max(o,this.points[0][1]):Math.min(o,this.points[0][1]),this.drawDropZone(t,o,1.27*this.points[2][1]-.27*this.points[1][1],this.p0[0])}var l=this.lineWidth,h=this.setLineColor(),c={pattern:this.pattern,lineWidth:l};this.segment<=this.maxSegments&&this.stx.plotLine(r,n,a,s,h,this.name,t,i,c);var u=this.fillColor,d=[];if(this.points.length){t.beginPath();for(var p=1;p<this.points.length&&p<=4;p++){var f=this.stx.pixelFromTick(this.points[p-1][0],i.chart),m=this.stx.pixelFromTick(this.points[p][0],i.chart),g=this.stx.pixelFromValueAdjusted(i,this.points[p-1][0],this.points[p-1][1]),v=this.stx.pixelFromValueAdjusted(i,this.points[p][0],this.points[p][1]);1==p&&d.push(f,g),d.push(m,v),this.stx.plotLine(f,m,g,v,h,this.name,t,i,c)}if(2!=this.points.length&&4!=this.points.length||d.push(n,s),this.points[2]&&d.push(this.stx.pixelFromTick(this.points[2][0],i.chart),this.stx.pixelFromValueAdjusted(i,this.points[2][0],this.points[2][1])),u&&"auto"!=u&&!e.isTransparent(u)){for(var y=0;y<d.length;y+=2)0===y&&t.moveTo(d[0],d[1]),t.lineTo(d[y],d[y+1]);t.fillStyle=u,t.globalAlpha=.2,t.closePath(),t.fill(),t.globalAlpha=1}}}},e.Drawing.gartley.prototype.lineIntersection=function(t,i,r,n){var a=this.points,s=this.stx.layout;if(a.length!=this.maxSegments+1)return!1;for(var o=0;o<a.length-1;o++)if(e.boxIntersects(r.x0,r.y0,r.x1,r.y1,a[o][0],a[o][1],a[o+1][0],a[o+1][1],"segment",s.semiLog||"log"==s.chartScale))return!0;return!1},e.Drawing.gartley.prototype.boxIntersection=function(t,e){if(!this.p0||!this.p1)return!1;if(t>Math.max(this.p0[0],this.p1[0])||t<Math.min(this.p0[0],this.p1[0]))return!1;for(var i=Math.min(this.p0[1],this.p1[1]),r=Math.max(this.p0[1],this.p1[1]),n=0;n<this.points.length;n++)i=Math.min(i,this.points[n][1]),r=Math.max(r,this.points[n][1]);return!(e>r||e<i)},e.Drawing.gartley.prototype.reposition=function(t,e,i,r){if(e){var n=this.stx.panels[this.panelName],a=e.tick-i;e.tick=i;var s=e.value-r;if(e.value=r,"move"==e.action){this.pts=[];for(var o=0;o<this.points.length;o++)this.points[o][0]-=a,this.points[o][1]-=s,this.setPoint(1,this.points[o][0],this.points[o][1],n.chart),o&&o<this.points.length-1&&this.pts.push(this.d1,this.tzo1,this.v1),this.points[o]=this.p1;this.setPoint(0,this.points[0][0],this.points[0][1],n.chart),this.render(t)}}},e.Drawing.gartley.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.gartley.prototype.drawDropZone=function(t,e,i,r){var n=this.stx.panels[this.panelName];if(n){var a=this.stx.pixelFromPrice(e,n),s=this.stx.pixelFromPrice(i,n)-a,o=this.stx.pixelFromTick(r,n.chart),l=this.stx.chart.width-o;t.fillStyle="#008000",t.globalAlpha=.2,t.fillRect(o,a,l,s),t.globalAlpha=1}},e.Drawing.gartley.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.reconstructPoints(),this.setPoint(0,this.d0,this.v0,t.chart),this.points.unshift(this.p0),this.setPoint(1,this.d1,this.v1,t.chart),this.points.push(this.p1))},e.Drawing.gartley.prototype.reconstructPoints=function(){var t=this.stx.panels[this.panelName];if(t){this.points=[];for(var i=0;i<this.pts.length;i+=3){var r=e.strToDateTime(this.pts[i]);r.setMinutes(r.getMinutes()+Number(this.pts[i+1])-r.getTimezoneOffset()),this.points.push([this.stx.tickFromDate(e.yyyymmddhhmmssmmm(r),t.chart),this.pts[i+2]])}}},e.Drawing.gartley.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.pts=e.pts.split(","),this.adjust()},e.Drawing.gartley.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,pts:this.pts.join(",")}},e.Drawing.freeform=function(){this.name="freeform",this.splineTension=.3,this.dragToDraw=!0},e.Drawing.freeform.ciqInheritsFrom(e.Drawing.segment),e.Drawing.freeform.prototype.measure=function(){},e.Drawing.freeform.prototype.intersected=function(t,i,r){return t>this.hiX||t<this.lowX?null:i>this.hiY||i<this.lowY?null:(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),tick:t,value:i})},e.Drawing.freeform.prototype.reposition=function(t,e,i,r){if(e){var n=this.stx.panels[this.panelName],a=e.tick-i,s=e.value-r;"move"==e.action&&(this.setPoint(0,e.p0[0]-a,e.p0[1]-s,n.chart),this.adjust(),this.render(t))}},e.Drawing.freeform.prototype.click=function(t,i,r){var n=this.stx.panels[this.panelName];if(n){if(!1===this.penDown){this.copyConfig(),this.startX=Math.round(this.stx.resolveX(this.stx.pixelFromTick(i,n.chart))),this.startY=Math.round(this.stx.resolveY(this.stx.pixelFromValueAdjusted(n,i,r)));var a=this.stx.dateFromTick(i,n.chart,!0);return this.d0=e.yyyymmddhhmmssmmm(a),this.tzo0=a.getTimezoneOffset(),this.v0=r,this.p0=[e.ChartEngine.crosshairX-this.startX,e.ChartEngine.crosshairY-this.startY],this.nodes=[this.p0[0],this.p0[1]],this.pNodes=[this.p0],this.candleWidth=this.stx.layout.candleWidth,this.multiplier=n.yAxis.multiplier,this.interval=this.stx.layout.interval,this.periodicity=this.stx.layout.periodicity,this.tempSplineTension=this.splineTension,this.splineTension=-1,document.body.style.cursor="pointer",this.penDown=!0,!1}return this.penDown=!1,this.splineTension=this.tempSplineTension,document.body.style.cursor="auto",!0}},e.Drawing.freeform.prototype.move=function(t,i,r){if(this.penDown){var n=this.stx.panels[this.panelName],a=this.stx.dateFromTick(i,n.chart,!0);return this.d1=e.yyyymmddhhmmssmmm(a),this.tzo1=a.getTimezoneOffset(),this.v1=r,this.p1=[e.ChartEngine.crosshairX-this.startX,e.ChartEngine.crosshairY-this.startY],this.pNodes.length>2&&(this.p1[0]==this.pNodes[this.pNodes.length-2][0]&&this.p1[0]==this.pNodes[this.pNodes.length-1][0]?(this.pNodes.length--,this.nodes.length-=2):this.p1[1]==this.pNodes[this.pNodes.length-2][1]&&this.p1[1]==this.pNodes[this.pNodes.length-1][1]&&(this.pNodes.length--,this.nodes.length-=2)),this.nodes.push(this.p1[0],this.p1[1]),this.pNodes.push(this.p1),this.render(t),!1}},e.Drawing.freeform.prototype.intervalRatio=function(t,i,r,n,a,s){function o(t,i){return e.Market.Symbology.isForexSymbol(i)?1440:390}var l=0;return t==i?l=1:isNaN(t)||isNaN(i)?isNaN(t)?"month"==t?"week"==i?l=5:"day"==i?l=30:isNaN(i)||(l=30*o(a,s)/i):"week"==t?("month"==i&&(l=.2),"day"==i?l=5:isNaN(i)||(l=5*o(a,s)/i)):"day"==t&&("week"==i?l=.2:"month"==i?l=1/30:isNaN(i)||(l=o(a,s)/i)):isNaN(t)||("month"==i?l=t/(30*o(a,s)):"week"==i?l=t/(5*o(a,s)):"day"==i&&(l=t/o(a,s))):l=t/i,l*=r/n},e.Drawing.freeform.prototype.render=function(t){var e=this.stx.panels[this.panelName];if(e){var i=this.intervalRatio(this.interval,this.stx.layout.interval,this.periodicity,this.stx.layout.periodicity,this.d0,e.chart.symbol);if(0!==i){var r=this.stx.layout.candleWidth/this.candleWidth,n=e.yAxis.multiplier/this.multiplier;this.setPoint(0,this.d0,this.v0,e.chart);for(var a=this.stx.pixelFromTick(this.p0[0],e.chart),s=this.stx.pixelFromValueAdjusted(e,this.p0[0],this.p0[1]),o=[],l=this.lineWidth,h=this.setLineColor(),c={pattern:this.pattern,lineWidth:l},u=0;u<this.pNodes.length;u++){var d=i*r*this.pNodes[u][0]+a,p=n*this.pNodes[u][1]+s;o.push(d,p)}o.length&&(this.splineTension<0?this.stx.connectTheDots(o,h,this.name,t,e,c):this.stx.plotSpline(o,this.splineTension,h,this.name,t,!0,c))}}},e.Drawing.freeform.prototype.adjust=function(){var t=this.stx.panels[this.panelName];if(t){var e=[this.nodes[0],this.nodes[1]];this.pNodes=[e],this.lowX=this.nodes[0],this.hiX=this.nodes[0],this.lowY=this.nodes[1],this.hiY=this.nodes[1];for(var i=2;i<this.nodes.length;i+=2){var r=[this.nodes[i],this.nodes[i+1]];this.pNodes.push(r),this.lowX=Math.min(this.lowX,r[0]),this.hiX=Math.max(this.hiX,r[0]),this.lowY=Math.max(this.lowY,r[1]),this.hiY=Math.min(this.hiY,r[1])}var n=this.intervalRatio(this.interval,this.stx.layout.interval,this.periodicity,this.stx.layout.periodicity,this.d0,t.chart.symbol);if(0!==n){var a=this.stx.layout.candleWidth/this.candleWidth,s=t.yAxis.multiplier/this.multiplier;this.setPoint(0,this.d0,this.v0,t.chart);var o=this.stx.pixelFromTick(this.p0[0],t.chart),l=this.stx.pixelFromValueAdjusted(t,this.p0[0],this.p0[1]);this.lowX=this.stx.tickFromPixel(Math.floor(n*a*this.lowX)+o,t.chart),this.hiX=this.stx.tickFromPixel(Math.ceil(n*a*this.hiX)+o,t.chart),this.lowY=this.stx.valueFromPixel(Math.floor(s*this.lowY)+l,t),this.hiY=this.stx.valueFromPixel(Math.ceil(s*this.hiY)+l,t)}}},e.Drawing.freeform.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,cw:Number(this.candleWidth.toFixed(4)),mlt:Number(this.multiplier.toFixed(4)),d0:this.d0,tzo0:this.tzo0,v0:this.v0,inter:this.interval,pd:this.periodicity,nodes:this.nodes}},e.Drawing.freeform.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.candleWidth=e.cw,this.multiplier=e.mlt,this.d0=e.d0,this.tzo0=e.tzo0,this.v0=e.v0,this.interval=e.inter,this.periodicity=e.pd,this.nodes=e.nodes,this.adjust()},e.Drawing.callout=function(){this.name="callout",this.arr=[],this.w=0,this.h=0,this.padding=4,this.text="",this.ta=null,this.fontSize=0,this.font={},this.stemEntry="",this.defaultWidth=50,this.defaultHeight=10},e.Drawing.callout.ciqInheritsFrom(e.Drawing.annotation),e.Drawing.callout.prototype.configs=["color","fillColor","lineWidth","pattern","font"],e.Drawing.callout.prototype.copyConfig=function(){e.Drawing.copyConfig(this),this.borderColor=this.color},e.Drawing.callout.prototype.move=function(t,e,i){this.penDown&&(this.copyConfig(),this.p0=[e,i],this.render(t))},e.Drawing.callout.prototype.onChange=function(t){if(this.stx.panels[this.panelName]){var i=t.target;this.w=i.clientWidth,this.h=i.clientHeight;var r=this.context||this.stx.chart.tempCanvas.context;e.clearCanvas(r.canvas,this.stx),this.render(r),this.edit(r)}},e.Drawing.callout.prototype.render=function(t){this.context=t;var i=this.stx.panels[this.panelName];if(i){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]);if(!isNaN(n)){t.font=this.fontString,t.textBaseline="top";var a=r,s=n,o=this.w/2,l=this.h/2;this.penDown&&(o=this.defaultWidth,(l=this.defaultHeight)||(l=this.fontSize));var h=this.lineWidth;h||(h=1.1);var c=this.color;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor);var u=this.borderColor;("auto"==u||e.isTransparent(u))&&(u=this.stx.defaultColor),this.highlighted&&(u=this.stx.getCanvasColor("stx_highlight_vector"));var d,p,f,m,g=Math.min(Math.min(o,l)/2,8);if(this.stem){this.stem.t?(d=this.stx.pixelFromTick(this.stem.t),f=this.stx.pixelFromValueAdjusted(i,this.stem.t,this.stem.v)):this.stem.x&&(d=a,f=s,a+=this.stem.x,s+=this.stem.y);var v="";d>=a+o?(p=a+o,v="r"):d>a-o&&d<a+o?(p=a,v="c"):d<=a-o&&(p=a-o,v="l"),f>=s+l?(m=s+l,v+="b"):f>s-l&&f<s+l?(m=s,v+="m"):f<=s-l&&(m=s-l,v+="t"),this.stemEntry=v,"cm"!=v&&(d=Math.round(d),p=Math.round(p),f=Math.round(f),m=Math.round(m))}this.highlighted?this.stx.canvasColor("stx_annotation_highlight_bg",t):this.fillColor?(t.fillStyle=this.fillColor,t.globalAlpha=.4):this.stem&&(t.fillStyle=this.stx.containerColor),t.strokeStyle=u,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(h,this.pattern)),t.lineDashOffset=0),u&&(t.beginPath(),t.lineWidth=h,t.moveTo(a+o-g,s-l),"rt"!=this.stemEntry?t.quadraticCurveTo(a+o,s-l,a+o,s-l+g):(t.lineTo(d,f),t.lineTo(a+o,s-l+g)),t.lineTo(a+o,s-g/2),"rm"==this.stemEntry&&t.lineTo(d,f),t.lineTo(a+o,s+g/2),t.lineTo(a+o,s+l-g),"rb"!=this.stemEntry?t.quadraticCurveTo(a+o,s+l,a+o-g,s+l):(t.lineTo(d,f),t.lineTo(a+o-g,s+l)),t.lineTo(a+g/2,s+l),"cb"==this.stemEntry&&t.lineTo(d,f),t.lineTo(a-g/2,s+l),t.lineTo(a-o+g,s+l),"lb"!=this.stemEntry?t.quadraticCurveTo(a-o,s+l,a-o,s+l-g):(t.lineTo(d,f),t.lineTo(a-o,s+l-g)),t.lineTo(a-o,s+g/2),"lm"==this.stemEntry&&t.lineTo(d,f),t.lineTo(a-o,s-g/2),t.lineTo(a-o,s-l+g),"lt"!=this.stemEntry?t.quadraticCurveTo(a-o,s-l,a-o+g,s-l):(t.lineTo(d,f),t.lineTo(a-o+g,s-l)),t.lineTo(a-g/2,s-l),"ct"==this.stemEntry&&t.lineTo(d,f),t.lineTo(a+g/2,s-l),t.lineTo(a+o-g,s-l),t.fill(),t.globalAlpha=1,t.stroke()),this.highlighted?this.stx.canvasColor("stx_annotation_highlight",t):t.fillStyle=c,s+=this.padding;for(var y=0;y<this.arr.length;y++)t.fillText(this.arr[y],a-o+this.padding,s-l),s+=this.fontSize;if(t.textBaseline="alphabetic",this.highlighted){var x="p0"==this.highlighted;this.littleCircle(t,d,f,x)}}}},e.Drawing.callout.prototype.click=function(t,e,i){if(!this.stx.overXAxis&&!this.stx.overYAxis){var r=this.stx.panels[this.panelName];return this.copyConfig(),(this.setPoint(0,e,i,r.chart),this.penDown)?(this.adjust(),this.edit(t),this.penDown=!1,!1):(this.stem={d:this.d0,v:this.v0},this.penDown=!0,this.adjust(),!1)}},e.Drawing.callout.prototype.reposition=function(t,e,i,r){if(e){var n=this.stx.panels[this.panelName],a=e.tick-i,s=e.value-r;e.stem?("drag"==e.action?this.stem={d:this.stx.dateFromTick(i,n.chart,!0),v:r}:"move"==e.action&&(this.setPoint(0,e.p0[0]-a,e.p0[1]-s,n.chart),this.stem={d:this.stx.dateFromTick(this.stx.tickFromDate(e.stem.d,n.chart)-a),v:e.stem.v-s}),this.adjust()):this.setPoint(0,e.p0[0]-a,e.p0[1]-s,n.chart),this.render(t)}},e.Drawing.callout.prototype.lineIntersection=function(t,i,r,n){var a=this.stx.panels[this.panelName],s=this.stem,o=this.p0;this.stx.layout;if(!o||!s||!a)return!1;var l=s.t||this.stx.tickFromDate(s.d,a.chart);return e.boxIntersects(r.x0,r.y0,r.x1,r.y1,o[0],o[1],l,s.v,n,a.yAxis.semiLog)},e.Drawing.callout.prototype.intersected=function(t,i,r){var n=this.stx.panels[this.panelName];if(!this.p0)return null;if(this.pointIntersection(this.stem.t,this.stem.v,r))return this.highlighted="p0",{action:"drag",stem:!0};var a=this.stx.pixelFromTick(this.p0[0],n.chart)-this.w/2,s=this.stx.pixelFromValueAdjusted(n,this.p0[0],this.p0[1])-this.h/2,o=a+this.w,l=s+this.h;this.stem&&this.stem.x&&(a+=this.stem.x,o+=this.stem.x,s+=this.stem.y,l+=this.stem.y);var h=this.stx.pixelFromTick(t,n.chart),c=this.stx.pixelFromValueAdjusted(n,t,i);return h>=a&&h<=o&&c>=s&&c<=l?(this.highlighted=!0,{p0:e.clone(this.p0),tick:t,value:i}):this.lineIntersection(t,i,r,"segment")?(this.highlighted=!0,{action:"move",stem:e.clone(this.stem),p0:e.clone(this.p0),tick:t,value:i}):null},e.Drawing.fibarc=function(){this.name="fibarc"},e.Drawing.fibarc.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.fibarc.prototype.setOuter=function(){this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};var t=this.p0[1],i=this.p1[1],r=this.p0[0],n=this.p1[0],a=2*(t-i)+i,s=e.xIntersection({x0:r,x1:n,y0:t,y1:i},a);this.outer.p0[1]=a,this.outer.p0[0]=s},e.Drawing.fibarc.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var r=i.yAxis;if(this.p1){var n=this.stx.pixelFromTick(this.p0[0],i.chart),a=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),l=o<s,h=Math.abs((o-s)/(a-n)),c=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var u=this.color;("auto"==u||e.isTransparent(u))&&(u=this.stx.defaultColor);for(var d=0;d<this.parameters.fibs.length;d++){t.fillStyle=u;var p=this.parameters.fibs[d];if(!(p.level<0)&&p.display){var f=Math.abs(this.p1[1]-this.p0[1])*Math.sqrt(2)*p.level,m=this.p1[1]+f*(l?-1:1),g=this.stx.pixelFromValueAdjusted(i,this.p0[0],m),v=e.xIntersection({x0:n,x1:a,y0:s,y1:o},g);if(this.parameters.printLevels){t.textAlign="center";var y=Math.round(1e3*p.level)/10+"%";this.parameters.printValues&&(t.fillStyle=u,this.stx.canvasFont("stx_yaxis",t)),t.fillText(y,a,Math.round(g-5))}if(t.textAlign="left",this.parameters.printValues&&v<this.stx.chart.width){var x=m;x=r.priceFormatter?r.priceFormatter(this.stx,i,x):this.stx.formatYAxisPrice(x,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,x,g,u,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var b=p.color;("auto"==b||e.isTransparent(b))&&(b=this.color),("auto"==b||e.isTransparent(b))&&(b=this.stx.defaultColor),t.strokeStyle=b;var C=p.color;("auto"==C||e.isTransparent(C))&&(C=this.fillColor),("auto"==C||e.isTransparent(C))&&(C=this.stx.defaultColor),t.fillStyle=C,t.globalAlpha=p.parameters.opacity,t.lineWidth=p.parameters.lineWidth,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(t.lineWidth,p.parameters.pattern)),t.lineDashOffset=0),t.save(),t.beginPath(),t.scale(1/h,1),t.arc(a*h,o,Math.abs(g-o),0,Math.PI,!l),t.stroke(),t.globalAlpha=.05,t.fill(),t.restore(),t.setLineDash&&t.setLineDash([]),t.globalAlpha=1}}if(t.textAlign="left",this.stx.plotLine(a,2*n-a,o,2*s-o,c,"segment",t,i,this.parameters.trend.parameters),this.highlighted){var S="p0"==this.highlighted,w="p1"==this.highlighted;this.littleCircle(t,n,s,S),this.littleCircle(t,a,o,w)}}}},e.Drawing.fibfan=function(){this.name="fibfan"},e.Drawing.fibfan.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.fibfan.prototype.setOuter=function(){this.outer={p0:e.clone(this.p0),p1:e.clone(this.p1)};for(var t=this.p0[1],i=this.p1[1],r=this.p0[0],n=this.p1[0],a=0,s=0;s<this.parameters.fibs.length;s++){var o=this.parameters.fibs[s];if(!(o.level>=a)&&o.display){var l=(t-i)*o.level+i,h=e.xIntersection({x0:r,x1:n,y0:t,y1:i},l);a=o.level,this.outer.p1[1]=l,this.outer.p1[0]=h}}},e.Drawing.fibfan.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){var r=i.yAxis;if(this.p1){var n=this.stx.pixelFromTick(this.p0[0],i.chart),a=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),l=Math.min(o,s),h=Math.max(o,s),c=h-l,u=(o-s)/(a-n)>0,d=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var p=t.measureText("161.8%").width+10,f=Number.MAX_VALUE,m=-1*Number.MAX_VALUE,g=this.color;("auto"==g||e.isTransparent(g))&&(g=this.stx.defaultColor);for(var v=0;v<this.parameters.fibs.length;v++){t.fillStyle=g;var y=this.parameters.fibs[v];if(y.display){var x=this.stx.pixelFromValueAdjusted(i,this.p0[0],(this.p0[1]-this.p1[1])*y.level+this.p1[1]),b=e.xIntersection({x0:a,x1:a,y0:s,y1:o},x),C=this.stx.chart.left;a>n&&(C+=this.stx.chart.width);var S=(C-n)*(x-s)/(b-n)+s;if(!(n>C-(this.parameters.printLevels?p+5:0)&&a>n||n<C+(this.parameters.printLevels?p+5:0)&&a<n)){if(this.parameters.printLevels){var w=Math.round(1e3*y.level)/10+"%";a>n?(C-=p,t.textAlign="left"):(C+=p,t.textAlign="right"),this.parameters.printValues&&(t.fillStyle=g,this.stx.canvasFont("stx_yaxis",t)),S=(C-n)*(x-s)/(b-n)+s,t.fillText(w,C,S),a>n?C-=5:C+=5}if(t.textAlign="left",this.parameters.printValues&&b<this.stx.chart.width){var M=this.stx.transformedPriceFromPixel(x,i);M=r.priceFormatter?r.priceFormatter(this.stx,i,M):this.stx.formatYAxisPrice(M,i),t==this.stx.chart.context&&this.stx.endClip(),this.stx.createYAxisLabel(i,M,x,g,null,t),t==this.stx.chart.context&&this.stx.startClip(i.name)}var T=y.color;("auto"==T||e.isTransparent(T))&&(T=this.color),("auto"==T||e.isTransparent(T))&&(T=this.stx.defaultColor);var B=y.color;("auto"==B||e.isTransparent(B))&&(B=this.fillColor),("auto"==B||e.isTransparent(B))&&(B=this.stx.defaultColor),t.fillStyle=B,this.parameters.printLevels&&(S=(C-n)*(x-s)/(b-n)+s),this.stx.plotLine(n,C,s,S,y.level||!this.highlighted?T:d,"segment",t,i,y.parameters),t.globalAlpha=.05,t.beginPath(),t.moveTo(C,S),t.lineTo(n,s),t.lineTo(C,s),t.fill(),t.globalAlpha=1,x<f&&(f=x),x>m&&(m=x)}}}for(var k in{0:0,1:1}){var D=u?h-c*k:l+c*k;D=Math.round(D),D<f&&(f=D),D>m&&(m=D)}if(this.highlighted){var A="p0"==this.highlighted,F="p1"==this.highlighted;this.littleCircle(t,n,s,A),this.littleCircle(t,a,o,F)}}}},e.Drawing.fibtimezone=function(){this.name="fibtimezone"},e.Drawing.fibtimezone.ciqInheritsFrom(e.Drawing.fibonacci),e.Drawing.fibtimezone.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=[1,0],l=this.setLineColor(this.parameters.trend.color);t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var h=this.p1[0]-this.p0[0],c=this.color;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor),t.textAlign="center";var u=r,d=this.stx.chart.panel.yAxis.height,p=0,f=this.parameters.timezone.color;("auto"==f||e.isTransparent(f))&&(f=this.color),("auto"==f||e.isTransparent(f))&&(f=this.stx.defaultColor);var m=this.parameters.timezone.color;("auto"==m||e.isTransparent(m))&&(m=this.fillColor),("auto"==m||e.isTransparent(m))&&(m=this.stx.defaultColor),this.parameters.printLevels&&(d-=13);do{if(u=this.stx.pixelFromTick(this.p0[0]+p*h,i.chart),r<n&&u>this.stx.chart.left+this.stx.chart.width)break;if(r>n&&u<this.stx.chart.left)break;this.parameters.printLevels&&(t.fillStyle=c,t.fillText(n>r?p:-1*p,u,d+7)),t.fillStyle=m,this.stx.plotLine(u,u,0,d,this.highlighted?l:f,"segment",t,i,this.parameters.timezone.parameters),t.globalAlpha=.05,t.beginPath(),t.moveTo(r,0),t.lineTo(u,0),t.lineTo(u,d),t.lineTo(r,d),t.fill(),t.globalAlpha=1,p=o[0]+o[1],o.unshift(p)}while(h);if(t.textAlign="left",this.stx.plotLine(r,n,a,s,l,"segment",t,i,this.parameters.trend.parameters),this.highlighted){var g="p0"==this.highlighted,v="p1"==this.highlighted;this.littleCircle(t,r,a,g),this.littleCircle(t,n,s,v)}}},e.Drawing.fibtimezone.prototype.intersected=function(t,i,r){var n=this.p0,a=this.p1,s=this.stx.layout;return n&&a?this.pointIntersection(n[0],n[1],r)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(a[0],a[1],r)?(this.highlighted="p1",{action:"drag",point:"p1"}):e.boxIntersects(r.x0,r.y0,r.x1,r.y1,n[0],n[1],a[0],a[1],"segment",s.semiLog||"log"==s.chartScale)||r.x0<=n[0]&&r.x1>=n[0]?(this.highlighted=!0,{action:"move",p0:e.clone(n),p1:e.clone(a),tick:t,value:i}):null:null},e.Drawing.shape=function(){this.name="shape",this.radians=0,this.a=0,this.rotating=!1,this.textMeasure=!1,this.configurator="shape",this.dimension=[0,0],this.points=[]},e.Drawing.shape.ciqInheritsFrom(e.Drawing.BaseTwoPoint),e.Drawing.shape.prototype.measure=function(){},e.Drawing.shape.prototype.render=function(t){if(this.points.length){var i=this.stx.panels[this.panelName];if(i){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]);if(this.p1){var a=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);t.globalAlpha=.5,t.fillStyle="#000000",this.rotating?(this.radians=Math.atan((s-n)/(a-r)),a<r?this.radians+=Math.PI:s<n&&(this.radians+=2*Math.PI),this.a=5*parseInt((36*this.radians/Math.PI).toFixed(0),10),this.a%=360,this.radians=this.a*Math.PI/180,this.textMeasure&&t.fillText(this.a+"°",a+10,s+10)):this.penDown&&(this.sx=Math.max(1,parseFloat(Math.abs(2*(a-r)/this.dimension[0]).toFixed(1))),a<r&&(this.sx*=-1),this.sy=Math.max(1,parseFloat(Math.abs(2*(s-n)/this.dimension[1]).toFixed(1))),s<n&&(this.sy*=-1),this.textMeasure&&t.fillText(this.sx+"x,"+this.sy+"x",a+this.sx+5,s+this.sy+5)),t.globalAlpha=1}var o=this.lineWidth;o||(o=1.1);var l={pattern:this.pattern,lineWidth:o};this.highlighted&&"none"==l.pattern&&(l.pattern="solid",.1==l.lineWidth&&(l.lineWidth=1));var h=this.color;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),this.highlighted&&(h=this.stx.getCanvasColor("stx_highlight_vector"),.1==o&&(o=1.1));var c=this.fillColor;o/=2*Math.abs(this.sx*this.sy)/(Math.abs(this.sx)+Math.abs(this.sy)),t.save(),t.translate(r,n),t.rotate(this.radians),t.scale(this.sx,this.sy);var u,d;for(u=0;u<this.points.length;u++){for(t.beginPath(),d=0;d<this.points[u].length;d++){var p,f,m,g,v,y;"M"==this.points[u][d]?(p=this.points[u][++d]-(this.dimension[0]-1)/2,f=this.points[u][++d]-(this.dimension[1]-1)/2,t.moveTo(p,f)):"L"==this.points[u][d]?(p=this.points[u][++d]-(this.dimension[0]-1)/2,f=this.points[u][++d]-(this.dimension[1]-1)/2,t.lineTo(p,f)):"Q"==this.points[u][d]?(m=this.points[u][++d]-(this.dimension[0]-1)/2,v=this.points[u][++d]-(this.dimension[1]-1)/2,p=this.points[u][++d]-(this.dimension[0]-1)/2,f=this.points[u][++d]-(this.dimension[1]-1)/2,t.quadraticCurveTo(m,v,p,f)):"B"==this.points[u][d]&&(m=this.points[u][++d]-(this.dimension[0]-1)/2,v=this.points[u][++d]-(this.dimension[1]-1)/2,g=this.points[u][++d]-(this.dimension[0]-1)/2,y=this.points[u][++d]-(this.dimension[1]-1)/2,p=this.points[u][++d]-(this.dimension[0]-1)/2,f=this.points[u][++d]-(this.dimension[1]-1)/2,t.bezierCurveTo(m,v,g,y,p,f))}t.closePath(),c&&!e.isTransparent(c)&&"auto"!=c&&(t.fillStyle=c,t.fill()),h&&"none"!=this.pattern&&(t.strokeStyle=h,t.lineWidth=o,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(o,this.pattern)),t.lineDashOffset=0),t.stroke())}if(t.restore(),t.save(),t.translate(r,n),t.rotate(this.radians),this.highlighted){var x="p0"==this.highlighted,b="p1"==this.highlighted,C="p2"==this.highlighted;this.littleCircle(t,0,0,x),this.mover(t,0,0,x),this.littleCircle(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,b),this.resizer(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,b),this.littleCircle(t,this.sx*this.dimension[0]/2,0,C),this.rotator(t,this.sx*this.dimension[0]/2,0,C),t.globalAlpha=.5,t.fillStyle="#000000",this.textMeasure&&(t.fillText(this.sx+"x,"+this.sy+"x",this.sx*this.dimension[0]/2+12,this.sy*this.dimension[1]/2+5),t.fillText(this.a+"°",this.sx*this.dimension[0]/2+12,5)),t.globalAlpha=1}else this.penDown&&(this.rotating?this.rotator(t,this.sx*this.dimension[0]/2,0,!0):this.resizer(t,this.sx*this.dimension[0]/2,this.sy*this.dimension[1]/2,!0));t.restore()}}},e.Drawing.shape.prototype.reposition=function(t,e,i,r){if(e){var n=this.stx.panels[this.panelName];if("move"==e.action){var a=e.tick-i,s=e.value-r;this.setPoint(0,e.p0[0]-a,e.p0[1]-s,n.chart),this.render(t)}else{var o=this.stx.pixelFromTick(this.p0[0],n.chart),l=this.stx.pixelFromValueAdjusted(n,this.p0[0],this.p0[1]),h=this.stx.pixelFromTick(i,n.chart),c=this.stx.pixelFromValueAdjusted(n,i,r);"scale"==e.action?(this[e.point]=[i,r],this.sx=parseFloat((((h-o)*Math.cos(this.radians)+(c-l)*Math.sin(this.radians))/(this.dimension[0]/2)).toFixed(1)),Math.abs(this.sx)<1&&(this.sx/=Math.abs(this.sy)),this.sy=parseFloat((((c-l)*Math.cos(this.radians)-(h-o)*Math.sin(this.radians))/(this.dimension[1]/2)).toFixed(1)),Math.abs(this.sy)<1&&(this.sy/=Math.abs(this.sy)),this.render(t)):"rotate"==e.action&&(this[e.point]=[i,r],this.radians=Math.atan((c-l)/(h-o)),h<o?this.radians+=Math.PI:c<l&&(this.radians+=2*Math.PI),this.a=5*parseInt((36*this.radians/Math.PI).toFixed(0),10),this.sx<0&&(this.a=this.a+180),this.a%=360,this.radians=this.a*Math.PI/180,this.render(t))}}},e.Drawing.shape.prototype.intersected=function(t,i,r){if(!this.p0)return null;if(this.stx.repositioningDrawing==this&&this.stx.repositioningDrawing.repositioner)return this.stx.repositioningDrawing.repositioner;var n=this.stx.panels[this.panelName],a=this.stx.pixelFromTick(this.p0[0],n.chart),s=this.stx.pixelFromValueAdjusted(n,this.p0[0],this.p0[1]),o=this.stx.pixelFromTick(t,n.chart),l=this.stx.pixelFromValueAdjusted(n,t,i);o-=a,l-=s;var h=l,c=o;o=Math.cos(this.radians)*c+Math.sin(this.radians)*h,l=Math.cos(this.radians)*h-Math.sin(this.radians)*c,o/=this.sx,l/=this.sy;var u=Math.pow(e.touchDevice?25:5+this.littleCircleRadius(),2),d=Math.abs(u/(this.sx*this.sy)),p=Math.pow(this.dimension[0]/2,2)+Math.pow(this.dimension[1]/2,2)>Math.pow(o,2)+Math.pow(l,2),f=(u-(Math.pow(o*this.sx,2)+Math.pow(l*this.sy,2)))/Math.abs(this.sx*this.sy),m=d-(Math.pow(o-this.dimension[0]/2,2)+Math.pow(l-this.dimension[1]/2,2)),g=d-(Math.pow(o-this.dimension[0]/2,2)+Math.pow(l,2));return m>0&&m>=g&&m>=f?(this.highlighted="p1",{action:"scale"}):g>0&&g>=m&&g>=f?(this.highlighted="p2",{action:"rotate"}):f>0&&f>=m&&f>=g?(this.highlighted="p0",{action:"move",p0:e.clone(this.p0),tick:t,value:i}):p?(this.highlighted=!0,{}):null},e.Drawing.shape.prototype.configs=["color","fillColor","lineWidth","pattern"],e.Drawing.shape.prototype.littleCircleRadius=function(){return 3},e.Drawing.shape.prototype.click=function(t,e,i){if(!this.points.length)return!1;this.copyConfig();var r=this.stx.panels[this.panelName];return this.penDown?(this.setPoint(1,e,i,r.chart),this.rotating?(this.penDown=!1,this.rotating=!1,!0):(this.rotating=!0,!1)):(this.setPoint(0,e,i,r.chart),this.penDown=!0,!1)},e.Drawing.shape.prototype.adjust=function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.radians=Math.round(this.a/5)*Math.PI/36)},e.Drawing.shape.prototype.reconstruct=function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.v0=e.v0,this.tzo0=e.tzo0,this.a=e.a,this.sx=e.sx,this.sy=e.sy,this.adjust()},e.Drawing.shape.prototype.serialize=function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,v0:this.v0,tzo0:this.tzo0,a:this.a,sx:this.sx,sy:this.sy}},e.Drawing.xcross=function(){this.name="xcross",this.dimension=[7,7],this.points=[["M",1,0,"L",3,2,"L",5,0,"L",6,1,"L",4,3,"L",6,5,"L",5,6,"L",3,4,"L",1,6,"L",0,5,"L",2,3,"L",0,1,"L",1,0]]},e.Drawing.xcross.ciqInheritsFrom(e.Drawing.shape),e.Drawing.arrow=function(){this.name="arrow",this.dimension=[11,11],this.points=[["M",3,0,"L",7,0,"L",7,5,"L",10,5,"L",5,10,"L",0,5,"L",3,5,"L",3,0]]},e.Drawing.arrow.ciqInheritsFrom(e.Drawing.shape),e.Drawing.check=function(){this.name="check",this.dimension=[8,9],this.points=[["M",1,5,"L",0,6,"L",2,8,"L",7,1,"L",6,0,"L",2,6,"L",1,5]]},e.Drawing.check.ciqInheritsFrom(e.Drawing.shape),e.Drawing.star=function(){this.name="star",this.dimension=[12,12],this.points=[["M",0,4,"L",4,4,"L",5.5,0,"L",7,4,"L",11,4,"L",8,7,"L",9,11,"L",5.5,9,"L",2,11,"L",3,7,"L",0,4]]},e.Drawing.star.ciqInheritsFrom(e.Drawing.shape),e.Drawing.heart=function(){this.name="heart",this.dimension=[23,20],this.points=[["M",11,3,"B",11,2.4,10,0,6,0,"B",0,0,0,7.5,0,7.5,"B",0,11,4,15.4,11,19,"B",18,15.4,22,11,22,7.5,"B",22,7.5,22,0,16,0,"B",13,0,11,2.4,11,3]]},e.Drawing.heart.ciqInheritsFrom(e.Drawing.shape),e.Drawing.focusarrow=function(){this.name="focusarrow",this.dimension=[7,5],this.points=[["M",0,0,"L",2,2,"L",0,4,"L",0,0],["M",6,0,"L",4,2,"L",6,4,"L",6,0]]},e.Drawing.focusarrow.ciqInheritsFrom(e.Drawing.shape),
e.Drawing.crossline=function(){this.name="crossline"},e.Drawing.crossline.ciqInheritsFrom(e.Drawing.horizontal),e.extend(e.Drawing.crossline.prototype,{measure:function(){},accidentalClick:function(t,e){return!1},adjust:function(){var t=this.stx.panels[this.panelName];t&&(this.setPoint(0,this.d0,this.v0,t.chart),this.p1=e.clone(this.p0))},intersected:function(t,i,r){if(!this.p0||!this.p1)return null;this.p1[0]+=1;var n=this.lineIntersection(t,i,r,"horizontal");return this.p1=e.clone(this.p0),n||(this.p1[1]+=1,n=this.lineIntersection(t,i,r,"vertical"),this.p1=e.clone(this.p0),n)?(this.highlighted=!0,{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}):null},render:function(t){var r=this.stx.panels[this.panelName];if(r){var n=this.stx.pixelFromTick(this.p0[0],r.chart),a=this.stx.pixelFromValueAdjusted(r,this.p0[0],this.p0[1]),s=this.setLineColor(),o={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(n,n+100,a,a,s,"horizontal",t,r,o),this.stx.plotLine(n,n,a,a+100,s,"vertical",t,r,o),this.axisLabel&&!this.highlighted){this.stx.endClip();var l=this.p0[1];if(r.chart.transformFunc&&(l=r.chart.transformFunc(this.stx,r.chart,l)),l=r.yAxis.priceFormatter?r.yAxis.priceFormatter(this.stx,r,l):this.stx.formatYAxisPrice(l,r),this.stx.createYAxisLabel(r,l,a,s),this.stx.startClip(r.name),this.p0[0]>=0&&!e.ChartEngine.hideDates()){var h,c;if(h=this.stx.dateFromTick(this.p0[0],r.chart,!0),e.ChartEngine.isDailyInterval(this.stx.layout.interval))h.setHours(0,0,0,0);else{var u=1e3*h.getSeconds()+h.getMilliseconds();this.stx.dataZone&&(c=new i.Date(h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),this.stx.dataZone),h=new Date(c.getTime()+u)),this.stx.displayZone&&(c=new i.Date(h.getTime(),this.stx.displayZone),h=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes()),h=new Date(h.getTime()+u))}var d=e.mmddhhmm(e.yyyymmddhhmm(h));if(r.chart.xAxis.formatter)d=r.chart.xAxis.formatter(h);else if(this.stx.internationalizer){var p;0!==h.getHours()||0!==h.getMinutes()?(p=this.stx.internationalizer.monthDay.format(h),p+=" "+this.stx.internationalizer.hourMinute.format(h)):p=this.stx.internationalizer.yearMonthDay.format(h),d=p}this.stx.endClip(),this.stx.createXAxisLabel(r,d,n,s,null,!0),this.stx.startClip(r.name)}}}}}),e.Drawing.speedarc=function(){this.name="speedarc",this.printLevels=!0},e.Drawing.speedarc.ciqInheritsFrom(e.Drawing.segment),e.extend(e.Drawing.speedarc.prototype,{defaultOpacity:.25,configs:["color","fillColor","lineWidth","pattern"],lineIntersection:function(t,i,r,n){var a=this.p0,s=this.p1,o=this.stx.layout;return a&&s&&e.boxIntersects(r.x0,r.y0,r.x1,r.y1,a[0],a[1],s[0],s[1],"segment",o.semiLog||"log"==o.chartScale)},copyConfig:function(){this.color=this.stx.currentVectorParameters.currentColor,this.fillColor=this.stx.currentVectorParameters.fillColor,this.lineWidth=this.stx.currentVectorParameters.lineWidth,this.pattern=this.stx.currentVectorParameters.pattern},render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=s<a,l=Math.abs((s-a)/(n-r)),h=this.color;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.strokeStyle=h;var c=this.fillColor;("auto"==c||e.isTransparent(c))&&(c=this.stx.defaultColor),t.fillStyle=c,t.setLineDash&&(t.setLineDash(e.borderPatternToArray(this.lineWidth,this.pattern)),t.lineDashOffset=0),this.stx.canvasFont("stx_yaxis",t);for(var u=1;u<3;u++){var d=Math.abs(this.p1[1]-this.p0[1])*Math.sqrt(2)*u/3,p=this.p1[1]+d*(o?-1:1),f=this.stx.pixelFromValueAdjusted(i,this.p0[0],p);if(t.save(),t.beginPath(),t.scale(1/l,1),t.arc(n*l,s,Math.abs(f-s),0,Math.PI,!o),t.globalAlpha=this.defaultOpacity,t.stroke(),t.globalAlpha=.1,t.fill(),t.restore(),t.globalAlpha=1,this.printLevels){t.fillStyle=h,t.textAlign="center";var m=u+"/3";t.fillText(m,n,Math.round(f-5)),t.fillStyle=c}}t.textAlign="left";var g=this.setLineColor(),v={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity};if(this.stx.plotLine(r,n,a,s,g,"segment",t,i,v),t.setLineDash&&t.setLineDash([]),this.highlighted){var y="p0"==this.highlighted,x="p1"==this.highlighted;this.littleCircle(t,r,a,y),this.littleCircle(t,n,s,x)}}},reconstruct:function(t,e){this.stx=t,this.color=e.col,this.fillColor=e.fc,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.adjust()},serialize:function(){return{name:this.name,pnl:this.panelName,col:this.color,fc:this.fillColor,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1}}}),e.Drawing.speedline=function(){this.name="speedline",this.printLevels=!0},e.Drawing.speedline.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.speedline.prototype,{render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);this.stx.canvasFont("stx_yaxis",t);var o=this.setLineColor(),l=this.color;("auto"==l||e.isTransparent(l))&&(l=this.stx.defaultColor),t.strokeStyle=l;var h=this.fillColor;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.fillStyle=h;for(var c,u,d={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity},p=["1","2/3","1/3","3/2","3"],f=[1,2/3,1/3,1.5,3],m=[],g=0;g<f.length;g++){var v=f[g];if(!(v>1)||this.extension){var y,x=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]-(this.p0[1]-this.p1[1])*v);v>1?(y=e.xIntersection({x0:r,x1:n,y0:a,y1:x},s),m.push(y)):(y=e.xIntersection({x0:n,x1:n,y0:a,y1:s},x),m.push(x));var b=v>1?y:n,C=v>1?s:x;if(this.confineToGrid||(b=this.stx.chart.left,n>r&&(b+=this.stx.chart.width),C=(b-r)*(x-a)/(n-r)+a),this.printLevels&&(1!=v||this.extension)){t.fillStyle=l;var S=0,w=0;a>s?(w=-5,t.textBaseline="bottom"):(w=5,t.textBaseline="top"),r>n?(S=5,t.textAlign="right"):(S=-5,t.textAlign="left"),v>1?t.fillText(p[g],y+(this.confineToGrid?0:S),s):t.fillText(p[g],n,x+(this.confineToGrid?0:w)),t.fillStyle=h}this.stx.plotLine(r,b,a,C,g||!this.highlighted?l:o,"segment",t,i,d),1==v&&(c=b,u=C),t.globalAlpha=.1,t.beginPath(),t.moveTo(b,C),t.lineTo(r,a),t.lineTo(c,u),t.fill(),t.globalAlpha=1}}if(t.textAlign="left",t.textBaseline="middle",this.confineToGrid&&(t.globalAlpha=.3,t.beginPath(),t.moveTo(r,a),t.lineTo(r,s),t.lineTo(n,s),t.lineTo(n,a),t.lineTo(r,a),t.moveTo(r,m[1]),t.lineTo(n,m[1]),t.moveTo(r,m[2]),t.lineTo(n,m[2]),this.extension&&(t.moveTo(m[3],a),t.lineTo(m[3],s),t.moveTo(m[4],a),t.lineTo(m[4],s)),t.stroke(),t.globalAlpha=1),this.highlighted){var M="p0"==this.highlighted,T="p1"==this.highlighted;this.littleCircle(t,r,a,M),this.littleCircle(t,n,s,T)}}}}),e.Drawing.gannfan=function(){this.name="gannfan",this.printLevels=!0},e.Drawing.gannfan.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.gannfan.prototype,{render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);this.stx.canvasFont("stx_yaxis",t);var o=this.setLineColor(),l=this.color;("auto"==l||e.isTransparent(l))&&(l=this.stx.defaultColor),t.strokeStyle=l;var h=this.fillColor;("auto"==h||e.isTransparent(h))&&(h=this.stx.defaultColor),t.fillStyle=h;for(var c,u,d={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity},p=[1,2,3,4,8,.5,1/3,.25,1/8],f=0;f<p.length;f++){var m=p[f],g=r+(n-r)/m,v=a-m*(a-s),y=this.stx.chart.left;n>r&&(y+=this.stx.chart.width);var x=(y-r)*(v-a)/(n-r)+a;if(this.printLevels){t.fillStyle=l;var b=0,C=0;a>s?(C=5,t.textBaseline="top"):(C=-5,t.textBaseline="botttom"),r>n?(b=5,t.textAlign="left"):(b=-5,t.textAlign="right"),m>1?t.fillText(m+"x1",g+b,s):t.fillText("1x"+1/m,n,v+C),t.fillStyle=h}this.stx.plotLine(r,y,a,x,f||!this.highlighted?l:o,"segment",t,i,d),1==m&&(c=y,u=x),t.globalAlpha=.1,t.beginPath(),t.moveTo(y,x),t.lineTo(r,a),t.lineTo(c,u),t.fill(),t.globalAlpha=1}if(t.textAlign="left",t.textBaseline="middle",this.highlighted){var S="p0"==this.highlighted,w="p1"==this.highlighted;this.littleCircle(t,r,a,S),this.littleCircle(t,n,s,w)}}}}),e.Drawing.timecycle=function(){this.name="timecycle",this.printLevels=!0},e.Drawing.timecycle.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.timecycle.prototype,{intersected:function(t,i,r){var n=this.p0,a=this.p1,s=this.stx.layout;return n&&a?this.pointIntersection(n[0],n[1],r)?(this.highlighted="p0",{action:"drag",point:"p0"}):this.pointIntersection(a[0],a[1],r)?(this.highlighted="p1",{action:"drag",point:"p1"}):e.boxIntersects(r.x0,r.y0,r.x1,r.y1,n[0],n[1],a[0],a[1],"segment",s.semiLog||"log"==s.chartScale)||r.x0<=this.p0[0]&&r.x1>=n[0]?(this.highlighted=!0,{action:"move",p0:e.clone(n),p1:e.clone(a),tick:t,value:i}):null:null},render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),s=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]),o=0,l=this.setLineColor();t.textBaseline="middle",this.stx.canvasFont("stx_yaxis",t);var h=this.p1[0]-this.p0[0];t.textAlign="center";var c=r,u=this.stx.chart.panel.yAxis.height,d=this.color;("auto"==d||e.isTransparent(d))&&(d=this.stx.defaultColor);var p=this.fillColor;("auto"==p||e.isTransparent(p))&&(p=this.stx.defaultColor),this.printLevels&&(u-=13);var f={pattern:this.pattern,lineWidth:this.lineWidth,opacity:this.defaultOpacity},m=[];t.save(),t.fillStyle=p,t.globalAlpha=.05;do{if(c=this.stx.pixelFromTick(this.p0[0]+o*h,i.chart),o++,r<n&&c>this.stx.chart.left+this.stx.chart.width)break;if(r>n&&c<this.stx.chart.left)break;c<this.stx.chart.left||c>this.stx.chart.left+this.stx.chart.width||(t.beginPath(),t.moveTo(r,0),t.lineTo(c,0),t.lineTo(c,u),t.lineTo(r,u),t.fill(),m.push({c:o,x:c}))}while(h);t.globalAlpha=1;for(var g=0,v=0;v<m.length;v++)if(this.stx.plotLine(m[v].x,m[v].x,0,u,this.highlighted?l:d,"segment",t,i,f),this.printLevels){t.fillStyle=d;var y=this.stx.chart.context.measureText(m[v].c).width+3;y<this.stx.layout.candleWidth+g?(t.fillText(m[v].c,m[v].x,u+7),g=0):g+=this.stx.layout.candleWidth}if(t.restore(),t.textAlign="left",this.stx.plotLine(r,n,a,s,l,"segment",t,i,f),this.highlighted){var x="p0"==this.highlighted,b="p1"==this.highlighted;this.littleCircle(t,r,a,x),this.littleCircle(t,n,s,b)}}}}),e.Drawing.regression=function(){this.name="regression"},e.Drawing.regression.ciqInheritsFrom(e.Drawing.segment),e.extend(e.Drawing.regression.prototype,{click:function(t,e,i){if(!(e<0)){this.copyConfig();var r=this.stx.panels[this.panelName];return this.penDown?this.accidentalClick(e,i)?this.dragToDraw:(this.setPoint(1,e,i,r.chart),this.penDown=!1,!0):(this.setPoint(0,e,i,r.chart),this.penDown=!0,!1)}},lineIntersection:function(t,i,r,n){var a=this.p0,s=this.p1,o=this.stx.layout;return a&&s&&e.boxIntersects(r.x0,r.y0,r.x1,r.y1,a[0],a[1],s[0],s[1],"segment",o.semiLog||"log"==o.chartScale)},render:function(t){var e=this.stx.panels[this.panelName];if(e&&this.p1&&!(this.p0[0]<0||this.p1[0]<0)){var i=this.stx.pixelFromTick(this.p0[0],e.chart),r=this.stx.pixelFromTick(this.p1[0],e.chart);if(!(i<this.stx.chart.left&&r<this.stx.chart.left||i>this.stx.chart.right&&r>this.stx.chart.right)){for(var n=[],a=0,s=0,o=0,l=Math.min(this.p1[0],this.p0[0]);l<=Math.max(this.p1[0],this.p0[0]);l++){if(this.stx.chart.dataSet[l]){var h=this.stx.chart.dataSet[l].Close;(h||0===h)&&n.push(h)}o++}for(l=0;l<n.length;l++)s+=n.length*n[l]-a,a+=n[l];var c,u,d=n.length,p=d*(d+1)/2,f=Math.pow(p,2),m=p*(2*d+1)/3,g=(d*s-p*a)/(d*m-f),v=(a-g*p)/d;this.p0[0]<this.p1[0]?(c=this.stx.pixelFromValueAdjusted(e,this.p0[0],v),u=this.stx.pixelFromValueAdjusted(e,this.p1[0],g*o+v)):(c=this.stx.pixelFromValueAdjusted(e,this.p0[0],g*o+v),u=this.stx.pixelFromValueAdjusted(e,this.p1[0],v));var y=this.setLineColor(),x={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(i,r,c,u,y,"segment",t,e,x),this.stx.plotLine(i,i,c-20,c+20,y,"segment",t,e,x),this.stx.plotLine(r,r,u-20,u+20,y,"segment",t,e,x),this.highlighted){var b="p0"==this.highlighted,C="p1"==this.highlighted;this.littleCircle(t,i,c,b),this.littleCircle(t,r,u,C)}else this.p0[0]<this.p1[0]?(this.setPoint(0,this.p0[0],v,e.chart),this.setPoint(1,this.p1[0],g*o+v,e.chart)):(this.setPoint(0,this.p0[0],g*o+v,e.chart),this.setPoint(1,this.p1[0],v,e.chart))}}}}),e.Drawing.trendline=function(){this.name="trendline"},e.Drawing.trendline.ciqInheritsFrom(e.Drawing.segment),e.Drawing.trendline.prototype.configs=["color","fillColor","lineWidth","pattern","font"],e.Drawing.trendline.prototype.measure=function(){},e.Drawing.trendline.prototype.reconstruct=function(t,i){e.Drawing.segment.prototype.reconstruct.call(this,t,i),this.callout=new e.Drawing.callout,this.callout.reconstruct(t,i.callout)},e.Drawing.trendline.prototype.serialize=function(){var t=e.Drawing.segment.prototype.serialize.call(this);return t.callout=this.callout.serialize(),t},e.Drawing.trendline.prototype.render=function(t){var i=this.stx.panels[this.panelName];if(i){if(e.Drawing.segment.prototype.render.call(this,t),!this.callout){this.callout=new e.Drawing.callout;var r=e.Drawing.segment.prototype.serialize.call(this);this.callout.reconstruct(this.stx,r)}this.callout.p0=e.clone(this.p0);var n=this.stx.pixelFromTick(this.p0[0],i.chart),a=this.stx.pixelFromTick(this.p1[0],i.chart),s=this.stx.pixelFromValueAdjusted(i,this.p0[0],this.p0[1]),o=this.stx.pixelFromValueAdjusted(i,this.p1[0],this.p1[1]);if(isFinite(s)&&isFinite(o)){var l=(n+a)/2,h=(s+o)/2;this.fontSize=e.stripPX(this.font&&this.font.size||13);var c=1.2*this.callout.w+("c"==this.callout.stemEntry[0]?0:50),u=Math.sqrt(Math.pow(a-n,2)+Math.pow(o-s,2)),d=c/(u||c)*(this.p1[1]<this.p0[1]?1:-1),p=-(o-h)*d+l,f=(a-l)*d+h;this.callout.p0[0]=this.stx.tickFromPixel(p,i.chart),this.callout.p0[1]=this.stx.priceFromPixel(f,i),this.callout.v0=this.callout.p0[1],this.callout.p1=e.clone(this.p0),this.callout.stx=this.stx,this.callout.fillColor=this.fillColor||this.callout.fillColor,this.callout.borderColor=this.color,this.callout.font=this.font||this.callout.font,this.callout.noHandles=!0;var m=this.p1[1]-this.p0[1];this.callout.text=Number(m).toFixed(2)+(0===this.p0[1]?"":" ("+Number(100*m/this.p0[1]).toFixed(2)+"%) ")+Math.abs(this.p1[0]-this.p0[0])+" Bars";var g,v=Math.floor((this.p0[0]+this.p1[0])/2);if(Math.abs(this.p0[0]-this.p1[0])>1&&Math.abs(this.p0[0]-this.p1[0])<20){var y=this.stx.pixelFromTick(v,i.chart),x=s+(o-s)/(a-n)*(y-n);g=this.stx.priceFromPixel(x,i)||h}else g=this.stx.priceFromPixel(h,i);if(this.callout.stem={t:v,v:g},this.callout.renderText(),this.callout.render(t),this.highlighted){var b="p0"==this.highlighted,C="p1"==this.highlighted;this.littleCircle(t,n,s,b),this.littleCircle(t,a,o,C)}}}},e.Drawing.trendline.prototype.lineIntersection=function(t,i,r,n){return e.Drawing.BaseTwoPoint.prototype.lineIntersection.call(this,t,i,r,"segment")},e.Drawing.trendline.prototype.intersected=function(t,i,r){if(!this.p0||!this.p1)return null;var n=this.callout.intersected(t,i,r),a=e.Drawing.segment.prototype.intersected.call(this,t,i,r);return this.callout.highlighted=!(!n&&!a),a||(n?{action:"move",p0:e.clone(this.p0),p1:e.clone(this.p1),tick:t,value:i}:null)},e.Drawing.average=function(){this.name="average"},e.Drawing.average.ciqInheritsFrom(e.Drawing.regression),e.extend(e.Drawing.average.prototype,{configs:["color","lineWidth","pattern","axisLabel"],measure:function(){},render:function(t){var e=this.stx.panels[this.panelName];if(e&&this.p1&&!(this.p0[0]<0||this.p1[0]<0)){var i=this.stx.pixelFromTick(this.p0[0],e.chart),r=this.stx.pixelFromTick(this.p1[0],e.chart);if(!(i<this.stx.chart.left&&r<this.stx.chart.left||i>this.stx.chart.right&&r>this.stx.chart.right)){for(var n=0,a=0,s=0,o=Math.min(this.p1[0],this.p0[0]);o<=Math.max(this.p1[0],this.p0[0]);o++){if(this.stx.chart.dataSet[o]){var l=this.stx.chart.dataSet[o].Close;(l||0===l)&&(s++,n+=l)}a++}if(s){var h=n/s;y=this.stx.pixelFromValueAdjusted(e,this.p0[0],h);var c=this.setLineColor(),u={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(i,r,y,y,c,"segment",t,e,u),this.stx.plotLine(i,i,y-20,y+20,c,"segment",t,e,u),this.stx.plotLine(r,r,y-20,y+20,c,"segment",t,e,u),this.axisLabel&&!this.highlighted&&!this.penDown&&(i>=e.chart.left&&i<=e.chart.right||r>=e.chart.left&&r<=e.chart.right)){this.stx.endClip();var d=h;e.chart.transformFunc&&(d=e.chart.transformFunc(this.stx,e.chart,d)),d=e.yAxis.priceFormatter?e.yAxis.priceFormatter(this.stx,e,d):this.stx.formatYAxisPrice(d,e),this.stx.createYAxisLabel(e,d,y,c),this.stx.startClip(e.name)}if(this.highlighted){var p="p0"==this.highlighted,f="p1"==this.highlighted;this.littleCircle(t,i,y,p),this.littleCircle(t,r,y,f)}else this.setPoint(0,this.p0[0],h),this.setPoint(1,this.p1[0],h)}}}},reconstruct:function(t,e){this.stx=t,this.color=e.col,this.panelName=e.pnl,this.pattern=e.ptrn,this.lineWidth=e.lw,this.d0=e.d0,this.d1=e.d1,this.tzo0=e.tzo0,this.tzo1=e.tzo1,this.v0=e.v0,this.v1=e.v1,this.axisLabel=e.al,this.adjust()},serialize:function(){return{name:this.name,pnl:this.panelName,col:this.color,ptrn:this.pattern,lw:this.lineWidth,d0:this.d0,d1:this.d1,tzo0:this.tzo0,tzo1:this.tzo1,v0:this.v0,v1:this.v1,al:this.axisLabel}}}),e.Drawing.quadrant=function(){this.name="quadrant"},e.Drawing.quadrant.ciqInheritsFrom(e.Drawing.speedarc),e.extend(e.Drawing.quadrant.prototype,{render:function(t){var i=this.stx.panels[this.panelName];if(i&&this.p1){for(var r=this.stx.pixelFromTick(this.p0[0],i.chart),n=this.stx.pixelFromTick(this.p1[0],i.chart),a=null,s=null,o=Math.min(this.p1[0],this.p0[0]);o<=Math.max(this.p1[0],this.p0[0]);o++)if(this.stx.chart.dataSet[o]){var l=this.stx.chart.dataSet[o].Close;(l||0===l)&&((null===a||l>a)&&(a=l),(null===s||l<s)&&(s=l))}var h=(a+s)/2,c=this.stx.pixelFromValueAdjusted(i,this.p0[0],a),u=this.stx.pixelFromValueAdjusted(i,this.p0[0],(a+h)/2),d=this.stx.pixelFromValueAdjusted(i,this.p0[0],(2*a+s)/3),p=this.stx.pixelFromValueAdjusted(i,this.p0[0],h),f=this.stx.pixelFromValueAdjusted(i,this.p0[0],(a+2*s)/3),m=this.stx.pixelFromValueAdjusted(i,this.p0[0],(s+h)/2),g=this.stx.pixelFromValueAdjusted(i,this.p0[0],s),v=this.setLineColor(),y=this.fillColor;("auto"==y||e.isTransparent(y))&&(y=this.stx.defaultColor),t.fillStyle=y;var x={pattern:this.pattern,lineWidth:this.lineWidth};if(this.stx.plotLine(r,n,c,c,v,"segment",t,i,x),this.stx.plotLine(r,n,g,g,v,"segment",t,i,x),"quadrant"==this.name?(this.stx.plotLine(r,n,u,u,v,"segment",t,i,x),this.stx.plotLine(r,n,m,m,v,"segment",t,i,x)):"tirone"==this.name&&(this.stx.plotLine(r,n,d,d,v,"segment",t,i,x),this.stx.plotLine(r,n,f,f,v,"segment",t,i,x)),this.stx.plotLine(r,r,c,g,v,"segment",t,i,x),this.stx.plotLine(n,n,c,g,v,"segment",t,i,x),this.stx.plotLine(r,n,p,p,v,"segment",t,i,e.extend(x,{opacity:"tirone"==this.name?.2:1})),t.globalAlpha=.1,t.beginPath(),t.fillRect(r,c,n-r,g-c),"quadrant"==this.name?t.fillRect(r,u,n-r,m-u):"tirone"==this.name&&t.fillRect(r,d,n-r,f-d),t.globalAlpha=1,this.highlighted){var b="p0"==this.highlighted,C="p1"==this.highlighted;this.littleCircle(t,r,p,b),this.littleCircle(t,n,p,C)}else this.setPoint(0,this.p0[0],h,i.chart),this.setPoint(1,this.p1[0],h,i.chart)}}}),e.Drawing.tirone=function(){this.name="tirone"},e.Drawing.tirone.ciqInheritsFrom(e.Drawing.quadrant),t},__equations_=function(t){var e=t.CIQ,i=function(){function t(t){function e(){}return e.prototype=t,new e}function e(t,e,i,r){this.type_=t,this.index_=e||0,this.prio_=i||0,this.number_=void 0!==r&&null!==r?r:0,this.toString=function(){switch(this.type_){case E:return this.number_;case L:case N:case O:return this.index_;case z:return"CALL";default:return"Invalid Token"}}}function i(t,e,i,r){this.tokens=t,this.ops1=e,this.ops2=i,this.functions=r}function r(t){return"string"==typeof t?(I.lastIndex=0,I.test(t)?"'"+t.replace(I,function(t){var e=R[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+"'":"'"+t+"'"):t}function n(t,e){return Number(t)+Number(e)}function a(t,e){return t-e}function s(t,e){return t*e}function o(t,e){return t/e}function l(t,e){return t%e}function h(t,e){return""+t+e}function c(t,e){return t==e}function u(t,e){return t!=e}function d(t,e){return t>e}function p(t,e){return t<e}function f(t,e){return t>=e}function m(t,e){return t<=e}function g(t,e){return Boolean(t&&e)}function v(t,e){return Boolean(t||e)}function y(t){return Math.sinh?Math.sinh(t):(Math.exp(t)-Math.exp(-t))/2}function x(t){return Math.cosh?Math.cosh(t):(Math.exp(t)+Math.exp(-t))/2}function b(t){return Math.tanh?Math.tanh(t):t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function C(t){return Math.asinh?Math.asinh(t):t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function S(t){return Math.acosh?Math.acosh(t):Math.log(t+Math.sqrt(t*t-1))}function w(t){return Math.atanh?Math.atanh(t):Math.log((1+t)/(1-t))/2}function M(t){return Math.log(t)*Math.LOG10E}function T(t){return-t}function B(t){return Math.trunc?Math.trunc(t):t<0?Math.ceil(t):Math.floor(t)}function k(t){return Math.random()*(t||1)}function D(t){t=Math.floor(t);for(var e=t;t>1;)e*=--t;return e}function A(){if(Math.hypot)return Math.hypot.apply(this,arguments);for(var t=0,e=arguments.length,i=0;i<e;i++){if(arguments[i]===1/0||arguments[i]===-1/0)return 1/0;t+=arguments[i]*arguments[i]}return Math.sqrt(t)}function F(t,e,i){return t?e:i}function _(t,e){return"[object Array]"!=Object.prototype.toString.call(t)?[t,e]:(t=t.slice(),t.push(e),t)}function P(){this.success=!1,this.errormsg="",this.expression="",this.pos=0,this.tokennumber=0,this.tokenprio=0,this.tokenindex=0,this.tmpprio=0,this.ops1={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:y,cosh:x,tanh:b,asinh:C,acosh:S,atanh:w,sqrt:Math.sqrt,log:Math.log,lg:M,log10:M,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:B,"-":T,exp:Math.exp},this.ops2={"+":n,"-":a,"*":s,"/":o,"%":l,"^":Math.pow,",":_,"||":h,"==":c,"!=":u,">":d,"<":p,">=":f,"<=":m,and:g,or:v},this.functions={random:k,fac:D,min:Math.min,max:Math.max,hypot:A,pyt:A,pow:Math.pow,atan2:Math.atan2,if:F},this.consts={E:Math.E,PI:Math.PI}}var E=0,L=1,N=2,O=3,z=4,I=/[\\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,R={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};i.prototype={simplify:function(r){r=r||{};var n,a,s,o,l=[],h=[],c=this.tokens.length,u=0;for(u=0;u<c;u++){o=this.tokens[u];var d=o.type_;if(d===E)l.push(o);else if(d===O&&o.index_ in r)o=new e(E,0,0,r[o.index_]),l.push(o);else if(d===N&&l.length>1)a=l.pop(),n=l.pop(),s=this.ops2[o.index_],o=new e(E,0,0,s(n.number_,a.number_)),l.push(o);else if(d===L&&l.length>0)n=l.pop(),s=this.ops1[o.index_],o=new e(E,0,0,s(n.number_)),l.push(o);else{for(;l.length>0;)h.push(l.shift());h.push(o)}}for(;l.length>0;)h.push(l.shift());return new i(h,t(this.ops1),t(this.ops2),t(this.functions))},substitute:function(r,n){n instanceof i||(n=(new P).parse(String(n)));var a,s=[],o=this.tokens.length,l=0;for(l=0;l<o;l++){a=this.tokens[l];if(a.type_===O&&a.index_===r)for(var h=0;h<n.tokens.length;h++){var c=n.tokens[h],u=new e(c.type_,c.index_,c.prio_,c.number_);s.push(u)}else s.push(a)}return new i(s,t(this.ops1),t(this.ops2),t(this.functions))},evaluate:function(t){t=t||{};var e,i,r,n,a=[],s=this.tokens.length,o=0;for(o=0;o<s;o++){n=this.tokens[o];var l=n.type_;if(l===E)a.push(n.number_);else if(l===N)i=a.pop(),e=a.pop(),r=this.ops2[n.index_],a.push(r(e,i));else if(l===O)if(n.index_ in t)a.push(t[n.index_]);else{if(!(n.index_ in this.functions))throw new Error("undefined variable: "+n.index_);a.push(this.functions[n.index_])}else if(l===L)e=a.pop(),r=this.ops1[n.index_],a.push(r(e));else{if(l!==z)throw new Error("invalid Expression");if(e=a.pop(),r=a.pop(),!r.apply||!r.call)throw new Error(r+" is not a function");"[object Array]"==Object.prototype.toString.call(e)?a.push(r.apply(void 0,e)):a.push(r.call(void 0,e))}}if(a.length>1)throw new Error("invalid Expression (parity)");return a[0]},toString:function(t){var e,i,n,a,s=[],o=this.tokens.length,l=0;for(l=0;l<o;l++){a=this.tokens[l];var h=a.type_;if(h===E)s.push(r(a.number_));else if(h===N)i=s.pop(),e=s.pop(),n=a.index_,t&&"^"==n?s.push("Math.pow("+e+","+i+")"):s.push("("+e+n+i+")");else if(h===O)s.push(a.index_);else if(h===L)e=s.pop(),n=a.index_,"-"===n?s.push("("+n+e+")"):s.push(n+"("+e+")");else{if(h!==z)throw new Error("invalid Expression");e=s.pop(),n=s.pop(),s.push(n+"("+e+")")}}if(s.length>1)throw new Error("invalid Expression (parity)");return s[0]},variables:function(){for(var t=this.tokens.length,e=[],i=0;i<t;i++){var r=this.tokens[i];r.type_===O&&-1==e.indexOf(r.index_)&&e.push(r.index_)}return e}},P.parse=function(t){return(new P).parse(t)},P.evaluate=function(t,e){return P.parse(t).evaluate(e)},P.Expression=i,P.values={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:y,cosh:x,tanh:b,asinh:C,acosh:S,atanh:w,sqrt:Math.sqrt,log:Math.log,lg:M,log10:M,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:B,random:k,fac:D,exp:Math.exp,min:Math.min,max:Math.max,hypot:A,pyt:A,pow:Math.pow,atan2:Math.atan2,if:F,E:Math.E,PI:Math.PI};return P.prototype={parse:function(r){this.errormsg="",this.success=!0;var n=[],a=[];this.tmpprio=0;var s=77,o=0;for(this.expression=r,this.pos=0;this.pos<this.expression.length;){var l;if(this.isOperator())this.isSign()&&64&s?(this.isNegativeSign()&&(this.tokenprio=2,this.tokenindex="-",o++,this.addfunc(a,n,L)),s=77):this.isComment()||(0==(2&s)&&this.error_parsing(this.pos,"unexpected operator"),o+=2,this.addfunc(a,n,N),s=77);else if(this.isNumber())0==(1&s)&&this.error_parsing(this.pos,"unexpected number"),l=new e(E,0,0,this.tokennumber),a.push(l),s=50;else if(this.isString())0==(1&s)&&this.error_parsing(this.pos,"unexpected string"),l=new e(E,0,0,this.tokennumber),a.push(l),s=50;else if(this.isLeftParenth())0==(8&s)&&this.error_parsing(this.pos,'unexpected "("'),128&s&&(o+=2,this.tokenprio=-2,this.tokenindex=-1,this.addfunc(a,n,z)),s=333;else if(this.isRightParenth())256&s?(l=new e(E,0,0,[]),a.push(l)):0==(16&s)&&this.error_parsing(this.pos,'unexpected ")"'),s=186;else if(this.isComma())0==(32&s)&&this.error_parsing(this.pos,'unexpected ","'),this.addfunc(a,n,N),o+=2,s=77;else if(this.isConst()){0==(1&s)&&this.error_parsing(this.pos,"unexpected constant");var h=new e(E,0,0,this.tokennumber);a.push(h),s=50}else if(this.isOp2())0==(4&s)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(a,n,N),o+=2,s=8;else if(this.isOp1())0==(4&s)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(a,n,L),o++,s=8;else if(this.isVar()){0==(1&s)&&this.error_parsing(this.pos,"unexpected variable");var c=new e(O,this.tokenindex,0,0);a.push(c),s=186}else this.isWhite()||(""===this.errormsg?this.error_parsing(this.pos,"unknown character"):this.error_parsing(this.pos,this.errormsg))}for((this.tmpprio<0||this.tmpprio>=10)&&this.error_parsing(this.pos,'unmatched "()"');n.length>0;){var u=n.pop();a.push(u)}return o+1!==a.length&&this.error_parsing(this.pos,"parity"),new i(a,t(this.ops1),t(this.ops2),t(this.functions))},evaluate:function(t,e){return this.parse(t).evaluate(e)},error_parsing:function(t,e){throw this.success=!1,this.errormsg="parse error [column "+t+"]: "+e,this.column=t,new Error(this.errormsg)},addfunc:function(t,i,r){for(var n=new e(r,this.tokenindex,this.tokenprio+this.tmpprio,0);i.length>0&&n.prio_<=i[i.length-1].prio_;)t.push(i.pop());i.push(n)},isNumber:function(){for(var t=!1,e="";this.pos<this.expression.length;){var i=this.expression.charCodeAt(this.pos);if(!(i>=48&&i<=57||46===i))break;e+=this.expression.charAt(this.pos),this.pos++,this.tokennumber=parseFloat(e),t=!0}return t},unescape:function(t,e){for(var i=[],r=!1,n=0;n<t.length;n++){var a=t.charAt(n);if(r){switch(a){case"'":i.push("'");break;case"\\":i.push("\\");break;case"/":i.push("/");break;case"b":i.push("\b");break;case"f":i.push("\f");break;case"n":i.push("\n");break;case"r":i.push("\r");break;case"t":i.push("\t");break;case"u":var s=parseInt(t.substring(n+1,n+5),16);i.push(String.fromCharCode(s)),n+=4;break;default:throw this.error_parsing(e+n,"Illegal escape sequence: '\\"+a+"'")}r=!1}else"\\"==a?r=!0:i.push(a)}return i.join("")},isString:function(){var t=!1,e="",i=this.pos;if(this.pos<this.expression.length&&"'"==this.expression.charAt(this.pos))for(this.pos++;this.pos<this.expression.length;){var r=this.expression.charAt(this.pos);if("'"==r&&"\\"!=e.slice(-1)){this.pos++,this.tokennumber=this.unescape(e,i),t=!0;break}e+=this.expression.charAt(this.pos),this.pos++}return t},isConst:function(){var t;for(var e in this.consts){var i=e.length;if(t=this.expression.substr(this.pos,i),e===t)return this.tokennumber=this.consts[e],this.pos+=i,!0}return!1},isOperator:function(){var t=this.expression.charCodeAt(this.pos);if(43===t)this.tokenprio=2,this.tokenindex="+";else if(45===t)this.tokenprio=2,this.tokenindex="-";else if(62===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex=">="):(this.tokenprio=1,this.tokenindex=">");else if(60===t)61===this.expression.charCodeAt(this.pos+1)?(this.pos++,this.tokenprio=1,this.tokenindex="<="):(this.tokenprio=1,this.tokenindex="<");else if(124===t){if(124!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="||"}else if(61===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="=="}else if(33===t){if(61!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=1,this.tokenindex="!="}else if(97===t){if(110!==this.expression.charCodeAt(this.pos+1)||100!==this.expression.charCodeAt(this.pos+2))return!1;this.pos++,this.pos++,this.tokenprio=0,this.tokenindex="and"}else if(111===t){if(114!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="or"}else if(42===t||8729===t||8226===t)this.tokenprio=3,this.tokenindex="*";else if(47===t)this.tokenprio=4,this.tokenindex="/";else if(37===t)this.tokenprio=4,this.tokenindex="%";else{if(94!==t)return!1;this.tokenprio=5,this.tokenindex="^"}return this.pos++,!0},isSign:function(){var t=this.expression.charCodeAt(this.pos-1);return 45===t||43===t},isPositiveSign:function(){return 43===this.expression.charCodeAt(this.pos-1)},isNegativeSign:function(){return 45===this.expression.charCodeAt(this.pos-1)},isLeftParenth:function(){return 40===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio+=10,!0)},isRightParenth:function(){return 41===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tmpprio-=10,!0)},isComma:function(){return 44===this.expression.charCodeAt(this.pos)&&(this.pos++,this.tokenprio=-1,this.tokenindex=",",!0)},isWhite:function(){var t=this.expression.charCodeAt(this.pos);return(32===t||9===t||10===t||13===t)&&(this.pos++,!0)},isOp1:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&t in this.ops1&&(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0)},isOp2:function(){for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&t in this.ops2&&(this.tokenindex=t,this.tokenprio=5,this.pos+=t.length,!0)},isVar:function(){
for(var t="",e=this.pos;e<this.expression.length;e++){var i=this.expression.charAt(e);if(i.toUpperCase()===i.toLowerCase()&&(e===this.pos||"_"!=i&&(i<"0"||i>"9")))break;t+=i}return t.length>0&&(this.tokenindex=t,this.tokenprio=4,this.pos+=t.length,!0)},isComment:function(){return 47===this.expression.charCodeAt(this.pos-1)&&42===this.expression.charCodeAt(this.pos)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)}},P};return e.formatEquation=function(t){for(var e="",i=[],r="",n=!1,a=1;a<t.length;a++){var s=t[a].toUpperCase();"["!=s||n?"]"==s&&n?(n=!1,""!==r&&(i.push(r),e+="["+r+"]"),r=""):n?r+=s:"+"==s||"-"==s||"*"==s||"/"==s||":"==s||"%"==s||"("==s||")"==s?(""!==r&&isNaN(r)?(i.push(r),e+="["+r+"]"):e+=r,":"==s&&(s="/"),e+=s,r=""):" "!=s&&(r+=s):n=!0}return""!==r&&isNaN(r)?(i.push(r),e+="["+r+"]"):e+=r,{equation:e,symbols:i}},e.fetchEquationChart=function(t,i){var r=e.formatEquation(t.symbol),n=r.symbols,a=[],s=t.stx;t.stx=null;for(var o=0;o<n.length;o++){var l=e.shallowClone(t);l.stx=s,l.symbol=n[o],a.push(l)}t.stx=s,s.quoteDriver.quoteFeed.multiFetch(a,function(n){var s={};t.loadMoreReplace=!0;for(var o={charge:0},l=0;l<n.length;l++){var h=n[l];if(h.dataCallback.error)return void i({error:h.dataCallback.error});s[h.params.symbol]=h.dataCallback.quotes,t.loadMoreReplace=t.loadMoreReplace&&h.params.loadMoreReplace,t.moreToLoad=t.moreToLoad||h.dataCallback.moreAvailable,h.dataCallback.attribution.charge&&(o.charge+=h.dataCallback.attribution.charge)}if(a.length||!t.loadMore&&!t.update)try{var c=e.computeEquationChart(r.equation,s);i({quotes:c,moreAvailable:t.moreToLoad,attribution:o})}catch(t){var u={error:"Invalid equation: "+r.equation};t.name&&"NoException"==t.name&&(u.suppressAlert=!0),i(u)}})},e.computeEquationChart=function(t,r){function n(t){if(t.i++,r[t.s]){if(t.i>=r[t.s].length)return 0;l=r[t.s][t.i]}return l.DT||(l.DT=e.strToDateTime(l.Date)),t.d=l.DT,1}t=t.replace(/[:]/,"/").toUpperCase();var a=0;for(var s in r){var o=new RegExp("\\["+s.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\$/g,"\\$").replace(/\^/g,"\\^").replace(/[+\-*\/%()]/g,"\\$&")+"\\]","g");t=t.replace(o,"symbol"+a),a++}var l,h=i().parse(t),c=[],u={},d=0,p=null,f=!1,m=[];for(s in r){var g={sym:s,map:r[s]};r[s]?m.unshift(g):m.push(g)}for(var v=0;v<m.length;v++){var y=m[v];u[y.sym]={i:0,s:y.sym},y.map?(d++,l=y.map[0]):1==d&&(f=y.sym),l.DT||(l.DT=e.strToDateTime(l.Date)),u[y.sym].d=l.DT,p||(p=u[y.sym])}var x=0===d,b=1==d&&-1==t.indexOf("%");t:for(;;){var C=function(){var t=null,e=null;for(var i in u)e?u[i].d.getTime()<e.d.getTime()?t=e=u[i]:u[i].d.getTime()>e.d.getTime()&&(t=e):e=u[i];return t?n(t)?-1:0:1}();if(!C)break;if(1==C){var S;if(f){var w=r[p.s][p.i][f];w&&(w.Close||0===w.Close)&&(w=w.Close);var M=h.evaluate({symbol0:r[p.s][p.i].Close,symbol1:w});M=Number(M.toFixed(8)),S={DT:p.d,Close:M,Adj_Close:M},S[p.s]=r[p.s][p.i].Close,isNaN(M)||M==1/0||c.push(S)}else{if(x){var T=h.evaluate({});throw e.alert(t+"="+T),{name:"NoException",message:""}}a=0;var B={Adj_Close:{},Close:{},Open:{},High:{},Low:{},Volume:{}};for(s in r){for(var k in B)B[k]["symbol"+a]=r[s][u[s].i][k];a++}S={DT:p.d},S.Adj_Close=h.evaluate(B.Adj_Close),S.Close=h.evaluate(B.Close),S.Open=h.evaluate(B.Open),S.Volume=h.evaluate(B.Volume),isNaN(S.Volume)&&(S.Volume=0),b?(S.High=h.evaluate(B.High),S.Low=h.evaluate(B.Low)):(S.High=Math.max(S.Open,S.Close),S.Low=Math.min(S.Open,S.Close)),isNaN(S.Close)||S.Close==1/0||c.push(S),isNaN(S.High)||(S.High=Number(S.High.toFixed(8))),isNaN(S.Low)||(S.Low=Number(S.Low.toFixed(8))),isNaN(S.Open)||(S.Open=Number(S.Open.toFixed(8))),isNaN(S.Close)||(S.Close=Number(S.Close.toFixed(8))),isNaN(S.Adj_Close)?S.Adj_Close=S.Close:S.Adj_Close=Number(S.Adj_Close.toFixed(8))}for(s in r)if(!n(u[s]))break t}}return c},t},__renderersAdvanced_=function(t){var e=t.CIQ;return e.Renderer.Shading=function(t){this.construct(t),this.beenSetup=!1,this.errTimeout=null,this.params.useChartLegend=!1,this.shading=[],"rangechannel"==this.params.type&&(this.highLowBars=!0)},e.Renderer.Shading.ciqInheritsFrom(e.Renderer.Lines,!1),e.Renderer.Shading.requestNew=function(t,i){for(var r=null,n=0;n<t.length;n++){"rangechannel"==t[n]&&(r="rangechannel")}return null===r?null:new e.Renderer.Shading({params:e.extend(i,{type:r})})},e.Renderer.Shading.prototype.setShading=function(t){t.constructor!=Array&&(t=[t]),this.shading=t},e.Renderer.Shading.prototype.draw=function(){function t(t){var e=h[t];if(e){var i=e.parameters.field,r=e.parameters.subField;return i+(r?"."+r:"")}return t}var i=this.stx,r=i.panels[this.params.panel].chart;if("rangechannel"==this.params.type)if(this.beenSetup)this.seriesParams.length>2&&this.removeSeries(this.seriesParams[2].id);else{this.beenSetup=!0,this.params.display=this.seriesParams[0].display,this.params.yAxis=this.seriesParams[0].yAxis;var n=this.seriesParams[0].color||"auto",a=this.seriesParams[0].symbol;a&&a+".",this.removeAllSeries(!0);var s=this.params.name;i.addSeries(null,{symbol:a,loadData:!!a,field:"High",renderer:"Shading",name:s,style:"stx_line_up",display:this.params.display}),i.addSeries(null,{symbol:a,loadData:!!a,field:"Low",renderer:"Shading",name:s,style:"stx_line_down",display:this.params.display}),this.setShading({primary:this.seriesParams[0].id,secondary:this.seriesParams[1].id,color:n})}if(!this.shading&&!this.errTimeout){console.log("Warning: no shading scheme set.  Use myRenderer.setShading(scheme) to set.");var o=this;this.errTimeout=setTimeout(function(){o.errTimeout=null},1e4)}var l,h={};for(l=0;l<this.seriesParams.length;l++){var c={};r.series[this.seriesParams[l].id]&&(c=e.clone(r.series[this.seriesParams[l].id].parameters)),h[this.seriesParams[l].id]={parameters:e.extend(e.extend(c,this.params),this.seriesParams[l]),yValueCache:this.caches[this.seriesParams[l].id]}}if(i.drawSeries(r,h,this.params.yAxis,this),r.legend&&"rangechannel"==this.params.type){r.legend.colorMap||(r.legend.colorMap={});var u=this.params.display,d=[i.getCanvasColor("stx_line_up"),i.getCanvasColor("stx_line_down")];r.legend.colorMap[u]={color:d,display:u,isBase:this==i.mainSeriesRenderer}}for(l in h)this.caches[l]=h[l].yValueCache;for(l=0;l<this.shading.length;l++){var p=this.shading[l],f=p.color;if("auto"==p.color&&(f=i.defaultColor),p.primary||(p.primary="Close"),p.secondary||(p.secondary=this.seriesParams[0].field),p.secondary&&f&&(h[p.primary]||"Close"==p.primary)&&h[p.secondary]&&("Close"!=p.primary||this.params.yAxis==r.yAxis)){var m=t(p.primary).split("."),g=t(p.secondary).split("."),v={topBand:m[0],topSubBand:m[1],topColor:p.greater||f,topAxis:this.params.yAxis,bottomBand:g[0],bottomSubBand:g[1],bottomColor:p.lesser||f,bottomAxis:"Close"==p.primary?null:this.params.yAxis,tension:this.params.tension||r.tension,opacity:.1};e.fillIntersecting(i,this.params.panel,v)}}},e.Renderer.Histogram=function(t){this.construct(t),this.params.type="histogram",this.params.highlightable=!1,this.barsHaveWidth=this.standaloneBars=!0},e.Renderer.Histogram.ciqInheritsFrom(e.Renderer,!1),e.Renderer.Histogram.prototype.performCalculations=function(t){if(this.params.yAxis){for(var e=this.stx.panels[this.params.panel],i=[],r=0;r<this.seriesParams.length;r++)i.push(this.seriesParams[r].field);var n=this.stx.determineMinMax(this.stx.chart.dataSegment,i,"stacked"==this.params.subtype,!0);t&&t.length&&(n[0]=Math.min(t[0],n[0]),n[1]=Math.max(t[1],n[1])),this.stx.calculateYAxisRange(e,this.params.yAxis,0,n[1]);var a=this.params.heightPercentage?this.params.heightPercentage:1;this.params.yAxis.high=n[1]/a,this.params.yAxis.min=0,this.params.bindToYAxis=!0}},e.Renderer.Histogram.prototype.draw=function(){this.stx.drawHistogram(e.clone(this.params),this.seriesParams)},e.Renderer.Heatmap=function(t){this.construct(t),this.params.type="heatmap",this.params.highlightable=!1,this.barsHaveWidth=this.standaloneBars=!0},e.Renderer.Heatmap.ciqInheritsFrom(e.Renderer,!1),e.Renderer.Heatmap.prototype.performCalculations=function(t){for(var e=this.stx.panels[this.params.panel],i=this.params.yAxis?this.params.yAxis:e.yAxis,r=[],n=0;n<this.seriesParams.length;n++)r.push(this.seriesParams[n].field);var a=this.stx.determineMinMax(this.stx.chart.dataSegment,r,!1,!0);t&&t.length&&(a[0]=Math.min(t[0],a[0]),a[1]=Math.max(t[1],a[1])),this.params.yAxis?this.stx.calculateYAxisRange(e,i,a[0],a[1]):this.params.panel==this.stx.chart.panel.name?(this.stx.chart.lowValue=Math.min(this.stx.chart.lowValue,a[0]),this.stx.chart.highValue=Math.max(this.stx.chart.highValue,a[1])):(this.stx.calculateYAxisRange(e,i,a[0],a[1]),e.lowValue=e.yAxis.low,e.highValue=e.yAxis.high)},e.Renderer.Heatmap.prototype.draw=function(){this.stx.drawHeatmap(e.clone(this.params),this.seriesParams)},e.Renderer.Scatter=function(t){this.construct(t),this.standaloneBars=this.barsHaveWidth=!0},e.Renderer.Scatter.ciqInheritsFrom(e.Renderer.Lines,!1),e.Renderer.Scatter.requestNew=function(t,i){for(var r=null,n=0;n<t.length;n++){"scatterplot"==t[n]&&(r="scatter")}return null===r?null:new e.Renderer.Scatter({params:e.extend(i,{type:r})})},e.Renderer.Scatter.prototype.drawIndividualSeries=function(t,e){panel=this.stx.panels[e.panel]||t.panel;var i={colors:[]};return this.stx.scatter?i=this.stx.scatter(panel,e):console.warn("Error, Scatter renderer requires customChart.js"),i},t},__share_=function(t){function e(t,e,i){e||(e={});var r=document.querySelector("body");if(e.hide&&e.hide instanceof Array)for(var s=e.hide.join(", "),o=document.querySelectorAll(s),l=0;l<o.length;l++)a.appendClassName(o[l],"ciq-no-share");a.appendClassName(r,"sharing"),n(t.chart.container,{allowTaint:!1,logging:!1,width:e.width?e.width:null,height:e.height?e.height:null,background:e.background?e.background:null,useCORS:!0}).then(function(t){if(i)return a.unappendClassName(r,"sharing"),e.data?i(null,t.toDataURL("image/png")):i(null,t)})}function i(t){if("undefined"!=typeof html2canvas)return n=html2canvas,t();if("undefined"!=typeof requirejs)try{return requirejs(["html2canvas"],function(e){return n=e,t()})}catch(t){console.warn("Require loading has failed, attempting to load html2canvas manually.")}a.loadScript(r()+"/html2canvas.js",function(){return n=html2canvas,t()})}function r(){if(a.Share.html2canvasLocation)return a.Share.html2canvasLocation;for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++){var i=t[e];if(i.src&&i.src.indexOf("share.js")>-1)return i.src.replace(/advanced\/share\.js/,"")+"thirdparty/"}return"js/thirdparty/"}var n,a=t.CIQ;return a.Share=function(){},t.STXSocial=a.Share,a.Share.FullChart2PNG=function(t,r,a){if(t&&t.chart){if("undefined"==typeof html2canvas)return i(function(){return e(t,r,a)});n=html2canvas,e(t,r,a)}},a.Share.createImage=function(t,e,i){var r=[].slice.call(arguments);i=r.pop(),null!==e&&"object"==typeof e||(e={widthPX:r[1],heightPX:r[2],imageType:r[3]});var n=e.widthPX,s=e.heightPX,o=e.imageType,l=t.chart.canvas.height,h=t.chart.canvas.width;t.chart.canvas.style.height&&(l=a.stripPX(t.chart.canvas.style.height),h=a.stripPX(t.chart.canvas.style.width)),n&&s?(l=s,h=n):s?h=t.chart.canvas.width*(l/t.chart.canvas.height):n&&(h=n,l=t.chart.canvas.height*(n/t.chart.canvas.width));var c=o?"image/"+o:"image/png",u=document.createElement("img");u.onload=function(){a.Share.FullChart2PNG(t,{image:this,width:h,height:l,hide:e.hide},function(t,e){try{i(e.toDataURL(c))}catch(t){console.warn("Safari devices do not handle CORS enabled images. Using the charts' canvas as a fallback."),i(u.src)}})},u.src=t.chart.canvas.toDataURL(c)},a.Share.uploadImage=function(t,e,i,r){i||(i={}),i.image=t,a.postAjax(e,JSON.stringify(i),function(t,e){if(200!=t)return void r(t,null);r(null,e)})||r(0,null)},a.Share.shareChart=function(t,e,i){a.Share.createImage(t,{},function(r){var n=a.uniqueID(),s="https://share.chartiq.com",o=s+"/upload/"+n;e&&(e.host&&(s=e.host),e.path&&(o=s+e.path+"/"+n));var l=t.getStartDateOffset(),h={layout:t.exportLayout(),drawings:t.exportDrawings(),xOffset:l,startDate:t.chart.dataSegment[l].Date,endDate:t.chart.dataSegment[t.chart.dataSegment.length-1].Date,id:n,symbol:t.chart.symbol},c={id:n,image:r,config:h};a.Share.uploadImage(r,o,c,function(t,e){null!==t?a.alert("error sharing chart: ",t):i(s+e)})})},t},__studiesAdvanced_=function(t){var e=t.CIQ;return e.Studies.calculateValuationLines=function(t,e,i){for(var r="field"==e.inputs.Field?"Close":e.inputs.Field,n=e.inputs["Average Type"],a=e.inputs["Display Average"],s=e.inputs["Display 1 Standard Deviation (1σ)"],o=e.inputs["Display 2 Standard Deviation (2σ)"],l=e.inputs["Display 3 Standard Deviation (3σ)"],h=[],c=0;c<i.length;++c)i[c]&&h.push(i[c][r]);var u=function(t,e){var i=t.length,r=0,n=0,a=0;switch(e){case"mean":for(n=i;a<i;++a)r+=t[a];break;case"harmonic":for(r=i;a<i;++a)n+=1/t[a];break;case"median":var s=Math.floor(i/2),o=t.slice().sort(function(t,e){return t>e?1:t<e?-1:0});i%1==0?(r=o[s]+o[s-1],n=2):(r=o[s],n=1)}return r/n}(h,n),d=!(s||o||l)||function(t,e){for(var i=t.length,r=0,n=0;n<i;++n)r+=Math.pow(t[n]-e,2);return Math.sqrt(r/i)}(h,u);e.data={Average:a?[u]:null,"1 Standard Deviation (1σ)":s?[u+d,u-d]:null,"2 Standard Deviation (2σ)":o?[u+2*d,u-2*d]:null,"3 Standard Deviation (3σ)":l?[u+3*d,u-3*d]:null}},e.Studies.displayValuationLines=function(t,i){var r,n,a,s,o,l,h,c,u,d=t.panels[i.panel],p=i.chart.context,f=i.data,m=i.parameters.labels,g=i.inputs["Average Type"],v={mean:"AVG",median:"MED",harmonic:"HAVG"},y=t.canvasStyle("ciq-valuation-average-line"),x=t.canvasStyle("ciq-valuation-deviation-line"),b=t.getCanvasFontSize("stx_yaxis")+6;for(var C in f)if(f[C])for(r="Average"==C,n=e.Studies.determineColor(i.outputs[C]),a=f[C],s=0;s<a.length;++s)o=a[s],(l=t.pixelFromTransformedValue(o,d))<=d.top||l>=d.yAxis.bottom||(u=r?{pattern:"none"!=y.borderStyle?y.borderStyle||"solid":"solid",lineWidth:parseFloat(y.borderWidth)||1,opacity:parseFloat(y.opacity)||1}:{pattern:"none"!=x.borderStyle?x.borderStyle||"dashed":"dashed",lineWidth:parseFloat(x.borderWidth)||1,opacity:parseFloat(x.opacity)||1},t.plotLine(d.left,d.right,l,l,n,"line",p,d,u),"yaxis"!==m?(l+=Math.floor(u.lineWidth/2))+b>=d.yAxis.bottom||(h=(r?v[g]+": ":C[0]+"σ: ")+t.formatYAxisPrice(o,d),c=p.measureText(h).width,p.strokeText(h,d.right-c-3,l+b/2+.5)):t.createYAxisLabel(d,t.formatYAxisPrice(o,d),l,n,null,p))},e.Studies.calculateCorrelationCoefficient=function(t,e){var i=e.chart.scrubbed,r=e.days;if(i.length<r+1)return void(e.error=!0);if(e.compare=e.inputs["Compare To"],!e.compare){e.compare=[],e.outputs={},e.outputMap={};for(var n in t.chart.series){var a=t.chart.series[n];a.parameters.color&&(e.compare.push(a.display),e.outputs["Result "+a.display]=a.parameters.color,e.outputMap["Result "+a.display+" "+e.name]="Result "+a.display)}}if(!e.compare.length)return void(e.error="Correlation Coefficient requires at least one comparison symbol");for(var s=0;s<e.compare.length;s++)for(var o=0,l=0,h=0,c=0,u=0,d=e.compare[s],p=0,f=e.startFrom-r;f<i.length;f++)if(i[f]){var m=i[f][d];if(m&&"object"==typeof m&&(m=m.Close),m||0===m||(m=f>0&&i[f-1]&&i[f-1]["_temps "+e.name].c?i[f-1]["_temps "+e.name].c:0),m&&"object"==typeof m&&(m=m.Close),i[f]["_temps "+e.name]={},o+=i[f]["_temps "+e.name].b=i[f].Close,l+=i[f]["_temps "+e.name].c=m,h+=i[f]["_temps "+e.name].b2=Math.pow(i[f].Close,2),c+=i[f]["_temps "+e.name].c2=Math.pow(m,2),u+=i[f]["_temps "+e.name].bc=i[f].Close*m,p>=r){o-=i[f-r]["_temps "+e.name].b,l-=i[f-r]["_temps "+e.name].c,h-=i[f-r]["_temps "+e.name].b2,c-=i[f-r]["_temps "+e.name].c2,u-=i[f-r]["_temps "+e.name].bc;var g=h/r-Math.pow(o/r,2),v=c/r-Math.pow(l/r,2),y=u/r-o*l/Math.pow(r,2),x=y/Math.sqrt(g*v);i[f]["Result "+d+" "+e.name]=x}p++}},e.Studies.prettify=e.extend({"2-exponential":"dema","3-exponential":"tema",hull:"hma"},e.Studies.prettify),e.extend(e.Studies.movingAverage,{conversions:{hma:"hull",dema:"2-exponential",tema:"3-exponential"},translations:{hull:"Hull","2-exponential":"Double Exponential","3-exponential":"Triple Exponential"},typeMap:{hma:"Hull",hull:"Hull",dema:"DoubleExponential","2-exponential":"DoubleExponential",tema:"TripleExponential","3-exponential":"TripleExponential"}}),e.Studies.calculateMovingAverageHull=function(t,i){var r=i.chart.scrubbed,n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA("wma",i.days,n,0,"_WMA1",t,i),e.Studies.MA("wma",Math.ceil(i.days/2),n,0,"_WMA2",t,i);var a,s;for(a=i.startFrom-1;a>=0&&(!(s=r[a][n])&&0!==s);a--);for(a++;a<r.length;a++){var o=r[a];o["_MMA "+i.name]=2*o["_WMA2 "+i.name]-o["_WMA1 "+i.name]}var l=parseInt(i.inputs.Offset,10);isNaN(l)&&(l=0);var h=Math.floor(Math.sqrt(i.days));e.Studies.MA("wma",h,"_MMA "+i.name,l,"_HMA",t,i);var c=i.name;for(var u in i.outputs)c=u+" "+c;for(a=Math.max(i.days+h-1,i.startFrom);a<r.length;a++)r[a][c]=r[a]["_HMA "+i.name]},e.Studies.calculateMovingAverageDoubleExponential=function(t,i){var r=i.chart.scrubbed,n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA("ema",i.days,n,0,"_EMA1",t,i),e.Studies.MA("ema",i.days,"_EMA1 "+i.name,0,"_EMA2",t,i);var a=parseInt(i.inputs.Offset,10);isNaN(a)&&(a=0);var s,o,l=a;for(s=i.startFrom-1;s>=0;s--)if((o=r[s][n])||0===o){if(!(l>0))break;l--}var h=i.name;for(var c in i.outputs)h=c+" "+h;for(s++;s<r.length;s++)if(!(s<2*(i.days-1))){var u=r[s];r[s+a]&&(r[s+a][h]=2*u["_EMA1 "+i.name]-u["_EMA2 "+i.name])}},e.Studies.calculateMovingAverageTripleExponential=function(t,i){var r=i.chart.scrubbed,n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA("ema",i.days,n,0,"_EMA1",t,i),e.Studies.MA("ema",i.days,"_EMA1 "+i.name,0,"_EMA2",t,i),e.Studies.MA("ema",i.days,"_EMA2 "+i.name,0,"_EMA3",t,i);var a=parseInt(i.inputs.Offset,10);isNaN(a)&&(a=0);var s,o,l=a;for(s=i.startFrom-1;s>=0;s--)if((o=r[s][n])||0===o){if(!(l>0))break;l--}var h=i.name;for(var c in i.outputs)h=c+" "+h;for(s++;s<r.length;s++)if(!(s<3*(i.days-1))){var u=r[s];r[s+a]&&(r[s+a][h]=3*u["_EMA1 "+i.name]-3*u["_EMA2 "+i.name]+u["_EMA3 "+i.name])}},e.Studies.calculateATRBands=function(t,i){e.Studies.calculateStudyATR(t,i);var r=i.inputs.Field;r&&"field"!=r||(r="Close"),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Shift,r,"ATR "+i.name)},e.Studies.calculateSTARCBands=function(t,i){e.Studies.calculateStudyATR(t,i),e.Studies.MA("simple",i.inputs["MA Period"],"Close",0,"_MA",t,i),e.Studies.calculateGenericEnvelope(t,i,i.inputs.Multiplier,"_MA "+i.name,"ATR "+i.name)},e.Studies.calculateATRStops=function(t,i){var r=i.chart.scrubbed;if(r){e.Studies.calculateStudyATR(t,i);for(var n=i.inputs.HighLow,a=Math.max(i.startFrom-1,1);a<r.length-1;a++){var s=r[a],o=r[a-1],l=s["Buy Stops "+i.name];if(l||(l=s["Sell Stops "+i.name]),l||(l=0),s&&o){var h=s.Close,c=h,u=s["ATR "+i.name]*i.inputs.Multiplier;s.Close>l&&o.Close>l?(n&&(h=s.High),c=Math.max(l,h-u)):s.Close<=l&&o.Close<=l?(n&&(h=s.Low),c=Math.min(l,h+u)):s.Close>l?(n&&(h=s.High),c=h-u):s.Close<=l&&(n&&(h=s.Low),c=h+u),h<=c?(r[a+1]["Buy Stops "+i.name]=c,delete r[a+1]["Sell Stops "+i.name]):h>c&&(r[a+1]["Sell Stops "+i.name]=c,delete r[a+1]["Buy Stops "+i.name]),r[a+1]["All Stops "+i.name]=c,i.referenceOutput="All Stops"}}}},e.Studies.calculateAwesomeOscillator=function(t,i){var r=i.chart.scrubbed;if(r.length<33)return void(i.error=!0);e.Studies.MA("simple",5,"hl/2",0,"_MA5",t,i),e.Studies.MA("simple",34,"hl/2",0,"_MA34",t,i);for(var n=Math.max(i.startFrom,33);n<r.length;n++)r[n]&&(r[n][i.name+"_hist"]=r[n]["_MA5 "+i.name]-r[n]["_MA34 "+i.name])},e.Studies.calculateRelativeVolatility=function(t,i){i.days=Number(i.inputs["Smoothing Period"]);var r=Number(i.inputs["STD Period"]),n=i.chart.scrubbed;if(n.length<i.days+r)return void(i.error=!0);var a=i.inputs.Field;a&&"field"!=a||(a="Close"),i.std=new e.Studies.StudyDescriptor(i.name,"sdev",i.panel),i.std.chart=i.chart,i.std.days=r,i.std.startFrom=i.startFrom,i.std.inputs={Field:a,"Standard Deviations":1,Type:"ma"},i.std.outputs={STD:null},e.Studies.calculateStandardDeviation(t,i.std);var s=0,o=0;i.startFrom>1&&(s=n[i.startFrom-1]["_avgG "+i.name],o=n[i.startFrom-1]["_avgL "+i.name]);for(var l=Math.max(i.startFrom,i.days);l<n.length;l++){var h=n[l];h[a]>n[l-1][a]?(s=(s*(i.days-1)+h["STD "+i.name])/i.days,o=o*(i.days-1)/i.days):(o=(o*(i.days-1)+h["STD "+i.name])/i.days,s=s*(i.days-1)/i.days),h["Rel Vol "+i.name]=function(t,e){return t+e===0?100:100*t/(t+e)}(s,o),h["_avgG "+i.name]=s,h["_avgL "+i.name]=o}i.zoneOutput="Rel Vol"},e.Studies.calculatePMO=function(t,i){var r={Smooth:Number(i.inputs["Smoothing Period"])-1,Double:Number(i.inputs["Double Smoothing Period"])-1,Signal:Number(i.inputs["Signal Period"])},n=i.chart.scrubbed;if(n.length<r.Smooth+r.Double)return void(i.error=!0);var a=i.inputs.Field;a&&"field"!=a||(a="Close");var s;for(s=i.startFrom;s<n.length;s++)if(n[s]&&n[s-1]){var o=n[s-1][a];o&&(n[s]["_ROCx10 "+i.name]=1e3*(n[s][a]/o-1))}e.Studies.MA("exponential",r.Smooth,"_ROCx10 "+i.name,0,"_EMAx10",t,i),e.Studies.MA("exponential",r.Double,"_EMAx10 "+i.name,0,"PMO",t,i),e.Studies.MA("exponential",r.Signal,"PMO "+i.name,0,"PMOSignal",t,i),i.zoneOutput="PMO"},e.Studies.calculateElderImpulse=function(t,i){var r=i.chart.scrubbed,n=i.outputs.Bullish,a=i.outputs.Bearish,s=i.outputs.Neutral;e.Studies.MA("exponential",13,"Close",0,"_MA",t,i),i.macd=new e.Studies.StudyDescriptor("_"+i.name,"macd",i.panel),i.macd.chart=i.chart,i.macd.days=i.days,i.macd.startFrom=i.startFrom,i.macd.inputs={"Fast MA Period":12,"Slow MA Period":26,"Signal Period":9},i.macd.outputs={_MACD:null,_Signal:null},e.Studies.calculateMACD(t,i.macd);for(var o,l=i.startFrom;l<r.length;l++)o=0===l?s:r[l]["_MA "+i.name]>r[l-1]["_MA "+i.name]&&r[l]["_"+i.name+"_hist"]>r[l-1]["_"+i.name+"_hist"]?n:r[l]["_MA "+i.name]<r[l-1]["_MA "+i.name]&&r[l]["_"+i.name+"_hist"]<r[l-1]["_"+i.name+"_hist"]?a:s,r[l]["Result "+i.name]=o},e.Studies.calculatePivotPoints=function(t,i){function r(){c.pivotPoint=(c.high+c.low+n[u-1].Close)/3,c.prevHigh=c.high,c.prevLow=c.low,c.hlSpread=c.high-c.low,c.high=c.low=0}var n=i.chart.scrubbed,a="day";if("day"==t.layout.interval)a="month";else if(e.ChartEngine.isDailyInterval(t.layout.interval))a="year";else if("second"==t.layout.interval||"millisecond"==t.layout.interval||"second"==t.layout.timeUnit||"millisecond"==t.layout.timeUnit)a="15min";else{var s=t.layout.periodicity;"minute"!=t.layout.interval&&(s*=t.layout.interval),s>=30&&(a="week")}var o=e.Market.Symbology.isForexSymbol(t.chart.symbol),l=e.Market.Symbology.isForexMetal(t.chart.symbol),h=null,c={pivotPoint:NaN,high:0,low:0,prevHigh:0,prevLow:0,hlSpread:0};i.startFrom>1&&(c=e.clone(n[i.startFrom-1]["_pointers "+i.name]));for(var u=Math.max(1,i.startFrom);u<n.length;u++)if(n[u-1]){if(c.high=Math.max(c.high,n[u-1].High),c.low=Math.min(c.low>0?c.low:n[u-1].Low,n[u-1].Low),i.inputs.Continuous)r();else if("year"==a&&n[u].DT.getYear()!=n[u-1].DT.getYear())r();else if("month"==a&&n[u].DT.getMonth()!=n[u-1].DT.getMonth())r();else if("week"==a&&n[u].DT.getDay()<n[u-1].DT.getDay())r();else if("day"==a){null===h&&(h=function(i){var r="America/New_York";if(!o)if(t.chart.market)r=t.chart.market.market_tz;else{var n=e.Market.Symbology.isForeignSymbol(t.chart.symbol)&&t.chart.symbol.split(".").pop();r=e&&e.realTimeDataSource?(new e.QuoteFeed[e.realTimeDataSource]).exchangeZones[n]:e.QuoteFeed.Xignite.Utility.timeZone[n]}var a=new Date(i.getTime()+6e4*i.getTimezoneOffset());return r&&-1!=r.indexOf("UTC")||(a=e.convertTimeZone(a,"UTC",r)),new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()).getTime()-i.getTime()}(n[u].DT),o&&(h+=l?216e5:252e5));var d=new Date(new Date(+n[u].DT).setMilliseconds(n[u].DT.getMilliseconds()+h)),p=new Date(new Date(+n[u-1].DT).setMilliseconds(n[u-1].DT.getMilliseconds()+h));p.getDate()!=d.getDate()&&0!==d.getDay()&&6!=d.getDay()&&(h=null,r())}else"15min"!=a||n[u].DT.getHours()==n[u-1].DT.getHours()&&Math.floor(n[u].DT.getMinutes()/15)==Math.floor(n[u-1].DT.getMinutes()/15)||r();n[u]["Pivot "+i.name]=c.pivotPoint,"fibonacci"==i.inputs.Type.toLowerCase()?(n[u]["Resistance 1 "+i.name]=c.pivotPoint+.382*c.hlSpread,n[u]["Resistance 2 "+i.name]=c.pivotPoint+.618*c.hlSpread,n[u]["Resistance 3 "+i.name]=c.pivotPoint+c.hlSpread,n[u]["Support 1 "+i.name]=c.pivotPoint-.382*c.hlSpread,n[u]["Support 2 "+i.name]=c.pivotPoint-.618*c.hlSpread,n[u]["Support 3 "+i.name]=c.pivotPoint-c.hlSpread):(n[u]["Resistance 1 "+i.name]=2*c.pivotPoint-c.prevLow,n[u]["Resistance 2 "+i.name]=c.pivotPoint+c.hlSpread,n[u]["Resistance 3 "+i.name]=c.pivotPoint+2*c.hlSpread,n[u]["Support 1 "+i.name]=2*c.pivotPoint-c.prevHigh,n[u]["Support 2 "+i.name]=c.pivotPoint-c.hlSpread,n[u]["Support 3 "+i.name]=c.pivotPoint-2*c.hlSpread),n[u]["_pointers "+i.name]=e.clone(c)}},e.Studies.calculateVWAP=function(t,i){var r=i.chart.scrubbed;if(e.ChartEngine.isDailyInterval(t.layout.interval))return void(i.error="VWAP is Intraday Only");var n=e.Market.Symbology.isForexSymbol(t.chart.symbol),a=e.Market.Symbology.isForexMetal(t.chart.symbol),s=null,o=0,l=0,h=!1;i.startFrom>1&&(o=r[i.startFrom-1]["_V "+i.name],l=r[i.startFrom-1]["_VxP "+i.name]);for(var c=i.startFrom;c<r.length;c++){if(null===s&&(s=function(i){var r="America/New_York";if(!n)if(t.chart.market)r=t.chart.market.market_tz;else{var a=e.Market.Symbology.isForeignSymbol(t.chart.symbol)&&t.chart.symbol.split(".").pop();r=e&&e.realTimeDataSource?(new e.QuoteFeed[e.realTimeDataSource]).exchangeZones[a]:e.QuoteFeed.Xignite.Utility.timeZone[a]}var s=new Date(i.getTime()+6e4*i.getTimezoneOffset());return r&&-1!=r.indexOf("UTC")||(s=e.convertTimeZone(s,"UTC",r)),new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()).getTime()-i.getTime()}(r[c].DT),n&&(s+=a?216e5:252e5)),r[c-1]&&r[c-1].DT){var u=new Date(new Date(+r[c].DT).setMilliseconds(r[c].DT.getMilliseconds()+s));new Date(new Date(+r[c-1].DT).setMilliseconds(r[c-1].DT.getMilliseconds()+s)).getDate()!=u.getDate()&&0!==u.getDay()&&6!=u.getDay()&&(s=null,o=l=0)}var d=r[c]["hlc/3"];o+=r[c].Volume,l+=r[c].Volume*d,o&&(r[c]["VWAP "+i.name]=l/o,r[c]["_V "+i.name]=o,r[c]["_VxP "+i.name]=l,h=!0)}h||(i.error="VWAP Requires Volume")},e.Studies.calculateMFI=function(t,e){var i,r=e.chart.scrubbed,n=0,a=e.inputs["Scale Factor"];a||(a=e.study.inputs["Scale Factor"]);var s=Math.pow(10,Number(a));e.startFrom>1&&(n=r[e.startFrom-1]["_high "+e.name]);var o;for(o=e.startFrom;o<r.length;o++)r[o]&&r[o].Volume&&(r[o][e.name+"_hist"]=i=s*(r[o].High-r[o].Low)/r[o].Volume,r[o]["_high "+e.name]=n=Math.max(n,i))},e.Studies.calculateAlligator=function(t,i){var r={J:Number(i.inputs["Jaw Period"]),T:Number(i.inputs["Teeth Period"]),L:Number(i.inputs["Lips Period"])},n=i.chart.scrubbed;if(n.length<Math.max(r.J,r.T,r.L)+1)return void(i.error=!0);e.Studies.MA("welles wilder",r.J,"hl/2",i.inputs["Jaw Offset"],"Jaw",t,i),e.Studies.MA("welles wilder",r.T,"hl/2",i.inputs["Teeth Offset"],"Teeth",t,i),e.Studies.MA("welles wilder",r.L,"hl/2",i.inputs["Lips Offset"],"Lips",t,i);for(var a=i.startFrom;a<n.length;a++)if(n[a]&&("Gator"==i.type&&(n[a][i.name+"_hist1"]=Math.abs(n[a]["Jaw "+i.name]-n[a]["Teeth "+i.name]),n[a][i.name+"_hist2"]=-Math.abs(n[a]["Teeth "+i.name]-n[a]["Lips "+i.name])),i.inputs["Show Fractals"])){if(!(n[a-2]&&n[a-1]&&n[a]&&n[a+1]&&n[a+2]))continue;n[a-2].High&&n[a-1].High&&n[a].High&&n[a+1].High&&n[a+2].High&&n[a].High>n[a-1].High&&n[a].High>n[a-2].High&&n[a].High>n[a+1].High&&n[a].High>n[a+2].High&&(n[a]["Fractal High "+i.name]=1),n[a-2].Low&&n[a-1].Low&&n[a].Low&&n[a+1].Low&&n[a+2].Low&&n[a].Low<n[a-1].Low&&n[a].Low<n[a-2].Low&&n[a].Low<n[a+1].Low&&n[a].Low<n[a+2].Low&&(n[a]["Fractal Low "+i.name]=1)}},e.Studies.calculateRelativeVigor=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n;for(n=i.startFrom;n<r.length;n++)r[n]["_Change "+i.name]=r[n].Close-r[n].Open,r[n]["_Range "+i.name]=r[n].High-r[n].Low;e.Studies.MA("triangular",4,"_Change "+i.name,0,"_Numer",t,i),e.Studies.MA("triangular",4,"_Range "+i.name,0,"_Denom",t,i);var a=[],s=[];for(n=Math.max(i.startFrom-i.days,0);n<r.length;n++){a.push(r[n]["_Numer "+i.name]),s.push(r[n]["_Denom "+i.name]),a.length>i.days&&(a.shift(),s.shift());var o,l=0,h=0;for(o=0;o<a.length;o++)l+=a[o];for(o=0;o<s.length;o++)h+=s[o];0===h&&(h=1e-8),n<i.startFrom||(r[n]["Rel Vig "+i.name]=l/h)}for(e.Studies.MA("triangular",4,"Rel Vig "+i.name,0,"RelVigSignal",t,i),n=i.startFrom;n<r.length;n++)r[n][i.name+"_hist"]=r[n]["Rel Vig "+i.name]-r[n]["RelVigSignal "+i.name]},e.Studies.calculateUlcerIndex=function(t,i){var r=i.chart.scrubbed;if(r.length<2*i.days-1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close");var a;for(a=Math.max(i.startFrom,i.days-1);a<r.length;a++)r[a]["_PD2 "+i.name]=Math.pow(100*(r[a][n]/function(t,e,i){for(var n=null,a=e-t+1;a<=e;a++)a<0||(n=null===n?r[a][i]:Math.max(n,r[a][i]));return n}(i.days,a,n)-1),2);for(e.Studies.MA("simple",i.days,"_PD2 "+i.name,0,"_MA",t,i),a=Math.max(i.startFrom,2*(i.days-1));a<r.length;a++)r[a]["Result "+i.name]=Math.sqrt(r[a]["_MA "+i.name])},e.Studies.calculateChoppiness=function(t,i){e.Studies.calculateStudyATR(t,i);var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);for(var n=Math.max(i.startFrom,i.days);n<r.length;n++)if(r[n]){var a=function(t,e){for(var i=-1*Number.MAX_VALUE,n=Number.MAX_VALUE,a=e-t+1;a<=e;a++)a<0||(i=Math.max(i,r[a].High),n=Math.min(n,r[a].Low));return[n,i]}(i.days,n);r[n]["Sum True Range "+i.name]?r[n]["Result "+i.name]=100*Math.log(r[n]["Sum True Range "+i.name]/Math.max(1e-6,a[1]-a[0]))/Math.log(i.days):r[n]["Result "+i.name]=0}},e.Studies.calculateDisparity=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA(i.inputs["Moving Average Type"],i.days,n,0,"_MA",t,i);for(var a=Math.max(i.startFrom,i.days-1);a<r.length;a++)r[a]&&(r[a]["Result "+i.name]=100*(r[a][n]/r[a]["_MA "+i.name]-1))},e.Studies.calculateRainbow=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close");for(var a=n,s=1;s<=10;s++)e.Studies.MA("simple",i.days,a,0,"SMA"+s,t,i),a="SMA"+s+" "+i.name;for(var o=Math.max(i.startFrom,10);o<r.length;o++)if(r[o]){var l=0,h=-1*Number.MAX_VALUE,c=Number.MAX_VALUE;for(s=1;s<=10;s++){var u=r[o]["SMA"+s+" "+i.name];l+=u,h=Math.max(h,u),c=Math.min(c,u)}if(i.name.indexOf("Osc")>-1){var d=function(t,e){for(var i=-1*Number.MAX_VALUE,n=Number.MAX_VALUE,a=e-t+1;a<=e;a++)a<0||(i=Math.max(i,r[a].Close),n=Math.min(n,r[a].Close));return[n,i]}(i.inputs["HHV/LLV Lookback"],o);r[o][i.name+"_hist"]=100*(r[o][n]-l/10)/Math.max(1e-6,d[1]-d[0]),r[o]["Over "+i.name]=100*(h-c)/Math.max(1e-6,d[1]-d[0]),r[o]["Under "+i.name]=-r[o]["Over "+i.name],r[o]["Zero "+i.name]=0}}},e.Studies.calculateKST=function(t,i){var r=i.chart.scrubbed,n=i.inputs.Field;n&&"field"!=n||(n="Close");var a={},s={};a[1]=Number(i.inputs["Lightest Rate of Change Period"]),a[2]=Number(i.inputs["Light Rate of Change Period"]),a[3]=Number(i.inputs["Heavy Rate of Change Period"]),a[4]=Number(i.inputs["Heaviest Rate of Change Period"]),s[1]=Number(i.inputs["Lightest SMA Period"]),s[2]=Number(i.inputs["Light SMA Period"]),s[3]=Number(i.inputs["Heavy SMA Period"]),s[4]=Number(i.inputs["Heaviest SMA Period"]);var o,l,h=Number(i.inputs["Signal Period"]);for(o=i.startFrom;o<r.length;o++)if(r[o])for(l=1;l<=4;l++)o>=a[l]&&r[o-a[l]]&&r[o-a[l]][n]&&(r[o]["_ROC"+l+" "+i.name]=100*(r[o][n]/r[o-a[l]][n]-1));for(l=1;l<=4;l++)e.Studies.MA("simple",s[l],"_ROC"+l+" "+i.name,0,"_SMA"+l,t,i);for(o=i.startFrom;o<r.length;o++)for(r[o]["KST "+i.name]=0,l=1;l<=4;l++)r[o]["KST "+i.name]+=l*r[o]["_SMA"+l+" "+i.name];e.Studies.MA("simple",h,"KST "+i.name,0,"KSTSignal",t,i)},e.Studies.calculateSpecialK=function(t,i){var r=i.chart.scrubbed,n=i.inputs.Field;n&&"field"!=n||(n="Close");var a=i.inputs.Interval;a||(a="daily");var s,o,l={daily:[10,15,20,30,50,65,75,100,195,265,390,530],weekly:[4,5,6,8,10,13,15,20,39,52,78,104]},h={daily:[10,10,10,15,50,65,75,100,130,130,130,195],weekly:[4,5,6,8,10,13,15,20,26,26,26,39]}
;for(s=i.startFrom;s<r.length;s++)if(r[s])for(o=0;o<l[a].length;o++)s>=l[a][o]&&r[s-l[a][o]]&&r[s-l[a][o]][n]&&(r[s]["_ROC"+o+" "+i.name]=100*(r[s][n]/r[s-l[a][o]][n]-1));for(o=0;o<h[a].length;o++)e.Studies.MA("daily"==a?"simple":"exponential",h[a][o],"_ROC"+o+" "+i.name,0,"_MA"+o,t,i);for(s=i.startFrom;s<r.length;s++)for(r[s]["Result "+i.name]=0,o=0;o<h[a].length;o++)r[s]["Result "+i.name]+=(o%4+1)*r[s]["_MA"+o+" "+i.name]},e.Studies.calculateDarvas=function(t,i){var r=i.chart.scrubbed,n=0,a=parseInt(i.inputs["ATH Lookback Period"],10);i.inputs["Volume Spike"]&&e.Studies.MA("simple",a,"Volume",0,"ADV",t,i);var s,o=parseFloat(i.inputs["Volume % of Avg"])/100,l="none",h={},c=null,u=null,d=null,p=parseFloat(i.inputs["Level Offset"]),f={};for(["Darvas","Ghost","Profit","Loss","ATH","ADV","Spike"].forEach(function(t){f[t]=t+" "+i.name}),s=i.startFrom-1;s>0;s--){var m=r[s];if(!m[f.Darvas]&&!m[f.Ghost]){n=m[f.ATH]||0,u=m[f.Profit],d=m[f.Loss];break}for(var g in f)m[g]=null}for(s;s<r.length;s++){var v=r[s];if(v){if(parseFloat(i.inputs["Price Minimum"])<=r[n].Close){if(!c||c.End&&s!=c.End+1||(r[s-1].Close>h.High?h={State:1,High:2*h.High-h.Low,Low:h.High,Start:s,End:2*h.End-h.Start+1}:c=null,c&&(v[f.Ghost]=e.clone(h),h.State=0,r[h.End]&&(r[h.End][f.Ghost]=e.clone(h)),c={Start:h.Start,End:h.End},u=h.High+p,(!d||d<h.Low-p)&&(d=h.Low-p))),v[f.Profit]=u,v[f.Loss]=d,v.Close>=u?u=null:"high/low"==i.inputs["Exit Field"]&&v.High>=u&&(u=null),"none"==l&&s==n+3&&!r[n+2][f.Darvas]&&!r[n+1][f.Darvas]&&!r[n][f.Darvas]&&r[n].High>v.High&&(l="high"),"high"==l&&(v.High>r[n].High?l="none":r[s-3].Low<r[s-2].Low&&r[s-3].Low<r[s-1].Low&&r[s-3].Low<v.Low&&(h={State:1,High:r[n].High,Low:r[s-3].Low,Start:n},r[n][f.Darvas]=e.clone(h),l="darvas",c&&(c.End>s&&r[c.Start]&&(v[f.Ghost]=e.clone(r[c.Start][f.Ghost]),v[f.Ghost].End=s,r[c.End]&&delete r[c.End][f.Ghost]),v[f.Ghost].State=0,r[c.Start][f.Ghost].End=s,c=null),u=h.High+p,(!d||d<h.Low-p)&&(d=h.Low-p))),"darvas"==l&&(v.Close>h.High?c={}:"high/low"==i.inputs["Exit Field"]&&v.High>h.High?c={}:v.Close<h.Low?l="none":"high/low"==i.inputs["Exit Field"]&&v.Low<h.Low&&(l="none"),c?l="none":"none"==l&&(u=null,d=null),i.inputs["Ghost Boxes"]||(c=null),"none"==l)){for(var y=h.Start+1;y<s;y++)r[y][f.Darvas]=e.clone(h);h.State=0,h.End=s,v[f.Darvas]=e.clone(h),v[f.ATH]=n;continue}d&&(v.Close<h.Low||"high/low"==i.inputs["Exit Field"]&&v.Low<h.Low)&&("darvas"==l&&(l="none"),(v.Close<d||"high/low"==i.inputs["Exit Field"]&&v.Low<d)&&(u=null,d=null),c&&(c.End>s&&r[c.Start]&&(v[f.Ghost]=e.clone(r[c.Start][f.Ghost]),v[f.Ghost].End=s,r[c.End]&&delete r[c.End][f.Ghost]),v[f.Ghost].State=0,r[c.Start][f.Ghost].End=s,c=null))}if(v.High>=r[n].High&&(n=s),(s<3||v.High>=r[s-1].High&&v.High>=r[s-2].High&&v.High>=r[s-3].High)&&s-n>=a){n=s;for(var x=0;x<a&&!(s-x<0);x++)r[s-x].High>r[n].High&&(n=s-x)}i.inputs["Volume Spike"]&&s>a&&s==n&&v[f.ADV]*o<v.Volume&&(v[f.Spike]=1),v[f.ATH]=n}}},e.Studies.calculateSupertrend=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);e.Studies.calculateStudyATR(t,i);for(var n=i.startFrom;n<r.length;n++){var a=r[n];if(a){var s=(a.High+a.Low)/2,o=i.inputs.Multiplier*a["ATR "+i.name],l=s-o,h=s+o;n&&(r[n-1]&&r[n-1].Close&&r[n-1].Close>r[n-1]["_Uptrend "+i.name]&&r[n-1]["_Uptrend "+i.name]>l&&(l=r[n-1]["_Uptrend "+i.name]),r[n-1]&&r[n-1].Close&&r[n-1].Close<r[n-1]["_Downtrend "+i.name]&&r[n-1]["_Downtrend "+i.name]<h&&(h=r[n-1]["_Downtrend "+i.name])),a["_Direction "+i.name]=1,n&&(a["_Direction "+i.name]=r[n-1]["_Direction "+i.name],a.Close>r[n-1]["_Downtrend "+i.name]?a["_Direction "+i.name]=1:a.Close<r[n-1]["_Uptrend "+i.name]&&(a["_Direction "+i.name]=-1)),a["_Uptrend "+i.name]=l,a["_Downtrend "+i.name]=h,a["Trend "+i.name]=a["_Direction "+i.name]>0?l:h}}i.outputMap={},i.outputMap["Trend "+i.name]="Trend"},e.Studies.fetchAdditionalInstruments=function(t,i,r,n){function a(){t.createDataSet(),t.draw()}if(!t.quoteDriver)return void console.log("CIQ.Studies.fetchAdditionalInstruments: No quotefeed to fetch symbol");var s=t.panels[i.panel].chart;i.symbols=r;var o,l,h;for(o=0;o<r.length;o++){l=h=r[o],"object"==typeof h?l=h.symbol:h={symbol:l};var c={symbol:l,symbolObject:h,bucket:"study",studyName:i.name,chartName:s.name,action:"add-study"};e.extend(c,n),i.series=t.addSeries(null,c,a)}},e.Studies.initPriceRelative=function(t,i,r,n,a,s){var o=e.Studies.initializeFN(t,i,r,n,a,s),l=[o.inputs["Comparison Symbol"].toUpperCase()];return e.Studies.fetchAdditionalInstruments(t,o,l),o},e.Studies.calculatePriceRelative=function(t,i){var r=i.chart.scrubbed,n=i.inputs["Comparison Symbol"].toUpperCase();n||(n=i.study.inputs["Comparison Symbol"]);var a={},s=t.chart.symbol.replace(/=/,"");if(s=s.replace(/[+\-*\\%]/g,""),a[s]=r.slice(i.startFrom),a[s].length){s!=n&&(a[n]=null);for(var o=e.computeEquationChart("["+s+"]/["+n+"]",a),l=0,h=i.startFrom;h<r.length&&l<o.length;h++){for(;l<o.length&&r[h].DT.getTime()>o[l].DT.getTime();)l++;r[h].DT.getTime()<o[l].DT.getTime()||(r[h]["Result "+i.name]=o[l].Close,l++)}}},e.Studies.calculatePerformance=function(t,i){var r=i.chart.scrubbed,n=i.inputs["Comparison Symbol"].toUpperCase();if(n||(n=i.study.inputs["Comparison Symbol"]),i.days||(i.days=i.study.inputs.Period),r.length<i.days+1)return void(i.error=!0);e.Studies.MA("ma",i.days,"Close",0,"_MA Base",t,i),e.Studies.MA("ma",i.days,n,0,"_MA Comp",t,i);for(var a=i.startFrom;a<r.length;a++){var s=r[a][n];s&&(s.Close||0===s.Close)&&(s=s.Close),r[a]["Result "+i.name]=r[a].Close/s*(r[a]["_MA Comp "+i.name]/r[a]["_MA Base "+i.name])}},e.Studies.calculateBeta=function(t,i){var r=i.chart.scrubbed,n=i.inputs["Comparison Symbol"].toUpperCase();if(n||(n=i.study.inputs["Comparison Symbol"]),i.days||(i.days=i.study.inputs.Period),r.length<i.days+1)return void(i.error=!0);for(var a=Math.max(i.startFrom,1);a<r.length;a++){r[a]["_BaseChange "+i.name]=r[a].Close/r[a-1].Close-1;var s=r[a][n];s&&(s.Close||0===s.Close)&&(s=s.Close);var o=r[a-1][n];o&&(o.Close||0===o.Close)&&(o=o.Close),r[a]["_CompChange "+i.name]=s/o-1}for(e.Studies.MA("ma",i.days,"_BaseChange "+i.name,0,"_MA Base",t,i),e.Studies.MA("ma",i.days,"_CompChange "+i.name,0,"_MA Comp",t,i),a=Math.max(i.startFrom,i.days);a<r.length;a++)r[a]["_COVARn "+i.name]=(r[a]["_BaseChange "+i.name]-r[a]["_MA Base "+i.name])*(r[a]["_CompChange "+i.name]-r[a]["_MA Comp "+i.name]),r[a]["_VARn "+i.name]=Math.pow(r[a]["_CompChange "+i.name]-r[a]["_MA Comp "+i.name],2);for(e.Studies.MA("ma",i.days,"_COVARn "+i.name,0,"_COVAR",t,i),e.Studies.MA("ma",i.days,"_VARn "+i.name,0,"_VAR",t,i),a=Math.max(i.startFrom,2*i.days-1);a<r.length;a++)r[a]["Result "+i.name]=r[a]["_COVAR "+i.name]/r[a]["_VAR "+i.name]},e.Studies.calculateVortex=function(t,i){var r=i.chart.scrubbed,n=i.days;if(r.length<n+1)return void(i.error=!0);var a={tr:0,vmPlus:0,vmMinus:0};i.startFrom>1&&(a=e.clone(r[i.startFrom-1]["_totals "+i.name]));for(var s=Math.max(i.startFrom,1);s<r.length;s++){var o=r[s],l=r[s-1],h=Math.abs(o.High-l.Low),c=Math.abs(o.Low-l.High),u=Math.max(o.High,l.Close)-Math.min(o.Low,l.Close);a.tr+=u,a.vmPlus+=h,a.vmMinus+=c,s>n&&(a.tr-=r[s-n]["_True Range "+i.name],a.vmPlus-=r[s-n]["_VMPlus "+i.name],a.vmMinus-=r[s-n]["_VMMinus "+i.name]),o["_True Range "+i.name]=u,o["_VMPlus "+i.name]=h,o["_VMMinus "+i.name]=c,s>=n&&(o["+VI "+i.name]=a.vmPlus/a.tr,o["-VI "+i.name]=a.vmMinus/a.tr),o["_totals "+i.name]=e.clone(a)}},e.Studies.calculateBalanceOfPower=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);for(var n=i.startFrom;n<r.length;n++){var a=r[n];a["_Ratio "+i.name]=a.Close-a.Open,0!==a["_Ratio "+i.name]&&(a["_Ratio "+i.name]/=a.High-a.Low)}e.Studies.MA(i.inputs["Moving Average Type"],i.days,"_Ratio "+i.name,0,"Result",t,i)},e.Studies.calculateTrendIntensity=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close"),e.Studies.MA("ma",i.days,n,0,"_SMA",t,i);var a,s,o=0,l=0,h=[],c=Math.ceil(i.days/2);for(a=Math.max(0,i.startFrom-c);a<r.length;a++)(r[a]["_SMA "+i.name]||0===r[a]["_SMA "+i.name])&&(s=r[a][n]-r[a]["_SMA "+i.name],s<0?l+=-1*s:o+=s,h.push(s),h.length>c&&(s=h.shift(),s<0?l-=-1*s:o-=s),a<i.startFrom||(r[a]["TII "+i.name]=function(t,e){return Math.abs(e)<1e-8?100:100-100/(1+t/e)}(o,l)));e.Studies.MA("ema",i.inputs["Signal Period"],"TII "+i.name,0,"Signal",t,i),i.zoneOutput="TII"},e.Studies.calculateZigZag=function(t,e){function i(t,i){for(var n=t+1;n<i;n++)r[n]["ShadowResult "+e.name]=(r[i]["Result "+e.name]-r[t]["Result "+e.name])*(n-t)/(i-t)+r[t]["Result "+e.name],delete r[n]["Result "+e.name]}var r=e.chart.scrubbed;if(r&&r.length){for(var n=e.highLowChart,a=null,s=null,o=e.inputs["Distance(%)"],l=0,h=0,c=0,u=null,d=null,p=0,f=Math.min(r.length-1,e.startFrom);f>=0;f--)if(p=f,r[f]["_state "+e.name]){var m=r[f]["_state "+e.name];a=m[0],s=m[1],l=m[2],h=m[3],c=m[4],u=m[5],d=m[6];break}for(var g=p;g<r.length;g++){var v=r[g][n?"High":"Close"],y=r[g][n?"Low":"Close"];if(null===s||s<v)if(s=v,l<0&&(a=y),u=(1-o/100)*s,l>-1){if(null!==d&&s>d){r[h]["Result "+e.name]=r[h][n?"Low":"Close"],i(c,h),l=-1,a=y,c=h,h=g;continue}}else h=g;if(null===a||a>y)if(a=y,l>0&&(s=v),d=(1+o/100)*a,l<1){if(null!==u&&a<u){r[h]["Result "+e.name]=r[h][n?"High":"Close"],i(c,h),l=1,s=v,c=h,h=g;continue}}else h=g}r[h]["Result "+e.name]=r[h][n?1==l?"Low":"High":"Close"],r[h]["_state "+e.name]=[a,s,l,h,c,u,d],i(c,h),r[r.length-1]["Result "+e.name]=r[r.length-1][n?1==l?"High":"Low":"Close"],i(h,r.length-1)}},e.Studies.calculatePsychologicalLine=function(t,e){var i=e.chart.scrubbed;if(i.length<e.days+1)return void(e.error=!0);for(var r=[],n=100/e.days,a=0,s=Math.max(e.startFrom-e.days,1);s<i.length;s++){var o=Number(i[s].Close>i[s-1].Close);o&&(a+=n),r.push(o),r.length>e.days&&(a-=r.shift()*n),s<e.startFrom||(i[s]["Result "+e.name]=a)}},e.Studies.calculateMADev=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n=i.inputs.Field;n&&"field"!=n||(n="Close");var a=i.inputs["Points Or Percent"];a||(a="Points");var s=i.inputs["Moving Average Type"];s||(s="exponential"),e.Studies.MA(s,i.days,n,0,"_MA",t,i);for(var o=i.name+"_hist",l=Math.max(i.startFrom,i.days-1);l<r.length;l++){var h=r[l];h[o]="Points"==a?h[n]-h["_MA "+i.name]:100*(h[n]/h["_MA "+i.name]-1)}},e.Studies.calculateShinohara=function(t,i){var r=i.chart.scrubbed;if(r.length<i.days+1)return void(i.error=!0);var n={weakNum:0,weakDen:0,strongNum:0,strongDen:0};i.startFrom>1&&(n=e.clone(r[i.startFrom-1]["_accums "+i.name]));for(var a=i.startFrom;a<r.length;a++)n.weakNum+=r[a].High-r[a].Close,n.weakDen+=r[a].Close-r[a].Low,a>0&&(n.strongNum+=r[a].High-r[a-1].Close,n.strongDen+=r[a-1].Close-r[a].Low),a>=i.days&&(n.weakNum-=r[a-i.days].High-r[a-i.days].Close,n.weakDen-=r[a-i.days].Close-r[a-i.days].Low,r[a]["Weak Ratio "+i.name]=100*n.weakNum/n.weakDen,a>i.days&&(n.strongNum-=r[a-i.days].High-r[a-i.days-1].Close,n.strongDen-=r[a-i.days-1].Close-r[a-i.days].Low,r[a]["Strong Ratio "+i.name]=100*n.strongNum/n.strongDen)),r[a]["_accums "+i.name]=e.clone(n)},e.Studies.calculateIchimoku=function(t,e){function i(t,e){for(var i=Number.MAX_VALUE,r=-1*Number.MAX_VALUE,n=e-t+1;n<=e;n++)n<0||(i=Math.min(i,a[n].Low),r=Math.max(r,a[n].High));return[i,r]}var r,n,a=e.chart.scrubbed,s={Base:Number(e.inputs["Base Line Period"]),Conv:Number(e.inputs["Conversion Line Period"]),LeadB:Number(e.inputs["Leading Span B Period"]),Lag:Number(e.inputs["Lagging Span Period"])};for(r=e.startFrom;r<a.length;r++)a[r]&&(n=i(s.Conv,r),a[r]["Conversion Line "+e.name]=(n[1]+n[0])/2,n=i(s.Base,r),a[r]["Base Line "+e.name]=(n[1]+n[0])/2,r<s.Lag||(a[r-s.Lag]["Lagging Span "+e.name]=a[r].Close));for(e.futureA=[],e.futureB=[],r=Math.max(0,e.startFrom-s.Base);r<a.length;r++){n=i(s.LeadB,r);var o=(a[r]["Conversion Line "+e.name]+a[r]["Base Line "+e.name])/2,l=(n[1]+n[0])/2;a[r+s.Base]?(a[r+s.Base]["Leading Span A "+e.name]=o,a[r+s.Base]["Leading Span B "+e.name]=l):(e.futureA.push(o),e.futureB.push(l))}},e.Studies.displayIchimoku=function(t,i,r){function n(r,n){var a={color:!1===n?l:n?o:"transparent",opacity:.3,panelName:i.panel};e.fillArea(t,r,a),t.endClip()}var a="Leading Span A "+i.name,s="Leading Span B "+i.name,o=e.Studies.determineColor(i.outputs[i.outputMap[a]]),l=e.Studies.determineColor(i.outputs[i.outputMap[s]]),h={topBand:a,bottomBand:s,topColor:o,bottomColor:l,skipTransform:t.panels[i.panel].name!=i.chart.name};e.fillIntersecting(t,i.panel,h);var c=t.panels[i.panel],u=t.pixelFromBar(r.length-1,c.chart),d=t.pixelFromPrice(r[r.length-1][a],c),p=t.pixelFromPrice(r[r.length-1][s],c),f=[[u,p],[u,d]],m=null,g=i.futureA,v=i.futureB;if(i.chart.dataSegment.length>=i.chart.scroll){for(var y=0;g&&y<g.length-1;y++)if(null!==g[y]&&!isNaN(g[y])&&null!==v[y]&&!isNaN(v[y])){var x=t.pixelFromBar(r.length+y,c.chart),b=t.pixelFromBar(r.length+y+1,c.chart),C=t.pixelFromPrice(g[y],c),S=t.pixelFromPrice(g[y+1],c),w=t.pixelFromPrice(v[y],c),M=t.pixelFromPrice(v[y+1],c);if(f.push([x,C]),f.unshift([x,w]),(m=C<w)&&S>M||!m&&S<M){var T=e.intersectLineLineX(x,b,C,S,x,b,w,M),B=e.intersectLineLineY(x,b,C,S,x,b,w,M);f.push([T,B]),n(f,m),f=[[T,B]],m=null}}f.length>2&&n(f,m)}e.Studies.displaySeriesAsLine(t,i,r)},e.Studies.displayDarvas=function(t,i,r){var n=i.outputs.Levels;n&&"auto"!=n&&!e.isTransparent(n)||(n=t.defaultColor);var a=i.outputs.Darvas;a&&"auto"!=a&&!e.isTransparent(a)||(a=t.defaultColor);var s=i.outputs.Ghost;s&&"auto"!=s&&!e.isTransparent(s)||(s=t.defaultColor);var o,l,h,c=t.panels[i.panel],u=t.layout.candleWidth-2;if(u<2&&(u=1),t.startClip(i.panel),i.inputs["Stop Levels"]){for(t.chart.context.setLineDash&&t.chart.context.setLineDash([2,2]),t.chart.context.lineWidth=2,t.chart.context.strokeStyle=n,t.chart.context.beginPath(),o=0;o<r.length;o++){l=r[o];var d=r[o-1];if(l){h=l["Loss "+i.name]?Math.floor(t.pixelFromPrice(l["Loss "+i.name],c)):null;var p=d&&d["Loss "+i.name]?Math.floor(t.pixelFromPrice(d["Loss "+i.name],c)):null;if(h){l.candleWidth&&(u=Math.floor(Math.max(1,l.candleWidth)));var f=Math.floor(t.pixelFromBar(o,c.chart)+u/2),m=Math.floor(t.pixelFromBar(o,c.chart)-u/2);p&&p>=h?t.chart.context.lineTo(m,h):0===o?t.chart.context.moveTo(t.chart.left,h):t.chart.context.moveTo(m,h),t.chart.context.lineTo(f,h)}}}t.chart.context.stroke(),t.chart.context.setLineDash&&t.chart.context.setLineDash([]),t.chart.context.lineWidth=1}var g,v,y,x,b=-10,C=0,S=-10,w=0,M=!1,T=!1,B=t.chart.context.measureText("▲").width/2;for(o=0;o<r.length;o++)if(r[o]){if(r[o]["Spike "+i.name]){t.chart.context.fillStyle=a,t.chart.context.textBaseline="bottom";var k=t.pixelFromPrice(r[o].High,t.chart.panel);t.chart.context.fillText("▼",t.pixelFromBar(o)-B,k-5)}r[o].candleWidth&&(u=Math.floor(Math.max(1,r[o].candleWidth))),r[o]["Darvas "+i.name]&&(l=r[o]["Darvas "+i.name],1!=l.State||M?0===l.State&&(C=Math.floor(t.pixelFromBar(o,c.chart)+u/2)-b,g=Math.floor(t.pixelFromPrice(l.High,c)),v=Math.floor(t.pixelFromPrice(l.Low,c))-g,t.chart.context.strokeStyle=a,t.chart.context.fillStyle=a,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.strokeRect(b,g,C,v),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(b,g,C,v),t.chart.context.globalAlpha=1,M=!1):(b=Math.floor(t.pixelFromBar(o,c.chart)-u/2),g=Math.floor(t.pixelFromPrice(l.High,c)),v=Math.floor(t.pixelFromPrice(l.Low,c))-g,M=!0)),r[o]["Ghost "+i.name]&&i.inputs["Ghost Boxes"]&&(l=r[o]["Ghost "+i.name],1!=l.State||T?0===l.State&&(l.Start==l.End&&(S=Math.floor(t.pixelFromBar(o,c.chart)-u/2)),w=Math.floor(t.pixelFromBar(o,c.chart)+u/2)-S,y=Math.floor(t.pixelFromPrice(l.High,c)),x=Math.floor(t.pixelFromPrice(l.Low,c))-y,t.chart.context.strokeStyle=s,t.chart.context.fillStyle=s,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.strokeRect(S,y,w,x),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(S,y,w,x),t.chart.context.globalAlpha=1,T=!1):(S=Math.floor(t.pixelFromBar(o,c.chart)-u/2),y=Math.floor(t.pixelFromPrice(l.High,c)),w=Math.floor((l.End-l.Start+1)*t.layout.candleWidth+u/2),x=Math.floor(t.pixelFromPrice(l.Low,c))-y,T=!0))}if(M&&(C=Math.floor(t.pixelFromBar(o,c.chart)+u/2)-b,t.chart.context.strokeStyle=a,t.chart.context.fillStyle=a,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.beginPath(),t.chart.context.moveTo(b+2*C,g),t.chart.context.lineTo(b,g),t.chart.context.lineTo(b,g+v),t.chart.context.lineTo(b+2*C,g+v),t.chart.context.stroke(),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(b,g,2*C,v),t.chart.context.globalAlpha=1),T&&(t.chart.context.strokeStyle=s,t.chart.context.fillStyle=s,i.inputs["Stop Levels"]?t.chart.context.globalAlpha=.3:(t.chart.context.strokeRect(S,y,w,x),t.chart.context.globalAlpha=.2),t.chart.context.fillRect(S,y,w,x),t.chart.context.globalAlpha=1),M||T){if(i.inputs["Stop Levels"]){t.chart.context.setLineDash&&t.chart.context.setLineDash([2,2]),t.chart.context.lineWidth=2,t.chart.context.strokeStyle=n;var D=Math.floor(t.pixelFromBar(o-1,c.chart)+u/2);h&&(t.chart.context.beginPath(),t.chart.context.moveTo(D,h),t.chart.context.lineTo(M?b+2*C:S+w,h),t.chart.context.stroke()),t.chart.context.setLineDash&&t.chart.context.setLineDash([]),t.chart.context.lineWidth=1}M=!1,T=!1}t.endClip()},e.Studies.displaySupertrend=function(t,e,i){function r(t,i,r){return i&&i["_Direction "+e.name]<0?e.outputs.Downtrend:e.outputs.Uptrend}var n=t.panels[e.panel],a={skipProjections:!0,label:t.preferences.labels},s=t.chart.context;s.strokeStyle=r(t,i[i.length-1]),s.lineWidth=2,e.highlight&&(s.lineWidth=3);for(var o="Trend "+e.name,l=0;n.chart.transformFunc&&l<i.length;l++){var h=i[l];h&&h.transform&&(h.transform[o]=n.chart.transformFunc(t,n.chart,h[o]))}t.plotDataSegmentAsLine(o,n,a,r),s.lineWidth=1,t.startClip(e.panel);var c,u=t.chart.context.measureText("▲").width/2;for(c=0;c<i.length;c++)if(i[c]&&i[c-1])if(i[c-1]["_Direction "+e.name]>i[c]["_Direction "+e.name]){t.chart.context.fillStyle=e.outputs.Downtrend,t.chart.context.textBaseline="bottom";for(var d=t.pixelFromPrice(i[c].High,t.chart.panel),p=5;p<=45;p+=10)t.chart.context.fillText("▼",t.pixelFromBar(c)-u,d-p)}else if(i[c-1]["_Direction "+e.name]<i[c]["_Direction "+e.name]){t.chart.context.fillStyle=e.outputs.Uptrend,t.chart.context.textBaseline="top";for(var f=t.pixelFromPrice(i[c].Low,t.chart.panel),m=5;m<=45;m+=10)t.chart.context.fillText("▲",t.pixelFromBar(c)-u,f+m)}t.endClip()},e.Studies.displayVsComparisonSymbol=function(t,i,r){var n=i.inputs["Comparison Symbol"].toUpperCase();if(!t.getSeries({symbol:n,chart:i.chart}).length)return void t.watermark(i.panel,"center","bottom",t.translateIf(i.study.name+" Not Available"));for(var a={skipTransform:t.panels[i.panel].name!=i.chart.name,panelName:i.panel,band:"Result "+i.name,threshold:i.study.centerline},s=r.length-1;s>=0;s--)if(r[s]&&r[s][n])return e.Studies.displaySeriesAsLine(t,i,r),void((i.study.centerline||0===i.study.centerline)&&(i.outputs.Gain&&e.preparePeakValleyFill(t,e.extend(a,{direction:1,color:i.outputs.Gain})),i.outputs.Loss&&e.preparePeakValleyFill(t,e.extend(a,{direction:-1,color:i.outputs.Loss}))))},e.Studies.displayMFI=function(t,i,r){var n=t.panels[i.panel];n.yAxis.min=0,e.Studies.displaySeriesAsLine(t,i,r);var a=n.yAxis.bottom,s=t.layout.candleWidth-2;s<2&&(s=1);var o=i.outputs.Green,l=i.outputs.Fade,h=i.outputs.Fake,c=i.outputs.Squat;t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC",t.startClip(i.panel);for(var u=0;u<r.length;u++){var d=r[u];d&&r[u-1]&&(0===u||(r[u-1][i.name+"_hist"]<d[i.name+"_hist"]?r[u-1].Volume<d.Volume?t.chart.context.fillStyle=o:r[u-1].Volume>d.Volume&&(t.chart.context.fillStyle=h):r[u-1][i.name+"_hist"]>d[i.name+"_hist"]&&(r[u-1].Volume<d.Volume?t.chart.context.fillStyle=c:r[u-1].Volume>d.Volume&&(t.chart.context.fillStyle=l))),d.candleWidth&&(s=Math.floor(Math.max(1,d.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(u,n.chart)-s/2),Math.floor(a),Math.floor(s),Math.floor(t.pixelFromPrice(d[i.name+"_hist"],n)-a)))}t.endClip()},e.Studies.displayAwesomeOscillator=function(t,i,r){e.Studies.determineMinMax(t,i,r);var n=t.panels[i.panel];n.yAxis.low=n.min=Math.min(0,n.min),n.yAxis.high=n.max=Math.max(0,n.max),e.Studies.displaySeriesAsLine(t,i,r);var a=t.pixelFromPrice(0,n),s=t.layout.candleWidth-2;s<2&&(s=1);var o=e.Studies.determineColor(i.outputs["Increasing Bar"]),l=e.Studies.determineColor(i.outputs["Decreasing Bar"]);t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC",t.startClip(i.panel);for(var h=0;h<r.length;h++){var c=r[h];c&&r[h-1]&&(0===h||(r[h-1][i.name+"_hist"]<c[i.name+"_hist"]?t.chart.context.fillStyle=o:r[h-1][i.name+"_hist"]>c[i.name+"_hist"]&&(t.chart.context.fillStyle=l)),c.candleWidth&&(s=Math.floor(Math.max(1,c.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(h,n.chart)-s/2),Math.floor(a),Math.floor(s),Math.floor(t.pixelFromPrice(c[i.name+"_hist"],n)-a)))}t.endClip()},e.Studies.displayGator=function(t,i,r){e.Studies.determineMinMax(t,i,r);var n=t.panels[i.panel];n.yAxis.low=n.min=Math.min(0,n.min),n.yAxis.high=n.max=Math.max(0,n.max),e.Studies.displaySeriesAsLine(t,i,r);var a=t.pixelFromPrice(0,n),s=t.layout.candleWidth-2;s<2&&(s=1);var o=e.Studies.determineColor(i.outputs["Increasing Bar"]),l=e.Studies.determineColor(i.outputs["Decreasing Bar"]);t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC",t.startClip(i.panel);for(var h=1;h<r.length;h++){var c=r[h];if(c&&r[h-1])for(var u=1;u<=2;u++)Math.abs(r[h-1][i.name+"_hist"+u])<Math.abs(c[i.name+"_hist"+u])?t.chart.context.fillStyle=o:Math.abs(r[h-1][i.name+"_hist"+u])>Math.abs(c[i.name+"_hist"+u])&&(t.chart.context.fillStyle=l),c.candleWidth&&(s=Math.floor(Math.max(1,c.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(h,n.chart)-s/2),Math.floor(a),Math.floor(s),Math.floor(t.pixelFromPrice(c[i.name+"_hist"+u],n)-a))}t.endClip()},e.Studies.initElderImpulse=function(t,i,r,n,a,s){var o=e.Studies.initializeFN(t,i,r,n,a,s);return t.chart.customChart={chartType:"colored_bar",colorFunction:function(t,e,i){return e["Result "+o.name]}},t.setMainSeriesRenderer(),o},e.Studies.displayPivotPoints=function(t,i,r){if(i.noSlopes=!i.inputs.Continuous,e.Studies.displaySeriesAsLine(t,i,r),i.inputs.Shading){var n={noSlopes:i.noSlopes,opacity:i.parameters.opacity?i.parameters.opacity:.2,skipTransform:t.panels[i.panel].name!=i.chart.name};e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 3 "+i.name,bottomBand:"Resistance 2 "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 3"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 2 "+i.name,bottomBand:"Resistance 1 "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 2"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Resistance 1 "+i.name,bottomBand:"Pivot "+i.name,color:e.Studies.determineColor(i.outputs["Resistance 1"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 1 "+i.name,bottomBand:"Pivot "+i.name,color:e.Studies.determineColor(i.outputs["Support 1"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 2 "+i.name,bottomBand:"Support 1 "+i.name,color:e.Studies.determineColor(i.outputs["Support 2"])},n)),e.prepareChannelFill(t,e.extend({panelName:i.panel,topBand:"Support 3 "+i.name,bottomBand:"Support 2 "+i.name,color:e.Studies.determineColor(i.outputs["Support 3"])},n))}},e.Studies.displayAlligator=function(t,i,r){function n(e,i){var n;"high"==e?(t.chart.context.fillStyle=t.defaultColor,t.chart.context.textBaseline="bottom",n=t.pixelFromPrice(r[i].High,t.chart.panel),t.chart.context.fillText("▲",t.pixelFromBar(s,t.chart)-t.chart.context.measureText("▲").width/2+1,n-5)):"low"==e&&(t.chart.context.fillStyle=t.defaultColor,t.chart.context.textBaseline="top",n=t.pixelFromPrice(r[i].Low,t.chart.panel),t.chart.context.fillText("▼",t.pixelFromBar(s,t.chart)-t.chart.context.measureText("▼").width/2+1,n+5))}var a=t.panels[i.panel];if(e.Studies.displayIndividualSeriesAsLine(t,i,a,"Jaw "+i.name,r),e.Studies.displayIndividualSeriesAsLine(t,i,a,"Lips "+i.name,r),e.Studies.displayIndividualSeriesAsLine(t,i,a,"Teeth "+i.name,r),i.inputs["Show Fractals"]){t.startClip(i.panel);for(var s=2;s<r.length-2;s++)r[s]&&(r[s]["Fractal High "+i.name]&&n("high",s),r[s]["Fractal Low "+i.name]&&n("low",s));t.endClip()}},e.Studies.displayRainbowMA=function(t,i,r){for(var n=t.panels[i.panel],a=10;a>0;a--)e.Studies.displayIndividualSeriesAsLine(t,i,n,"SMA"+a+" "+i.name,r)},e.Studies.displayRainbowOsc=function(t,i,r){var n=t.panels[i.panel];n.min=-100,n.max=100,n.yAxis.low=n.min=Math.min(0,n.min),n.yAxis.high=n.max=Math.max(0,n.max),e.Studies.displaySeriesAsLine(t,i,r),t.startClip(i.panel);var a=t.pixelFromPrice(0,n);t.plotDataSegmentAsLine("Zero "+i.name,n,{noDraw:!0,skipTransform:!0,label:!1});var s=e.Studies.determineColor(i.outputs["Positive Bar"]);t.chart.context.strokeStyle=s,t.plotDataSegmentAsLine("Over "+i.name,n,{skipTransform:!0,label:!1});var o=t.panels[i.panel].name!=i.chart.name,l=t.chart.context.createLinearGradient(0,a,0,n.yAxis.top);l.addColorStop(0,t.containerColor),l.addColorStop(1,s),e.prepareChannelFill(t,{skipTransform:o,color:l,opacity:1,panelName:i.name,topBand:"Over "+i.name,bottomBand:"Zero "+i.name});var h=e.Studies.determineColor(i.outputs["Negative Bar"]);t.chart.context.strokeStyle=h,t.plotDataSegmentAsLine("Under "+i.name,n,{skipTransform:!0,label:!1});var c=t.chart.context.createLinearGradient(0,a,0,n.yAxis.bottom);c.addColorStop(0,t.containerColor),c.addColorStop(1,h),e.prepareChannelFill(t,{skipTransform:o,color:c,opacity:1,panelName:i.name,topBand:"Zero "+i.name,bottomBand:"Under "+i.name});var u=t.layout.candleWidth-2;u<2&&(u=1),t.canvasColor("stx_histogram"),t.chart.context.globalAlpha=1,t.chart.context.fillStyle="#CCCCCC";for(var d=0;d<r.length;d++){var p=r[d];p&&(p[i.name+"_hist"]>0?t.chart.context.fillStyle=s:p[i.name+"_hist"]<0&&(t.chart.context.fillStyle=h),p.candleWidth&&(u=Math.floor(Math.max(1,p.candleWidth-2))),t.chart.context.fillRect(Math.floor(t.pixelFromBar(d,n.chart)-u/2),Math.floor(a),Math.floor(u),Math.floor(t.pixelFromPrice(p[i.name+"_hist"],n)-a)))}t.endClip()},e.Studies.displayZigZag=function(t,i,r){var n=t.chart.highLowBars||t.highLowBars[t.layout.chartType];i.highLowChart!=n&&(i.highLowChart=n,i.startFrom=0,i.study.calculateFN(t,i));for(var a=t.chart,s=0;s<r.length;s++)r[s]&&r[s]["_shadowCopy "+i.name]&&(delete r[s]["Result "+i.name],r[s].transform&&delete r[s].transform["Result "+i.name],delete r[s]["_shadowCopy "+i.name]);var o=r[0],l=r[r.length-1];o&&!o["Result "+i.name]&&o["ShadowResult "+i.name]&&(o["Result "+i.name]=o["ShadowResult "+i.name],o.transform&&(o.transform["Result "+i.name]=a.transformFunc(t,a,o["ShadowResult "+i.name])),o["_shadowCopy "+i.name]=1),l&&!l["Result "+i.name]&&l["ShadowResult "+i.name]&&(l["Result "+i.name]=l["ShadowResult "+i.name],l.transform&&(l.transform["Result "+i.name]=a.transformFunc(t,a,l["ShadowResult "+i.name])),l["_shadowCopy "+i.name]=1),e.Studies.displaySeriesAsLine(t,i,r)},e.Studies.displayVolumeProfile=function(t,i,r){function n(t,i){i||(M-=2),D.canvasColor(t),e.isIE8&&(b.globalAlpha=.5),b.beginPath();for(var r=u[0][0],n=M,a=1;a<u.length;a++){if(u[a][1]){var s=Math.round(M-u[a][1]*T/p)-.5,o=Math.round(D.pixelFromTransformedValue(r,S))+.5,l=Math.round(D.pixelFromTransformedValue(u[a][0],S))+.5;if(i||(o-=.5,l+=.5,s+=.5),o>w&&(o=w),l<w)if(b.moveTo(M,o),b.lineTo(M,l),b.lineTo(s,l),b.lineTo(s,o),i)(n>s||1==a)&&b.lineTo(n,o);else if(b.lineTo(M,o),h){var c=e.condenseInt(u[a][1]),d=o-l;if(C<=d-2){var f;try{f=b.measureText(c).width}catch(t){f=0}b.textBaseline="top";var m=b.fillStyle;b.fillStyle=B,b.fillText(c,s-f-3,l+(d/2-C/2)),b.fillStyle=m}}n=s}else n=M;r=u[a][0]}i||b.fill(),b.strokeStyle=B,i&&b.stroke(),b.closePath()}if(t&&t.chart.dataSet){var a=t.chart,s=i.parameters.numberOfBars,o=i.parameters.widthPercentage,l=i.parameters.displayBorder,h=i.parameters.displayVolume;(!s||s<0)&&(s=30),s=Math.ceil(s),(!o||o<0)&&(o=.25),!1!==l&&(l=!0),!0!==h&&(h=!1);var c=(a.highValue-a.lowValue)/s;if(0!==c){for(var u=[],d=a.lowValue;d<a.highValue+.1;d+=c)u.push([d,0]);if(u.length<2)return void t.watermark("chart","center","top",t.translateIf("Not enough data to render the Volume Profile"));for(var p=0,f=0;f<r.length;f++){var m=r[f];if(m){var g=m.Volume;i.panel==a.name&&m.transform&&(m=m.transform);for(var v=u[0][0],y=0,x=1;x<u.length;x++)y=u[x][0],(m.Low>=v&&m.Low<=y||m.Low<v&&m.High>y||m.High>=v&&m.High<=y)&&(u[x][1]+=g,u[x][1]>p&&(p=u[x][1])),v=y}}if(0===p)return void t.watermark("chart","center","top",t.translateIf("Not enough data to render the Volume Profile"));t.setStyle("stx_volume_profile","color",e.Studies.determineColor(i.outputs["Bars Color"]));var b=a.context;t.canvasFont("stx-float-date",b);var C=t.getCanvasFontSize("stx-float-date"),S=a.panel,w=S.yAxis.bottom,M=Math.round(a.width)-.5,T=a.width*o,B=t.canvasStyle("stx_volume_profile").borderColor,k=!e.isTransparent(t.canvasStyle("stx_volume_profile").borderColor)&&l,D=t;n("stx_volume_profile",!1),k&&n("stx_volume_profile",!0),b.globalAlpha=1}}},e.Studies.studyLibrary=e.extend(e.Studies.studyLibrary,{"val lines":{name:"Valuation Lines",calculateFN:function(){},seriesFN:function(t,i,r){e.Studies.calculateValuationLines(t,i,r),e.Studies.displayValuationLines(t,i)},overlay:!0,inputs:{Field:"field","Average Type":["mean","median","harmonic"],"Display Average":!0,"Display 1 Standard Deviation (1σ)":!1,"Display 2 Standard Deviation (2σ)":!1,"Display 3 Standard Deviation (3σ)":!1},outputs:{Average:"#00afed","1 Standard Deviation (1σ)":"#e1e1e1","2 Standard Deviation (2σ)":"#85c99e","3 Standard Deviation (3σ)":"#fff69e"}},correl:{name:"Correlation Coefficient",range:"-1 to 1",calculateFN:e.Studies.calculateCorrelationCoefficient,outputs:{}},PMO:{name:"Price Momentum Oscillator",calculateFN:e.Studies.calculatePMO,inputs:{Field:"field","Smoothing Period":35,"Double Smoothing Period":20,"Signal Period":10},outputs:{PMO:"auto",PMOSignal:"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:2.5,studyOverBoughtColor:"auto",studyOverSoldValue:-2.5,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:0,step:"0.05"},studyOverSoldValue:{max:0,step:"0.05"}}},"Rel Vol":{name:"Relative Volatility",range:"0 to 100",calculateFN:e.Studies.calculateRelativeVolatility,inputs:{Field:"field","STD Period":10,"Smoothing Period":14},outputs:{"Rel Vol":"auto"},centerline:50,parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:70,studyOverBoughtColor:"auto",studyOverSoldValue:30,studyOverSoldColor:"auto"}}},Awesome:{name:"Awesome Oscillator",seriesFN:e.Studies.displayAwesomeOscillator,calculateFN:e.Studies.calculateAwesomeOscillator,inputs:{},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"W MFI":{name:"Market Facilitation Index",seriesFN:e.Studies.displayMFI,calculateFN:e.Studies.calculateMFI,yAxis:{ground:!0},range:"0 to max",inputs:{"Scale Factor":6},outputs:{Green:"#8bc176",Fade:"#ab611f",Fake:"#5f7cb8",Squat:"#ffd0cf"}},"ATR Bands":{name:"ATR Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateATRBands,inputs:{Period:5,Shift:3,Field:"field","Channel Fill":!0},outputs:{"ATR Bands Top":"auto","ATR Bands Bottom":"auto","ATR Bands Channel":"auto"},attributes:{Shift:{min:.1,step:.1}}},"STARC Bands":{name:"STARC Bands",overlay:!0,seriesFN:e.Studies.displayChannel,calculateFN:e.Studies.calculateSTARCBands,inputs:{Period:15,"MA Period":5,Multiplier:1.3,"Channel Fill":!0},outputs:{"STARC Bands Top":"auto","STARC Bands Median":"auto","STARC Bands Bottom":"auto"},attributes:{Multiplier:{min:.1,step:.1}}},"ATR Trailing Stop":{name:"ATR Trailing Stops",overlay:!0,seriesFN:e.Studies.displayPSAR2,calculateFN:e.Studies.calculateATRStops,inputs:{Multiplier:3,Period:21,"Plot Type":["points","squarewave"],HighLow:!1},outputs:{"Buy Stops":"#FF0000","Sell Stops":"#00FF00"},attributes:{
Multiplier:{min:.1,step:.1}}},"Boll %b":{name:"Bollinger %b",calculateFN:e.Studies.calculateBollinger,inputs:{Field:"field",Period:20,"Standard Deviations":2,"Moving Average Type":"ma"},outputs:{"%b":"auto"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:100,studyOverBoughtColor:"auto",studyOverSoldValue:0,studyOverSoldColor:"auto"}},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Boll BW":{name:"Bollinger Bandwidth",calculateFN:e.Studies.calculateBollinger,inputs:{Field:"field",Period:20,"Standard Deviations":2,"Moving Average Type":"ma"},outputs:{Bandwidth:"auto"},attributes:{"Standard Deviations":{min:.1,step:.1}}},"Donchian Width":{name:"Donchian Width",calculateFN:e.Studies.calculateMaxHighMinLow,inputs:{"High Period":20,"Low Period":20}},"Rel Vig":{name:"Relative Vigor Index",seriesFN:e.Studies.displayHistogramWithSeries,calculateFN:e.Studies.calculateRelativeVigor,inputs:{Period:10},outputs:{"Rel Vig":"auto",RelVigSignal:"#FF0000","Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},"Elder Impulse":{name:"Elder Impulse System",calculateFN:e.Studies.calculateElderImpulse,initializeFN:e.Studies.initElderImpulse,seriesFN:null,customRemoval:!0,underlay:!0,inputs:{},outputs:{Bullish:"#8BC176",Bearish:"#DD3E39",Neutral:"#5F7CB8"},removeFN:function(t,e){t.chart.customChart=null,t.setMainSeriesRenderer()}},"Pivot Points":{name:"Pivot Points",overlay:!0,seriesFN:e.Studies.displayPivotPoints,calculateFN:e.Studies.calculatePivotPoints,inputs:{Type:["standard","fibonacci"],Continuous:!1,Shading:!1},outputs:{Pivot:"auto","Resistance 1":"rgb(184,44,11)","Support 1":"rgb(105,145,88)","Resistance 2":"rgb(227,100,96)","Support 2":"rgb(179,217,135)","Resistance 3":"rgb(255,208,207)","Support 3":"rgb(211,232,174)"},parameters:{init:{opacity:.2}}},VWAP:{name:"VWAP",overlay:!0,calculateFN:e.Studies.calculateVWAP,inputs:{},outputs:{VWAP:"#FF0000"}},Alligator:{name:"Alligator",overlay:!0,seriesFN:e.Studies.displayAlligator,calculateFN:e.Studies.calculateAlligator,inputs:{"Jaw Period":13,"Jaw Offset":8,"Teeth Period":8,"Teeth Offset":5,"Lips Period":5,"Lips Offset":3,"Show Fractals":!1},outputs:{Jaw:"#0000FF",Teeth:"#FF0000",Lips:"#00DD00"}},Gator:{name:"Gator Oscillator",seriesFN:e.Studies.displayGator,calculateFN:e.Studies.calculateAlligator,inputs:{"Jaw Period":13,"Jaw Offset":8,"Teeth Period":8,"Teeth Offset":5,"Lips Period":5,"Lips Offset":3},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"},centerline:0},"Ichimoku Clouds":{name:"Ichimoku Clouds",overlay:!0,range:"bypass",calculateFN:e.Studies.calculateIchimoku,seriesFN:e.Studies.displayIchimoku,inputs:{"Conversion Line Period":9,"Base Line Period":26,"Leading Span B Period":52,"Lagging Span Period":26},outputs:{"Conversion Line":"#0000FF","Base Line":"#FF0000","Leading Span A":"#00FF00","Leading Span B":"#FF0000","Lagging Span":"#808000"}},"P Rel":{name:"Price Relative",initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculatePriceRelative,inputs:{"Comparison Symbol":"SPY"},deferUpdate:!0},"Perf Idx":{name:"Performance Index",centerline:1,initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculatePerformance,inputs:{Period:120,"Comparison Symbol":"SPY"},outputs:{Result:"auto",Gain:"#00DD00",Loss:"#FF0000"},deferUpdate:!0},Beta:{name:"Beta",centerline:1,initializeFN:e.Studies.initPriceRelative,seriesFN:e.Studies.displayVsComparisonSymbol,calculateFN:e.Studies.calculateBeta,inputs:{Period:20,"Comparison Symbol":"SPY"},deferUpdate:!0},Ulcer:{name:"Ulcer Index",calculateFN:e.Studies.calculateUlcerIndex,inputs:{Field:"field",Period:14}},"Bal Pwr":{name:"Balance of Power",range:"-1 to 1",calculateFN:e.Studies.calculateBalanceOfPower,inputs:{Period:14,"Moving Average Type":"ma"}},"Trend Int":{name:"Trend Intensity Index",calculateFN:e.Studies.calculateTrendIntensity,range:"0 to 100",inputs:{Field:"field",Period:14,"Signal Period":9},outputs:{TII:"auto",Signal:"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:80,studyOverBoughtColor:"auto",studyOverSoldValue:20,studyOverSoldColor:"auto"}}},Choppiness:{name:"Choppiness Index",calculateFN:e.Studies.calculateChoppiness,centerline:50,parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:61.8,studyOverBoughtColor:"auto",studyOverSoldValue:38.2,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:50,step:"0.1"},studyOverSoldValue:{max:50,step:"0.1"}}},Disparity:{name:"Disparity Index",calculateFN:e.Studies.calculateDisparity,inputs:{Field:"field",Period:14,"Moving Average Type":"ma"}},"Rainbow MA":{name:"Rainbow Moving Average",overlay:!0,calculateFN:e.Studies.calculateRainbow,seriesFN:e.Studies.displayRainbowMA,inputs:{Field:"field",Period:2,Underlay:!1},outputs:{SMA1:"#FF0000",SMA2:"#FF7F00",SMA3:"#FFFF00",SMA4:"#7FFF00",SMA5:"#00FF7F",SMA6:"#00FFFF",SMA7:"#007FFF",SMA8:"#0000FF",SMA9:"#7F00FF",SMA10:"#FF00FF"}},"Rainbow Osc":{name:"Rainbow Oscillator",calculateFN:e.Studies.calculateRainbow,seriesFN:e.Studies.displayRainbowOsc,inputs:{Field:"field",Period:2,"HHV/LLV Lookback":10},outputs:{"Positive Bar":"#00DD00","Negative Bar":"#FF0000"}},"Pring KST":{name:"Pring's Know Sure Thing",calculateFN:e.Studies.calculateKST,inputs:{Field:"field","Lightest Rate of Change Period":10,"Lightest SMA Period":10,"Light Rate of Change Period":15,"Light SMA Period":10,"Heavy Rate of Change Period":20,"Heavy SMA Period":10,"Heaviest Rate of Change Period":30,"Heaviest SMA Period":15,"Signal Period":9},outputs:{KST:"#00DD00",KSTSignal:"#FF0000"}},"Pring Sp-K":{name:"Pring's Special K",calculateFN:e.Studies.calculateSpecialK,inputs:{Field:"field",Interval:["daily","weekly"]}},Darvas:{name:"Darvas Box",underlay:!0,calculateFN:e.Studies.calculateDarvas,seriesFN:e.Studies.displayDarvas,inputs:{"ATH Lookback Period":100,"Exit Field":["close","high/low"],"Ghost Boxes":!0,"Stop Levels":!1,"Level Offset":.01,"Price Minimum":5,"Volume Spike":!1,"Volume % of Avg":400},outputs:{Darvas:"#5F7CB8",Ghost:"#699158",Levels:"auto"},customRemoval:!0,attributes:{"Price Minimum":{min:.01,step:.01}}},Supertrend:{name:"Supertrend",overlay:!0,seriesFN:e.Studies.displaySupertrend,calculateFN:e.Studies.calculateSupertrend,inputs:{Period:7,Multiplier:3},outputs:{Uptrend:"#8cc176",Downtrend:"#b82c0c"},attributes:{Multiplier:{min:.1,step:.1}}},"vol profile":{name:"Volume Profile",overlay:!0,seriesFN:e.Studies.displayVolumeProfile,calculateFN:null,inputs:{},outputs:{"Bars Color":"#b64a96"},customRemoval:!0,parameters:{init:{displayBorder:!0,displayVolume:!1,numberOfBars:30,widthPercentage:.25}}},Vortex:{name:"Vortex Indicator",calculateFN:e.Studies.calculateVortex,centerline:1,outputs:{"+VI":"#00FF00","-VI":"#FF0000"},parameters:{template:"studyOverZones",init:{studyOverZonesEnabled:!0,studyOverBoughtValue:1.1,studyOverBoughtColor:"auto",studyOverSoldValue:.9,studyOverSoldColor:"auto"}},attributes:{studyOverBoughtValue:{min:1,step:"0.01"},studyOverSoldValue:{max:1,step:"0.01"}}},ZigZag:{name:"ZigZag",overlay:!0,seriesFN:e.Studies.displayZigZag,calculateFN:e.Studies.calculateZigZag,inputs:{"Distance(%)":10},parameters:{init:{label:!1}},customRemoval:!0,attributes:{"Distance(%)":{min:.1,step:.1}}},PSY:{name:"Psychological Line",range:"0 to 100",calculateFN:e.Studies.calculatePsychologicalLine,inputs:{Period:20}},"MA Dev":{name:"Moving Average Deviation",calculateFN:e.Studies.calculateMADev,seriesFN:e.Studies.displayHistogramWithSeries,inputs:{Field:"field",Period:12,"Moving Average Type":"ma","Points Or Percent":["Points","Percent"]},outputs:{"Increasing Bar":"#00DD00","Decreasing Bar":"#FF0000"}},Shinohara:{name:"Shinohara Intensity Ratio",calculateFN:e.Studies.calculateShinohara,inputs:{Period:26},outputs:{"Strong Ratio":"#E99B54","Weak Ratio":"#5F7CB8"}}}),t},__core_=function(t,e){t.SplinePlotter||(t.SplinePlotter={});var i=t.CIQ,r=(t.$$$,t.SplinePlotter),n=function(t,e,i,r){window.splineWarning||console.log("Warning: Cannot find implementation of splining.  Try loading splines.js"),window.splineWarning=1;var n=0;i.moveTo(t[0],t[1]);for(var a=2;a<t.length;a+=2){if(r&&n<r.length){var s=r[n];s.coord[0]==t[a-2]&&s.coord[1]==t[a-1]&&(i.stroke(),i.strokeStyle=s.color,i.setLineDash(s.pattern),i.lineDashOffset=0,i.lineWidth=s.width,i.beginPath(),i.moveTo(t[a-2],t[a-1]),n++)}i.lineTo(t[a],t[a+1])}};return t.SplinePlotter.plotSpline||(t.SplinePlotter.plotSpline=n),i.getETDateTime=function(){var t=new Date;return i.convertTimeZone(new Date(t.getTime()+6e4*t.getTimezoneOffset()),"UTC","America/New_York")},i.fromET=function(t){var e=new Date,i=4;(e.getMonth()<2||2==e.getMonth()&&e.getDate()<11||e.getMonth()>10||10==e.getMonth()&&e.getDate()>=4)&&(i=5);var r=t.getTime()+36e5*i;return new Date(r)},i.convertFutureMonth=function(t){var e=t.toString();if(e.length<=0||e.length>2)return"";switch(e){case"1":return"F";case"2":return"G";case"3":return"H";case"4":return"J";case"5":return"K";case"6":return"M";case"7":return"N";case"8":return"Q";case"9":return"U";case"10":return"V";case"11":return"X";case"12":return"Z";case"F":return"1";case"G":return"2";case"H":return"3";case"J":return"4";case"K":return"5";case"M":return"6";case"N":return"7";case"Q":return"8";case"U":return"9";case"V":return"10";case"X":return"11";case"Z":return"12"}return e},i.money=function(t,e,r){return r||(r="$"),3==r.length&&(r+=" "),e||0===e||(e=2),r+i.commas((Math.round(1e4*t)/1e4).toFixed(e))},i.convertCurrencyCode=function(t){var e={JPY:"¥",USD:"$",AUD:"A$",BRL:"R$",CAD:"CA$",CNY:"CN¥",CZK:"Kč",DKK:"kr",EUR:"€",GBP:"£",HKD:"HK$",HUF:"Ft",ILS:"₪",INR:"₹",KRW:"₩",MXN:"MX$",NOK:"kr",NZD:"NZ$",PLN:"zł",RUB:"руб",SAR:"﷼",SEK:"kr",SGD:"S$",THB:"฿",TRY:"₺",TWD:"NT$",VND:"₫",XAF:"FCFA",XCD:"EC$",XOF:"CFA",XPF:"CFPF",ZAR:"R"},i=e[t];return i||t},i.commas=function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},i.alert=function(t){alert(t)},i.withinElement=function(t,e,i){var r=t.getBoundingClientRect();return!(e<=r.left)&&(!(i<=r.top)&&(!(e>=r.left+t.offsetWidth)&&!(i>=r.top+t.offsetHeight)))},i.efficientDOMUpdate=function(t,e,i){t[e]!==i&&(t[e]=i)},i.safeMouseOut=function(t,e){t.addEventListener("mouseout",function(t,e){return function(r){void 0===r.pageX&&(r.pageX=r.clientX,r.pageY=r.clientY),i.withinElement(t,r.pageX,r.pageY)||(t.stxMouseOver=!1,e(r))}}(t,e))},i.safeMouseOver=function(t,e){t.addEventListener("mouseover",function(t,e){return function(r){if(void 0===r.pageX&&(r.pageX=r.clientX,r.pageY=r.clientY),i.withinElement(t,r.pageX,r.pageY)){if(t.stxMouseOver)return;t.stxMouseOver=!0,e(r)}}}(t,e))},i.installTapEvent=function(t,e){var r=function(t){var i=document.createEvent("Event");i.initEvent("stxtap",!0,!0),void 0===t.pageX&&(t.pageX=t.clientX,t.pageY=t.clientY),i.pageX=t.pageX,i.pageY=t.pageY,t.target.dispatchEvent(i),e&&e.stopPropagation&&t.stopPropagation()};i.safeClickTouch(t,r,e)},i.safeClickTouch=function(t,e,r){function n(t,r,n){return function(a){if(!i.safeClickTouchEvent){if(!n.t)return;var s=n.t;if(n.t=null,s+1e3<(new Date).getTime())return}if(!(r.safety&&r.safety.recentlyDragged||(a||(a=event),a.which&&a.which>=2||a.button&&a.button>=2))){if(r.preventUnderlayClick)"INPUT"!==a.target.tagName&&a.preventDefault();else{if(r.lastType!=t&&Date.now()<r.allowAnotherDevice)return;r.lastType=t,r.allowAnotherDevice=Date.now()+1e3}e(a)}}}function a(t,e){return function(i){var r=i.clientX?i.clientX:i.pageX,n=i.clientY?i.clientY:i.pageY;e?(t.t=(new Date).getTime(),t.x=r,t.y=n):t.x&&Math.pow(t.x-r,2)+Math.pow(t.y-n,2)>16&&(t.t=null)}}r||(r={});var s={};r.allowMultiple||i.clearSafeClickTouches(t),!1!==r.preventUnderlayClick&&(r.preventUnderlayClick=!0),!1!==r.absorbDownEvent&&(r.absorbDownEvent=!0),r.allowAnotherDevice=0,r.registeredClick=!1;var o=t.safeClickTouchEvents;o||(o=t.safeClickTouchEvents=[]);var l=n("mouseup",r,s),h=n("touchend",r,s),c=n("pointerup",r,s),u=function(t){t.stopPropagation()},d={};if(i.safeClickTouchEvent){var p=n(i.safeClickTouchEvent,r);t.addEventListener(i.safeClickTouchEvent,p),d[i.safeClickTouchEvent]=p,o.push(d)}else"onpointerup"in document?(t.addEventListener("pointerdown",a(s,!0)),t.addEventListener("pointermove",a(s)),t.addEventListener("pointerup",c),d.pointerup=c,r.absorbDownEvent&&(t.addEventListener("pointerdown",u),d.pointerdown=u),o.push(d)):(t.addEventListener("mousedown",a(s,!0)),t.addEventListener("mousemove",a(s)),t.addEventListener("touchstart",a(s,!0)),t.addEventListener("touchmove",a(s)),t.addEventListener("mouseup",l),t.addEventListener("touchend",h),d.mouseup=l,d.touchend=h,r.absorbDownEvent&&(t.addEventListener("mousedown",u),d.mousedown=u,t.addEventListener("touchstart",u),d.touchstart=u),o.push(d))},i.clearSafeClickTouches=function(t){var e=t.safeClickTouchEvents;if(e){for(var i=0;i<e.length;i++){var r=e[i];for(var n in r){var a=r[n];t.removeEventListener(n,a)}}t.safeClickTouchEvents=null}},i.safeDrag=function(t,e,r,n){function a(t){function a(t){if(t.touches){if(t.touches.length>=1)return t.touches[0].pageX;if(t.changedTouches&&t.changedTouches.length>=1)return t.changedTouches[0].pageX}return void 0===t.pageX?t.clientX:t.pageX}function u(t){if(t.touches){if(t.touches.length>=1)return t.touches[0].pageY;if(t.changedTouches&&t.changedTouches.length>=1)return t.changedTouches[0].pageY}return void 0===t.pageY?t.clientY:t.pageY}var d={mousedown:{move:"mousemove",up:"mouseup"},pointerdown:{move:"pointermove",up:"pointerup"},touchstart:{move:"touchmove",up:"touchend"}};return function(p){if(!o){o=!0,i.ChartEngine.ignoreTouch=!0;var f=function(t){t&&t.preventDefault&&t.preventDefault(),c.recentlyDragged=!0,t.displacementX=a(t)-l,t.displacementY=u(t)-h,r(t)};r&&document.body.addEventListener(d[t].move,f),document.body.addEventListener(d[t].up,function(e){i.ChartEngine.ignoreTouch=!1,r&&document.body.removeEventListener(d[t].move,f),document.body.removeEventListener(d[t].up,arguments.callee),e.displacementX=a(e)-l,e.displacementY=u(e)-h,n&&n(e),setTimeout(function(t){return function(){t.recentlyDragged=!1}}(c),50)}),setTimeout(function(){o=!1},s),l=a(p),h=u(p),e&&e(p)}}}var s=100,o=!1,l=0,h=0,c={recentlyDragged:!1};return t.addEventListener("mousedown",a("mousedown")),t.addEventListener("pointerdown",a("pointerdown")),t.addEventListener("touchstart",a("touchstart")),c},i.isSurface&&(i.gesture=new MSGesture,i.gesture.target=document.body,i.gesturePointerId=null),i.inputKeyEvents=function(t,e){t.addEventListener("keyup",function(i){switch(window.event?event.keyCode:i.keyCode){case 13:e();break;case 27:t.value=""}},!1)},i.fixScreen=function(){window.scrollTo(0,0)},i.setCaretPosition=function(t,e){if(t.style.zIndex=5e3,t.setSelectionRange){i.focus(t);try{t.setSelectionRange(e,e)}catch(t){}}else if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveEnd("character",e),r.moveStart("character",e),r.select()}},i.setValueIfNotActive=function(t,e){document.activeElement!=t&&(t.value=e)},i.hideKeyboard=function(t){var e=document.activeElement;"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName||(e.blur(),window.focus(),t&&(t===document.body||document.body.contains(t))&&t.focus())},i.boxIntersects=function(t,e,r,n,a,s,o,l,h,c){function u(t,e){return(s-l)*t+(o-a)*e+(a*l-o*s)}var d=a,p=o;if(a>o&&(d=o,p=a),p>r&&(p=r),d<t&&(d=t),"segment"==h&&d>p)return!1;c&&(s=i.log10(s),l=i.log10(l),e=i.log10(e),n=i.log10(n));var f=s,m=l,g=o-a;if(Math.abs(g)>1e-7){var v=(l-s)/g,y=s-v*a;f=v*d+y,m=v*p+y}if(f>m){var x=m;m=f,f=x}if(m>e&&(m=e),f<n&&(f=n),"segment"==h)return f<=m;var b={a:u(t,e),b:u(t,n),c:u(r,e),d:u(r,n)};return!(b.a>0&&b.b>0&&b.c>0&&b.d>0)&&!(b.a<0&&b.b<0&&b.c<0&&b.d<0)},i.linesIntersect=function(t,e,i,r,n,a,s,o,l){var h=(o-s)*(e-t)-(a-n)*(r-i),c=(a-n)*(i-s)-(o-s)*(t-n),u=(e-t)*(i-s)-(r-i)*(t-n);if(0===h)return 0===c&&0===u;var d=c/h,p=u/h;if("segment"==l){if(d>=0&&d<=1&&p>=0&&p<=1)return!0}else if("line"==l||"horizontal"==l||"vertical"==l){if(d>=0&&d<=1)return!0}else if("ray"==l&&d>=0&&d<=1&&p>=0)return!0;return!1},i.yIntersection=function(t,e){var i=t.x0,r=t.x1,n=e,a=e,s=t.y0,o=t.y1,l=1e4*(r-i)-(a-n)*(o-s),h=(a-n)*(s-0)-1e4*(i-n),c=h/l;if(0===l){if(0!==h)return null;c=1}return s+c*(o-s)},i.xIntersection=function(t,e){var i=t.x0,r=t.x1,n=t.y0,a=t.y1,s=e,o=e,l=(o-s)*(r-i)-1e4*(a-n),h=1e4*(n-s)-(o-s)*(i-0),c=h/l;if(0===l){if(0!==h)return null;c=1}return i+c*(r-i)},i.intersectLineLineX=function(t,e,i,r,n,a,s,o){return t+((a-n)*(i-s)-(o-s)*(t-n))/((o-s)*(e-t)-(a-n)*(r-i))*(e-t)},i.intersectLineLineY=function(t,e,i,r,n,a,s,o){return i+((a-n)*(i-s)-(o-s)*(t-n))/((o-s)*(e-t)-(a-n)*(r-i))*(r-i)},i.privateBrowsingAlert=!1,i.localStorage="undefined"!=typeof localStorage?localStorage:{},i.localStorageSetItem=function(t,e){try{i.localStorage.setItem(t,e)}catch(t){i.privateBrowsingAlert||(i.alert("No storage space available.  Possible causes include browser being in Private Browsing mode, or maximum storage space has been reached."),i.privateBrowsingAlert=!0)}},i.loadUI=function(t,e){var r=document.createElement("iframe"),n=function(){var t=null;try{t=r.contentDocument||r.contentWindow.document}catch(t){return e(t)}if(t&&!t.title){var n=t.body.innerHTML,a=document.createElement("div");document.body.removeChild(r),i.innerHTML(a,n);for(var s=0;s<a.children.length;s++){var o=a.children[s].cloneNode(!0);document.body.appendChild(o)}e(null)}else e(new Error("iFrame not found or document has a title"))};r.src=t+"?"+i.uniqueID(),r.hidden=!0,r.addEventListener("load",n,!1),document.body.appendChild(r)},i.loadScript=function(t,e){if(i.loadedScripts||(i.loadedScripts={}),i.loadedScripts[t])return void(e&&e());var r=document.createElement("SCRIPT");r.async=!0,r.onload=function(){i.loadedScripts[t]=!0,e&&e()},"undefined"!=typeof isIE8&&(r.onreadystatechange=function(){"loaded"==r.readyState&&(i.loadedScripts[t]=!0,e&&setTimeout(e,0))});var n=t;n=-1==n.indexOf("?")?n+"?"+Date.now():n+"&"+Date.now(),r.src=n;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a.nextSibling)},i.loadStylesheet=function(t,e){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.media="screen",i.href=t+"?"+Date.now(),i.onload=function(){this.loaded||(this.loaded=!0,e&&e())};var r=document.getElementsByTagName("link"),n=r[r.length-1];n.parentNode.insertBefore(i,n.nextSibling)},i.loadWidget=function(t,e){i.loadStylesheet(t+".css",function(){i.loadUI(t+".html",function(r){r?e(r):i.loadScript(t+".js",e)})})},i.fillTransparentCanvas=function(t,e,i,r){var n=t.globalCompositeOperation;t.globalCompositeOperation="destination-over",t.fillStyle=e,t.fillRect(0,0,i,r),t.globalCompositeOperation=n},i.tickedRect=function(t){i.rect(t);var e=Math.round(t.top+t.height/2)+.5;t.ctx.beginPath(),t.ctx.moveTo(t.x-2,e),t.ctx.lineTo(t.x,e),t.ctx.stroke(),t.ctx.closePath()},i.roundRect=function(t,e){9===arguments.length&&(t={ctx:arguments[0],x:arguments[1],top:arguments[2],width:arguments[3],height:arguments[4],radius:arguments[5],fill:arguments[6],stroke:arguments[7],edge:arguments[8]});var r=t.stroke,n=t.x,a=t.top,s=t.width,o=t.height,l=t.radius,h=t.fill,c=t.ctx;void 0===r&&(r=!0),void 0===l&&(l=5,s<0&&(l=-5));var u=s<0?-1*l:l;l&&!e&&(n-=1);var d=n+l,p=n+s,f=a+u,m=a+o,g=p-l,v=m-u;if(c.beginPath(),c.moveTo(d,a),c.lineTo(g,a),c.quadraticCurveTo(p,a,p,f),c.lineTo(p,v),c.quadraticCurveTo(p,m,g,m),c.lineTo(d,m),"flush"==e)c.lineTo(n,m),c.lineTo(n,a);else if("arrow"==e){c.quadraticCurveTo(n,m,n-l,v);var y=s<0?1:-1;c.lineTo(n+o/2*y,a+o/2),c.lineTo(n-l,f),c.quadraticCurveTo(n,a,d,a)}else c.quadraticCurveTo(n,m,n,v),c.lineTo(n,f),c.quadraticCurveTo(n,a,d,a);c.closePath(),t.backgroundColor&&(c.fillStyle=t.backgroundColor),r&&c.stroke(),h&&c.fill(),t.txt&&i.createLabel(t)},i.createLabel=function(t){t.ctx.textBaseline="middle",t.ctx.fillStyle=t.color?t.color:i.chooseForegroundColor(t.backgroundColor),t.ctx.fillStyle===t.backgroundColor&&("#FFFFFF"==t.backgroundColor.toUpperCase()?t.ctx.fillStyle="#000000":t.ctx.fillStyle="#FFFFFF"),t.ctx.fillText(t.txt,t.x+t.margin.left,t.y+t.margin.top),t.ctx.textAlign="left"},i.roundRectArrow=function(t){i.roundRect(t,"arrow")},i.semiRoundRect=function(t){i.roundRect(t,"flush")},i.rect=function(t){t.radius=0,i.roundRect(t)},i.noop=function(t){i.createLabel(t)},i.getLines=function(t,e,i){for(var r=e.split(" "),n=[],a="",s=0,o=!1,l=0;l<r.length;l++){var h=r[l];if(s=t.measureText(a+h).width,s<i?(o&&(a+=" "),o=!0,a+=h):(n.push(a),a=h),l===r.length-1){n.push(a);break}}return n},i.readablePeriodicity=function(t){var e=t.layout.periodicity,i=t.layout.interval;return"number"==typeof t.layout.interval&&t.layout.timeUnit?(e=t.layout.interval*t.layout.periodicity,i=t.layout.timeUnit):"number"!=typeof t.layout.interval||t.layout.timeUnit||(e=t.layout.interval*t.layout.periodicity,i="minute"),e%60==0&&"minute"==i&&(e/=60,i="hour"),e+" "+t.translateIf(i.capitalize())},i.translatableTextNode=function(t,e,i){if(t.translationCallback){var r=document.createElement("translate");return r.setAttribute("original",e),r.innerHTML=t.translationCallback(e,i),r}return document.createTextNode(e)},i.clearCanvas=function(t,e){t.isDirty=!1;var r=t.context;if(r.clearRect(0,0,t.width,t.height),i.isAndroid&&!i.is_chrome){i.ChartEngine.useOldAndroidClear&&e&&(r.fillStyle=e.containerColor,r.fillRect(0,0,t.width,t.height),r.clearRect(0,0,t.width,t.height));var n=t.width;t.width=1,t.width=n}},i.monthLetters=["J","F","M","A","M","J","J","A","S","O","N","D"],i.monthAbv=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i.MILLISECOND=1,i.SECOND=1e3,i.MINUTE=60*i.SECOND,i.HOUR=60*i.MINUTE,i.DAY=24*i.HOUR,i.WEEK=7*i.DAY,i.MONTH=31*i.DAY,i.YEAR=366*i.DAY,i.DECADE=10*i.YEAR-7*i.DAY,i.monthAsDisplay=function(t,e,r){return e?r&&r.monthLetters?r.monthLetters[t]:i.monthLetters[t]:r&&r.monthAbv?r.monthAbv[t]:i.monthAbv[t]},i.timeAsDisplay=function(t,e,r){var n=e?e.internationalizer:null;if(n)return r==i.SECOND?n.hourMinuteSecond.format(t):r==i.MILLISECOND?n.hourMinuteSecond.format(t)+"."+t.getMilliseconds():n.hourMinute.format(t);var a=t.getMinutes();a<10&&(a="0"+a);var s=t.getHours()+":"+a,o="";if(r<=i.SECOND&&(o=t.getSeconds(),o<10&&(o="0"+o),s+=":"+o),r==i.MILLISECOND){var l=t.getMilliseconds();l<10?l="00"+l:l<100&&(l="0"+l),s+="."+l}return s},i.displayableDate=function(t,e,r){function n(t){return t<10?"0"+t:t}var a="",s=t.layout.interval,o=i.ChartEngine.isDailyInterval(s);if(e.xAxis.formatter)a=e.xAxis.formatter(r);else if(t.internationalizer)a=t.internationalizer.monthDay.format(r),o?a="month"==s?t.internationalizer.yearMonth.format(r):t.internationalizer.yearMonthDay.format(r):a+=" "+t.internationalizer.hourMinute.format(r);else{var l=n(r.getMonth()+1),h=n(r.getDate()),c=n(r.getHours()),u=n(r.getMinutes());if(o)a="month"==s?l+"-":l+"-"+h+"-",a+=r.getFullYear();else{a=l+"/"+h+" "+c+":"+u;var d=e.xAxis.activeTimeUnit&&e.xAxis.activeTimeUnit<=i.SECOND||"second"==t.layout.timeUnit,p=e.xAxis.activeTimeUnit&&e.xAxis.activeTimeUnit<=i.MILLISECOND||"millisecond"==t.layout.timeUnit;if(d||p){var f=n(r.getSeconds());if(a+=":"+f,p){var m=n(r.getMilliseconds());m<100&&(m="0"+m),a+=":"+m}}}}return a},i.fixPrice=function(t){if(!t&&0!==t)return null;for(var e=t.toFixed(10),i=e.length-1;i>1&&"0"==e.charAt(i);i--);return e=e.substring(0,i+1),parseFloat(e)},i.condenseInt=function(t){return null===t||void 0===t?"":t===1/0||t===-1/0?"n/a":t=t>0?t>1e12?Math.round(t/1e11)/10+"t":t>1e11?Math.round(t/1e9)+"b":t>1e10?(Math.round(t/1e8)/10).toFixed(1)+"b":t>1e9?(Math.round(t/1e7)/100).toFixed(2)+"b":t>1e8?Math.round(t/1e6)+"m":t>1e7?(Math.round(t/1e5)/10).toFixed(1)+"m":t>1e6?(Math.round(t/1e4)/100).toFixed(2)+"m":t>1e5?Math.round(t/1e3)+"k":t>1e4?(Math.round(t/100)/10).toFixed(1)+"k":t>1e3?(Math.round(t/10)/100).toFixed(2)+"k":t.toString():t<-1e12?Math.round(t/1e11)/10+"t":t<-1e9?Math.round(t/1e8)/10+"b":t<-1e6?Math.round(t/1e5)/10+"m":t<-1e3?Math.round(t/100)/10+"k":t.toString()},i.calculateTradingDecimalPlaces=function(t){var e=t.chart,i=2,r=e.masterData;if(r&&r.length>50)for(var n=2;n<50;n++){var a=r.length-n;if(a<0)break;var s=r[a];if(s.Close&&"number"==typeof s.Close){var o=s.Close.toString(),l=o.indexOf(".");if(-1!=l){var h=o.length-l-1;h>i&&(i=h)}}}var c=e.yAxis.maxDecimalPlaces;return i>c&&(i=c),i},i.fillArea=function(t,e,i){if(e.length){var n=t.chart.context,a=n.globalAlpha,s=arguments[2],o=arguments[3],l=arguments[4],h=0;i&&"object"==typeof i&&(s=i.color,o=i.opacity,h=i.tension,l=i.panelName),o||0===o||(o=.2),"auto"==s&&(s=t.defaultColor),n.globalAlpha=o,s&&(n.fillStyle=s);var c=Number.MAX_VALUE,u=-1*c,d=t.panels[l];d&&(u=d.yAxis.top,c=d.yAxis.bottom,n.save(),n.beginPath(),n.rect(d.left,u,d.width,c-u),n.clip()),n.beginPath();var p;if(h){var f=[];for(p=0;p<e.length-2;p++)f.push(e[p][0],e[p][1]);for(r.plotSpline(f,h,n),p=e.length-2;p<e.length;p++)n.lineTo(Math.round(e[p][0]),Math.round(e[p][1]))}else for(n.moveTo(e[0][0],e[0][1]),p=1;p<e.length;p++)n.lineTo(e[p][0],e[p][1]);n.closePath(),n.fill(),d&&n.restore(),n.globalAlpha=a}},i.prepareChannelFill=function(t,e){(!e||e instanceof Array)&&(e=arguments[2]);var r=t.panels[e.panelName],n=t.chart,a=(n.context.strokeStyle,{noDraw:e.noDraw}),s=i.ensureDefaults(e,{noDraw:!0,yAxis:r.yAxis}),o=t.plotDataSegmentAsLine(e.topBand,r,s),l=t.plotDataSegmentAsLine(e.bottomBand,r,s);e.noDraw=a.noDraw,e.gaps=a.gaps;for(var h=[],c=0;c<o.points.length;c+=2)h.push([o.points[c],o.points[c+1]]);for(var u=l.points.length-1;u>=0;u-=2)h.push([l.points[u-1],l.points[u]]);i.fillArea(t,h,e)},i.preparePeakValleyFill=function(t,e){(!e||e instanceof Array)&&(e=arguments[2]);var r=t.panels[e.panelName],n=r.yAxis,a=t.chart,s=a.context,o=(s.strokeStyle,{noDraw:e.noDraw}),l=t.plotDataSegmentAsLine(e.band,r,i.ensureDefaults(e,{noDraw:!0}));e.noDraw=o.noDraw;var h=e.threshold,c=e.direction,u=e.reverse,d=e.gaps;e.yAxis&&(n=e.yAxis);var p=-Number.MAX_VALUE,f=Number.MAX_VALUE,m=u?p:f;(h||0===h)&&(m=t.pixelFromPrice(h,r,n));for(var g=[],v=l.points.length,y=0;y<v;y+=2){var x,b,C=l.points[y],S=l.points[y+1];if(!isNaN(S)){S>m&&c>0||S<m&&c<0||(g.push([C,S]),p=Math.max(S,p),f=Math.min(S,f)),y<v-3&&(x=l.points[y+2],b=l.points[y+3],(S<m&&b>m||S>m&&b<m)&&(C+=(m-S)*(x-C)/(b-S),g.push([C,m])))}}if(v=g.length){var w=e.edgeParameters;if(e.edgeHighlight){w.lineWidth>100&&(w.lineWidth=1);for(var M=0;M<v-1;M++){var T=g[M],B=g[M+1];if(T[1]!=m||B[1]!=m){if(T[0]==B[0]&&t.layout.candleWidth>=1){if(T[1]==m&&g[M-1]&&g[M-1][1]==m)continue;if(B[1]==m&&g[M+2]&&g[M+2][1]==m)continue}t.plotLine(T[0],B[0],T[1],B[1],e.edgeHighlight,"segment",a.context,!0,w)}}}h||0===h||(m=u?Math.min(f,n.top):Math.max(p,n.bottom)),g.push([g[v-1][0],m],[g[0][0],m]);var k=e.opacity;if(k||0===k||(e.opacity=.3),i.fillArea(t,g,e),d&&d.color&&d.fillMountain&&!e.tension&&!i.isTransparent(d.color)&&!i.isTransparent(e.color)){if(s.save(),s.fillStyle instanceof CanvasGradient){var D=s.createLinearGradient(0,1===c?r.top:r.bottom,0,m);D.addColorStop(0,i.hexToRgba(i.colorToHex(d.color),60)),D.addColorStop(1,i.hexToRgba(i.colorToHex(d.color),10)),s.fillStyle=D}else s.fillStyle=d.color;var A=[],F={opacity:e.opacity,panelName:e.panelName};for(y=0;y<l.gapAreas.length;y++){var _=l.gapAreas[y],P=_.start,E=_.end,L=_.threshold;P?A=[[P[0],P[1]],[P[0],L]]:A.push([E[0],L],[E[0],e.step?A[0][1]:E[1]]),4==A.length&&(i.fillArea(t,A,F),e.step?(t.plotLine(A[0][0],A[3][0],A[0][1],A[0][1],d,"segment",s,!0,d),t.plotLine(A[3][0],A[3][0],A[0][1],A[3][1],d,"segment",s,!0,d)):t.plotLine(A[0][0],A[3][0],A[0][1],A[3][1],d,"segment",s,!0,d))}s.restore()}e.opacity=k}},i.fillIntersecting=function(t,e,r){(!r||r instanceof Array)&&(r=arguments[3]);var n=r.topBand,a=r.bottomBand,s=r.topSubBand,o=r.bottomSubBand,l=r.topColor,h=r.bottomColor,c=e;c.panel&&(c.outputs&&c.outputMap&&(l||(l=c.outputs[c.outputMap[n]]),h||(h=c.outputs[c.outputMap[a]])),c=c.panel),c=t.panels[c];var u=t.chart.context,d=t.scratchContext;if(!d){var p=u.canvas.cloneNode(!0);d=t.scratchContext=p.getContext("2d"),d.canvas=p}d.canvas.height=u.canvas.height,d.canvas.width=u.canvas.width,d.drawImage(u.canvas,0,0),u.clearRect(0,0,u.canvas.width,u.canvas.height);var f=.3;r.opacity&&(f=r.opacity),u.save(),u.globalCompositeOperation="xor";var m={band:n,subField:s,color:l,opacity:1,panelName:c.name,yAxis:r.topAxis,skipTransform:r.skipTransform,tension:r.tension};i.preparePeakValleyFill(t,m),i.extend(m,{band:a,subField:o,color:h,yAxis:r.bottomAxis}),i.preparePeakValleyFill(t,m),u.globalAlpha=f,u.globalCompositeOperation="copy",u.scale(1/t.adjustedDisplayPixelRatio,1/t.adjustedDisplayPixelRatio),u.drawImage(u.canvas,0,0),u.globalAlpha=1,u.globalCompositeOperation="destination-over",u.drawImage(t.scratchContext.canvas,0,0),u.restore()},i.drawLegendItem=function(t,e,i,r,n){n||(n=1);var a=e[0],s=e[1],o=t.chart.context;return o.globalAlpha=n,o.fillStyle=r,o.fillRect(a,s,10,10),o.globalAlpha=1,a+=12,o.fillStyle=t.defaultColor,o.fillText(i,a,s),a+=o.measureText(i).width+6,[a,s]},i.drawLegend=function(t,e){var r=e.coordinates,n=t.chart.context;n.textBaseline="top";var a=n.font;t.canvasFont("stx-legend",n),r||(r=e.chart.legend);for(var s=[r.x,r.y],o=t.defaultColor,l=0;l<2;l++)for(var h in e.legendColorMap){var c=e.legendColorMap[h];if((!c.isBase||!l&&!e.noBase)&&(c.isBase||l)){var u;if(c.color instanceof Array){var d=c.color;for(u=d.length-1;u>=0;u--)i.isTransparent(d[u])&&d.splice(u,1);if(d.length>1){var p=n.createLinearGradient(s[0],s[1],s[0]+10,s[1]);for(u=0;u<d.length;u++)p.addColorStop(u/(d.length-1),d[u]);o=p}else o=d.length>0?d[0]:t.getCanvasColor("stx_line_chart")}else o=null;if(o){var f=h;c.display&&(f=c.display),f||(f=e.chart.symbolDisplay?e.chart.symbolDisplay:e.chart.symbol),s=i.drawLegendItem(t,s,f,o,c.opacity)}}}n.font=a},i.minMax=function(t,e,i,r){var n=Number.MAX_VALUE,a=-1*Number.MAX_VALUE;i||(i="Close");for(var s=r?"High":i,o=r?"Low":i,l=0;l<t.length;l++){var h=t[l];if(h){var c=h[e];if(c||0===c){var u=c;"object"==typeof c&&(u=c[s]),isNaN(u)||!u&&0!==u||(a=Math.max(a,u)),"object"==typeof c&&(u=c[o]),isNaN(u)||!u&&0!==u||(n=Math.min(n,u))}}}return[n,a]},i.symbolEqual=function(t,e){if(!t||!e)return!1;if("object"!=typeof t&&(t={symbol:t}),"object"!=typeof e&&(e={symbol:e}),"function"==typeof t.equals)return t.equals(e);var i=t.symbol,r=e.symbol;return i&&(i=i.toUpperCase()),r&&(r=r.toUpperCase()),i==r&&t.source==e.source},i.addMemberToMasterdata=function(t){function e(t,e){if(s&&s.length)if("*"==s[0])i.extend(t,e);else for(var r=0;r<s.length;r++)t[s[r]]=e[s[r]];else o?t[n]=e:l?t[n]=e[l]:v&&g&&void 0!==e[g]?t[n]=e[g]:m.adj&&void 0!==e.Adj_Close?t[n]=e.Adj_Close:void 0!==e.Close?t[n]=e.Close:void 0!==e.Value?t[n]=e.Value:t[n]=e[n]}t.constructor===i.ChartEngine&&(t={stx:arguments[0],label:arguments[1],data:arguments[2],fields:arguments[3],createObject:arguments[4],fieldForLabel:arguments[5]});var r=t.stx,n=t.label,a=t.data,s=t.fields,o=t.createObject,l=t.fieldForLabel;if(a&&a.constructor==Object&&(a=[a]),a&&a.length){r.doCleanupDates(a,r.layout.interval);var h,c,u=t.chart?t.chart:r.chart,d=0,p=0,f=u.masterData,m=r.layout;f||(f=[]);for(var g=r.chart&&r.chart.defaultPlotField?r.chart.defaultPlotField:null,v=!r.chart.highLowBars&&!r.highLowBars[r.layout.chartType];a&&d<f.length&&p<a.length;)c=a[p],h=f[d],c.DT&&void 0!==c.DT?("number"==typeof c.DT&&(c.DT=new Date(c.DT)),c.Date&&17==c.Date.length||(c.Date=i.yyyymmddhhmmssmmm(c.DT))):c.DT=i.strToDateTime(c.Date),+c.DT!=+h.DT?c.DT<h.DT?f.splice(d,0,{DT:c.DT,Date:c.Date}):d++:(e(h,c),p++,d++);if(d>=f.length)for(;a&&p<a.length;)c=a[p],c.DT&&void 0!==c.DT?("number"==typeof c.DT&&(c.DT=new Date(c.DT)),c.Date&&17==c.Date.length||(c.Date=i.yyyymmddhhmmssmmm(c.DT))):c.DT=i.strToDateTime(c.Date),h={DT:c.DT,Date:c.Date},e(h,c),f.push(h),p++;if(t.fillGaps&&f.length)for(var y=f[0],x=1;x<f.length;x++){var b=f[x];if(s)for(var C=0;C<s.length;C++){var S=s[C];void 0===b[S]&&void 0!==y[S]&&(b[S]=y[S])}else void 0===b[n]&&void 0!==y[n]&&(b[n]=y[n]);y=b}u.series[n]&&(u.series[n].lastQuote=h[n]),r.setMasterData(f,u)}},i.ThemeHelper=function(t){this.params=t;var e=t.stx,r="#FFFFFF"
;e.chart.container&&(r=getComputedStyle(e.chart.container).backgroundColor,i.isTransparent(r)&&(r=e.containerColor)),this.settings.chart.Background.color=i.hexToRgba(r),this.settings.chart["Grid Lines"].color=i.hexToRgba(e.canvasStyle("stx_grid").color),this.settings.chart["Grid Dividers"].color=i.hexToRgba(e.canvasStyle("stx_grid_dark").color),this.settings.chart["Axis Text"].color=i.hexToRgba(e.canvasStyle("stx_xaxis").color),this.settings.chartTypes["Candle/Bar"].up.color=i.hexToRgba(e.canvasStyle("stx_candle_up").color),this.settings.chartTypes["Candle/Bar"].down.color=i.hexToRgba(e.canvasStyle("stx_candle_down").color),this.settings.chartTypes["Candle/Bar"].up.wick=i.hexToRgba(e.canvasStyle("stx_candle_shadow_up").color),this.settings.chartTypes["Candle/Bar"].down.wick=i.hexToRgba(e.canvasStyle("stx_candle_shadow_down").color),this.settings.chartTypes["Candle/Bar"].even.wick=i.hexToRgba(e.canvasStyle("stx_candle_shadow_even").color),this.settings.chartTypes["Candle/Bar"].up.border=i.hexToRgba(e.canvasStyle("stx_candle_up").borderLeftColor),this.settings.chartTypes["Candle/Bar"].down.border=i.hexToRgba(e.canvasStyle("stx_candle_down").borderLeftColor),i.isTransparent(e.canvasStyle("stx_candle_up").borderLeftColor)&&(this.settings.chartTypes["Candle/Bar"].up.border=null),i.isTransparent(e.canvasStyle("stx_candle_down").borderLeftColor)&&(this.settings.chartTypes["Candle/Bar"].down.border=null),this.settings.chartTypes.Line.color=i.hexToRgba(e.canvasStyle("stx_line_chart").color),this.settings.chartTypes.Mountain.color=i.hexToRgba(e.canvasStyle("stx_mountain_chart").backgroundColor)},i.ThemeHelper.prototype.settings={chart:{Background:{color:null},"Grid Lines":{color:null},"Grid Dividers":{color:null},"Axis Text":{color:null}},chartTypes:{"Candle/Bar":{up:{color:null,wick:null,border:null},down:{color:null,wick:null,border:null},even:{color:null,wick:null,border:null}},Line:{color:null},Mountain:{color:null}}},i.ThemeHelper.prototype.update=function(t){function e(e,i,n){var a=r[e];for(var s in a)t.setStyle(s,i,n)}t||(t=this.params.stx);var r={stx_candle_up:{stx_candle_up:!0,stx_bar_up:!0,stx_hollow_candle_up:!0,stx_line_up:!0,stx_baseline_up:!0},stx_candle_down:{stx_candle_down:!0,stx_bar_down:!0,stx_hollow_candle_down:!0,stx_line_down:!0,stx_baseline_down:!0},stx_shadow_up:{stx_candle_shadow_up:!0},stx_shadow_down:{stx_candle_shadow_down:!0},stx_shadow_even:{stx_candle_shadow_even:!0},stx_line_chart:{stx_bar_chart:!0,stx_line_chart:!0},stx_grid:{stx_grid:!0},stx_grid_dark:{stx_grid_dark:!0},stx_xaxis:{stx_xaxis_dark:!0,stx_xaxis:!0,stx_yaxis:!0,stx_yaxis_dark:!0,stx_grid_border:!0},stx_mountain_chart:{stx_mountain_chart:!0},stx_market_session:{stx_market_session:!0}};t.chart.container.style.backgroundColor=this.settings.chart.Background.color,e("stx_grid","color",this.settings.chart["Grid Lines"].color),e("stx_grid_dark","color",this.settings.chart["Grid Dividers"].color),e("stx_xaxis","color",this.settings.chart["Axis Text"].color);var n=this.settings.chartTypes["Candle/Bar"];n.even||(n.even={color:null,wick:i.hexToRgba(t.canvasStyle("stx_candle_shadow_even").color),border:null}),e("stx_candle_up","color",n.up.color),e("stx_candle_down","color",n.down.color),e("stx_shadow_up","color",n.up.wick),e("stx_shadow_down","color",n.down.wick),e("stx_shadow_even","color",n.even.wick),t.setStyle("stx_candle_up","borderLeftColor",n.up.border),t.setStyle("stx_candle_down","borderLeftColor",n.down.border),e("stx_line_chart","color",this.settings.chartTypes.Line.color),t.setStyle("stx_mountain_chart","borderTopColor",this.settings.chartTypes.Mountain.color),t.setStyle("stx_mountain_chart","backgroundColor",i.hexToRgba(this.settings.chartTypes.Mountain.color,.8)),t.setStyle("stx_mountain_chart","color",i.hexToRgba(this.settings.chartTypes.Mountain.color,.1)),t.draw()},i.NameValueStore=function(){},i.NameValueStore.prototype.toJSONIfNecessary=function(t){if(t.constructor==String)return t;try{return JSON.stringify(t)}catch(e){return console.log("Cannot convert to JSON: "+t),null}},i.NameValueStore.prototype.fromJSONIfNecessary=function(t){try{return JSON.parse(t)}catch(e){return t}},i.NameValueStore.prototype.get=function(t,e){var r=i.localStorage.getItem(t);e&&e(null,this.fromJSONIfNecessary(r))},i.NameValueStore.prototype.set=function(t,e,r){i.localStorageSetItem(t,this.toJSONIfNecessary(e)),r&&r(null)},i.NameValueStore.prototype.remove=function(t,e){i.localStorage.removeItem(t),e&&e(null)},i.Plotter=function(){this.seriesArray=[],this.seriesMap={}},i.Plotter.prototype={Series:function(t,e,r,n,a,s){this.name=t,this.strokeOrFill=e,this.color=r,this.moves=[],this.text=[],(!n||n>1||n<0)&&(n=1),this.opacity=n,(!a||a>25||a<1)&&(a=1),this.width=a,this.pattern=i.borderPatternToArray(a,s)},newSeries:function(t,e,i,r,n){var a;a=i.constructor==String?new this.Series(t,e,i,r,n):new this.Series(t,e,i.color,i.opacity,n,i.borderTopStyle),this.seriesArray.push(a),this.seriesMap[t]=a},reset:function(t){for(var e in this.seriesMap)if(!t||t==e){var i=this.seriesMap[e];i&&(i.moves=[],i.text=[])}},moveTo:function(t,e,i){this.seriesMap[t].moves.push({action:"moveTo",x:e,y:i})},lineTo:function(t,e,i){var r=this.seriesMap[t],n=r.pattern;r.moves.push({action:"lineTo",x:e,y:i,pattern:n})},dashedLineTo:function(t,e,i,r){this.seriesMap[t].moves.push({action:"lineTo",x:e,y:i,pattern:r})},quadraticCurveTo:function(t,e,i,r,n){var a=this.seriesMap[t],s=a.pattern;a.moves.push({action:"quadraticCurveTo",x0:e,y0:i,x:r,y:n,pattern:s})},bezierCurveTo:function(t,e,i,r,n,a,s){var o=this.seriesMap[t],l=o.pattern;o.moves.push({action:"bezierCurveTo",x0:e,y0:i,x1:r,y1:n,x:a,y:s,pattern:l})},addText:function(t,e,i,r,n,a,s){this.seriesMap[t].text.push({text:e,x:i,y:r,bg:n})},drawText:function(t,e){for(var i=0;i<e.text.length;i++){var r=e.text[i];if(r.bg){var n=r.width?r.width:t.measureText(r.text).width,a=r.height?r.height:12,s=t.fillStyle;t.fillStyle=r.bg,"right"==t.textAlign?t.fillRect(r.x,r.y+a/2,-n,-a):t.fillRect(r.x,r.y+a/2,n,a),t.fillStyle=s}t.fillText(r.text,r.x,r.y)}},draw:function(t,e){for(var i=t.lineWidth,r=t.fillStyle,n=t.strokeStyle,a=t.globalAlpha,s=0;s<this.seriesArray.length;s++){var o=this.seriesArray[s];if(!e||o.name==e){t.beginPath(),t.lineWidth=o.width,t.globalAlpha=o.opacity,t.fillStyle=o.color,t.strokeStyle=o.color,t.save();for(var l=0;l<o.moves.length;l++){var h=o.moves[l];h.pattern?(t.setLineDash(h.pattern),t.lineDashOffset=0):t.setLineDash([]),"quadraticCurveTo"==h.action?t[h.action](h.x0,h.y0,h.x,h.y):"bezierCurveTo"==h.action?t[h.action](h.x0,h.y0,h.x1,h.y1,h.x,h.y):t[h.action](h.x,h.y)}"fill"==o.strokeOrFill?t.fill():t.stroke(),t.closePath(),t.restore(),this.drawText(t,o),t.lineWidth=1}}t.lineWidth=i,t.fillStyle=r,t.strokeStyle=n,t.globalAlpha=a}},i.EaseMachine=function(t,e,i,r){this.fc=t,this.ms=e,(i||0===i)&&this.reset(i,r)},i.EaseMachine.prototype.reset=function(t,e){t||0===t||(t=this.currentValues),this.hasCompleted=!1,this.running=!1,this.okayToRun=!0,this.useNameValuePairs="object"==typeof e,this.startTime=Date.now(),this.useNameValuePairs?(this.startValues=t,this.endValues=e):(this.startValues={default:t},this.endValues={default:e}),this.changeValues={},this.currentValues={};for(var i in this.startValues)this.changeValues[i]=this.endValues[i]-this.startValues[i]},i.EaseMachine.prototype.next=function(){var t=Date.now();t>=this.startTime+this.ms&&(t=this.startTime+this.ms,this.hasCompleted=!0,this.running=!1),this.currentValues={};for(var e in this.changeValues)this.currentValues[e]=this.fc(t-this.startTime,this.startValues[e],this.changeValues[e],this.ms);return this.useNameValuePairs?this.currentValues:this.currentValues.default},i.EaseMachine.prototype.hasCompleted=!0,i.EaseMachine.prototype.run=function(t,e,i,r){function n(){if(a.afid=null,a.okayToRun){var e=a.next();t(e),a.hasCompleted||(a.afid=requestAnimationFrame(n))}}this.afid&&cancelAnimationFrame(this.afid),e||0===e?this.reset(e,i):(i||0===i)&&this.reset(this.currentValues,i);var a=this;this.running=!0,r?this.afid=requestAnimationFrame(n):n()},i.EaseMachine.prototype.stop=function(){return this.afid&&cancelAnimationFrame(this.afid),this.afid=null,this.okayToRun=!1,this.running=!1,void 0===this.useNameValuePairs?{}:this.useNameValuePairs?this.currentValues:this.currentValues.default},i.Renderer=function(){},i.Renderer.produce=function(t,e){var r=null;if(t)for(var n in i.Renderer){var a=i.Renderer[n];if(a.requestNew&&(r=a.requestNew(t.split("_"),e)),r)return r}return e.type="line",new i.Renderer.Lines({params:e})},i.Renderer.colorFunctions={},i.Renderer.registerColorFunction=function(t,e){i.Renderer.colorFunctions[t]=e},i.Renderer.unregisterColorFunction=function(t){delete i.Renderer.colorFunctions[t]},i.Renderer.prototype.performCalculations=function(){},i.Renderer.prototype.draw=function(){},i.Renderer.prototype.drawIndividualSeries=function(t,e){},i.Renderer.prototype.construct=function(t){t||(t={});var e=t.params?t.params:{};e.name||(e.name=i.uniqueID()),e.heightPercentage||(e.heightPercentage=.7),e.opacity||(e.opacity=1),!1!==e.highlightable&&(e.highlightable=!0),e.panel||(e.panel="chart"),this.cb=t.callback,this.params=e,this.seriesParams=[],this.caches={},this.colors={}},i.Renderer.prototype.attachSeries=function(t,e){var r=this.stx;if(!r)return this;var n=this.stx.chart.series[t];n||(n={parameters:{}});var a=this.params,s=(n.parameters,{id:t,chartType:a.type,display:n.parameters.display,border_color_up:a.defaultBorders?"auto":null,fill_color_up:n.parameters.color,opacity_up:a.opacity,border_color_down:a.defaultBorders?"auto":null,fill_color_down:n.parameters.color,opacity_down:a.opacity,color:n.parameters.color,symbol:n.parameters.symbol,symbolObject:i.clone(n.parameters.symbolObject)});if("string"==typeof e)s.color=s.fill_color_down=s.fill_color_up=e;else if("object"==typeof e){for(var o in e)s[o]=e[o];var l=s.color,h=s.border_color;l&&(s.fill_color_up||(s.fill_color_up=l),s.fill_color_down||(s.fill_color_down=l),s.fill_color_even||(s.fill_color_even=l)),h&&(s.border_color_up||(s.border_color_up=h),s.border_color_down||(s.border_color_down=h),s.border_color_even||(s.border_color_even=h))}return s.symbol&&s.field!=s.symbol&&(s.subField=s.field,s.field=s.symbol),s.symbol||s.field||this.highLowBars||(s.field="Close"),s.id||(s.id=i.uniqueID()),this.removeSeries(t,!0).seriesParams.push(s),s.fill_color_up!=s.fill_color_down?(this.colors[t+" up"]={color:s.fill_color_up,opacity:s.opacity_up,display:s.display?s.display+" up":t+" up"},this.colors[t+" dn"]={color:s.fill_color_down,opacity:s.opacity_down,display:s.display?s.display+" down":t+" down"}):this.colors[t]={color:s.fill_color_up,opacity:s.opacity_up,display:s.display?s.display:t},a.yAxis&&(a.yAxis=r.addYAxis(r.panels[a.panel],a.yAxis),a.yAxis.needsInitialPadding=!0),this},i.Renderer.prototype.removeSeries=function(t,e){for(var i=0;i<this.seriesParams.length;i++)if(this.seriesParams[i].id==t){this.seriesParams.splice(i,1);break}if(delete this.colors[t+" up"],delete this.colors[t+" dn"],delete this.colors[t],!e){var r=!1;for(var n in this.stx.chart.seriesRenderers){for(var a=this.stx.chart.seriesRenderers[n],s=0;s<a.seriesParams.length;s++)if(a.seriesParams[s].id==t){r=!0;break}if(r)break}r||this.stx.deleteSeries(t,this.stx.chart)}return this.stx.deleteYAxisIfUnused(this.stx.panels[this.params.panel],this.params.yAxis),this},i.Renderer.prototype.removeAllSeries=function(t){if(t){for(var e=[],i=0;i<this.seriesParams.length;i++)e.push(this.seriesParams[i].id);for(var r=0;r<e.length;r++)this.removeSeries(e[r])}return this.seriesParams=[],this.colors={},this.stx.deleteYAxisIfUnused(this.stx.panels[this.params.panel],this.params.yAxis),this},i.Renderer.prototype.ready=function(){return this.stx.createDataSet(),this.stx.draw(),this},i.Renderer.Lines=function(t){this.construct(t);var e=this.params;if(e.type||(e.type="line"),!e.style)switch(e.type){case"mountain":e.baseline?e.style="stx_baseline_delta_mountain":e.colored?e.style="stx_colored_mountain_chart":e.style="stx_mountain_chart";break;default:e.style="stx_line_chart"}this.supportsAnimation=!0,"wave"==e.type?(e.step=e.vertex=e.baseline=e.colored=!1,this.highLowBars=this.barsHaveWidth=!0,this.supportsAnimation=!1):"step"==e.type&&(e.step=!0)},i.Renderer.Lines.ciqInheritsFrom(i.Renderer,!1),i.Renderer.Lines.requestNew=function(t,e){for(var r=null,n=!1,a=!1,s=!1,o=!1,l=0;l<t.length;l++){var h=t[l];switch(h){case"line":case"mountain":case"wave":r=h;break;case"baseline":s=!0;break;case"colored":a=!0;break;case"step":n=!0;break;case"vertex":o=!0;break;case"delta":break;default:return null}}return null!==r||s||n?new i.Renderer.Lines({params:i.extend(e,{type:r,step:n,colored:a,baseline:s,vertex:o})}):null},i.Renderer.Lines.prototype.performCalculations=function(t){var e=this.params.yAxis,r=this.stx;if(e){for(var n=r.panels[this.params.panel],a=[],s=0;s<this.seriesParams.length;s++){var o=this.seriesParams[s].field,l=this.seriesParams[s].subField||"Close";a.push(o),"Close"==o?a.push("iqPrevClose"):a=a.concat(i.createObjectChainNames(o,[l,"iqPrevClose"]))}var h=r.determineMinMax(r.chart.dataSegment,a,!1,!0);t&&t.length&&(h[0]=Math.min(t[0],h[0]),h[1]=Math.max(t[1],h[1])),r.calculateYAxisRange(n,e,h[0],h[1]),e.needsInitialPadding&&(r.calculateYAxisMargins(e),e.needsInitialPadding=!1)}},i.Renderer.Lines.prototype.draw=function(){var t,e=this.stx,r=this.stx.panels[this.params.panel],n=r.chart,a={},s=this.seriesParams,o=this.params.colorFunction;for(this.params.vertex&&!e.scatter&&(console.warn("Error, vertex option requires customChart.js"),this.params.vertex=!1),t=0;t<s.length;t++){var l=s[t];if(this.params.colored){for(var h=["_color_up","_color_down","_color"],c=0;c<h.length;c++){var u=l["border"+h[c]];u&&"auto"!=u&&(l["fill"+h[c]]=u)}o||(o=function(t){var i=t.fill_color_up||e.getCanvasColor("stx_line_up"),r=t.fill_color_down||e.getCanvasColor("stx_line_down"),n=t.color||e.getCanvasColor("stx_line_chart");return function(t,e,a){return e.iqPrevClose||0===e.iqPrevClose?e.Close>e.iqPrevClose?i:e.Close<e.iqPrevClose?r:n:n}}(l)),this.params.colorFunction=o}var d={};n.series[l.id]&&(d=i.clone(n.series[l.id].parameters)),a[l.id]={parameters:i.extend(i.extend(d,this.params),l),yValueCache:this.caches[l.id]},this==e.mainSeriesRenderer&&n.customChart&&n.customChart.colorFunction&&(a[l.id].parameters.colorFunction=n.customChart.colorFunction)}e.drawSeries(n,a,this.params.yAxis,this);for(t in a)this.caches[t]=a[t].yValueCache},i.Renderer.Lines.prototype.drawIndividualSeries=function(t,e){if(!e.invalid){var r=this.stx,n=t.context,a=null,s=e.colorFunction,o=r.panels[e.panel]||t.panel;if("string"!=typeof s||(s=i.Renderer.colorFunctions[s]))return e.vertex&&(n.save(),n.lineJoin="bevel"),"wave"==e.type?a=r.drawWaveChart(o,e):e.baseline?a=r.drawBaselineChart(o,e):"mountain"==e.type?(e.returnObject=!0,a=r.drawMountainChart(o,e,s)):(e.returnObject=!0,a=r.drawLineChart(o,e.style,s,e)),e.vertex&&(r.scatter(o,{yAxis:e.yAxis,field:e.field,subField:e.subField,symbol:e.symbol,color:e.vertex_color,overlayScaling:e.overlayScaling}),n.restore()),a}},i.Renderer.OHLC=function(t){this.construct(t);var e=this.params;e.type||(e.type="candle"),this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.histogram&&(e.type="candle",this.highLowBars=!1,e.volume=e.hollow=!1),"bar"==e.type&&(e.volume=e.hollow=e.histogram=!1),"candle"==e.type&&(e.hlc=e.colored=!1),e.volume&&(e.hollow=!0)},i.Renderer.OHLC.ciqInheritsFrom(i.Renderer,!1),i.Renderer.OHLC.requestNew=function(t,e){for(var r=null,n=!1,a=!1,s=!1,o=!1,l=!1,h=0;h<t.length;h++){var c=t[h];switch(c){case"bar":case"candle":r=c;break;case"volume":o=!0;break;case"hollow":s=!0;break;case"colored":a=!0;break;case"histogram":l=!0,r="candle";break;case"hlc":n=!0,r="bar";break;default:return null}}return null===r?null:new i.Renderer.OHLC({params:i.extend(e,{type:r,hlc:n,colored:a,hollow:s,volume:o,histogram:l})})},i.Renderer.OHLC.prototype.performCalculations=function(t){var e=this.params.yAxis,r=this.stx;if(e){for(var n=r.panels[this.params.panel],a=[],s=0;s<this.seriesParams.length;s++){var o=this.seriesParams[s].field;a=a.concat(i.createObjectChainNames(o,["Close","High","Low","Open","iqPrevClose"]))}var l=r.determineMinMax(r.chart.dataSegment,a,!1,!0);t&&t.length&&(l[0]=Math.min(t[0],l[0]),l[1]=Math.max(t[1],l[1])),r.calculateYAxisRange(n,e,l[0],l[1]),e.needsInitialPadding&&(r.calculateYAxisMargins(e),e.needsInitialPadding=!1)}},i.Renderer.OHLC.prototype.draw=function(){var t,e=this.stx,r=this.stx.panels[this.params.panel],n=r.chart,a={},s=this.seriesParams;for(t=0;t<s.length;t++){var o=s[t],l={};n.series[o.id]&&(l=i.clone(n.series[o.id].parameters)),a[o.id]={parameters:i.extend(i.extend(l,this.params),o)},this==e.mainSeriesRenderer&&n.customChart&&n.customChart.colorFunction&&(a[o.id].parameters.colorFunction=n.customChart.colorFunction)}e.drawSeries(n,a,this.params.yAxis,this);for(t in a)a[t].yValueCache&&(this.caches[t]=a[t].yValueCache)},i.Renderer.OHLC.prototype.getColor=function(t,e,r,n,a,s){var o=s||r.color;if(n&&!(o=s||r.borderLeftColor||r["border-left-color"]))return null;if(!a)return o;var l=t.pixelFromTransformedValue(e.chart.highValue,e);isNaN(l)&&(l=0);var h=r.backgroundColor;if(o&&!i.isTransparent(o)){var c=t.chart.context.createLinearGradient(0,l,0,2*e.yAxis.bottom-l);return c.addColorStop(0,o),c.addColorStop(1,h),c}return h},i.Renderer.OHLC.prototype.drawIndividualSeries=function(t,e){if(!e.invalid){var r=this.stx,n=(t.context,e.colorFunction),a=r.panels[e.panel]||t.panel;if("string"!=typeof n||(n=i.Renderer.colorFunctions[n])){var s=r.layout.candleWidth-t.tmpWidth<=2&&t.tmpWidth<=3;t.state.chartType||(t.state.chartType={});var o=t.state.chartType.pass={},l=r.colorByCandleDirection;e.colorBasis&&(l="open"==e.colorBasis);var h=e.histogram,c=e.type,u=e.hollow,d=r.noWicksOnCandles[c];r.startClip(a.name);var p=null,f={colors:[],cache:[]},m=[];if(n){var g={isHistogram:h,field:e.field,yAxis:e.yAxis,volume:e.volume,overlayScaling:e.overlayScaling,highlight:e.highlight};h||"bar"!=c?("candle"!=c||d||r.drawShadows(a,n,g),f=r.drawCandles(a,n,g),g.isOutline=!0,!u&&s||r.drawCandles(a,n,g)):(g.type=e.hlc?"hlc":"bar",f=r.drawBarChart(a,"stx_bar_chart",n,g))}else for(var v=h&&!1!==e.gradient,y=[{type:"histogram",drawType:"histogram",style:"stx_histogram_up",condition:8,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0,useBorderStyleProp:!0},{type:"histogram",drawType:"histogram",style:"stx_histogram_down",condition:16,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0,useBorderStyleProp:!0},{type:"histogram",drawType:"histogram",style:"stx_histogram_even",condition:32,fill:"fill_color_even",border:"border_color_even",skipIfPass:!0,useColorInMap:!0,useBorderStyleProp:!0},{type:"bar",drawType:"bar",style:e.style||"stx_bar_chart",useColorInMap:!0},{type:"bar",drawType:"bar",style:"stx_bar_up",condition:l?8:1,border:"border_color_up",useColorInMap:!0},{type:"bar",drawType:"bar",style:"stx_bar_down",condition:l?16:2,border:"border_color_down",useColorInMap:!0},{type:"bar",drawType:"bar",style:"stx_bar_even",condition:l?32:4,border:"border_color_even",skipIfPass:!0,useColorInMap:!0},{type:"candle",drawType:"shadow",style:"stx_candle_shadow",border:"border_color_up"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_up",condition:8,border:"border_color_up"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_down",condition:16,border:"border_color_down"},{type:"candle",drawType:"shadow",style:"stx_candle_shadow_even",condition:32,border:"border_color_even",skipIfPass:!0},{type:"candle",drawType:"candle",style:"stx_candle_up",condition:8,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0,useBorderStyleProp:!0},{type:"candle",drawType:"candle",style:"stx_candle_down",condition:16,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0,useBorderStyleProp:!0},{type:"hollow",drawType:"shadow",style:"stx_hollow_candle_up",condition:1,border:"border_color_up"},{type:"hollow",drawType:"shadow",style:"stx_hollow_candle_down",condition:2,border:"border_color_down"},{type:"hollow",drawType:"shadow",style:"stx_hollow_candle_even",condition:4,border:"border_color_even",skipIfPass:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_up",condition:17,fill:"fill_color_up",border:"border_color_up",useColorInMap:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_down",condition:18,fill:"fill_color_down",border:"border_color_down",useColorInMap:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_even",condition:20,fill:"fill_color_even",border:"border_color_even",skipIfPass:!0,useColorInMap:!0},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_up",condition:9,fill:"fill_color_up",border:"border_color_up"},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_down",condition:10,fill:"fill_color_down",border:"border_color_down"},{type:"hollow",drawType:"candle",style:"stx_hollow_candle_even",condition:12,fill:"fill_color_even",border:"border_color_even"}],x=0;x<y.length;x++){var b=y[x];if(!b.skipIfPass||o.even){if(h){if("histogram"!=b.type)continue}else if("bar"==c){if("bar"!=b.type)continue;if(e.colored&&!b.condition)continue;if(!e.colored&&b.condition)continue}else if(u){if("hollow"!=b.type)continue;if("shadow"==b.drawType&&d)continue}else{if("candle"!=c)continue;if("candle"!=b.type)continue;if("shadow"==b.drawType){if(d)continue;var C=e.border_color_up||r.getCanvasColor("stx_candle_shadow_up"),S=e.border_color_down||r.getCanvasColor("stx_candle_shadow_down"),w=e.border_color_even||r.getCanvasColor("stx_candle_shadow_even");if(i.colorsEqual(C,S)&&i.colorsEqual(C,w)&&i.colorsEqual(C,r.defaultColor)){if(b.condition)continue}else if(!b.condition)continue}}var M=r.canvasStyle(b.style),T=this.getColor(r,a,M,!1,!1,e[b.fill]),B=this.getColor(r,a,M,!1,v,e[b.fill]),k=this.getColor(r,a,M,b.useBorderStyleProp&&!s,v,e[b.border]);"candle"==b.drawType&&("hollow"==b.type?(!i.isTransparent(B)&&i.colorsEqual(k,B)&&(k=b.useColorInMap?"transparent":B),b.useColorInMap||(B=r.containerColor)):"candle"==b.type&&s&&(i.isTransparent(B)?B=k:k=B)),m.push(r.drawBarTypeChartInner({fillColor:B,borderColor:k,condition:b.condition,style:b.style,type:e.hlc?"hlc":b.drawType,panel:a,field:e.field,yAxis:e.yAxis,volume:e.volume,overlayScaling:e.overlayScaling,highlight:e.highlight})),p||(p={}),b.useColorInMap&&(p[T]=1)}}r.endClip();for(var D in p)e.hollow&&i.equals(D,r.containerColor)||f.colors.push(D);for(D=0;D<m.length;D++)for(var A=0;A<m[D].cache.length;A++){var F=m[D].cache[A];(F||0===F)&&(f.cache[A]=F)}return f}}},i.Renderer.Bars=function(t){this.construct(t);var e=this.params;e.type="bar",this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.hlc=e.volume=e.hollow=e.histogram=!1},i.Renderer.Bars.ciqInheritsFrom(i.Renderer.OHLC,!1),i.Renderer.HLC=function(t){this.construct(t);var e=this.params;e.type="bar",e.hlc=!0,this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.volume=e.hollow=e.histogram=!1},i.Renderer.HLC.ciqInheritsFrom(i.Renderer.Bars,!1),i.Renderer.Candles=function(t){this.construct(t);var e=this.params;e.type="candle",this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,e.hlc=e.colored=e.histogram=!1,e.volume&&(e.hollow=!0)},i.Renderer.Candles.ciqInheritsFrom(i.Renderer.OHLC,!1),i.Renderer.SimpleHistogram=function(t){this.construct(t);var e=this.params;e.type="candle",e.histogram=!0,this.barsHaveWidth=this.standaloneBars=!0,this.highLowBars=!1,e.hlc=e.colored=e.hollow=e.volume=!1},i.Renderer.SimpleHistogram.ciqInheritsFrom(i.Renderer.Candles,!1),t},__engine_=function(t,e){var i=t.CIQ,r=t.$$,n=t.$$$,a=t.SplinePlotter,s=t.timezoneJS;return i.ChartEngine=function(t){if(t||(t={container:null}),t.constructor==HTMLDivElement){t={container:t}}if(this.markers={},this.panels={},this.overlays={},this.charts={},this.eventListeners=[],this.animations={zoom:new i.EaseMachine(Math.easeOutCubic,400)},this.callbacks={studyOverlayEdit:null,studyPanelEdit:null,tap:null,rightClick:null,longhold:null,move:null,layout:null,drawing:null,preferences:null,theme:null,symbolChange:null,symbolImport:null,calculateTradingDecimalPlaces:i.calculateTradingDecimalPlaces},this.controls={},this.goneVertical=!1,this.pinchingScreen=!1,this.grabbingScreen=!1,this.grabStartX=0,this.grabStartY=0,this.grabStartScrollX=0,this.grabStartScrollY=0,this.swipe={},this.yTolerance=100,this.minimumLeftBars=1,this.grabStartCandleWidth=0,this.grabStartZoom=0,this.grabOverrideClick=!1,this.grabMode="",this.vectorsShowing=!1,this.mouseMode=!0,this.reverseMouseWheel=!1,this.mouseWheelAcceleration=!0,this.minimumCandleWidth=1,this.minimumZoomTicks=9,this.allowZoom=!0,this.allowScroll=!0,this.allowSideswipe=!0,this.allowThreeFingerTouch=!1,this.bypassRightClick={series:!1,study:!1,drawing:!1},this.anyHighlighted=!1,this.accessoryTimer=null,this.lastAccessoryUpdate=(new Date).getTime(),this.displayCrosshairs=!0,this.hrPanel=null,this.editingAnnotation=!1,this.openDialog="",this.displayIconsUpDown=!0,this.displayIconsSolo=!0,this.displayIconsClose=!0,this.displayPanelResize=!0,this.soloPanelToFullScreen=!1,this.markerDelay=0,this.useBackingStore=!0,this.disableBackingStoreDuringTouch=i.isMobile,this.manageTouchAndMouse=!0,this.captureTouchEvents=!0,this.captureMouseWheelEvents=!0,this.touches=[],this.changedTouched=[],this.crosshairTick=null,this.crosshairValue=null,this.yaxisLabelStyle="roundRectArrow",this.axisBorders=null,this.pt={x1:-1,x2:-1,y1:-1,y2:-1},this.moveA=-1,this.moveB=-1,this.touchStartTime=-1,this.gestureStartDistance=-1,this.grabStartPeriodicity=1,this.grabEndPeriodicity=-1,this.scrollEvent=null,this.cmd=!1,this.ctrl=!1,this.shift=!1,this.userPointerDown=!1,this.cloneDrawing=!1,this.singleDrawingHighlight=!0,this.crosshairXOffset=-40,this.crosshairYOffset=-40,this.displayInitialized=!1,this.cx=null,this.cy=null,this.extendLastTick=!1,this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},this.cancelTouchSingleClick=!1,this.layout={interval:"day",periodicity:1,timeUnit:null,candleWidth:8,volumeUnderlay:!1,adj:!0,crosshair:!1,chartType:"candle",extended:!1,marketSessions:{},aggregationType:"ohlc",chartScale:"linear",studies:{},panels:{},setSpan:{}},this.preferences={highlightsRadius:10,highlightsTapRadius:30,currentPriceLine:!1,magnet:!1,horizontalCrosshairField:null,labels:!0,language:null,timeZone:null,whitespace:50,zoomInSpeed:null,zoomOutSpeed:null,zoomAtCurrentMousePosition:!1},this.streamParameters={count:0,maxWait:1e3,maxTicks:100,timeout:-1,fillGaps:!0},this.translationCallback=null,this.locale=null,this.dataZone=null,this.displayZone=null,this.timeZoneOffset=0,this.changeCallback=null,this.masterData=null,this.transformDataSetPre=null,this.transformDataSetPost=null,this.transformMasterDataQuote=null,this.dataCallback=null,this.dontRoll=!1,this.allowEquations=!0,this.drawingObjects=[],this.undoStamps=[],this.cleanupGaps=!1,this.staticRange=!1,this.maxDataSetSize=2e4,this.maxMasterDataSize=0,this.resizeDetectMS=1e3,this.xAxisAsFooter=!0,this.xaxisHeight=30,this.displayGridLinesInStudies=!1,this.escapeOnSerialize=!0,this.chart=new i.ChartEngine.Chart,this.chart.name="chart",this.chart.canvas=null,this.chart.tempCanvas=null,this.chart.container=t.container,this.chart.market=new i.Market,this.candleWidthPercent=.65,this.colorByCandleDirection=!1,this.noWicksOnCandles={renko:!0,linebreak:!0},this.fetchMaximumBars={rangebars:!0,kagi:!0,renko:!0,linebreak:!0,pandf:!0},this.mainSeriesRenderer=null,this.highLowBars={bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,wave:!0,rangechannel:!0,none:!0},this.standaloneBars={bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,histogram:!0,scatterplot:!0},this.barsHaveWidth={bar:!0,colored_bar:!0,candle:!0,hollow_candle:!0,volume_candle:!0,hlc:!0,colored_hlc:!0,hlc_box:!0,hlc_shaded_box:!0,histogram:!0,scatterplot:!0,wave:!0},this.autoPickCandleWidth={turnOn:!1,candleWidth:5},this.staticRangePeriodicityMap=[{rangeInMS:i.WEEK,periodicity:1,interval:5,timeUnit:"minute"},{rangeInMS:i.MONTH,periodicity:1,interval:30,timeUnit:"minute"},{rangeInMS:i.YEAR,periodicity:1,interval:"day"},{rangeInMS:i.DECADE,periodicity:1,interval:"week"},{rangeInMS:10*i.DECADE,periodicity:1,interval:"month"},{rangeInMS:Number.MAX_VALUE,periodicity:12,interval:"month"}],this.dynamicRangePeriodicityMap=[{interval:1,timeUnit:"minute",rangeInMS:i.MINUTE},{interval:5,timeUnit:"minute",rangeInMS:5*i.MINUTE},{interval:30,timeUnit:"minute",rangeInMS:30*i.MINUTE},{interval:60,timeUnit:"minute",rangeInMS:60*i.MINUTE},{interval:"day",rangeInMS:i.DAY},{interval:"month",rangeInMS:i.MONTH},{interval:"year",rangeInMS:i.YEAR}],this.charts.chart=this.chart,this.styles={},this.currentVectorParameters=i.clone(i.ChartEngine.currentVectorParameters),i.extend(this,t),t.container&&(this.registerHTMLElements(),this.chart.width=this.chart.container.clientWidth-this.chart.yAxis.width,this.setCandleWidth(this.layout.candleWidth,this.chart),this.chart.canvasHeight=this.chart.container.clientHeight,i.useOldWheelLogic&&!i.FireFoxWheelWorkaround)){var e;e=i.isIE?function(t){if(i.ChartEngine.insideChart){t.preventDefault();for(var e=0;e<i.ChartEngine.registeredContainers.length;e++){var r=i.ChartEngine.registeredContainers[e].stx;i.ChartEngine.crosshairX>=r.left&&i.ChartEngine.crosshairX<=r.right&&i.ChartEngine.crosshairY>=r.top&&i.ChartEngine.crosshairY<=r.bottom&&r.mouseWheel(t,"onmousewheel")}}}:function(t){i.ChartEngine.insideChart&&t.preventDefault()},this.addDomEventListener(document.body,"wheel",e),i.FireFoxWheelWorkaround=!0}this.construct()},i.ChartEngine.drawingLine=!1,i.ChartEngine.resizingPanel=null,i.ChartEngine.vectorType="",i.ChartEngine.crosshairX=0,i.ChartEngine.crosshairY=0,i.ChartEngine.insideChart=!1,i.ChartEngine.overXAxis=!1,i.ChartEngine.overYAxis=!1,i.ChartEngine.currentColor="auto",i.ChartEngine.drawingTools={},i.ChartEngine.useAnimation=!0,i.ChartEngine.ipadMaxTicks=1500,i.ChartEngine.enableCaching=!1,i.ChartEngine.ignoreTouch=!1,i.ChartEngine.useOldAndroidClear=!0,i.ChartEngine.currentVectorParameters={vectorType:null,pattern:"solid",lineWidth:1,fillColor:"#7DA6F5",currentColor:"auto",axisLabel:!0,fibonacci:{trend:{color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},fibs:[{level:-.786,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:-.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:-.5,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:-.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:-.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:0,color:"auto",parameters:{pattern:"solid",lineWidth:1},display:!0},{level:.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.5,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:.786,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:1,color:"auto",parameters:{pattern:"solid",lineWidth:1},display:!0},{level:1.382,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:1.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1},display:!0},{level:2.618,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}},{level:4.236,color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}}],extendLeft:!1,printLevels:!0,printValues:!1,timezone:{color:"auto",parameters:{pattern:"solid",opacity:.25,lineWidth:1}}},annotation:{font:{style:null,size:null,weight:null,family:null}}},i.ChartEngine.defaultDisplayTimeZone=null,i.ChartEngine.Chart=function(){this.xAxis=new i.ChartEngine.XAxis,this.yAxis=new i.ChartEngine.YAxis,this.symbolObject={symbol:null},
this.series={},this.seriesRenderers={},this.xaxis=[],this.state={},this.defaultChartStyleConfig={},this.baseline=i.clone(this.baseline)},i.ChartEngine.YAxis=function(t){this.name=i.uniqueID();for(var e in t)this[e]=t[e]},i.ChartEngine.XAxis=function(t){for(var e in t)this[e]=t[e]},i.ChartEngine.Panel=function(t,e){this.yAxis=e||new i.ChartEngine.YAxis,this.name=t,this.state={}},i.ChartEngine.YAxis.prototype={high:null,low:null,shadow:null,logHigh:null,logLow:null,logShadow:null,multiplier:null,bottom:null,top:null,height:null,left:null,width:null},i.ChartEngine.YAxis.prototype.maxDecimalPlaces=5,i.ChartEngine.YAxis.prototype.max=null,i.ChartEngine.YAxis.prototype.min=null,i.ChartEngine.YAxis.prototype.decimalPlaces=null,i.ChartEngine.YAxis.prototype.idealTickSizePixels=null,i.ChartEngine.YAxis.prototype.minimumPriceTick=null,i.ChartEngine.YAxis.prototype.fractional=null,i.ChartEngine.YAxis.prototype.displayBorder=!0,i.ChartEngine.YAxis.prototype.displayGridLines=!0,i.ChartEngine.YAxis.prototype.noDraw=null,i.ChartEngine.YAxis.prototype.drawCurrentPriceLabel=!0,i.ChartEngine.YAxis.prototype.drawSeriesPriceLabels=!0,i.ChartEngine.YAxis.prototype.drawPriceLabels=!0,i.ChartEngine.YAxis.prototype.goldenRatioYAxis=!0,i.ChartEngine.YAxis.prototype.yaxisLabelStyle=null,i.ChartEngine.YAxis.prototype.justifyRight=null,i.ChartEngine.YAxis.prototype.textBackground=!1,i.ChartEngine.YAxis.prototype.priceFormatter=null,i.ChartEngine.YAxis.prototype.bottomOffset=0,i.ChartEngine.YAxis.prototype.topOffset=0,i.ChartEngine.YAxis.prototype.initialMarginTop=10,i.ChartEngine.YAxis.prototype.initialMarginBottom=10,i.ChartEngine.YAxis.prototype.zoom=0,i.ChartEngine.YAxis.prototype.scroll=0,i.ChartEngine.YAxis.prototype.width=50,i.ChartEngine.YAxis.prototype.textStyle=null,i.ChartEngine.YAxis.prototype.position=null,i.ChartEngine.YAxis.defaultShadowBreaks=[[1e3,2],[1,4]],i.ChartEngine.YAxis.smallChartShadowBreaks=[[10,2],[1,4]],i.ChartEngine.YAxis.prototype.pretty=!0,i.ChartEngine.YAxis.prototype.increments=[1,2.5,5],i.ChartEngine.YAxis.prototype.prettySemiLog=!0,i.ChartEngine.YAxis.prototype.shadowBreaks=i.ChartEngine.YAxis.defaultShadowBreaks,i.ChartEngine.Panel.prototype={name:null,display:null,chart:null,yAxis:null,shareChartXAxis:null,top:null,bottom:null,height:null,percent:null},i.ChartEngine.XAxis.prototype={formatter:null,adjustTimeZone:!0,idealTickSizePixels:null,timeUnit:null,timeUnitMultiplier:null,displayBorder:!0,displayGridLines:!0,noDraw:null,minimumLabelWidth:50,futureTicks:!0,futureTicksInterval:1},i.ChartEngine.Chart.prototype={symbol:null,symbolObject:{symbol:null},symbolDisplay:null,series:{},seriesRenderers:{},scroll:0,standStill:0,maxTicks:0,tension:null,masterData:null,dataSet:null,scrubbed:null,dataSegment:null,segmentImage:null,baseline:{includeInDataSegment:!1,defaultLevel:null,userLevel:null,actualLevel:null},xAxis:null,xaxis:[],xaxisFactor:30,decimalPlaces:2,dynamicYAxis:!1,quoteTextLength:0,roundit:100,legendRenderer:i.drawLegend,customChart:null,yaxisPaddingRight:null,yaxisPaddingLeft:null,tickCache:{},allowScrollPast:!0,allowScrollFuture:!0,hideDrawings:!1,defaultPlotField:"Close",defaultChartStyleConfig:{},lockScroll:!1,includeOverlaysInMinMax:!0,gaplines:null,lineStyle:null,lineApproximation:!0,highLowBars:!1,standaloneBars:!1,barsHaveWidth:!1},i.ChartEngine.prototype.convertToDataZone=function(t){if(this.dataZone){var e=i.convertTimeZone(t,null,this.dataZone);t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}return t},i.ChartEngine.isDailyInterval=function(t){return"day"==t||("week"==t||"month"==t)},i.ChartEngine.prototype.needDifferentData=function(t){var e=this.layout,r=i.ChartEngine.isDailyInterval(t.interval),n=i.ChartEngine.isDailyInterval(e.interval),a=!1;return this.dontRoll||!n?e.interval!=t.interval&&(a=!0):r!=n&&(a=!0),r||t.timeUnit||(t.timeUnit="minute"),n||e.timeUnit||(e.timeUnit="minute"),t.timeUnit!=e.timeUnit&&(a=!0),a},i.ChartEngine.chartShowsHighs=function(t){return console.warn("CIQ.ChartEngine.chartShowsHighs() has been deprecated. Please check one of the appropriate renderer properties instead: stxx.chart.highLowBars, stxx.chart.standaloneBars, or stxx.chart.barsHaveWidth."),1!={line:1,colored_line:1,mountain:1,colored_mountain:1,baseline_delta:1,baseline_delta_mountain:1,histogram:1,scatterplot:1,step:1,colored_step:1}[t]},i.ChartEngine.prototype.debug=function(){},i.ChartEngine.prototype.fps=function(t,e){function r(){var o=((new Date).getTime()-n)/1e3;if(o>t){var l=a/o;return console.log("FPS="+l),void(e&&e(l))}s.draw(),a++,i.ChartEngine.useAnimation?requestAnimationFrame(r):setTimeout(r,0)}t=t||5;var n=(new Date).getTime(),a=0,s=this;console.log("Running fps() for "+t+" seconds"),r()},t.STXChart=i.ChartEngine,i.ChartEngine.DrawingDescriptor={name:"",render:null,intersected:null,click:null,abort:null},i.ChartEngine.prototype.prepend=function(t,e){var r,n="prepend"+t;return this instanceof i.ChartEngine?(r=this.hasOwnProperty(n)?this[n]:[],this[n]=[e].concat(r)):(r=i.ChartEngine.prototype[n]||[],i.ChartEngine.prototype[n]=[e].concat(r)),{method:n,func:e}},i.ChartEngine.prototype.append=function(t,e){var r,n="append"+t;return this instanceof i.ChartEngine?(r=this.hasOwnProperty(n)?this[n]:[],this[n]=r.concat(e)):(r=i.ChartEngine.prototype[n]||[],i.ChartEngine.prototype[n]=r.concat(e)),{method:n,func:e}},i.ChartEngine.prototype.removeInjection=function(t){var e,r=t.method;if(this instanceof i.ChartEngine){if(!this[r])return;for(e=0;e<this[r].length;e++)if(this[r][e]==t.func)return void this[r].splice(e,1)}else{if(!i.ChartEngine.prototype[r])return;for(e=0;e<i.ChartEngine.prototype[r].length;e++)if(i.ChartEngine.prototype[r][e]==t.func)return void i.ChartEngine.prototype[r].splice(e,1)}},i.ChartEngine.prototype.remove=function(t){this instanceof i.ChartEngine?(delete this["append"+t],delete this["prepend"+t]):(delete i.ChartEngine.prototype["append"+t],delete i.ChartEngine.prototype["prepend"+t])},i.ChartEngine.registeredContainers=[],i.ChartEngine.handleContextMenu=function(t){t||(t=event);for(var e=0;e<i.ChartEngine.registeredContainers.length;e++){var r=i.ChartEngine.registeredContainers[e].stx;if(r&&r.anyHighlighted)return t.preventDefault&&t.preventDefault(),!1}},i.ChartEngine.prototype.positionMarkers=function(){},i.ChartEngine.prototype.plugins={},i.ChartEngine.htmlControls={annotationSave:'<span class="stx-btn stx_annotation_save" style="display: none;">save</span>',annotationCancel:'<span class="stx-btn stx_annotation_cancel" style="display: none; margin-left:10px;">cancel</span>',mSticky:'<div id="mSticky"> <span id="mStickyInterior"></span> <span id="mStickyRightClick" class=""><span class="overlayEdit stx-btn" style="display:none"><span>&nbsp;</span></span> <span id="overlayTrashCan" class="stx-btn" style="display:none"><span>&nbsp;</span></span> <span id="mouseDeleteInstructions"><span>(</span><span id="mouseDeleteText">right-click to delete</span><span id="mouseManageText">right-click to manage</span><span>)</span></span></span></div>',crossX:'<div class="stx_crosshair stx_crosshair_x" style="display: none;"></div>',crossY:'<div class="stx_crosshair stx_crosshair_y" style="display: none;"></div>',chartControls:'<div class="stx_chart_controls" style="display: none; bottom: 22px;"><div id="chartSize"><span id="zoomOut" class="stx-zoom-out"></span><span id="zoomIn" class="stx-zoom-in"></span></div></div>',home:'<div id="home" class="stx_jump_today home" style="display:none"><span></span></div>',floatDate:'<div class="stx-float-date" style="visibility: hidden;"></div>',handleTemplate:'<div class="stx-ico-handle" style="display: none;"><span></span></div> ',iconsTemplate:'<div class="stx-panel-control"><div class="stx-panel-title"></div><div class="stx-btn-panel"><span class="stx-ico-up"></span></div><div class="stx-btn-panel"><span class="stx-ico-focus"></span></div><div class="stx-btn-panel"><span class="stx-ico-down"></span></div><div class="stx-btn-panel"><span class="stx-ico-edit"></span></div><div class="stx-btn-panel"><span class="stx-ico-close"></span></div></div>',baselineHandle:'<div class="stx-baseline-handle" style="display: none;"></div>'},i.ChartEngine.prototype.registerHTMLElements=function(){var t=this.chart.container;for(var e in i.ChartEngine.htmlControls)if(void 0===this.chart[e]&&void 0===this.controls[e]){if(!this.allowZoom&&"chartControls"==e)continue;var r=n("#"+e,t);if(r)this.chart[e]=r,this.controls[e]=r;else{var a=i.ChartEngine.htmlControls[e],s=document.createElement("DIV");s.innerHTML=a,r=s.firstChild,t.appendChild(r),this.chart[e]=r,this.controls[e]=r,r.id=e}}if(this.controls.chartControls){var o=n("#zoomIn",this.controls.chartControls),l=n("#zoomOut",this.controls.chartControls);i.safeClickTouch(o,function(t){return function(e){t.zoomIn(e),e.stopPropagation()}}(this)),i.safeClickTouch(l,function(t){return function(e){t.zoomOut(e),e.stopPropagation()}}(this)),i.touchDevice||(this.makeModal(o),this.makeModal(l))}this.controls.home&&(i.safeClickTouch(this.controls.home,function(t){return function(e){t.home({animate:!0}),e.stopPropagation()}}(this)),i.touchDevice||this.makeModal(this.controls.home))},i.ChartEngine.prototype.makeModal=function(t){var e=this;t.onmouseover=function(t){e.modalBegin()},t.onmouseout=function(t){e.modalEnd()}},i.ChartEngine.prototype.cloneStyle=function(t){function e(t){return t[1].toUpperCase()}var r={},n=!1;for(var a in t){var s=t[a];if("backgroundAttachment"==a&&(n=!0),n)s&&s.constructor==String&&isNaN(a)&&(r[a]=s);else if(isNaN(a)){var o=a.replace(i.camelCaseRegExp,e);r[o]=s}else{var l=t.getPropertyValue(s);if(l){s=s.split("-");for(var h=0,c=s.length,u=s[0];++h<c;)u+=s[h].charAt(0).toUpperCase()+s[h].slice(1);r[u]=l}}}return r},i.ChartEngine.prototype.canvasStyle=function(t){var e=this.styles[t];if(!e){var i=document.createElement("div");i.className=t,this.container.appendChild(i);var r=getComputedStyle(i);e=this.styles[t]=this.cloneStyle(r),this.container.removeChild(i),r||(this.styles[t]=null)}return e},i.ChartEngine.prototype.colorOrStyle=function(t){return-1!=t.indexOf("#")?t:-1!=t.indexOf("(")?t:"transparent"==t?t:this.canvasStyle(t)},i.ChartEngine.prototype.clearStyles=function(){this.styles={}},i.ChartEngine.prototype.setStyle=function(t,e,r){this.styles[t]||this.canvasStyle(t),this.styles[t]||(this.styles[t]={}),this.styles[t][i.makeCamelCase(e)]=r},i.ChartEngine.prototype.canvasFont=function(t,e){e||(e=this.chart.context);var i=this.canvasStyle(t);if(i){var r=i.fontStyle+" "+i.fontWeight+" "+i.fontSize+" "+i.fontFamily;-1==r.indexOf("undefined")?e.font=r:(this.styles[t]=null,console.log("bad css style for class "+t))}},i.ChartEngine.prototype.canvasColor=function(t,e){e||(e=this.chart.context);var i=this.canvasStyle(t);if(i){var r=i.color;r||(r=this.defaultColor),e.globalAlpha=1,e.fillStyle=r,e.strokeStyle=r;var n=i.opacity;void 0!==n&&(e.globalAlpha=n)}},i.ChartEngine.prototype.getCanvasFontSize=function(t){var e=this.canvasStyle(t),r=e.fontSize;return r||(r="12"),parseInt(i.stripPX(r),10)},i.ChartEngine.prototype.getCanvasColor=function(t){return this.canvasStyle(t).color},i.ChartEngine.hideDates=function(){return!1},i.ChartEngine.prototype.runPrepend=function(t,e,r){var n="prepend"+t,a=this.hasOwnProperty(n)?this[n]:[];if(a=a.concat(i.ChartEngine.prototype[n]||[]),!a.length)return!1;r||(r=this);for(var s=0;s<a.length;s++){var o=a[s].apply(r,e);if(o)return o}return!1},i.ChartEngine.prototype.runAppend=function(t,e,r){var n="append"+t,a=this.hasOwnProperty(n)?this[n]:[];if(a=a.concat(i.ChartEngine.prototype[n]||[]),!a.length)return!1;r||(r=this);for(var s=0;s<a.length;s++){var o=a[s].apply(r,e);if(o)return o}return!1},i.ChartEngine.registerDrawingTool=function(t,e){i.ChartEngine.drawingTools[t]=e},i.ChartEngine.prototype.createBlock=function(t,e,i,r,n,a){a||(a=this.chart.context),void 0!==r&&(this.canvasColor(n,a),a.fillRect(t,i,e,r),a.globalAlpha=1)},i.ChartEngine.prototype.changeOccurred=function(t){if(!this.currentlyImporting){this.changeCallback&&(console.warn("CIQ.ChartEngine.changeCallback has been deprecated. Please use addEventListener()"),this.changeCallback(this,t));var e={stx:this,symbol:this.chart.symbol,symbolObject:this.chart.symbolObject,layout:this.layout,drawings:this.drawingObjects};"layout"==t?this.dispatch("layout",e):"vector"==t?this.dispatch("drawing",e):"theme"==t?this.dispatch("theme",e):"preferences"==t&&this.dispatch("preferences",e)}},i.ChartEngine.prototype.setChartType=function(t){var e=this.layout,i=this.chart;"ohlc"!=e.aggregationType&&(e.aggregationType="ohlc",i.canvas&&this.createDataSet()),e.chartType=t,this.setMainSeriesRenderer(!0),i.defaultChartStyleConfig={type:t},this.displayInitialized&&this.draw(),this.changeOccurred("layout")},i.ChartEngine.prototype.setAggregationType=function(t){this.layout.chartType="candle";var e=this.chart;!1!==e.baseline.userLevel&&(e.baseline.userLevel=e.baseline.defaultLevel,e.panel.yAxis.scroll=i.ChartEngine.YAxis.prototype.scroll),this.layout.aggregationType=t,this.setMainSeriesRenderer(),e.canvas&&(this.createDataSet(),this.draw()),this.changeOccurred("layout")},i.ChartEngine.prototype.setChartScale=function(t){var e=this.chart,r={percent:!0,relative:!0};if(t||(t="linear"),r[t])this.setComparison(t,e,i.Comparison.initialPrice);else if(r[this.layout.chartScale]){var n=!1;for(var a in e.series)e.series[a].parameters.isComparison&&(n=!0);n||this.setComparison(!1,e)}this.layout.chartScale=t,e.canvas&&this.draw(),this.changeOccurred("layout")},i.ChartEngine.prototype.setAdjusted=function(t){this.layout.adj=t,this.chart.canvas&&(this.createDataSet(),this.draw()),this.changeOccurred("layout")},i.ChartEngine.prototype.setVolumeUnderlay=function(t){this.layout.volumeUnderlay=t,this.chart.canvas&&this.draw(),this.changeOccurred("layout")},i.ChartEngine.prototype.serializeDrawings=function(){return console.warn("CIQ.ChartEngine.serializeDrawings() has been deprecated. Please use exportDrawings()"),this.exportDrawings()},i.ChartEngine.prototype.exportDrawings=function(){for(var t=[],e=0;e<this.drawingObjects.length;e++)t.push(this.drawingObjects[e].serialize());return t},i.ChartEngine.prototype.abortDrawings=function(){for(var t=0;t<this.drawingObjects.length;t++)this.drawingObjects[t].abort(!0);this.drawingObjects=[]},i.ChartEngine.prototype.reconstructDrawings=function(t){console.warn("CIQ.ChartEngine.reconstructDrawings() has been deprecated. Please use importDrawings()"),this.importDrawings(t)},i.ChartEngine.prototype.importDrawings=function(t){if(i.Drawing)for(var e=0;e<t.length;e++){var r=t[e];"fibonacci"==r.name&&(r.name="retracement");var n=i.ChartEngine.drawingTools[r.name];if(n||i.Drawing[r.name]&&(n=i.Drawing[r.name],i.ChartEngine.registerDrawingTool(r.name,n)),n){var a=new n;a.reconstruct(this,r),this.drawingObjects.push(a)}}},i.ChartEngine.prototype.clearDrawings=function(t){var e=i.shallowClone(this.drawingObjects);this.abortDrawings(),t?this.undoStamps=[]:this.undoStamp(e,i.shallowClone(this.drawingObjects)),this.changeOccurred("vector"),this.cancelTouchSingleClick=!0,i.clearCanvas(this.chart.tempCanvas,this),this.draw(),this.controls.mSticky&&(this.controls.mSticky.style.display="none",this.controls.mSticky.children[0].innerHTML="")},i.ChartEngine.prototype.createDrawing=function(t,e){if(i.Drawing){var r=new i.Drawing[t];r.reconstruct(this,e);var n=new i.Drawing[t];n.stx=this,n.copyConfig();for(var a in n)r[a]=r[a]||n[a];return this.drawingObjects.push(r),this.draw(),r}},i.ChartEngine.prototype.removeDrawing=function(t){for(var e=0;e<this.drawingObjects.length;e++)if(this.drawingObjects[e]==t)return this.drawingObjects.splice(e,1),this.changeOccurred("vector"),void this.draw()},i.ChartEngine.prototype.dateFromTick=function(t,e,r){e||(e=this.chart);var n,a,s,o=e.dataSet.length,l=!1;return 0===o&&(e.dataSet[0]={},e.dataSet[0].DT=new Date,o=e.dataSet.length,l=!0),t<0?(a=this.standardMarketIterator(e.dataSet[0].DT),n=a.previous(Math.abs(t))):t>=o?(a=this.standardMarketIterator(e.dataSet[o-1].DT),n=a.next(t-(o-1))):n=e.dataSet[t].DT,s=r?new Date(n.getTime()):i.yyyymmddhhmm(n),l&&delete e.dataSet[0].DT,s},i.ChartEngine.prototype.calculateYAxisMargins=function(t){t.zoom=t.initialMarginTop+t.initialMarginBottom,t.scroll=(t.initialMarginTop-t.initialMarginBottom)/2,t.zoom>t.height&&(t.zoom=0,t.scroll=0)},i.ChartEngine.prototype.getLabelOffsetInPixels=function(t,e){var i=!(this.mainSeriesRenderer&&this.mainSeriesRenderer.standaloneBars||this.standaloneBars[e]);if(!("roundRectArrow"!=this.yaxisLabelStyle||i&&this.extendLastTick&&0!==t.yaxisPaddingRight)){return.66*(this.getCanvasFontSize("stx_yaxis")+6)}return 0},i.ChartEngine.prototype.home=function(t){function e(t){for(var e in t.panels)for(var i=t.panels[e].yaxisLHS.concat(t.panels[e].yaxisRHS),r=0;r<i.length;r++)t.calculateYAxisMargins(i[r])}this.swipe.amplitude=0,this.grabbingScreen=!1;var r=this.layout;if(i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),"object"!=typeof t&&(t={maintainWhitespace:t}),void 0===t.maintainWhitespace&&(t.maintainWhitespace=!0),this.cancelTouchSingleClick=!0,!this.chart.dataSet||!this.chart.dataSet.length)return void this.draw();this.micropixels=0;var n=Math.floor(this.chart.width/r.candleWidth);for(var a in this.charts){var s=this.charts[a];if(!t.chart||t.chart==s){var o=0;t.maintainWhitespace&&this.preferences.whitespace>=0&&(o=this.preferences.whitespace),(t.whitespace||0===t.whitespace)&&(o=t.whitespace);var l=this.getLabelOffsetInPixels(s,r.chartType);l>o&&(o=l);var h=Math.min(n,s.dataSet.length);for(this.chart.allowScrollPast&&(h=n),this.micropixels=this.chart.width-h*r.candleWidth-o,this.preferences.whitespace=o;this.micropixels>r.candleWidth;)h++,this.micropixels-=r.candleWidth;for(;this.micropixels<0;)h--,this.micropixels+=r.candleWidth;if(this.micropixels-=r.candleWidth,h++,this.mainSeriesRenderer&&this.mainSeriesRenderer.standaloneBars||this.standaloneBars[r.chartType]||(this.micropixels+=r.candleWidth/2),t.animate){var c=this;this.scrollTo(s,h,function(t,i,r){return function(){e(t),i.scroll=r,t.draw()}}(c,s,h))}else s.scroll=h,e(this)}}this.draw()},i.ChartEngine.prototype.isHome=function(){var t=this.chart,e=t.dataSet,i=t.animatingHorizontalScroll;return this.pixelFromTick(e.length-(i?2:1),t)<t.width+t.panel.left},i.ChartEngine.prototype.tickFromDate=function(t,e,r,n){if(e||(e=this.chart),!e.dataSet||!e.dataSet.length)return 0;r||(r=0),e||(e=this.chart);var a=t.constructor==Date?t:i.strToDateTime(t);i.ChartEngine.isDailyInterval(this.layout.interval)||a.setMinutes(a.getMinutes()+r);var s=a.getTime(),o=e.tickCache[s];if(o||0===o)return o;var l=e.dataSet[0].DT,h=e.dataSet[e.dataSet.length-1].DT;if(a>=l&&a<=h)for(var c=0;c<e.dataSet.length;c++){var u=e.dataSet[c].DT;if(u.getTime()==a.getTime())return e.tickCache[s]=c,c;if(u>a)return e.tickCache[s]=n?c:c-1,e.tickCache[s]}var d=a<l,p=d?l:h,f=this.standardMarketIterator(p),m=f.futureTick({end:a});return o=d?-1*m:e.dataSet.length-1+m,n&&d&&o++,n||d||o--,e.tickCache[s]=o,o},i.ChartEngine.XAxisLabel=function(t,e,i){this.hz=t,this.grid=e,this.text=i},i.ChartEngine.prototype.createXAxis=function(t){if(t.dataSegment.length<=0)return null;if(i.ChartEngine.hideDates())return null;var e=[t],r=this.runPrepend("createXAxis",e);return r||(r=this.createTickXAxisWithDates(t),this.headsUpHR(),this.runAppend("createXAxis",e),r)},i.ChartEngine.prototype.adjustYAxisHeightOffset=function(t,e){var i=e.topOffset,r=e.bottomOffset;i+r>t.height&&(console.log("The sum of yAxis.topOffset and yAxis.bottomOffset cannot be greater than the panel height. Both values will be reset to 0."),e.bottomOffset=0,e.topOffset=0),this.xaxisHeight||0===this.xaxisHeight||(this.xaxisHeight=this.getCanvasFontSize("stx_xaxis")+4,(this.chart.xAxis.displayBorder||this.axisBorders)&&(this.xaxisHeight+=3)),(this.xAxisAsFooter&&t.bottom>this.chart.canvasHeight-this.xaxisHeight||!this.xAxisAsFooter&&t==this.chart.panel)&&(r+=this.xaxisHeight),e.top=t.top+i,e.bottom=t.bottom-r},i.ChartEngine.prototype.plotYAxisGrid=function(t){if(!this.runPrepend("plotYAxisGrid",arguments)){var e=this.chart.context;t.yAxis.yAxisPlotter&&t.yAxis.yAxisPlotter.draw(e,"grid"),this.runAppend("plotYAxisGrid",arguments)}},i.ChartEngine.prototype.plotYAxisText=function(t){if(!this.runPrepend("plotYAxisText",arguments)){for(var e=t.yaxisLHS.concat(t.yaxisRHS),i=0;i<e.length;i++){var r=e[i];if(r.yAxisPlotter&&!r.noDraw){this.canvasFont("stx_yaxis"),this.canvasColor("stx_yaxis");var n=this.chart.context;n.textBaseline="middle",r.justifyRight?n.textAlign="right":n.textAlign="left",r.yAxisPlotter.draw(n,"text"),n.textBaseline="alphabetic",n.textAlign="left"}}this.runAppend("plotYAxisText",arguments)}},i.ChartEngine.prototype.formatYAxisPrice=function(t,e,r,n){if(null===t||void 0===t||isNaN(t))return"";var a=n||e.yAxis,s=r;if(s||0===s||(s=a.printDecimalPlaces),s||0===s||(s=a.priceTick<.01?4:a.priceTick<.1?2:a.priceTick<1?1:0),e.name!=e.chart.name&&a.priceTick>=1e3)return i.condenseInt(t);var o=this.internationalizer;if(o){var l=o.priceFormatters.length;s>=l&&(s=l-1),t=o.priceFormatters[s].format(t)}else t=t.toFixed(s);return t},i.ChartEngine.prototype.padOutPrice=function(t,e){if(0!==t&&(!t||"number"!=typeof t))return"";e||0===e||(e=t);var i=""+e,r=i.substring(i.indexOf(".")).length-1;r=e>=1e3?Math.max(r,0):e<2?Math.max(r,4):Math.max(r,2);var n=this.internationalizer;if(n){var a=n.priceFormatters.length;r>=a&&(r=a-1),t=n.priceFormatters[r].format(t)}else t=t.toFixed(r);return t},i.ChartEngine.prototype.formatPrice=function(t,e){if(0!==t&&(!t||void 0===t))return"";if(e||(e=this.currentPanel),e||(e=this.chart.panel),!e)return t;var i=e.decimalPlaces;if(i||0===i||(i=e.chart.decimalPlaces),!i&&0!==i)return t;var r=this.internationalizer;if(r){var n=r.priceFormatters.length;i>=n&&(i=n-1),t=r.priceFormatters[i].format(t)}else t=t.toFixed(i);return t},i.ChartEngine.prototype.createCrosshairs=function(){this.runPrepend("createCrosshairs",arguments)||this.controls.crossX.onmousedown||(this.controls.crossY.onmousedown=function(t){return t||(t=event),t.preventDefault&&t.preventDefault(),!1},this.controls.crossX.onmousedown=function(t){return t||(t=event),t.preventDefault&&t.preventDefault(),!1},this.runAppend("createCrosshairs",arguments))},i.ChartEngine.prototype.determineMinMax=function(t,e,r,n,a){var s=-1*Number.MAX_VALUE,o=Number.MAX_VALUE,l=!1,h=t.length;a&&(h=a);for(var c=0;c<=h+1;c++){var u;if(e.length&&(u=c==h?this.getPreviousBar(this.chart,e[0],0):c==h+1?this.getNextBar(this.chart,e[0],h-1):t[c]),u){if(!n)if(u.transform)l=!0,u=u.transform;else if(l)continue;for(var d=0,p=0;p<e.length;p++){var f=i.existsInObjectChain(u,e[p]);if(f){var m=f.obj[f.member];"number"==typeof m&&(m=[m]);for(var g=0;g<m.length;g++){var v=m[g];(v||0===v)&&(r?(d+=v,d>s&&(s=d),d<o&&(o=d)):(v>s&&(s=v),v<o&&(o=v)))}}}}}return s==-1*Number.MAX_VALUE&&(s=0),o==Number.MAX_VALUE&&(o=0),[o,s]},i.ChartEngine.prototype.calculateYAxisRange=function(t,e,i,r){i==Number.MAX_VALUE&&(i=0,r=0);var n=t.height,a=null,s=null;this.adjustYAxisHeightOffset(t,e),e.height=e.bottom-e.top;var o=Math.round(Math.abs(n/5));if(n-Math.abs(e.scroll)<o&&(e.scroll=(n-o)*(e.scroll<0?-1:1)),i||0===i){if(r-i==0){var l=Math.pow(10,-(i.toString()+".").split(".")[1].length);1==l&&(l=100),a=i+l,s=i-l}else if((this.layout.semiLog||"log"==this.layout.chartScale)&&a){var h=Math.log(i)/Math.LN10,c=Math.log(r)/Math.LN10;a=Math.pow(10,c),s=Math.pow(10,h)}else a=r,s=i;e.high=a,e.low=s}if((e.max||0===e.max)&&(e.high=e.max),(e.min||0===e.min)&&(e.low=e.min),e.shadow=e.high-e.low,t.chart.name===t.name&&t.yAxis.name===e.name){var u=this.layout.semiLog||"log"==this.layout.chartScale;(t.chart.isComparison||"pandf"==this.layout.aggregationType)&&(u=!1),e.semiLog!=u&&(this.clearPixelCache(),e.semiLog=u)}},i.ChartEngine.prototype.renderYAxis=function(t){if(!this.runPrepend("renderYAxis",arguments)){var e,i=t.panel,r=i.yaxisRHS.concat(i.yaxisLHS);for(e=0;e<r.length;e++){var n=r[e],a=null,s=null;i.yAxis.name===n.name&&(a=t.lowValue,s=t.highValue),this.calculateYAxisRange(i,n,a,s)}var o={};for(e=0;e<r.length;e++)o.yAxis=r[e],this.createYAxis(i,o),this.drawYAxis(i,o);this.runAppend("renderYAxis",arguments)}},i.ChartEngine.prototype.initializeDisplay=function(t){function e(e){for(var r in t.seriesRenderers){var s=t.seriesRenderers[r],o=s.params,l=o.panel;a.panels[l];if(!o.yAxis||l!=t.panel.name)for(var h=0;h<s.seriesParams.length;h++){var c=s.seriesParams[h];c.shareYAxis&&(c.symbol?n=n.concat(i.createObjectChainNames(c.symbol,e)):c.field&&n.push(c.field))}}if(t.panel=a.panels[t.name],t.includeOverlaysInMinMax)for(var u in a.overlays){var d=a.overlays[u];if(d.panel==t.name)for(var p in d.outputMap)n.push(p)}}if(!this.runPrepend("initializeDisplay",arguments)){var r,n=[],a=this,s=null,o=Math.floor((t.width-this.micropixels)/this.layout.candleWidth);if(t.scroll>t.maxTicks&&t.maxTicks>o+1&&(s=t.dataSegment.length-1),this.mainSeriesRenderer&&!this.mainSeriesRenderer.highLowBars||!this.highLowBars[this.layout.chartType]){var l=this.chart.defaultPlotField||"Close";n.push(l),e(n.slice()),r=this.determineMinMax(t.dataSegment,n,null,!t.transformFunc,s);var h=this.mainSeriesRenderer||{};if(h.params&&h.params.baseline&&"mountain"!=h.params.type){var c=t.baseline.actualLevel;if(c||0===c){t.transformFunc&&(c=t.transformFunc(this,t,c));var u=Math.max(c-r[0],r[1]-c);this.repositioningBaseline?r=[t.lowValue,t.highValue]:(r[0]=c-u,r[1]=c+u)}}}else n.push("Close","Open","High","Low"),e(n.slice()),r=this.determineMinMax(t.dataSegment,n,null,!this.chart.transformFunc,s);t.lowValue=r[0],t.highValue=r[1];var d=t.state.aggregation;d&&d.box&&(t.lowValue-=d.box/2,t.highValue+=d.box/2),this.runAppend("initializeDisplay",arguments)}},i.ChartEngine.prototype.computePosition=function(t,e){return void 0===e&&(e=0),t*this.layout.candleWidth+e+this.micropixels},i.ChartEngine.prototype.computeColor=function(t,e){return t<e?"stx_candle_up":t>e?"stx_candle_down":"stx_candle_shadow"},i.ChartEngine.prototype.computeLength=function(t,e){var i=this.pixelFromPrice(t);return this.pixelFromPrice(e)-i},i.ChartEngine.prototype.setSeriesRenderer=function(t){var e=t.params;return this.chart.seriesRenderers[e.name]?this.chart.seriesRenderers[e.name]:(e.yAxis&&(e.yAxis=this.addYAxis(this.panels[e.panel],e.yAxis)),t.stx=this,this.chart.seriesRenderers[e.name]=t,t)},i.ChartEngine.prototype.setMainSeriesRenderer=function(t){var e=this.layout.chartType,r=this.layout.aggregationType,n=this.chart.customChart,a=this.mainSeriesRenderer;a&&(a.removeAllSeries(t),this.removeSeriesRenderer(a),a=this.mainSeriesRenderer=null);var s={panel:this.chart.panel.name,name:"_main_series",highlightable:!1,useChartLegend:!0};if(n&&n.chartType&&(e=n.chartType),"none"!=e){r&&"ohlc"!=r&&(e=r);var o=i.Renderer.produce(e,s);o&&(this.setSeriesRenderer(o).attachSeries(null,{display:this.chart.symbol}),this.mainSeriesRenderer=o),["highLowBars","standaloneBars","barsHaveWidth"].forEach(function(t){this.chart[t]=this.mainSeriesRenderer&&this.mainSeriesRenderer[t]}.bind(this))}},i.ChartEngine.prototype.setMarket=function(t,e){e||(e=this.chart),e.market=new i.Market(t);for(var r in this.layout.marketSessions)e.market.disableSession(r,this.layout.marketSessions[r])},i.ChartEngine.prototype.setMarketFactory=function(t){this.marketFactory=t},i.ChartEngine.prototype.removeSeriesRenderer=function(t){for(var e in this.chart.seriesRenderers)if(t.params.name===this.chart.seriesRenderers[e].params.name){var i=this.chart.seriesRenderers[t.params.name],r=i.params.yAxis,n=this.panels[i.params.panel];return delete this.chart.seriesRenderers[t.params.name],void this.deleteYAxisIfUnused(n,r)}},i.ChartEngine.prototype.getSeriesRenderer=function(t){return this.chart.seriesRenderers[t]},i.ChartEngine.prototype.startClip=function(t,e){t||(t="chart");var i=this.panels[t],r=i.yAxis;this.chart.context.save(),this.chart.context.beginPath();var n=i.left,a=i.width;e?(n=0,a=this.width):i.yaxisLHS&&i.yaxisLHS.length&&(n++,a--),this.chart.context.rect(n,r.top,a,r.height),this.chart.context.clip()},i.ChartEngine.prototype.endClip=function(){this.chart.context.restore()},i.ChartEngine.prototype.setLineStyle=function(t,e){var r={};t&&"object"==typeof t?r=t:r.color=t,r.color||r.pattern||r.width||(r=null),e||(e=this.chart);var n=1;r&&r.width&&(n=r.width),r&&r.pattern&&(r.pattern=i.borderPatternToArray(n,r.pattern)),e.lineStyle=r},i.ChartEngine.prototype.setGapLines=function(t,e){var r={};t&&"object"==typeof t?r=t:r.color=t,r.color||r.pattern||r.fillMountain||(r=null),e||(e=this.chart),r&&r.pattern&&(r.pattern=i.borderPatternToArray(r.pattern)),r&&r.width<=0&&(r.width=null),e.gaplines=r},i.ChartEngine.prototype.getGapColorFunction=function(t,e,i,r,n){return"object"!=typeof i&&(i={color:i}),function(a,s,o){var l=n?n(a,s,o):i.color;l.color&&(l=l.color);var h=s[t];return h||0===h||(h=s[e]),o||!h&&0!==h?r?("object"!=typeof r&&(r="string"==typeof r?{color:r}:{}),{color:r.color||l,pattern:r.pattern||i.pattern,width:r.width||i.width}):null:{color:l,pattern:i.pattern,width:i.width}}},i.ChartEngine.prototype.drawLineChart=function(t,e,r,n){var a=r,s=this.chart,o=s.context,l=s.lineStyle||{},h=this.canvasStyle(e);n||(n={}),this.startClip(t.name);var c=n.width||l.width||h.width;c&&parseInt(c,10)<=25?o.lineWidth=Math.max(1,i.stripPX(c)):o.lineWidth=1,n.pattern=n.pattern||l.pattern||h.borderTopStyle,n.pattern=i.borderPatternToArray(o.lineWidth,n.pattern),this.canvasColor(e);var u=n.color||l.color;u&&(o.strokeStyle=u),n.skipProjections=!0;var d=n.field||s.defaultPlotField,p=n.subField||s.defaultPlotField||"Close",f=n.gaps||s.gaplines;f&&(a=this.getGapColorFunction(d,p,{color:o.strokeStyle,pattern:n.pattern,width:o.lineWidth},f,r)),t.chart.tension&&(n.tension=t.chart.tension);var m=this.plotDataSegmentAsLine(d,t,n,a);return m.colors.length||m.colors.push(o.strokeStyle),o.lineWidth=1,this.endClip(),n.returnObject?m:m.colors},i.ChartEngine.prototype.getPreviousBar=function(t,e,i){return this.getNextBarInternal(t,e,i,-1)},i.ChartEngine.prototype.getNextBar=function(t,e,i){return this.getNextBarInternal(t,e,i,1)},i.ChartEngine.prototype.getNextBarInternal=function(t,e,r,n){var a=t.dataSegment&&t.dataSegment[r];if(a)for(var s=a.tick;s>0&&s<t.dataSet.length;){s+=n;var o=t.dataSet[s];if(o){var l=i.existsInObjectChain(o,e);if(l&&l.obj[l.member])return o}}return null},i.ChartEngine.prototype.updateFloatHRLabel=function(t){var e=t.yaxisLHS.concat(t.yaxisRHS),r=this.crossYActualPos?this.crossYActualPos:this.cy;if(this.floatCanvas.isDirty&&i.clearCanvas(this.floatCanvas,this),"none"!=this.controls.crossX.style.display){if(this.controls.crossY){var n=t.width;"roundRectArrow"==this.yaxisLabelStyle&&(n-=7),this.controls.crossY.style.left=t.left+"px",this.controls.crossY.style.width=n+"px"}for(var a=0;a<e.length;a++){var s=e[a],o=this.transformedPriceFromPixel(r,t,s);if(!isNaN(o)&&!((t.min||0===t.min)&&o<t.min||(t.max||0===t.max)&&o>t.max)){var l=null;s!==t.chart.yAxis&&(l=0,s.shadow<1e3&&(l=2),s.shadow<5&&(l=4),(s.decimalPlaces||0===s.decimalPlaces)&&(l=s.decimalPlaces)),o=s.priceFormatter?s.priceFormatter(this,t,o,l):this.formatYAxisPrice(o,t,l,s);var h=this.canvasStyle("stx-float-price");this.createYAxisLabel(t,o,r,h.backgroundColor,h.color,this.floatCanvas.context,s),this.floatCanvas.isDirty=!0}}}},i.ChartEngine.prototype.headsUpHR=function(){function t(t){i.efficientDOMUpdate(n,"innerHTML",t)}if(!this.runPrepend("headsUpHR",arguments)){var e=this.currentPanel;if(e){var r=e.chart;this.updateFloatHRLabel(e);var n=this.controls.floatDate;if(n&&!i.ChartEngine.hideDates()){var a=this.barFromPixel(this.cx),s=r.xaxis[a];t(s&&s.DT?i.displayableDate(this,r,s.DT):s&&s.index?s.index:"")}this.runAppend("headsUpHR",arguments)}}},i.ChartEngine.prototype.setCrosshairColors=function(){},i.ChartEngine.prototype.magnetize=function(){if(this.magnetizedPrice=null,!this.runPrepend("magnetize",arguments)){var t=this.currentVectorParameters.vectorType
;if(("annotation"!=t&&"callout"!=t||!i.ChartEngine.drawingLine)&&"projection"!=t&&"freeform"!=t){var e=this.currentPanel;if(e.name==e.chart.name){var r=e.chart,n=this.tickFromPixel(i.ChartEngine.crosshairX-this.left,r);if(n>r.dataSet.length)return;var a=r.dataSet[n];if(!a)return;var s=this.valueFromPixel(this.cy,e);this.magnetizedPrice=a.Close;if(this.mainSeriesRenderer&&this.mainSeriesRenderer.highLowBars||this.highLowBars[this.layout.chartType])for(var o=["Open","High","Low","Close"],l=1e9,h=0;h<o.length;h++){var c=a[o[h]];Math.abs(s-c)<l&&(l=Math.abs(s-c),this.magnetizedPrice=c)}var u=this.pixelFromTick(n,r),d=this.pixelFromPrice(this.magnetizedPrice,this.currentPanel),p=this.chart.tempCanvas.context;p.beginPath(),p.lineWidth=1;var f=Math.max(this.layout.candleWidth,12)/3;p.arc(u,d,Math.min(f,8),0,2*Math.PI,!1),p.fillStyle="#FFFFFF",p.strokeStyle="#000000",p.fill(),p.stroke(),p.closePath(),this.chart.tempCanvas.style.display="block"}this.runAppend("magnetize",arguments)}}},i.ChartEngine.prototype.positionCrosshairsAtPointer=function(){var t=this.currentPanel;if(t&&!this.runPrepend("positionCrosshairsAtPointer",arguments)){var e=t.chart,r=this.container.getBoundingClientRect();this.top=r.top,this.left=r.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cy=this.crossYActualPos=this.backOutY(i.ChartEngine.crosshairY),this.cx=this.backOutX(i.ChartEngine.crosshairX);var n=this.crosshairTick=this.tickFromPixel(this.cx,e),a=this.pixelFromTick(n,e)-1;if(this.controls.crossX.style.left=a+"px",a>=t.right||a<=t.left)return void this.undisplayCrosshairs();var s="chart"==t.name?this.preferences.horizontalCrosshairField:t.horizontalCrosshairField,o=e.dataSet;s&&o&&n<o.length&&n>-1&&(this.crossYActualPos=this.pixelFromPrice(o[n][s],t)),this.controls.crossY.style.top=this.crossYActualPos+"px",this.runAppend("positionCrosshairsAtPointer",arguments)}},i.ChartEngine.prototype.doDisplayCrosshairs=function(){if(!this.runPrepend("doDisplayCrosshairs",arguments)){if(this.displayInitialized){var t=this.floatCanvas,e=this.currentVectorParameters.vectorType;if(this.layout.crosshair||""!==e&&e)if(i.Drawing&&i.Drawing[e]&&(new i.Drawing[e]).dragToDraw)this.undisplayCrosshairs();else if(this.overXAxis||this.overYAxis||!i.ChartEngine.insideChart&&!this.grabbingScreen)this.undisplayCrosshairs();else if(""!==this.openDialog)this.undisplayCrosshairs();else{var r=this.controls,n=r.crossX,a=r.crossY;""!==n.style.display&&(n.style.display="",a.style.display="",this.preferences.magnet&&e?(i.unappendClassName(this.container,"stx-crosshair-on"),this.chart.tempCanvas.style.display="block"):i.appendClassName(this.container,"stx-crosshair-on")),r.floatDate&&!i.ChartEngine.hideDates()&&(r.floatDate.style.visibility="",this.currentPanel&&this.updateFloatHRLabel(this.currentPanel)),t&&(t.style.display="block")}else this.undisplayCrosshairs()}this.runAppend("doDisplayCrosshairs",arguments)}},i.ChartEngine.prototype.undisplayCrosshairs=function(){if(!this.runPrepend("undisplayCrosshairs",arguments)){var t=this.controls,e=t.crossX,r=t.crossY;e&&"none"!=e.style.display&&(e.style.display="none",r.style.display="none"),this.displayInitialized&&t.floatDate&&(t.floatDate.style.visibility="hidden"),i.unappendClassName(this.container,"stx-crosshair-on");var n=this.floatCanvas;if(n&&n.isDirty&&(i.clearCanvas(n,this),"none"!=n.style.display&&(n.style.display="none")),!this.activeDrawing&&!this.repositioningDrawing&&!this.editingAnnotation){var a=this.chart.tempCanvas;a&&"none"!=a.style.display&&(a.style.display="none")}this.runAppend("undisplayCrosshairs",arguments)}},i.ChartEngine.prototype.modalBegin=function(){this.openDialog="modal",this.undisplayCrosshairs()},i.ChartEngine.prototype.modalEnd=function(){this.cancelTouchSingleClick=!0,this.openDialog="",this.doDisplayCrosshairs()},i.ChartEngine.prototype.updateChartAccessories=function(){if(null!==this.accessoryTimer&&clearTimeout(this.accessoryTimer),!i.ChartEngine.drawingLine&&i.touchDevice&&(new Date).getTime()-this.lastAccessoryUpdate<100)return void(this.accessoryTimer=setTimeout(function(t){return function(){t.updateChartAccessories()}}(this),10));if(this.chart.dataSet&&!this.runPrepend("updateChartAccessories",arguments)){this.positionCrosshairsAtPointer(),this.accessoryTimer=null,this.lastAccessoryUpdate=(new Date).getTime();var t=this.controls.floatDate;if(t){var e=this.currentPanel;if(e||(e=this.chart.panel),e){var r=e.chart,n=!0===this.xAxisAsFooter?0:this.chart.canvasHeight-e.chart.bottom,a=this.pixelFromTick(this.crosshairTick,r)-t.offsetWidth/2-.5;a<0&&(a=0),i.efficientDOMUpdate(t.style,"left",a+"px"),i.efficientDOMUpdate(t.style,"bottom",n+"px")}}this.headsUpHR(),this.runAppend("updateChartAccessories",arguments)}},i.ChartEngine.prototype.mousemove=function(t){var e=t||event;i.ChartEngine.crosshairX=e.clientX,i.ChartEngine.crosshairY=e.clientY,this.runPrepend("mousemove",arguments)||this.displayInitialized&&""===this.openDialog&&(this.mousemoveinner(e.clientX,e.clientY),this.runAppend("mousemove",arguments))},i.ChartEngine.prototype.setResizeTimer=function(t){this.resizeDetectMS=t,t?(this.resizeTimeout&&window.clearInterval(this.resizeTimeout),this.resizeTimeout=window.setInterval(function(t){return function(){t.chart.canvas&&(i.isAndroid||t.chart.canvas.height==Math.floor(t.devicePixelRatio*t.chart.container.clientHeight)&&t.chart.canvas.width==Math.floor(t.devicePixelRatio*t.chart.container.clientWidth)||t.resizeChart())}}(this),t)):(this.resizeTimeout&&window.clearInterval(this.resizeTimeout),this.resizeTimeout=null)},i.ChartEngine.prototype.whichYAxis=function(t,e){if(void 0===e&&(e=this.cx),t)for(var i=t.yaxisLHS.concat(t.yaxisRHS),r=0;r<i.length;r++){var n=i[r];if(n.left<=e&&n.left+n.width>=e)return n}return this.chart.panel.yAxis},i.ChartEngine.prototype.findHighlights=function(t,e){function r(t,e,r,n,a){function s(t){if(!t)return null;var e=t[c];return e&&(e[u]||0===e[u])&&(e=e[u]),o.transformFunc&&n==o.yAxis?t.transform&&c in t.transform?(e=t.transform[c],e&&(e[u]||0===e[u])&&(e=e[u]),e):o.transformFunc(this,o,e):e}var o=this.chart,l=this.currentPanel;n||(n=o.yAxis);var h=r.split("--\x3e"),c=h[0],u=h[1];u||(u="Close");var d,p,f,m,g,v=o.dataSegment[C],y=null,x=null,b=null,S=new Array(3);if(v&&a){f=a[C],y=v.tick,(f||0===f)&&(S[0]=1);var w;for(w=C-1;w>=0;w--)if(a[w]||0===a[w]){m=a[w],x=y-(C-w),S[1]=1;break}for(w=C+1;w<o.dataSegment.length;w++)if(a[w]||0===a[w]){g=a[w],b=y-(C-w),S[2]=1;break}}if(null===x&&(d=this.getPreviousBar.call(this,o,r,C))&&(x=d.tick,m=s(d)),null===b&&(p=this.getNextBar.call(this,o,r,C))&&(b=p.tick,g=s(p)),null===x&&null===b)return!1;a||(f=s(v),m=s(d),g=s(p),y=v.tick,d&&(x=d.tick),p&&(b=p.tick)),m||0===m||(m=0,x=0),g||0===g||(f||0===f?(g=f,S[2]=S[0]):(g=m,S[2]=S[1]),b=o.dataSet.length-1),f||0===f||(f=g,y=b,S[0]=S[2],0===m&&0===x&&(m=f,x=y,S[1]=S[0]));var M=this.pixelFromTransformedValue.bind(this),T=this.valueFromPixel.bind(this);return f=T(S[0]?f:M(f,l,n),l),m=T(S[1]?m:M(m,l,n),l),g=T(S[2]?g:M(g,l,n),l),!(!i.boxIntersects(e.x0,e.y0,e.x1,e.y1,x,m,y,f,"segment")&&!i.boxIntersects(e.x0,e.y0,e.x1,e.y1,y,f,b,g,"segment"))}var n=this.preferences.highlightsRadius;t&&(n=this.preferences.highlightsTapRadius);var a=this.cy,s=this.cx;if(this.anyHighlighted=!1,this.currentPanel){this.preferences.magnet&&!this.activeDrawing&&i.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing&&(e=!0);var o=!1,l=null,h=e?null:["","",!0,null,"drawing"],c=this.currentPanel.chart,u={x0:this.tickFromPixel(s-n,c),x1:this.tickFromPixel(s+n,c),y0:this.valueFromPixel(a-n,this.currentPanel),y1:this.valueFromPixel(a+n,this.currentPanel)};this.repositioningDrawing&&u.x1-u.x0<2?(u.x1++,u.x0--):u.x1==u.x0&&(u.x0-=.5,u.x1+=.5);for(var d=this.drawingObjects.length-1;d>=0;d--){var p=this.drawingObjects[d];if(!p.permanent&&(this.panels[p.panelName]&&(!this.repositioningDrawing||this.repositioningDrawing==p))){var f=p.highlighted,m=p.panelName==this.currentPanel.name;p.repositioner=p.intersected(this.crosshairTick,this.crosshairValue,u),m=m&&p.repositioner,!e&&m?(f?(l=p,this.anyHighlighted&&this.singleDrawingHighlight&&(p.highlighted=!1)):f!=p.highlight(!0)&&(l||(l=p),this.anyHighlighted&&this.singleDrawingHighlight&&(p.highlighted=!1),o=!0),this.anyHighlighted=!0):f!=p.highlight(!1)&&(o=!0)}}var g,v,y;for(g in this.overlays)v=this.overlays[g],v.prev=v.highlight,v.highlight=!1;for(g in c.seriesRenderers)for(var x=c.seriesRenderers[g],b=0;b<x.seriesParams.length;b++)y=x.seriesParams[b],y.prev=y.highlight,y.highlight=!1;if(!e){var C=this.barFromPixel(s);if(C>=0&&C<c.dataSegment.length){var S;for(g in this.overlays)if(v=this.overlays[g],v.panel==this.currentPanel.name&&!1!==v.study.isHighlighted)if("function"!=typeof v.study.isHighlighted){var w=c.dataSegment[C];if(w){for(var M in v.outputMap)if(r.call(this,C,u,M,this.panels[v.panel].yAxis)){v.highlight=!0,this.anyHighlighted=!0;break}if(v.highlight)break}}else v.study.isHighlighted(this,s,a)&&(v.highlight=!0,this.anyHighlighted=!0);for(g in c.seriesRenderers){var T=c.seriesRenderers[g],B=T.params.panel;if(T.params.highlightable&&B==this.currentPanel.name)for(var k=0;k<T.seriesParams.length;k++){y=T.seriesParams[k];var D=y.field;y.symbol&&y.subField&&(D+="--\x3e"+y.subField);var A=T.params.yAxis;if(!A&&B&&(A=this.panels[B].yAxis),T.params.step&&C>0){if(!T.caches[y.id])continue;if(!(S=T.caches[y.id][C])&&0!==S)continue;var F=T.caches[y.id][C-1];((F||0===F)&&a+n>=S&&a-n<=F||a-n<=S&&a+n>=F)&&(y.highlight=!0,this.anyHighlighted=!0)}else r.call(this,C,u,D,A,T.caches[y.id])&&(y.highlight=!0,this.anyHighlighted=!0)}}}}for(g in this.overlays){if(v=this.overlays[g],v.highlight){this.anyHighlighted=!0;var _=v.inputs.display||v.name;_=this.translateIf(_),h=[_,null,null,v.permanent,"study"],l=null}v.prev!=v.highlight&&(o=!0)}for(g in c.seriesRenderers){var P=c.seriesRenderers[g];if(P.params.highlightable)for(var E=P.params.yAxis?P.params.yAxis.textStyle:null,L=0;L<P.seriesParams.length;L++)y=P.seriesParams[L],y.highlight&&(this.anyHighlighted=!0,h=[y.display?y.display:y.symbol,y.color||E,!1,y.permanent,"series"],l=null),y.prev!=y.highlight&&(o=!0)}o&&(this.draw(),this.displaySticky.apply(this,this.anyHighlighted?h:null),this.clearMeasure(),l&&l.measure()),this.anyHighlighted||this.setMeasure()}},i.ChartEngine.prototype.positionSticky=function(t){var e=Math.max(this.cy-t.offsetHeight-60,0),i=Math.min(this.chart.canvasWidth-(this.cx-50),this.chart.canvasWidth-t.offsetWidth);t.style.top=e+"px",t.style.right=i+"px"},i.ChartEngine.prototype.displaySticky=function(t,e,r,a,s){var o=this.controls.mSticky;if(o){var l=n("#mStickyInterior",o);if(l){var h=n("#overlayTrashCan",o),c=n(".overlayEdit",o),u=n("#mouseDeleteInstructions",o);r||t?(t||(t=""),r&&!t?(l.style.backgroundColor="",l.style.color="",l.style.display="none"):e?(l.style.backgroundColor=e,l.style.color=i.chooseForegroundColor(e),l.style.display="inline-block"):(l.style.backgroundColor="",l.style.color="",l.style.display="inline-block"),l.innerHTML=t,s&&(n("#mStickyRightClick",o).className="rightclick_"+s),o.style.display="inline-block",this.positionSticky(o),a||!0===this.bypassRightClick||this.bypassRightClick[s]?this.controls.mSticky.style.display="none":i.touchDevice?(h&&(h.style.display="inline-block"),c&&(c.style.display="inline-block"),u&&(u.style.display="none")):u&&(u.style.display="block")):(l.innerHTML="",o.style.display="none",i.touchDevice?(h&&(h.style.display="none"),c&&(c.style.display="none")):i.touchDevice||u&&(u.style.display="none"))}}},i.ChartEngine.prototype.setMeasure=function(t,e,i,n,a){if(!this.runPrepend("setMeasure",arguments)){var s=r("mMeasure"),o="";if(t){var l=Math.round(Math.abs(t-e)*this.chart.roundit)/this.chart.roundit;l=l.toFixed(this.chart.yAxis.printDecimalPlaces),this.internationalizer?o+=this.internationalizer.numbers.format(l):o+=l;var h=(e-t)/t;h=Math.abs(h)>.1?Math.round(100*h):Math.abs(h)>.01?Math.round(1e3*h)/10:Math.round(1e4*h)/100,this.internationalizer?h=this.internationalizer.percent.format(h/100):h+="%",o+=" ("+h+")";var c=Math.abs(n-i);c=Math.round(c)+1;o+=" "+c+" "+this.translateIf("Bars"),s&&("measureLit"!=s.className&&(s.className="measureLit"),s.innerHTML=o)}else s&&"measureUnlit"!=s.className&&(s.className="measureUnlit"),this.anyHighlighted||""!==this.currentVectorParameters.vectorType||this.clearMeasure();this.activeDrawing||(s=this.controls.mSticky,s&&(a?(s.style.display="inline-block",s.children[0].style.display="inline-block",t&&(s.children[0].innerHTML=o),this.positionSticky(s)):(s.style.display="none",s.children[0].innerHTML="")),this.runAppend("setMeasure",arguments))}},i.ChartEngine.prototype.clearMeasure=function(){var t=r("mMeasure");t&&("measureUnlit"!=t.className&&(t.className="measureUnlit"),t.innerHTML="")},i.ChartEngine.prototype.pixelFromBar=function(t,e){e||(e=this.chart);var i=0,r=this.chart.segmentImage;return i=r&&r[t]&&r[t].leftOffset?r[t].leftOffset:(t+.5)*this.layout.candleWidth,i=e.panel.left+Math.floor(i+this.micropixels)-1},i.ChartEngine.prototype.barFromPixel=function(t,e){e||(e=this.chart);var i=this.chart.segmentImage,r=this.micropixels,n=this.layout.candleWidth;if(i){var a,s,o,l=t-e.panel.left-r,h=2,c=i.length,u=Math.round(c/h),d=i[c-1].leftOffset+i[c-1].candleWidth/2;if(l>d)return c+Math.floor((t-d-e.panel.left-r)/n);for(var p=1;p<c&&(h*=2,a=i[u]);p++){s=a.leftOffset,o=a.candleWidth/2;var f=s-o,m=s+o;if(0===u||l>=f&&l<m)break;l<f?u-=Math.max(1,Math.round(c/h)):u+=Math.max(1,Math.round(c/h)),u=Math.max(0,Math.min(c-1,u))}if(!i[u])for(p=0;p<c;p++)if(a=i[p]){if(s=a.leftOffset,o=a.candleWidth/2,l<s-o)return Math.max(0,p-1);if(l<s+o)return p;if(l>=s+o)return p+1}return u}return Math.floor((t-e.panel.left-r)/n)},i.ChartEngine.prototype.tickFromPixel=function(t,e){e||(e=this.chart);var i=e.dataSet.length-e.scroll;return e.segmentImage?i+=this.barFromPixel(t,e):i+=Math.floor((t-e.panel.left-this.micropixels)/this.layout.candleWidth),i},i.ChartEngine.prototype.pixelFromTick=function(t,e){e||(e=this.chart);var i=e.dataSegment,r=e.dataSet,n=e.segmentImage,a=this.micropixels,s=i?i.length:0,o=e.panel,l=e.scroll,h=t-r.length+l,c=s?i[h]:null;if(n&&(c=n[h]),c&&c.leftOffset)return o.left+Math.floor(c.leftOffset+a);var u=0,d=0;return c=s?i[s-1]:null,n&&(c=n[s-1]),c&&c.leftOffset&&s<t-r.length+l&&(u=c.leftOffset-c.candleWidth/2,d=s),u+o.left+Math.floor((t-d-r.length+l+.5)*this.layout.candleWidth+a)},i.ChartEngine.prototype.pixelFromDate=function(t,e){return this.pixelFromTick(this.tickFromDate(t,e),e)},i.ChartEngine.prototype.transformedPriceFromPixel=function(t,e,i){e||(e=this.chart.panel);var r=i||e.yAxis;if(t=r.bottom-t,!r.multiplier)return null;var n=r.low+t/r.multiplier;if(r.semiLog){var a=r.logLow+t*r.logShadow/r.height;n=Math.pow(10,a)}return n},i.ChartEngine.prototype.priceFromPixel=function(t,e,i){e||(e=this.chart.panel);var r=this.transformedPriceFromPixel(t,e,i);return this.charts[e.name]&&e.chart.untransformFunc&&(r=e.chart.untransformFunc(this,e.chart,r,i)),r},i.ChartEngine.prototype.valueFromPixel=function(t,e,r){return e||(e=this.whichPanel(t)),e||(e=t<=0?this.panels[i.first(this.panels)]:this.panels[i.last(this.panels)]),this.priceFromPixel(t,e,r)},i.ChartEngine.prototype.valueFromPixelUntransform=function(t,e,i){return this.valueFromPixel(t,e,i)},i.ChartEngine.prototype.pixelFromPriceTransform=function(t,e,i){return this.pixelFromPrice(t,e,i)},i.ChartEngine.prototype.pixelFromTransformedValue=function(t,e,i){e||(e=this.chart.panel);var r=i||e.yAxis,n=(r.high-t)*r.multiplier;if(r.semiLog){var a=Math.max(t,0),s=Math.log(a)/Math.LN10,o=r.height;n=o-o*(s-r.logLow)/r.logShadow}return n+=r.top},i.ChartEngine.prototype.pixelFromPrice=function(t,e,i){return e||(e=this.chart.panel),this.charts[e.name]&&e.chart.transformFunc&&(t=e.chart.transformFunc(this,e.chart,t,i)),this.pixelFromTransformedValue(t,e,i)},i.ChartEngine.prototype.pixelFromValueAdjusted=function(t,e,i,r){if(this.layout.adj||!this.charts[t.name])return this.pixelFromPrice(i,t,r);var n,a=Math.round(e);return a>0&&a<t.chart.dataSet.length&&(n=t.chart.dataSet[a].ratio)?this.pixelFromPrice(i*n,t,r):this.pixelFromPrice(i,t,r)},i.ChartEngine.prototype.adjustIfNecessary=function(t,e,i){if(this.layout.adj)return i;if(!t||!this.charts[t.name])return i;var r,n=Math.round(e);return n>0&&n<t.chart.dataSet.length&&(r=t.chart.dataSet[n].ratio)?i/r:i},i.ChartEngine.prototype.setTransform=function(t,e,i){t.transformFunc=e,t.untransformFunc=i},i.ChartEngine.prototype.unsetTransform=function(t){delete t.transformFunc,delete t.untransformFunc;for(var e=0;e<t.dataSet.length;e++)t.dataSet[e].transform=null},i.ChartEngine.prototype.undo=function(){this.runPrepend("undo",arguments)||(this.activeDrawing&&(this.activeDrawing.abort(),this.activateDrawing(null),i.clearCanvas(this.chart.tempCanvas,this),this.draw(),i.swapClassName(this.controls.crossX,"stx_crosshair","stx_crosshair_drawing"),i.swapClassName(this.controls.crossY,"stx_crosshair","stx_crosshair_drawing"),i.ChartEngine.drawingLine=!1),this.runAppend("undo",arguments))},i.ChartEngine.prototype.undoStamp=function(t,e){this.undoStamps.push(t),this.dispatch("undoStamp",{before:t,after:e,stx:this})},i.ChartEngine.prototype.undoLast=function(){this.activeDrawing?this.undo():this.undoStamps.length&&(this.drawingObjects=this.undoStamps.pop(),this.changeOccurred("vector"),this.draw())},i.ChartEngine.prototype.addDrawing=function(t){var e=i.shallowClone(this.drawingObjects);this.drawingObjects.push(t),this.undoStamp(e,i.shallowClone(this.drawingObjects))},i.ChartEngine.prototype.connectTheDots=function(t,e,r,n,a,s){if(s||(s={}),"none"!=s.pattern&&(!0===a&&(a=this.chart.panel),null!==n&&void 0!==n||(n=this.chart.context),!(t.length<4))){var o=0,l=this.chart.canvasHeight,h=this.chart.width;a&&(l=a.yAxis.bottom,o=a.yAxis.top),n.lineWidth=1.1,"object"==typeof e?(n.strokeStyle=e.color,e.opacity?n.globalAlpha=e.opacity:n.globalAlpha=1,n.lineWidth=parseInt(i.stripPX(e.width),10)):!e||"auto"==e||i.isTransparent(e)?n.strokeStyle=this.defaultColor:n.strokeStyle=e,s.opacity&&(n.globalAlpha=s.opacity),s.lineWidth&&(n.lineWidth=s.lineWidth);var c=i.borderPatternToArray(n.lineWidth,s.pattern);n.beginPath();for(var u=0;u<t.length-2;u+=2){var d=t[u],p=t[u+1],f=t[u+2],m=t[u+3];if(isNaN(d)||isNaN(f)||isNaN(p)||isNaN(m))return;for(var g,v,y,x=0,b=1,C=f-d,S=m-p,w=0;w<4;w++){if(0===w&&(g=-C,v=-(0-d)),1==w&&(g=C,v=h-d),2==w&&(g=-S,v=-(o-p)),3==w&&(g=S,v=l-p),y=v/g,(m||0===m)&&0===g&&v<0)return!1;if(g<0){if(y>b)return!1;y>x&&(x=y)}else if(g>0){if(y<x)return!1;y<b&&(b=y)}}var M=d+x*C,T=p+x*S,B=d+b*C,k=p+b*S;try{c&&c.length?n.dashedLineTo(M,T,B,k,c):(n.moveTo(M,T),n.lineTo(B,k))}catch(t){}}n.stroke(),n.closePath(),n.globalAlpha=1,n.lineWidth=1}},i.ChartEngine.prototype.plotSpline=function(t,e,r,n,s,o,l){if(l||(l={}),"none"!=l.pattern){!0===o&&(o=this.chart.panel),null!==s&&void 0!==s||(s=this.chart.context),s.save(),s.lineWidth=1.1,"object"==typeof r?(s.strokeStyle=r.color,r.opacity?s.globalAlpha=r.opacity:s.globalAlpha=1,s.lineWidth=parseInt(i.stripPX(r.width),10)):!r||"auto"==r||i.isTransparent(r)?s.strokeStyle=this.defaultColor:s.strokeStyle=r,l.opacity&&(s.globalAlpha=l.opacity),l.lineWidth&&(s.lineWidth=l.lineWidth);var h=i.borderPatternToArray(s.lineWidth,l.pattern);l.pattern&&s.setLineDash&&(s.setLineDash(h),s.lineDashOffset=0),s.beginPath(),a.plotSpline(t,e,s),s.stroke(),s.closePath(),s.restore()}},i.ChartEngine.prototype.repositionDrawing=function(t,e){var r=this.panels[t.panelName],n=this.adjustIfNecessary(r,this.crosshairTick,this.valueFromPixel(this.backOutY(i.ChartEngine.crosshairY),r));this.preferences.magnet&&this.magnetizedPrice&&r.name==r.chart.name&&(n=this.adjustIfNecessary(r,this.crosshairTick,this.magnetizedPrice));var a=this.chart.tempCanvas;i.clearCanvas(a,this),e?t.render(a.context):t.reposition(a.context,t.repositioner,this.crosshairTick,n),t.measure&&t.measure()},i.ChartEngine.prototype.activateRepositioning=function(t){this.repositioningDrawing=t;t&&(this.draw(),this.repositionDrawing(t,!0)),this.chart.tempCanvas.style.display=t?"block":"none"},i.ChartEngine.prototype.activateDrawing=function(t,e){if(!t)return this.activeDrawing=null,this.chart.tempCanvas.style.display="none",!1;e||(e=this.chart.panel);var r=i.ChartEngine.drawingTools[t];return r||i.Drawing[t]&&(r=i.Drawing[t],i.ChartEngine.registerDrawingTool(t,r)),r&&(this.activeDrawing=new r,this.activeDrawing.construct(this,e),!this.charts[e.name]&&this.activeDrawing.chartsOnly)?(this.activeDrawing=null,!1):(this.chart.tempCanvas.style.display="block",!0)},i.ChartEngine.prototype.drawingClick=function(t,e,r){if(i.Drawing&&t&&""===this.openDialog&&(this.activeDrawing||this.activateDrawing(this.currentVectorParameters.vectorType,t))){if(this.activeDrawing){if(this.userPointerDown&&!this.activeDrawing.dragToDraw)return void(i.ChartEngine.drawingLine||this.activateDrawing(null));var n=this.tickFromPixel(e,t.chart),a=this.panels[this.activeDrawing.panelName],s=this.adjustIfNecessary(a,n,this.valueFromPixel(r,a));return this.preferences.magnet&&this.magnetizedPrice&&(s=this.adjustIfNecessary(a,n,this.magnetizedPrice)),this.activeDrawing.click(this.chart.tempCanvas.context,n,s)?this.activeDrawing&&(i.ChartEngine.drawingLine=!1,i.clearCanvas(this.chart.tempCanvas,this),this.addDrawing(this.activeDrawing),this.activateDrawing(null),this.adjustDrawings(),this.draw(),this.changeOccurred("vector"),i.swapClassName(this.controls.crossX,"stx_crosshair","stx_crosshair_drawing"),i.swapClassName(this.controls.crossY,"stx_crosshair","stx_crosshair_drawing")):(this.changeOccurred("drawing"),i.ChartEngine.drawingLine=!0,i.swapClassName(this.controls.crossX,"stx_crosshair_drawing","stx_crosshair"),i.swapClassName(this.controls.crossY,"stx_crosshair_drawing","stx_crosshair")),!0}return!1}},i.ChartEngine.prototype.whichPanel=function(t){for(var e in this.panels){var i=this.panels[e];if(!i.hidden&&(t>i.top&&t<i.bottom))return i}return null},i.ChartEngine.prototype.mouseup=function(t){if(!this.runPrepend("mouseup",arguments)){if(this.swipe.end=!0,this.cancelLongHold=!0,this.repositioningDrawing){if(!this.currentVectorParameters.vectorType||Date.now()-this.mouseTimer>250)return this.changeOccurred("vector"),i.clearCanvas(this.chart.tempCanvas,this),this.activateRepositioning(null),this.adjustDrawings(),void this.draw();this.activateRepositioning(null)}if(this.repositioningBaseline){this.repositioningBaseline=null;var e=this.mainSeriesRenderer||{};return e.params&&e.params.baseline&&"mountain"!=e.params.type&&(this.chart.panel.yAxis.scroll=this.pixelFromPrice(this.chart.baseline.userLevel,this.chart.panel)-(this.chart.panel.yAxis.top+this.chart.panel.yAxis.bottom)/2),void this.draw()}var r=this.userPointerDown;if(this.userPointerDown=!1,this.displayInitialized){if(this.grabbingScreen=!1,""!==this.openDialog)return void(i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"));if(this.grabOverrideClick)return this.swipeRelease(),i.unappendClassName(this.container,"stx-drag-chart"),this.grabOverrideClick=!1,this.doDisplayCrosshairs(),void this.updateChartAccessories();if(i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),i.ChartEngine.resizingPanel)return void this.releaseHandle({});if(t||(t=event),t.which&&t.which>=2||t.button&&t.button>=2||t.ctrlKey)return this.anyHighlighted&&!0!==this.bypassRightClick?(this.rightClickHighlighted(),t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),t.stopPropagation(),!1):(this.dispatch("rightClick",{stx:this,panel:this.currentPanel,x:a,y:n}),!0);if(!(t.clientX<this.left||t.clientX>this.right||t.clientY<this.top||t.clientY>this.bottom)){var n=this.backOutY(t.clientY),a=this.backOutX(t.clientX);!r||this.longHoldTookEffect&&!this.activeDrawing||this.drawingClick(this.currentPanel,a,n),this.activeDrawing||this.longHoldTookEffect||this.dispatch("tap",{stx:this,panel:this.currentPanel,x:a,y:n}),this.runAppend("mouseup",arguments)}}}},i.ChartEngine.prototype.grabbingHand=function(){this.allowScroll&&this.grabbingScreen&&(i.touchDevice||i.appendClassName(this.container,"stx-drag-chart"))},i.ChartEngine.prototype.mousedown=function(t){if(!this.runPrepend("mousedown",arguments)&&(this.grabOverrideClick=!1,this.displayInitialized&&this.displayCrosshairs&&!this.repositioningDrawing&&!(this.editingAnnotation||(t||(t=event),t.which&&t.which>=2||t.button&&t.button>=2)))){var e=this.container.getBoundingClientRect();if(this.top=e.top,this.left=e.left,this.right=this.left+this.width,this.bottom=this.top+this.height,!(t.clientX>=this.left&&t.clientX<=this.right&&t.clientY>=this.top&&t.clientY<=this.bottom))return void(i.ChartEngine.insideChart=!1);if(i.ChartEngine.insideChart=!0,this.currentPanel){this.manageTouchAndMouse&&t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),this.mouseTimer=Date.now(),this.longHoldTookEffect=!1,this.hasDragged=!1,this.userPointerDown=!0;for(var r=this.currentPanel.chart,n=0;n<this.drawingObjects.length;n++){var a=this.drawingObjects[n];if(a.highlighted){if(this.cloneDrawing){var s=i.ChartEngine.drawingTools[a.name],o=new s;return o.reconstruct(this,a.serialize()),this.drawingObjects.push(o),this.activateRepositioning(o),void(o.repositioner=a.repositioner)}var l=this.currentVectorParameters.vectorType;if(!(i.Drawing&&l&&i.Drawing[l]&&(new i.Drawing[l]).dragToDraw))return void this.activateRepositioning(a)}}var h=this.mainSeriesRenderer||{};if(h.params&&h.params.baseline&&!1!==r.baseline.userLevel){var c=this.valueFromPixel(this.cy-5,this.currentPanel),u=this.valueFromPixel(this.cy+5,this.currentPanel),d=this.chart.right-parseInt(getComputedStyle(this.controls.baselineHandle).width,10);if(r.baseline.actualLevel<c&&r.baseline.actualLevel>u&&this.cx>d)return void(this.repositioningBaseline={lastDraw:Date.now()})}this.drawingClick(this.currentPanel,this.cx,this.cy),this.activeDrawing&&this.activeDrawing.dragToDraw||(this.grabbingScreen=!0,r.spanLock=!1,this.yToleranceBroken=!1,t||(t=event),this.grabStartX=t.clientX,this.grabStartY=t.clientY,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=r.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartCandleWidth=this.layout.candleWidth,this.grabStartYAxis=this.whichYAxis(this.currentPanel),this.grabStartZoom=this.grabStartYAxis.zoom,this.grabStartPanel=this.currentPanel,setTimeout(function(t){return function(){t.grabbingHand()}}(this),100),this.swipeStart(r),this.longHoldTime&&this.startLongHoldTimer(),this.runAppend("mousedown",arguments))}}},i.ChartEngine.prototype.startLongHoldTimer=function(){var t=this;this.cancelLongHold=!1,this.longHoldTimeout&&clearTimeout(this.longHoldTimeout),this.longHoldTimeout=setTimeout(function(){t.cancelLongHold||(t.dispatch("longhold",{stx:t,panel:t.currentPanel,x:t.cx,y:t.cy}),t.longHoldTookEffect=!0)},this.longHoldTime)},i.ChartEngine.prototype.changeVectorType=function(t){this.currentVectorParameters.vectorType=t,i.ChartEngine.drawingLine&&this.undo(),this.setCrosshairColors(),i.ChartEngine.insideChart&&this.doDisplayCrosshairs()},i.ChartEngine.prototype.changeVectorParameter=function(t,e){"axisLabel"==t?e="true"===e.toString()||Number(e):"lineWidth"==t?e=Number(e):"fontSize"==t&&(e=parseInt(e,10)+"px");var i=this.currentVectorParameters;return void 0!==i[t]?(i[t]=e,!0):"font"==t.substr(0,4)&&(t=t.substr(4).toLowerCase(),"family"==t&&"default"==e.toLowerCase()&&(e=null),i=i.annotation.font,void 0!==i[t])&&(i[t]=e,!0)},i.ChartEngine.prototype.rightClickOverlay=function(t,e){if(!this.runPrepend("rightClickOverlay",arguments)){var i=this.overlays[t];i.editFunction?i.editFunction(e):this.removeOverlay(t),this.runAppend("rightClickOverlay",arguments)}},i.ChartEngine.prototype.removeOverlay=function(t){if(!this.runPrepend("removeOverlay",arguments)){var e=this.overlays[t];for(var r in this.overlays){var n=this.overlays[r],a=["Field"];i.Studies&&(a=i.Studies.getFieldInputs(n));for(var s=0;s<a.length;s++)e.outputMap[n.inputs[a[s]]]&&this.removeOverlay(n.name)}if(i.Studies){var o=this.layout.studies[t];i.deleteRHS(i.Studies.studyPanelMap,o),e&&this.cleanupRemovedStudy(e)}delete this.overlays[t],this.currentlyImporting||(this.displaySticky(),this.createDataSet(),this.changeOccurred("layout")),this.runAppend("removeOverlay",arguments)}},i.ChartEngine.prototype.addSeries=function(t,e,r){function n(r,n){var a=e.renderer||"Lines",s=e.name||i.uniqueID();if(e.renderer||e.name||e.color||e.chartType){var o=r.getSeriesRenderer(s);if(!o){var l={name:s,overChart:!0,useChartLegend:!0};if(e.chartType?(l=i.extend({panel:e.panel,yAxis:e.yAxis},l),o=i.Renderer.produce(e.chartType,l)):o=new i.Renderer[a]({params:i.extend(l,e)}),!o)return;r.setSeriesRenderer(o)}o.attachSeries(t,e),!1!==e.loadData&&o.ready()}}function a(t){return function(a){a.error||(i.addMemberToMasterdata({stx:p,label:l,fieldForLabel:e.field,data:a.quotes,fillGaps:e.fillGaps,createObject:!0}),n(p,h)),null===e.action||d||p.dispatch(p.currentlyImporting?"symbolImport":"symbolChange",{stx:p,symbol:t.symbol,symbolObject:t.symbolObject,action:e.action}),r&&r.call(p,a.error,h)}}var s=this.runPrepend("addSeries",arguments);if(s)return s;var o=t||null,l=t;t||(t=i.uniqueID());var h={parameters:e?i.clone(e):{},yValueCache:[],display:o,id:t};e=h.parameters,e.symbol&&(l=e.symbol),i.ensureDefaults(e,{chartName:this.chart.name,symbolObject:{symbol:l},panel:this.chart.panel.name,action:"add-series"}),"display"in e&&(h.display=e.display),e.isComparison&&(e.shareYAxis=!0);var c=this.charts[e.chartName],u=e.symbolObject;l=e.symbol=u.symbol,h.display||(h.display=l||e.field),e.isComparison&&void 0===e.gaps&&(e.gaps="transparent");var d=this.getSeries({symbolObject:u,chart:c,includeMaster:!0}).length;c.series[t]=h;var p=this;e.isComparison&&this.setComparison(!0,c);var f=c.masterData;f||(f=c.masterData=this.masterData=[]);var m=f.length;if(e.data&&!e.data.useDefaultQuoteFeed)i.addMemberToMasterdata({stx:this,label:l,fieldForLabel:e.field,data:e.data,fillGaps:e.fillGaps,createObject:!0}),n(this,h),null===e.action||d||p.dispatch(p.currentlyImporting?"symbolImport":"symbolChange",{stx:p,symbol:l,symbolObject:u,action:e.action}),r&&r.call(this,null,h);else if(d)n(this,h),r&&setTimeout(function(){r.call(p,null,h)},0);else if(this.quoteDriver&&!1!==e.loadData){var g=this.quoteDriver,v=g.makeParams(l,u,c);m&&(v.startDate=f[0].DT,v.endDate=this.convertToDataZone(new Date)),v.stx.isEquationChart(v.symbol)?i.fetchEquationChart(v,a(v)):i.ChartEngine.Driver.fetchData(i.QuoteFeed.SERIES,g.quoteFeed,v,a(v))}else n(this,h),r&&r.call(this,null,h);return this.runAppend("addSeries",arguments),h},i.ChartEngine.prototype.getSeries=function(t){var e=t.chart?t.chart:this.chart,r=e.series,n=t.symbolObject;n||(n={symbol:t.symbol});var a=[];for(var s in r){var o=r[s];i.symbolEqual(n,o.parameters.symbolObject)&&a.push(o)}return t.includeMaster&&i.symbolEqual(n,e.symbolObject)&&a.push({}),a},i.ChartEngine.prototype.modifySeries=function(t,e,r){if(!this.runPrepend("modifySeries",arguments)){var n,a,s;"string"==typeof t?(n=e&&e.chartName?this.charts[e.chartName]:this.chart,s=t,a=n.series[s]):(a=t,s=a.id),a&&(i.extend(a.parameters,e||{}),a.parameters.action="modify-series",this.removeSeries(a),a=this.addSeries(s,a.parameters,r),a.parameters.action=null,this.runAppend("modifySeries",arguments))}},i.ChartEngine.prototype.isEquationChart=function(t){return!(!this.allowEquations||!i.computeEquationChart)&&!(!t||"="!=t[0])},i.ChartEngine.prototype.getDataFields=function(t){t||(t=this.chart);var e=t.defaultPlotField||"Close",i=["Open","High","Low"];i.push(e);for(var r in t.series){var n=t.series[r].parameters;i.push(n.symbol)}return i},i.ChartEngine.prototype.cleanMasterData=function(t,e){function i(t,e){for(var i=0;i<e.length;i++){if(void 0!==t[e[i]])return!1}return!0}var r=t.symbol,n=e.masterData;if(n&&n.length){var a=this.getDataFields(e),s=0;do{var o=n[s];delete o[r],i.call(this,o,a)?n.splice(s,1):s++}while(s<n.length);n=this.doCleanupGaps(n),this.setMasterData(n,e)}},i.ChartEngine.prototype.deleteSeries=function(t,e,i){
if(!this.runPrepend("deleteSeries",arguments)){i=i||{};var r,n=i.action?i.action:"remove-series";"object"==typeof t?(r=t.id,e=e||this.charts[t.parameters.chartName]):(r=t,e=e||this.chart);var a=e.series[r];if(a){var s=a.parameters.loadData,o=a.parameters.symbolObject;"modify-series"!==a.parameters.action&&delete e.series[r];var l=this.getSeries({symbolObject:o,includeMaster:!0});if(!1===s&&l.push(r),l.length||this.cleanMasterData(o,e),"percent"!=this.layout.chartScale){var h=!1;for(var c in e.series)e.series[c].parameters.isComparison&&(h=!0);h||this.setComparison(!1,e)}this.createDataSet(),l.length||this.dispatch(this.currentlyImporting?"symbolImport":"symbolChange",{stx:this,symbol:o.symbol,symbolObject:o,action:n}),this.quoteDriver&&this.quoteDriver.updateSubscriptions(),this.runAppend("deleteSeries",arguments)}}},i.ChartEngine.prototype.removeSeries=function(t,e){if(!this.runPrepend("removeSeries",arguments)){var i,r=!1;"object"==typeof t?(i=t.id,e=e||this.charts[t.parameters.chartName]):(i=t,e=e||this.chart);for(var n in e.seriesRenderers)for(var a=e.seriesRenderers[n],s=a.seriesParams.length-1;s>=0;s--){var o=a.seriesParams[s];o.id===i&&(a.removeSeries(i),a.seriesParams.length<1&&this.removeSeriesRenderer(a),r=!0)}r||this.deleteSeries(i,e),this.draw(),this.runAppend("removeSeries",arguments)}},i.ChartEngine.prototype.isDailyInterval=function(t){return console.warn("CIQ.ChartEngine.prototype.isDailyInterval has been deprecated. Use use static version insted"),i.ChartEngine.isDailyInterval(t)},i.ChartEngine.prototype.setPeriodicity=function(t,e){if(!this.runPrepend("setPeriodicity",arguments)){var r,n,a=null;t&&"object"==typeof t?(r=t.period,n=t.interval,a=t.timeUnit):(r=t,n=e,e=arguments[arguments.length-1],arguments.length>3&&(a=arguments[2])),"function"!=typeof e&&(e=null);var s=i.cleanPeriodicity(r,n,a);r=s.period,n=s.interval,a=s.timeUnit;var o=this.layout,l=o.candleWidth;o.setSpan={},o.range={},this.chart.inflectionPoint=null;var h=!1;if(this.chart.symbol&&(h=this.needDifferentData({periodicity:r,interval:n,timeUnit:a})),o.periodicity=r,o.interval=n,o.timeUnit=a,h)if(this.changeOccurred("layout"),this.quoteDriver)for(var c in this.charts)this.charts[c].symbol&&(this.displayInitialized?this.quoteDriver.newChart({symbol:this.charts[c].symbol,symbolObject:this.charts[c].symbolObject,chart:this.charts[c]},e):this.newChart(this.charts[c].symbol,null,this.charts[c],e));else this.dataCallback?(this.dataCallback(),e&&e(null)):console.log("cannot change periodicity because neither dataCallback or quoteDriver are set");else{var u,d;for(u in this.charts){d=this.charts[u];var p,f=d.dataSegment,m=d.dataSet,g=d.maxTicks,v=d.scroll,y=f?f.length:0,x=m?m.length:0,b=Math.round(d.maxTicks/2);this.setCandleWidth(l,d);var C=!0,S=!1;if(v<=g?C=!1:f&&!f[b]&&(C=!1,S=v-x),C&&y>0&&(g<(Math.round(this.chart.width/l-.499)-1)/2&&(b=y-1),b>=y?(p=f[y-1].DT,b=y-1):p=f[b].DT),this.createDataSet(),C){if(y>0)for(var w=x-1;w>=0;w--){var M=m[w].DT;if(M.getTime()<p.getTime()){d.scroll=x-w+b;break}}}else if(S)d.scroll=m.length+S;else{var T=Math.round(this.preferences.whitespace/l);d.scroll=g-T-1}}if(this.displayInitialized&&this.draw(),this.changeOccurred("layout"),this.quoteDriver)for(u in this.charts)d=this.charts[u],d.symbol&&d.moreAvailable&&this.quoteDriver.checkLoadMore(d);e&&e(null),this.runAppend("setPeriodicity",arguments)}}},i.ChartEngine.prototype.setPeriodicityV2=function(t,e,i,r){"function"==typeof i&&(r=i,i=null),this.runPrepend("setPeriodicityV2",arguments)||(this.setPeriodicity(t,e,i,r),this.runAppend("setPeriodicityV2",arguments))},i.ChartEngine.prototype.drawVectors=function(){if(!this.vectorsShowing&&!this.runPrepend("drawVectors",arguments)){if(this.vectorsShowing=!0,!this.chart.hideDrawings){var t,e,i={};for(e=0;e<this.drawingObjects.length;e++){var r=this.drawingObjects[e];this.repositioningDrawing!==r&&(t=r.panelName,this.panels[r.panelName]&&!this.panels[r.panelName].hidden&&(i[t]||(i[t]=[]),i[t].push(r)))}for(t in i){this.startClip(t);var n=i[t];for(e=0;e<n.length;e++)n[e].render(this.chart.context);this.endClip()}}this.runAppend("drawVectors",arguments)}},i.ChartEngine.NONE=0,i.ChartEngine.CLOSEUP=1,i.ChartEngine.CLOSEDOWN=2,i.ChartEngine.CLOSEEVEN=4,i.ChartEngine.CANDLEUP=8,i.ChartEngine.CANDLEDOWN=16,i.ChartEngine.CANDLEEVEN=32,i.ChartEngine.prototype.displayChart=function(t){this.runPrepend("displayChart",arguments)||(this.rendererAction(t,"main"),this.runAppend("displayChart",arguments))},i.ChartEngine.prototype.calculateATR=function(t,e,i){i||(i=t.dataSet);var r=t.state.calculations.atr;r||(r=t.state.calculations.atr={}),e||(e=20);var n=[];r.accum&&(n=r.accum);for(var a,s=0;s<i.length;s++){var o=i[s];if(a=s?i[s-1]:r.q1){var l=Math.max(o.High-o.Low,Math.abs(o.High-a.Close),Math.abs(o.Low-a.Close));if(n.length<e){if(n.push(l)==e){for(var h=0,c=0;c<n.length;c++)h+=n[c];o.atr=h/e}}else o.atr=(a.atr*(e-1)+l)/e;o.trueRange=l}}t.state.calculations.atr={accum:n,q1:a}},i.ChartEngine.prototype.calculateMedianPrice=function(t,e){e||(e=t.dataSet);for(var i,r=0;r<e.length;++r)i=e[r],i["hl/2"]=(i.High+i.Low)/2},i.ChartEngine.prototype.calculateTypicalPrice=function(t,e){e||(e=t.dataSet);for(var i,r=0;r<e.length;++r)i=e[r],i["hlc/3"]=(i.High+i.Low+i.Close)/3},i.ChartEngine.prototype.calculateWeightedClose=function(t,e){e||(e=t.dataSet);for(var i,r=0;r<e.length;++r)i=e[r],i["hlcc/4"]=(i.High+i.Low+2*i.Close)/4},i.ChartEngine.prototype.calculateOHLC4=function(t,e){e||(e=t.dataSet);for(var i,r=0;r<e.length;++r)i=e[r],i["ohlc/4"]=(i.Open+i.High+i.Low+i.Close)/4},i.ChartEngine.prototype.currentQuote=function(){if(!this.chart.dataSet)return null;for(var t=this.chart.dataSet.length-1;t>=0;t--)if(this.chart.dataSet[t])return this.chart.dataSet[t];return null},i.ChartEngine.prototype.correctIfOffEdge=function(t){if(!this.runPrepend("correctIfOffEdge",arguments)){for(var e in this.charts){var i=this.charts[e],r=i.dataSet,n=i.maxTicks,a=this.layout,s=this.minimumLeftBars;this.mainSeriesRenderer&&this.mainSeriesRenderer.standaloneBars||this.standaloneBars[a.chartType]||s--;var o=Math.min(s,n);if(i.allowScrollPast){var l=n-o;o>r.length&&(l=n-r.length),i.scroll-l>=r.length&&(i.scroll=r.length+l-1,this.micropixels=0),i.scroll<=o&&(i.scroll=o,this.micropixels=0)}else i.scroll<o&&(i.scroll=o),i.scroll>r.length&&(i.scroll=r.length);if(!1===i.allowScrollFuture){var h=this.getLabelOffsetInPixels(i,a.chartType),c=n-Math.round(h/a.candleWidth)-1;(this.micropixels<0?i.scroll-1:i.scroll)<c&&(i.scroll=c,this.micropixels=0)}}this.runAppend("correctIfOffEdge",arguments)}},i.ChartEngine.prototype.createDataSegment=function(t){if(!this.runPrepend("createDataSegment",arguments)){var e;for(var r in this.charts){e=this.charts[r],t&&(e=t),e.isComparison&&i.Comparison.createComparisonSegmentInner(this,e);var n=e.dataSet,a=e.baseline,s=e.scroll,o=e.maxTicks,l=this.layout,h=l.candleWidth;a.actualLevel=a.userLevel?a.userLevel:a.defaultLevel;for(var c,u=a.includeInDataSegment&&(!this.mainSeriesRenderer||!this.mainSeriesRenderer.standaloneBars)&&!this.standaloneBars[l.chartType],d=e.dataSegment=[],p=n.length-1-s-1,f=e.defaultPlotField,m=-1;m<s&&m<o;m++)if(p++,-1!=m||u)if(p<n.length&&p>=0){if(c=n[p],c.candleWidth=null,d.push(c),null===a.actualLevel&&m>=0)if(f&&"Close"!=f){var g=n[p-1];(g[f]||0===g[f])&&(a.actualLevel=g[f])}else(c.iqPrevClose||0===c.iqPrevClose)&&(a.actualLevel=c.iqPrevClose)}else p<0&&d.push(null);e.segmentImage=null;var v=this.mainSeriesRenderer||{};if(v.params&&v.params.volume){for(var y=0,x=e.width-(o-d.length-1)*l.candleWidth,b=0;b<d.length;b++)(c=d[b])&&(y+=c.Volume);var C=0;e.segmentImage=[];for(var S=0;S<d.length;S++){c=d[S],e.segmentImage[S]={};var w=null;c?(c.Volume?(c.candleWidth=x*c.Volume/y,w=C+c.candleWidth/2,C+=c.candleWidth):(c.candleWidth=h,w=C+h/2,C+=h),e.segmentImage[S]={tick:c.tick,candleWidth:c.candleWidth,leftOffset:w}):C+=h}}if(t)break}e&&e.isComparison&&this.clearPixelCache(),this.positionCrosshairsAtPointer(),this.runAppend("createDataSegment",arguments)}},i.ChartEngine.prototype.leftTick=function(){return this.chart.dataSet.length-this.chart.scroll},i.ChartEngine.prototype.getStartDateOffset=function(){for(var t=0;t<this.chart.dataSegment.length;t++)if(this.chart.dataSegment[t])return t;return 0},i.ChartEngine.prototype.setStartDate=function(t){for(var e=0;e<this.chart.dataSet.length;e++){if(this.chart.dataSet[e].DT.getTime()==t.getTime())return this.chart.scroll=this.chart.dataSet.length-e,void this.draw()}},i.ChartEngine.prototype.updateListeners=function(t){for(var e in this.plugins){var i=this.plugins[e];i.display&&i.listener&&i.listener(this,t)}},i.ChartEngine.prototype.clearPixelCache=function(){for(var t in this.panels){var e=this.panels[t];e.cacheHigh=null,e.cacheLow=null,e.cacheLeft=1e6,e.cacheRight=-1}for(var i in this.charts){var r=this.charts[i];if(r.dataSet)for(var n=0;n<r.dataSet.length;n++)r.dataSet[n].cache={}}},i.ChartEngine.prototype.createYAxisLabel=function(t,e,r,n,a,s,o){if(!1!==t.yAxis.drawPriceLabels&&!t.yAxis.noDraw){var l=o||t.yAxis,h=s||this.chart.context,c=this.getCanvasFontSize("stx_yaxis")+6;this.canvasFont("stx_yaxis",h);var u,d=(l.displayBorder,this.drawBorders?3:0);try{u=h.measureText(e).width+d+6}catch(t){u=l.width}var p=l.left-3+3,f=p+3+d,m=3;"left"===(null===l.position?t.chart.yAxis.position:l.position)&&(p=l.left+l.width+3-3,u*=-1,f=p,m=-3,h.textAlign="right"),r+c/2>l.bottom&&(r=l.bottom-c/2),r-c/2<l.top&&(r=l.top+c/2),void 0===i[this.yaxisLabelStyle]&&(this.yaxisLabelStyle="roundRectArrow");var g=this.yaxisLabelStyle;l.yaxisLabelStyle&&(g=l.yaxisLabelStyle);var v={ctx:h,x:p,y:r,top:r-c/2,width:u,height:c,radius:m,backgroundColor:n,fill:!0,stroke:!1,margin:{left:f-p,top:1},txt:e,color:a};i[g](v)}},i.ChartEngine.prototype.createXAxisLabel=function(t,e,r,n,a,s){var o=this.chart.context,l=this.getCanvasFontSize("stx-float-date")+4;this.canvasFont("stx-float-date",o);var h;try{h=o.measureText(e).width+4}catch(t){h=0}var c=t.top+t.height-l;if(!(r+h/2<t.left||r-h/2>t.right)){s||(r+h/2>t.right&&(r=t.right-h/2),r-h/2<t.left&&(r=t.left+h/2)),o.fillStyle=n,i.roundRect({ctx:o,x:r-h/2,top:c,width:h,height:l,radius:3,fill:!0});var u=t.bottom-t.yAxis.bottom-l;o.beginPath(),s?(o.moveTo(r-u,c),o.lineTo(r,c-u-1),o.lineTo(r+u,c),o.closePath(),o.fill()):(o.moveTo(r,c),o.lineTo(r,c-u),o.strokeStyle=n,o.stroke()),o.textBaseline="top",o.fillStyle=a||i.chooseForegroundColor(n),o.fillStyle==n&&("#FFFFFF"==n.toUpperCase()?o.fillStyle="#000000":o.fillStyle="#FFFFFF"),o.fillText(e,r-h/2+2,c+2)}},i.ChartEngine.prototype.drawCurrentHR=function(){if(!this.runPrepend("drawCurrentHR",arguments)){var t,e,i=this.mainSeriesRenderer||{},r=i.highLowBars||this.highLowBars[this.layout.chartType];for(var n in this.charts){var a=this.charts[n],s=a.panel,o=s.yAxis;if(!s.hidden&&(!1!==o.drawCurrentPriceLabel&&!o.noDraw&&i.params)){var l=o.whichSet;l||(l="dataSet");var h=a[l].length,c=this.layout.candleWidth;if("dataSegment"==l)for(;h>(a.width-this.micropixels+c/2+1)/c;)h--;if(h&&a[l][h-1]){var u=a.defaultPlotField;u&&!r||(u="Close");var d,p;do{if(d=a[l][h-1][u],p=d,0==--h)break}while(null===p);if("dataSet"==l&&a.currentQuote)p=a.currentQuote[u];else if(a[l].length>=2){var f=a[l][h-2];f&&(d=f[u])}p<d?(t=this.canvasStyle("stx_current_hr_down").backgroundColor,e=this.canvasStyle("stx_current_hr_down").color):(t=this.canvasStyle("stx_current_hr_up").backgroundColor,e=this.canvasStyle("stx_current_hr_up").color),a.transformFunc&&(p=a.transformFunc(this,a,p));var m,g=Math.max(s.yAxis.printDecimalPlaces,s.chart.decimalPlaces);(o.maxDecimalPlaces||0===o.maxDecimalPlaces)&&(g=Math.min(g,o.maxDecimalPlaces)),m=o.priceFormatter?o.priceFormatter(this,s,p,g):this.formatYAxisPrice(p,s,g);var v=this.pixelFromTransformedValue(p,s);this.createYAxisLabel(s,m,v,t,e),!0===this.preferences.currentPriceLine&&this.isHome()&&(s.chart.context.globalCompositeOperation="destination-over",this.plotLine(s.left,s.right,v,v,t,"line",s.chart.context,s,{pattern:"dashed",lineWidth:1,opacity:.8}),s.chart.context.globalCompositeOperation="source-over")}}}this.runAppend("drawCurrentHR",arguments)}},i.ChartEngine.prototype.getDefaultColor=function(){this.defaultColor="#000000";for(var t=null,e=this.chart.container;!t||i.isTransparent(t);){var r=getComputedStyle(e);if(!r)return;if(t=r.backgroundColor,i.isTransparent(t)&&(t="transparent"),!(e=e.parentNode)||!e.tagName)break}if(t)if("transparent"==t&&(t="#FFFFFF"),this.containerColor=t,i.isTransparent(t))this.defaultColor="#000000";else{var n=i.hsv(t),a=n[2];this.defaultColor=a>.65?"#000000":"#FFFFFF"}else this.containerColor="#FFFFFF"},i.ChartEngine.prototype.startAsyncAction=function(){this.pendingAsyncs||(this.pendingAsyncs=[]),this.pendingAsyncs.push(!0)},i.ChartEngine.prototype.registerChartDrawnCallback=function(t){return this.asyncCallbacks||(this.asyncCallbacks=[]),this.asyncCallbacks.push(t),{fc:t}},i.ChartEngine.prototype.unregisterChartDrawnCallback=function(t){for(var e=0;e<this.asyncCallbacks.length;e++)if(this.asyncCallbacks[e]==t.fc)return void this.asyncCallbacks.splice(e,1)},i.ChartEngine.prototype.makeAsyncCallbacks=function(){if(this.asyncCallbacks&&(!this.pendingAsyncs||!this.pendingAsyncs.length))for(var t=0;t<this.asyncCallbacks.length;t++)this.asyncCallbacks[t]()},i.ChartEngine.prototype.completeAsyncAction=function(){this.pendingAsyncs.pop(),this.makeAsyncCallbacks()},i.ChartEngine.prototype.draw=function(){if(this.debug(),this.chart.canvas&&this.chart.dataSet&&this.chart.canvasHeight&&(this.offset=this.layout.candleWidth*this.candleWidthPercent/2,i.clearCanvas(this.chart.canvas,this),this.masterData&&this.masterData.length&&!this.runPrepend("draw",arguments))){this.getDefaultColor(),this.vectorsShowing=!1,this.drawPanels(),this.yAxisLabels=[];var t,e,r,n;for(r in this.charts){e=this.charts[r],this.correctIfOffEdge(),this.createDataSegment();var a=this.createXAxis(e);this.initializeDisplay(e),this.rendererAction(e,"calculate"),this.renderYAxis(e),this.drawXAxis(e,a),e.tmpWidth=Math.floor(this.layout.candleWidth*this.candleWidthPercent),e.tmpWidth%2==0&&(e.tmpWidth+=1,e.tmpWidth>this.layout.candleWidth&&(e.tmpWidth-=2)),e.tmpWidth<.5&&(e.tmpWidth=.5);for(t in this.plugins)n=this.plugins[t],n.display&&n.drawUnder&&n.drawUnder(this,e);this.chart.legend&&(this.chart.legend.colorMap=null),this.controls.baselineHandle.style.display="none",this.rendererAction(e,"yaxis"),this.rendererAction(e,"underlay"),i.Studies&&i.Studies.displayStudies(this,e,!0),this.displayChart(e),i.Studies&&i.Studies.displayStudies(this,e,!1),this.rendererAction(e,"overlay"),e.legend&&e.legend.colorMap&&e.legendRenderer&&e.legendRenderer(this,{chart:e,legendColorMap:e.legend.colorMap,coordinates:{x:e.legend.x,y:e.legend.y+e.panel.yAxis.top}})}for(r in this.charts){e=this.charts[r];for(t in this.plugins)n=this.plugins[t],n.display&&n.drawOver&&n.drawOver(this,e)}for(var s in this.panels)this.panels[s].hidden||this.plotYAxisText(this.panels[s]);for(var o=0;o<this.yAxisLabels.length;o++){var l=this.yAxisLabels[o];"series"==l.src&&l.args[6]&&!1===l.args[6].drawSeriesPriceLabels||this.createYAxisLabel.apply(this,l.args)}this.createCrosshairs(),this.drawVectors(),this.drawCurrentHR(),this.displayInitialized=!0,this.controls.home&&(this.controls.home.style.display=this.isHome()?"none":"block"),this.positionMarkers();for(r in this.charts)e=this.charts[r],this.quoteDriver&&this.quoteDriver.checkLoadMore(e);this.runAppend("draw",arguments),this.makeAsyncCallbacks()}},i.ChartEngine.prototype.adjustBackingStore=function(t,e){this.devicePixelRatio=window.devicePixelRatio||1,this.devicePixelRatio<1&&(this.devicePixelRatio=1);var r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,n=this.devicePixelRatio/r;if(!this.useBackingStore)return void(this.devicePixelRatio=this.adjustedDisplayPixelRatio=1);if(!i.isAndroid||i.is_chrome){var a=t.width,s=t.height;t.width=a*n,t.height=s*n,t.style.width=a+"px",t.style.height=s+"px",e.scale(n,n),this.adjustedDisplayPixelRatio=n,this.backing={ratio:n,width:t.width,height:t.height,styleWidth:a,styleHeight:s}}},i.ChartEngine.prototype.reconstituteBackingStore=function(){if(this.useBackingStore){var t=this.chart.canvas;t.width!=this.backing.width&&(t.width=this.backing.width,t.height=this.backing.height,t.context.scale(this.backing.ratio,this.backing.ratio),this.adjustedDisplayPixelRatio=this.backing.ratio,this.draw())}},i.ChartEngine.prototype.disableBackingStore=function(){if(this.useBackingStore){var t=this.chart.canvas;t.width!=this.backing.styleWidth&&(t.width=this.backing.styleWidth,t.height=this.backing.styleHeight,t.context.scale(1,1),this.adjustedDisplayPixelRatio=1,this.draw())}},i.ChartEngine.prototype.resizeCanvas=function(){this.chart.panel||(this.chart.panel=this.panels.chart);var t=this.chart.canvas,e=this.chart.context;t&&e&&(this.floatCanvas.height=this.chart.tempCanvas.height=t.height=this.chart.container.clientHeight,this.floatCanvas.width=this.chart.tempCanvas.width=t.width=this.chart.container.clientWidth,this.adjustBackingStore(t,e),this.adjustBackingStore(this.chart.tempCanvas,this.chart.tempCanvas.context),this.adjustBackingStore(this.floatCanvas,this.floatCanvas.context));var i=this.container.getBoundingClientRect();this.top=i.top,this.left=i.left,this.canvasWidth=this.chart.canvasWidth=this.chart.container.clientWidth,this.right=this.left+this.canvasWidth,this.height=this.chart.container.clientHeight,this.width=this.right-this.left,0!==this.width||this.container.dimensionlessCanvas||console.log("warning: zero width chart. Check CSS for chart container."),this.bottom=this.top+this.height,this.calculateYAxisPositions(),this.chart.canvasRight=this.right,this.chart.canvasHeight=this.height;var r=this.layout.candleWidth;void 0===r&&(r=8);for(var n in this.charts){var a=this.charts[n];if(this.setCandleWidth(r,a),a.scroll<a.width/r){a.scroll=Math.floor(a.width/r);var s=Math.round(this.preferences.whitespace/this.layout.candleWidth);a.scroll-=s}var o,l=10;try{o=2*e.measureText("10:00").width}catch(t){o=100}for(;l>1&&!(this.chart.width/o>l);)l/=1.5;a.xAxis.autoComputedTickSizePixels=Math.round(this.chart.width/l),a.xAxis.autoComputedTickSizePixels<1&&(a.xAxis.autoComputedTickSizePixels=1)}},i.ChartEngine.prototype.setCandleWidth=function(t,e){e||(e=this.chart),t<this.minimumCandleWidth&&(t=this.minimumCandleWidth),this.layout.candleWidth=t,e.maxTicks=Math.round(e.width/t)+1},i.ChartEngine.prototype.resizeChart=function(t){if(!this.runPrepend("resizeChart",arguments)){!1!==t&&(t=!0),t&&this.preAdjustScroll();var e=this.chart.canvasHeight;this.resizeCanvas(),t&&this.postAdjustScroll(),this.displayInitialized?(this.adjustPanelPositions(),this.draw()):0!==this.chart.canvasHeight&&0===e&&(this.adjustPanelPositions(),this.draw()),this.doDisplayCrosshairs(),this.updateChartAccessories(),this.runAppend("resizeChart",arguments)}},i.ChartEngine.prototype.newChart=function(t,e,r,n,a){r||(r=this.chart),a||(a={});var s=this.layout,o=a.periodicity;if(o){var l=i.cleanPeriodicity(o.period?o.period:o.periodicity,o.interval,o.timeUnit);s.interval=l.interval,s.periodicity=l.period,s.timeUnit=l.timeUnit}var h=r.symbol,c=i.clone(r.symbolObject),u=r.market,d=r.dataSet,p=r.moreAvailable;if(r.dataSet=[],r.moreAvailable=null,t?"object"==typeof t?(r.symbol=t.symbol,r.symbolObject=t):(r.symbol=t,r.symbolObject.symbol=t):(r.symbol=null,r.symbolObject={symbol:null}),r.inflectionPoint=null,this.marketFactory){var f=this.marketFactory(r.symbolObject);this.setMarket(f,r)}this.setMainSeriesRenderer(!0);var m=a.span,g=a.range;g||m||!s?g&&m&&(m={}):(m=s.range?{}:s.setSpan,g=s.range||{});var v=this;if(!e&&this.quoteDriver){var y=function(t){t&&"orphaned"!=t&&(r.symbol=h,r.symbolObject=c,r.market=u,r.dataSet=d,r.moreAvailable=p),v.dispatch(v.currentlyImporting?"symbolImport":"symbolChange",{stx:v,symbol:v.chart.symbol,symbolObject:v.chart.symbolObject,action:"master"}),n&&n.call(v,t)};g&&Object.keys(g).length?(delete a.span,delete s.setSpan,this.chart.masterData=null,this.displayInitialized=!1,"all"==g.base?this.displayAll({base:"all",multiplier:1,periodicity:o,forceLoad:!0,maintainPeriodicity:!0}):(o&&(g.periodicity=o),this.setRange(g,y))):m&&m.base?(m.multiplier=m.multiplier||1,this.chart.masterData=null,this.displayInitialized=!1,o&&(m.maintainPeriodicity=!0),m.forceLoad=!0,this.setSpan(m,y)):this.quoteDriver.newChart({symbol:r.symbol,symbolObject:r.symbolObject,chart:r,initializeChart:!0},function(t){t||(v.adjustPanelPositions(),v.quoteDriver.updateSubscriptions(),a.stretchToFillScreen&&v.fillScreen()),y.apply(v,arguments)})}else e||console.log("Warning: No masterData specified and no QuoteFeed configured"),r.symbol||(r.symbol=""),this.doCleanupDates(e,s.interval),this.setMasterData(e,r),this.createDataSet(),this.initializeChart(),g&&Object.keys(g).length?this.setRange(g):m&&m.multiplier&&m.base?this.setSpan({maintainPeriodicity:!0,multiplier:m.multiplier,base:m.base}):a.stretchToFillScreen?this.fillScreen():e&&e.length?this.draw():this.clear(),this.adjustPanelPositions(),v.dispatch(v.currentlyImporting?"symbolImport":"symbolChange",{stx:v,symbol:v.chart.symbol,symbolObject:v.chart.symbolObject,action:"master"}),n&&n.call(v)},i.ChartEngine.prototype.clear=function(){this.displayInitialized=!1;for(var t in this.layout.studies){var e=this.layout.studies[t];i.Studies.removeStudy(this,e)}this.controls.chartControls.style.display="none",this.panels.chart.title.innerHTML="",this.panels.chart.title.appendChild(document.createTextNode(this.panels.chart.display))},i.ChartEngine.prototype.fillScreen=function(){var t=this.chart,e=this.layout.candleWidth,i=t.width-this.preferences.whitespace,r=t.dataSet.length;if(r*e>=i)return void this.draw();this.mainSeriesRenderer&&this.mainSeriesRenderer.standaloneBars||this.standaloneBars[this.layout.chartType]||r--;var n=i/r;this.setCandleWidth(n,t),this.home({maintainWhitespace:!0})},i.ChartEngine.prototype.setMasterData=function(t,e){if(e||(e=this.chart),this.marketFactory){var r=this.marketFactory(e.symbolObject);this.setMarket(r,e)}e.masterData=t,"chart"==e.name&&(this.masterData=t);var n;for(n=0;t&&n<t.length;n++){this.transformMasterDataQuote&&(t[n]=this.transformMasterDataQuote(t[n]));var a=t[n];a.DT?("[object Date]"!=Object.prototype.toString.call(a.DT)&&(a.DT=new Date(a.DT)),a.Date&&17==a.Date.length||(a.Date=i.yyyymmddhhmmssmmm(a.DT))):a.Date?a.DT=i.strToDateTime(a.Date):console.log("setMasterData : Missing DT and Date on masterData object"),a.Volume&&"number"!=typeof a.Volume&&(a.Volume=parseInt(a.Volume,10))}e.decimalPlaces=this.callbacks.calculateTradingDecimalPlaces({stx:this,chart:e,symbol:e.symbolObject.symbol,symbolObject:e.symbolObject}),i.ChartEngine.isDailyInterval(this.layout.interval)||this.setDisplayDates(t),this.chart.roundit=Math.pow(10,e.decimalPlaces);for(n in this.plugins){var s=this.plugins[n];s.display&&s.setMasterData&&s.setMasterData(this,e)}},i.ChartEngine.prototype.setMasterDataRender=function(t,e,i){i||(i=this.chart),i.symbol||(i.symbol=""),this.setMasterData(e,i),e&&e.length&&(i.symbol=t),this.createDataSet(),this.initializeChart(),this.draw(),e&&e.length||(i.symbol=null,this.clear()),this.adjustPanelPositions()},i.ChartEngine.prototype.getSymbols=function(t){function e(t,e,i){return{symbol:t,symbolObject:e,periodicity:i.periodicity,interval:i.interval,timeUnit:i.timeUnit,setSpan:i.setSpan}}t||(t={});var r,n,a,s=[],o=this.layout;for(var l in this.charts){var h=this.charts[l];h.symbolObject&&h.symbolObject.symbol&&s.push(e(h.symbol,h.symbolObject,o));for(var c in h.series){var u=h.series[c],d=u.parameters;d.data&&!d.data.useDefaultQuoteFeed||(a=d.symbolObject,n=d.symbol,r=e(n,a,o),r.id=c,t["include-parameters"]&&(r.parameters=d),t["exclude-studies"]&&"study"==d.bucket||s.push(r))}}for(var p=s.length-1;p>=0;p--)if(n=s[p].symbol,this.isEquationChart(n)){var f=i.formatEquation(n);if(f){for(var m=0;m<f.symbols.length;m++)r=e(f.symbols[m],s[p].symbolObject,s[p]),s.push(r);s.splice(p,1)}}return s},i.ChartEngine.prototype.setDisplayDate=function(t){var e,i=t.DT,r=1e3*i.getSeconds()+i.getMilliseconds();this.dataZone&&(e=new s.Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),this.dataZone),i=new Date(e.getTime()+r)),this.displayZone&&(e=new s.Date(i.getTime(),this.displayZone),i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()),i=new Date(i.getTime()+r)),t.displayDate=i},i.ChartEngine.prototype.setDisplayDates=function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];i.DT&&this.setDisplayDate(i)}},i.ChartEngine.prototype.streamTrade=function(t,e,i,r){var n=this.chart;r||(r={}),r.chart&&(n=r.chart),r.fillGaps=this.streamParameters.fillGaps;var a="object"==typeof t,s=a?t.last:arguments[0],o=a?t.volume:arguments[1],l=a?t.bid:null,h=a?t.ask:null;a||(e=arguments[2],i=arguments[3]),i&&(r.secondarySeries=i);var c={DT:e,Last:s,Volume:o,Bid:l,Ask:h};this.appendMasterData(c,n,r)},i.ChartEngine.prototype.appendMasterData=function(t,e,i){this.updateChartData(t,e,i)},i.ChartEngine.prototype.updateChartData=function(t,e,r){r||(r={}),e||(e=this.chart);var n=!1,a=!1,s=e.masterData,o=this.layout,l=this.dataZone;if(this.doCleanupDates(t,o.interval),r.useAsLastSale||t.constructor==Object&&void 0!==t.Last&&null!==t.Last){if(n=!0,r.useAsLastSale&&r.useAsLastSale.aggregatedVolume&&(a=!0),t.constructor===Array){var h=t[t.length-1];t={},h.DT?t.DT=h.DT:t.DT=i.strToDateTime(h.Date),t.Close=h.Close,t.Volume=h.Volume}else t.Last&&(t.Close=t.Last,delete t.Last);if(t.DT&&(t.DT=new Date(+t.DT)),t.DT&&"Invalid Date"!=t.DT||(t.DT=this.convertToDataZone(new Date)),"tick"!=o.interval){var c,u,d=new i.Market({}),p={begin:s&&s.length?s[s.length-1].DT:t.DT,interval:o.interval,periodicity:1,timeUnit:o.timeUnit,inZone:l,outZone:l},f=d.newIterator(p),m=f.next();if(s){if(t.DT<m){c=0;var g=f.previous();for(u=t.DT,r.appending=!0;u<g&&c<1e3;)r.appending=!1,g=f.previous(),c++;t.DT=g,r.updating=!r.appending}else if(t.DT>=m){for(c=0,u=t.DT;u>m&&c<1e3;)t.DT=m,m=f.next(),c++;r.appending=!0}}else t.DT=new Date(+f.previous())}t.Open=t.Close,t.High=t.Close,t.Low=t.Close}if(r.secondarySeries)i.addMemberToMasterdata({stx:this,label:r.secondarySeries,data:t,fillGaps:r.fillGaps,createObject:!0});else{if(t&&t.constructor==Object&&(t=[t]),!t||!t.length)return;if(this.runPrepend("appendMasterData",[t,e,r]))return;if(this.runPrepend("updateChartData",[t,e,r]))return;if(s&&s.length)for(var v=!1,y=s.length-1,x=!1,b=0;b<t.length;b++){var C=t[b],S=C.DT,w=C.Date;for(S&&"[object Date]"!=Object.prototype.toString.call(S)&&(C.DT=S=new Date(S)),S&&(w&&17==w.length||(C.Date=i.yyyymmddhhmmssmmm(C.DT))),S||(S=C.DT=i.strToDateTime(w));y>=0&&y<s.length;){var M=s[y].DT;if(M||(M=i.strToDateTime(s[y].Date)),M.getTime()<=S.getTime()){x=!0;var T=0;if(M.getTime()<S.getTime()){if(y<s.length-1){var B=s[y+1].DT||i.strToDateTime(s[y+1].Date);if(B.getTime()<=S.getTime()){y++;continue}}if(T=1,r.fillGaps&&!v&&y==s.length-1){var k=t.slice(b);k.unshift(s[y]),k=this.doCleanupGaps(k,e),k.shift(),t=t.slice(0,b).concat(k),C=t[b],v=!0}}var D=r.deleteItems;if(D)T||s.splice(y,1);else{if(!T){var A=s.length>y+b?s[y+b]:null;if(A){n?(C.Volume&&(C.Volume=parseInt(C.Volume,10)),a||(C.Volume+=A.Volume)):!C.Volume&&A.Volume&&(C.Volume=A.Volume),r.allowReplaceOHL||(isNaN(A.Open)||(C.Open=A.Open),!isNaN(A.High)&&A.High>C.High&&(C.High=A.High),!isNaN(A.Low)&&A.Low<C.Low&&(C.Low=A.Low)),isNaN(C.Close)&&!isNaN(A.Close)&&(C.Close=A.Close),isNaN(C.Bid)&&!isNaN(A.Bid)&&(C.Bid=A.Bid),isNaN(C.Ask)&&!isNaN(A.Ask)&&(C.Ask=A.Ask);for(var F in e.series){var _=e.series[F].parameters.symbolObject.symbol;void 0===C[_]&&void 0!==A[_]&&(C[_]=A[_])}}}isNaN(C.Open)&&(C.Open=C.Close),isNaN(C.High)&&(C.High=Math.max(C.Open,C.Close)),isNaN(C.Low)&&(C.Low=Math.min(C.Open,C.Close)),C.Volume&&"number"!=typeof C.Volume&&(C.Volume=parseInt(C.Volume,10)),i.ChartEngine.isDailyInterval(o.interval)||this.setDisplayDate(C),y+=T,s.splice(y,T?0:1,C)}break}y+=x?1:-1}}else s=i.clone(t),this.setMasterData(s,e);this.maxMasterDataSize&&(s=e.masterData=this.masterData=s.slice(-this.maxMasterDataSize));for(var P in this.plugins){var E=this.plugins[P];E.display&&E.appendMasterData&&E.appendMasterData(this,t,e)}this.masterData&&this.masterData.length||(this.masterData=s)}if(!r.noCreateDataSet){var L=this.streamParameters;if(++L.count>L.maxTicks||r.bypassGovernor)clearTimeout(L.timeout),this.createDataSet(null,null,r),this.draw(),this.updateChartAccessories(),L.count=0,L.timeout=-1;else{var N=this;-1==L.timeout&&(L.timeout=setTimeout(function(){N.createDataSet(null,null,r),N.draw(),N.updateChartAccessories(),N.streamParameters.count=0,N.streamParameters.timeout=-1},L.maxWait))}}this.runAppend("appendMasterData",arguments),this.runAppend("updateChartData",arguments)},i.ChartEngine.prototype.setMaxTicks=function(t,e){e||(e={}),(t=Math.round(t))<2&&(t=2);var i=e.padding?e.padding:0;this.layout.candleWidth=(this.chart.width-i)/t,this.layout.candleWidth||(this.layout.candleWidth=8),this.chart.maxTicks=Math.round(this.chart.width/this.layout.candleWidth-.499),(e.padding||0===e.padding)&&(this.chart.scroll=t+1)},i.ChartEngine.prototype.construct=function(){this.stackPanel("chart","chart",1),this.adjustPanelPositions(),this.chart.panel=this.panels[this.chart.name],this.cx=0,this.cy=0,this.micropixels=0,this.chart.panel.subholder.appendChild(this.controls.home),this.callbackListeners={doubleTap:[],drawing:[],layout:[],longhold:[],move:[],newChart:[],preferences:[],rightClick:[],studyOverlayEdit:[],studyPanelEdit:[],symbolChange:[],symbolImport:[],tap:[],theme:[],undoStamp:[]},this.longHoldTime=1e3},i.ChartEngine.prototype.addDomEventListener=function(t,e,i,r){t.addEventListener(e,i,r),this.eventListeners.push({element:t,event:e,function:i,options:r})},i.ChartEngine.prototype.addEventListener=function(t,e){if("*"===t)for(var i in this.callbackListeners)this.callbackListeners[i].push(e);else if(t instanceof Array)for(var r=0;r<t.length;r++)this.callbackListeners[t[r]].push(e);else{var n=this.callbackListeners[t];if(!n)throw new Error("Attempted to add an invalid listener.");n.push(e)}return{type:t,cb:e}},i.ChartEngine.prototype.removeEventListener=function(t,e){t&&"object"==typeof t||(t={type:t,cb:e});var i=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return void t.splice(i,1)},r=this.callbackListeners;if("*"!==t.type){if(!r[t.type])throw new Error("Attempted to remove an invalid listener.");i(r[t.type],t.cb)}else for(var n in r)i(r[n],t.cb)},i.ChartEngine.prototype.dispatch=function(t,e){this.callbacks[t]&&this.callbacks[t].call(this,e);var i,r=this.callbackListeners[t];if(r){for(var n=0;n<r.length;n++)i=r[n].call(this,e);if(i)return i}if(r=this.callbackListeners["*"]){for(var a=0;a<r.length;a++)i=r[a].call(this,e);if(i)return i}return!1},i.ChartEngine.prototype.deleteYAxisIfUnused=function(t,e){if(e&&e.name!==t.yAxis.name){for(var i in this.chart.seriesRenderers){var r=this.chart.seriesRenderers[i];if(r.params.yAxis&&r.params.yAxis.name===e.name&&0!==r.seriesParams.length)return}var n;for(n=0;n<t.yaxisLHS.length;n++)t.yaxisLHS[n]===e&&t.yaxisLHS.splice(n,1);for(n=1;n<t.yaxisRHS.length;n++)t.yaxisRHS[n]===e&&t.yaxisRHS.splice(n,1);this.resizeCanvas(),this.adjustPanelPositions()}},i.ChartEngine.prototype.addYAxis=function(t,e){if(e){t.yaxisLHS||(t.yaxisLHS=[],t.yaxisRHS=[],"left"==t.yAxis.position?t.yaxisLHS.push(t.yAxis):t.yaxisRHS.push(t.yAxis));for(var i=t.yaxisLHS.concat(t.yaxisRHS),r=0;r<i.length;r++)if(i[r].name===e.name)return i[r];return"left"===e.position?t.yaxisLHS.unshift(e):(e.position="right",t.yaxisRHS.push(e)),this.preAdjustScroll(),this.resizeCanvas(),this.adjustPanelPositions(),this.postAdjustScroll(),e}},i.ChartEngine.prototype.calculateYAxisPositions=function(){var t=[],e=this.chart;for(var i in this.charts)t.push(i);for(var r in this.panels){var n=this.panels[r];n.name!==n.chart.name&&t.push(r)}var a,s,o,l,h=this.drawBorders?3:0,c=0,u=0;for(s=0;s<t.length;s++)if(o=this.panels[t[s]]){if(!o.yaxisLHS){o.yaxisLHS=[],o.yaxisRHS=[]
;var d=o.yAxis.position;d||(d=o.chart.panel.yAxis.position),o["left"==d?"yaxisLHS":"yaxisRHS"].push(o.yAxis)}o.yAxis.width||0===o.yAxis.width||(o.yAxis.width=this.yaxisWidth),o.yaxisTotalWidthRight=0,o.yaxisTotalWidthLeft=0;var p=o.yaxisLHS.concat(o.yaxisRHS);for(a=0;a<p.length;a++)l=p[a],!l.noDraw&&l.width&&(e.quoteTextLength&&e.quoteTextLength>l.width&&(l.width=e.quoteTextLength+h+16),"left"==l.position?(o.yaxisTotalWidthLeft+=l.width,l.justifyRight=null===l.justifyRight?o.chart.yAxis.justifyRight:l.justifyRight,null===l.justifyRight&&(l.justifyRight=!0)):o.yaxisTotalWidthRight+=l.width);o.yaxisTotalWidthLeft>c&&(c=o.yaxisTotalWidthLeft),o.yaxisTotalWidthRight>u&&(u=o.yaxisTotalWidthRight)}for(s=0;s<t.length;s++)if(o=this.panels[t[s]]){var f=o.name===o.chart.name,m=c;for(a=o.yaxisLHS.length-1;a>=0;a--)l=o.yaxisLHS[a],l.noDraw||(m-=l.width,l.left=m);for(m=this.width-u,a=0;a<o.yaxisRHS.length;a++)l=o.yaxisRHS[a],l.noDraw||(l.left=m,m+=l.width);void 0!==this.yaxisLeft&&(o.chart.yaxisPaddingRight=this.yaxisLeft),o.yaxisCalculatedPaddingRight=u,(o.chart.yaxisPaddingRight||0===o.chart.yaxisPaddingRight)&&(o.yaxisCalculatedPaddingRight=o.chart.yaxisPaddingRight),o.yaxisCalculatedPaddingLeft=c,(o.chart.yaxisPaddingLeft||0===o.chart.yaxisPaddingLeft)&&(o.yaxisCalculatedPaddingLeft=o.chart.yaxisPaddingLeft),f?(o.left=o.yaxisCalculatedPaddingLeft,o.right=this.width-o.yaxisCalculatedPaddingRight):(o.left=o.chart.panel.left,o.right=o.chart.panel.right),o.width=o.right-o.left,o.handle.style.left=o.left+"px",o.handle.style.width=o.width+"px",f&&(o.chart.left=o.left,o.chart.right=o.right,o.chart.width=Math.max(o.right-o.left,0))}},i.ChartEngine.prototype.initializeChart=function(t){if(!this.runPrepend("initializeChart",arguments)){this.chart.symbolObject.symbol||(this.chart.symbolObject.symbol=this.chart.symbol),this.locale&&this.setLocale(this.locale),!this.displayZone&&i.ChartEngine.defaultDisplayTimeZone&&this.setTimeZone(null,i.ChartEngine.defaultDisplayTimeZone),this.calculateYAxisPositions(),this.micropixels=0,t?this.chart.container=t:t=this.chart.container,t.stx=this,t.CIQRegistered||(t.CIQRegistered=!0,i.ChartEngine.registeredContainers.push(t)),i.isSurface&&(this.gesture||(this.gesture=new MSGesture,this.manageTouchAndMouse?this.gesture.target=t:this.gesture.target=document.body,this.gesturePointerId=null)),this.registerHTMLElements();var e=this.chart.canvas,r=this.chart.tempCanvas,a=this.floatCanvas;e&&document.createElement("canvas").getContext?(e.id||(t.removeChild(e),this.chart.canvas=null),r&&!r.id&&(t.removeChild(r),this.chart.tempCanvas=null),a&&!a.id&&(t.removeChild(a),this.floatCanvas=null)):(this.layout.candleWidth<this.minimumCandleWidth&&(this.layout.candleWidth=this.minimumCandleWidth),this.layout.candleWidth>200&&(this.layout.candleWidth=8)),this.chart.canvas||(e=this.chart.canvas=document.createElement("canvas")),this.chart.canvas.getContext?t.appendChild(e):(e=this.chart.canvas=t.querySelectorAll("#ie8canvas")[0],e.getContext||window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(e),e.style.display="block"),e.style.position="absolute",e.style.left="0px";(e.context=this.chart.context=e.getContext("2d")).lineWidth=1,this.chart.tempCanvas||(r=this.chart.tempCanvas=document.createElement("canvas")),this.chart.tempCanvas.getContext?t.appendChild(r):(r=this.chart.tempCanvas=t.querySelectorAll("#ie8canvasTemp")[0],r.getContext||window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(r)),r.style.position="absolute",r.style.left="0px",r.context=this.chart.tempCanvas.getContext("2d"),r.context.lineWidth=1,r.style.display="none",this.floatCanvas||(a=this.floatCanvas=document.createElement("canvas")),this.floatCanvas.getContext?t.appendChild(a):(a=this.floatCanvas=t.querySelectorAll("#ie8canvasFloat")[0],a.getContext||window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(a)),a.style.position="absolute",a.style.left="0px",a.context=a.getContext("2d"),a.context.lineWidth=1,a.style.display="none",this.resizeCanvas(),i.isAndroid&&(this.chart.tempCanvas.ontouchstart=function(t){t.preventDefault&&t.preventDefault()},this.floatCanvas.ontouchstart=function(t){t.preventDefault&&t.preventDefault()});var s=this.chart,o=this.panels;if(o.chart.display=s.symbol,s.symbolDisplay&&(o.chart.display=s.symbolDisplay),this.adjustPanelPositions(),this.chart.panel=o[s.name],this.calculateYAxisMargins(s.panel.yAxis),this.initialWhitespace=this.preferences.whitespace,s.dataSet&&s.dataSet.length>0){s.scroll=Math.floor(s.width/this.layout.candleWidth);var l=Math.round(this.preferences.whitespace/this.layout.candleWidth);s.scroll-=l}if(i.touchDevice){var h=n(".overlayEdit",t),c=n("#overlayTrashCan",t),u=n("#vectorTrashCan",t);h?(i.safeClickTouch(h,function(t){return function(e){t.deleteHighlighted(!0,!0)}}(this)),c&&i.safeClickTouch(c,function(t){return function(e){t.deleteHighlighted(!1)}}(this))):c&&i.safeClickTouch(c,function(t){return function(e){t.deleteHighlighted(!0)}}(this)),u&&i.safeClickTouch(u,function(t){return function(e){t.deleteHighlighted(!0)}}(this))}this.manageTouchAndMouse&&(this.registerTouchAndMouseEvents(),this.controls.chartControls&&(this.controls.chartControls.style.display="block")),t.onmouseout=function(t){return function(e){t.handleMouseOut(e)}}(this),this.abortDrawings(),this.undoStamps=[];for(var d in o){var p=o[d];p.markerHolder&&(t.removeChild(p.markerHolder),p.markerHolder=null)}for(var f in this.plugins){var m=this.plugins[f];m.display&&m.initializeChart&&m.initializeChart(this)}if(!this.resizeListenerInitialized){var g=this;this.resizeListenerInitialized=!0;this.addDomEventListener(window,"resize",function(){return function(t){g.resizeChart()}}(),!0)}s.baseline.userLevel&&(s.baseline.userLevel=null),this.setResizeTimer(this.resizeDetectMS),this.runAppend("initializeChart",arguments)}},i.ChartEngine.prototype.destroy=function(){this.setResizeTimer(0),this.quoteDriver&&this.quoteDriver.die(),this.styles={};for(var t=0;t<this.eventListeners.length;t++){var e=this.eventListeners[t];e.element.removeEventListener(e.event,e.function,e.options)}this.streamParameters.timeout&&clearTimeout(this.streamParameters.timeout);var r=i.ChartEngine.registeredContainers,n=r.indexOf(this.chart.container);if(n>-1&&r.splice(n,1),this.slider){var a=r.indexOf(this.slider.slider.chart.container);a>-1&&r.splice(a,1)}},i.ChartEngine.prototype.handleMouseOut=function(t){if(t=t||window.event,!i.withinElement(this.chart.container,t.pageX,t.pageY)){if(this.runPrepend("handleMouseOut",arguments))return;if(this.undisplayCrosshairs(),this.grabbingScreen=!1,this.touches=[],this.touching=!1,this.activeDrawing&&this.userPointerDown){this.userPointerDown=!1,this.drawingLine=!1;var e=this.backOutY(t.pageY),r=this.backOutX(t.pageX);this.drawingClick(this.currentPanel,r,e)}i.ChartEngine.insideChart=!1,this.displaySticky(),this.findHighlights(!1,!0),this.runAppend("handleMouseOut",arguments)}},i.ChartEngine.prototype.registerTouchAndMouseEvents=function(){if(!this.touchAndMouseEventsRegistered){this.touchAndMouseEventsRegistered=!0;var t=n("#zoomIn",this.controls.chartControls),e=n("#zoomOut",this.controls.chartControls),r=this.chart.container,a=this,s=function(t,e){a.addDomEventListener(r,t,e)};i.touchDevice?i.isSurface?(s("mousemove",function(t){a.msMouseMoveProxy(t)}),s("mousedown",function(t){a.msMouseDownProxy(t)}),s("mouseup",function(t){a.msMouseUpProxy(t)}),window.navigator.msPointerEnabled?(s("MSPointerDown",function(t){return a.startProxy(t)}),s("MSGestureStart",function(t){a.gestureInEffect=!0}),s("MSGestureChange",function(t){return a.touchmove(t)}),s("MSGestureEnd",function(t){return a.gestureInEffect=!1,a.touchend(t)}),s("MSPointerMove",function(t){a.moveProxy(t)}),s("MSPointerUp",function(t){return a.endProxy(t)})):(s("pointerdown",function(t){return a.startProxy(t)}),s("MSGestureStart",function(t){a.gestureInEffect=!0}),s("MSGestureChange",function(t){return a.touchmove(t)}),s("MSGestureEnd",function(t){return a.gestureInEffect=!1,a.touchend(t)}),s("pointermove",function(t){a.moveProxy(t)}),s("pointerup",function(t){return a.endProxy(t)}))):(i.isAndroid||i.ipad||i.iphone||(s("mousemove",function(t){a.iosMouseMoveProxy(t)}),s("mousedown",function(t){a.iosMouseDownProxy(t)}),s("mouseup",function(t){a.iosMouseUpProxy(t)})),s("touchstart",function(t){a.touchstart(t)}),s("touchmove",function(t){a.touchmove(t)}),s("touchend",function(t){a.touchend(t)}),t&&(t.removeAttribute("onMouseOver"),t.removeAttribute("onMouseOut")),e&&(e.removeAttribute("onMouseOver"),e.removeAttribute("onMouseOut"))):(s("mousemove",function(t){a.mousemove(t)}),s("mousedown",function(t){a.mousedown(t)}),s("mouseup",function(t){a.mouseup(t)}));var o=i.wheelEvent;this.captureMouseWheelEvents&&this.addDomEventListener(r,o,function(t){a.mouseWheel(t)})}},i.ChartEngine.prototype.rightClickHighlighted=function(){this.runPrepend("rightClickHighlighted",arguments)||(this.deleteHighlighted(!0),this.runAppend("rightClickHighlighted",arguments))},i.ChartEngine.prototype.deleteHighlighted=function(t,e){if(!this.runPrepend("deleteHighlighted",arguments)){this.cancelTouchSingleClick=!0,i.clearCanvas(this.chart.tempCanvas,this);var r=!1===this.bypassRightClick;if(r||!this.bypassRightClick.drawing)for(var n=this.drawingObjects.length-1;n>=0;n--){var a=this.drawingObjects[n];if(a.highlighted&&!a.permanent){var s=a.abort();if(!s){var o=i.shallowClone(this.drawingObjects);this.drawingObjects.splice(n,1),this.undoStamp(o,i.shallowClone(this.drawingObjects))}this.changeOccurred("vector")}}if(r||!this.bypassRightClick.study)for(var l in this.overlays){var h=this.overlays[l];h.highlight&&!h.permanent&&(t||e?this.rightClickOverlay(l,e):this.removeOverlay(l))}var c=this.currentPanel.chart;if(r||!this.bypassRightClick.series)for(var u in c.seriesRenderers)for(var d=c.seriesRenderers[u],p=d.seriesParams.length-1;p>=0;p--){var f=d.seriesParams[p];f.highlight&&!f.permanent&&(d.removeSeries(f.id),d.seriesParams.length<1&&this.removeSeriesRenderer(d))}this.draw(),this.clearMeasure(),this.controls.mSticky&&(this.controls.mSticky.style.display="none",this.controls.mSticky.children[0].innerHTML=""),this.runAppend("deleteHighlighted",arguments)}},i.ChartEngine.prototype.panelExists=function(t){for(var e in this.panels){if(this.panels[e].name==t)return!0}return!1},i.ChartEngine.prototype.hideCrosshairs=function(){this.displayCrosshairs=!1},i.ChartEngine.prototype.showCrosshairs=function(){this.displayCrosshairs=!0},i.ChartEngine.prototype.grabHandle=function(t){this.runPrepend("grabHandle",arguments)||t&&(i.ChartEngine.crosshairY=t.top+this.top,i.ChartEngine.resizingPanel=t,i.appendClassName(t.handle,"stx-grab"),this.runAppend("grabHandle",arguments))},i.ChartEngine.prototype.releaseHandle=function(){this.runPrepend("releaseHandle",arguments)||(i.clearCanvas(this.chart.tempCanvas,this),this.resizePanels(),i.ChartEngine.resizingPanel&&i.unappendClassName(i.ChartEngine.resizingPanel.handle,"stx-grab"),i.ChartEngine.resizingPanel=null,this.runAppend("releaseHandle",arguments))},i.ChartEngine.prototype.storePanels=function(){this.layout||(this.layout={});var t=this.layout;t.panels={};for(var e in this.panels){var i=this.panels[e];t.panels[i.name]={percent:i.percent,display:i.display}}},i.ChartEngine.prototype.savePanels=function(t){this.storePanels(),!1!==t&&this.changeOccurred("layout")},i.ChartEngine.prototype.resolveY=function(t){return this.top+t},i.ChartEngine.prototype.resolveX=function(t){return this.left+t},i.ChartEngine.prototype.backOutY=function(t){return t-this.top},i.ChartEngine.prototype.backOutX=function(t){return t-this.left},i.ChartEngine.prototype.cleanupRemovedStudy=function(t){t.study.removeFN&&t.study.removeFN(this,t),t.study.feed&&this.detachTagAlongQuoteFeed(t.study.feed);for(var e in this.plugins)e.indexOf("{"+t.id+"}")>-1&&delete this.plugins[e];this.layout.studies&&delete this.layout.studies[t.name],i.Studies.removeStudySymbols(t,this),this.quoteDriver&&this.quoteDriver.updateSubscriptions()},i.ChartEngine.prototype.privateDeletePanel=function(t){if(this.layout.studies){var e=this.layout.studies[t.name];e&&this.cleanupRemovedStudy(e)}if(delete this.panels[t.name],i.Studies)for(var r in i.Studies.studyPanelMap)i.Studies.studyPanelMap[r].panel==t.name&&delete i.Studies.studyPanelMap[r];for(var n in this.overlays)this.overlays[n].panel==t.name&&(this.cleanupRemovedStudy(this.layout.studies[n]),delete this.overlays[n]);if(t.holder&&(this.chart.container.removeChild(t.holder),this.getMarkerArray))for(var a=this.getMarkerArray("panelName",t.name),s=0;s<a.length;s++)this.removeFromHolder(a[s]);t.handle.parentNode.removeChild(t.handle),this.currentPanel=null},i.ChartEngine.prototype.panelClose=function(t){if(t&&!this.runPrepend("panelClose",arguments)){if(this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,t.soloing&&this.panelSolo(t),this.charts[t.name]){for(var e in this.panels){var r=this.panels[e];r.chart.name==t.name&&this.privateDeletePanel(r)}delete this.charts[t.name]}else this.privateDeletePanel(t);this.currentlyImporting||(this.showCrosshairs(),this.createDataSet(),this.adjustPanelPositions(),this.draw(),this.savePanels()),this.openDialog&&(this.openDialog=""),this.runAppend("panelClose",arguments)}},i.ChartEngine.prototype.deleteAllPanels=function(){for(var t in this.panels){var e=this.panels[t];this.privateDeletePanel(e)}this.layout.panels={},this.panels={}},i.ChartEngine.prototype.panelUp=function(t){this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,this.showCrosshairs();var e,r={},n=0;for(e in this.panels){if(e==t.name)break;n++}if(n){var a=0;for(e in this.panels)a==n-1&&(r[t.name]=t),e!=t.name&&(r[e]=this.panels[e],a++);this.panels=r,this.adjustPanelPositions(),this.draw(),this.savePanels()}},i.ChartEngine.prototype.panelDown=function(t){this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,this.showCrosshairs();var e,r={},n=0;for(e in this.panels){if(e==t.name)break;n++}var a=0;for(e in this.panels)a++;if(n!=a-1){var s=0;for(e in this.panels)e!=t.name?(r[e]=this.panels[e],s==n+1&&(r[t.name]=t),s++):s++;this.panels=r,this.adjustPanelPositions(),this.draw(),this.savePanels()}},i.ChartEngine.prototype.panelSolo=function(t){this.cancelTouchSingleClick=!0,i.ChartEngine.drawingLine=!1,this.showCrosshairs();var e=!0;t.soloing?(e=!1,t.soloing=!1,i.unappendClassName(t.solo,"stx_solo_lit"),t.percent=t.oldPercent,"chart"==t.name||this.soloPanelToFullScreen||(this.panels.chart.percent=this.panels.chart.oldPercent),this.soloPanelToFullScreen&&(this.xAxisAsFooter=this.panels.chart.oldXAxisAsFooter,this.panels.chart.subholder.appendChild(this.controls.home))):(t.soloing=!0,i.appendClassName(t.solo,"stx_solo_lit"),t.oldPercent=t.percent,"chart"!=t.name&&(this.soloPanelToFullScreen?(this.panels.chart.oldXAxisAsFooter=this.xAxisAsFooter,this.xAxisAsFooter=!0,t.subholder.appendChild(this.controls.home)):(this.panels.chart.oldPercent=this.panels.chart.percent,t.percent=1-this.panels.chart.percent)));for(var r in this.panels)this.panels[r].hidden=e;this.soloPanelToFullScreen||(this.panels.chart.hidden=!1),t.hidden=!1,this.adjustPanelPositions(),this.draw(),this.savePanels()},i.ChartEngine.prototype.calculatePanelPercent=function(t){var e=t.bottom-t.top;t.percent=e/this.chart.canvasHeight},i.ChartEngine.prototype.resizePanels=function(){if(i.ChartEngine.resizingPanel){var t,e,r,n=!0;if(i.ChartEngine.crosshairY>this.resolveY(i.ChartEngine.resizingPanel.top)&&(n=!1),n){r=null;for(t in this.panels){if(this.panels[t]==i.ChartEngine.resizingPanel)break;this.panels[t].hidden||(r=this.panels[t])}e=this.backOutY(i.ChartEngine.crosshairY),e<r.top+30&&(e=r.top+30,i.ChartEngine.crosshairY=this.resolveY(e)),r.bottom=e,i.ChartEngine.resizingPanel.top=e,this.calculatePanelPercent(r),this.calculatePanelPercent(i.ChartEngine.resizingPanel)}else{r=null;for(t in this.panels){if(this.panels[t]==i.ChartEngine.resizingPanel)break;this.panels[t].hidden||(r=this.panels[t])}e=this.backOutY(i.ChartEngine.crosshairY),e>i.ChartEngine.resizingPanel.bottom-30&&(e=i.ChartEngine.resizingPanel.bottom-30,i.ChartEngine.crosshairY=this.resolveY(e)),r.bottom=e,i.ChartEngine.resizingPanel.top=e,this.calculatePanelPercent(r),this.calculatePanelPercent(i.ChartEngine.resizingPanel)}this.adjustPanelPositions(),this.draw(),this.savePanels()}},i.ChartEngine.prototype.adjustPanelPositions=function(){if(this.chart.tempCanvas&&i.clearCanvas(this.chart.tempCanvas,this),this.chart.symbol&&!this.runPrepend("adjustPanelPositions",arguments)){var t,e,r=0,n=this.chart.canvasHeight,a=!1,s=0,o=0,l=!1;for(t in this.panels)e=this.panels[t],(isNaN(e.percent)||e.percent<=0)&&(e.percent=.05),e.hidden||(s+=e.percent,o++,e.soloing&&(l=!0));for(t in this.panels){var h=0;if(e=this.panels[t],e.hidden)e.markerHolder&&(e.markerHolder.style.display="none");else{a?this.displayIconsUpDown&&(e.up.style.display=""):(a=!0,e.up.style.display="none"),l?e.soloing?this.displayIconsSolo&&(e.solo.style.display=""):e.solo.style.display="none":1==o?e.solo.style.display="none":2!=o||this.soloPanelToFullScreen?this.displayIconsSolo&&(e.solo.style.display=""):e.solo.style.display="none",1==o?e.down.style.display="none":this.displayIconsUpDown&&(e.down.style.display=""),e.editFunction?e.edit.style.display="":e.edit.style.display="none",e.percent=e.percent/s,e.top=r,e.bottom=e.top+n*e.percent,e.height=e.bottom-e.top,e.chart.name==e.name&&(e.chart.top=e.top,e.chart.bottom=e.bottom,e.chart.height=e.height);var c=e.yAxis;c.zoom&&c.height>0&&(h=c.zoom/c.height),this.adjustYAxisHeightOffset(e,c),c.height=c.bottom-c.top,h&&(c.zoom=h*c.height,c.zoom>c.height&&(c.zoom=0,c.scroll=0)),r=e.bottom,c.high||0===c.high||(c.high=100,c.low=0,c.shadow=100),c.multiplier=c.height/c.shadow,e.holder&&(e.holder.style.right="0px",e.holder.style.top=e.top+"px",e.holder.style.left="0px",e.holder.style.height=e.height+"px",e.subholder.style.left=e.left+"px",e.subholder.style.width=e.width+"px",e.subholder.style.top="0px",c.height>=0&&(e.subholder.style.height=c.height+"px"))}}if(t&&(this.panels[t].down.style.display="none"),2!=o||l||(this.panels.chart.solo.style.display=""),this.controls.chartControls&&this.panels.chart){var u;u=l&&this.soloPanelToFullScreen?this.chart.canvasHeight-e.yAxis.bottom+12:this.chart.canvasHeight-this.panels.chart.yAxis.bottom+12,this.controls.chartControls.style.bottom=u+"px"}this.clearPixelCache(),this.adjustDrawings(),this.runAppend("adjustPanelPositions",arguments)}},i.ChartEngine.prototype.addChart=function(t,e){e.name=t,this.charts[t]=e},i.ChartEngine.prototype.createPanel=function(t,e,i,r){if(!this.runPrepend("createPanel",arguments)){r||(r="chart");var n=this.chart.canvasHeight;i||(i=.2*n);var a=i/n,s=1-a;for(var o in this.panels){this.panels[o].percent*=s}this.stackPanel(t,e,a,r),this.adjustPanelPositions(),this.savePanels(!1),this.runAppend("createPanel",arguments)}},i.ChartEngine.prototype.configurePanelControls=function(t){var e=t.name==t.chart.name;t.icons=n(".stx-panel-control",t.holder),t.close=t.icons.children[4],t.close=n(".stx-ico-close",t.icons).parentNode,i.appendClassName(t.icons,"stx-show"),t.title=n(".stx-panel-title",t.icons),t.up=n(".stx-ico-up",t.icons).parentNode,t.solo=n(".stx-ico-focus",t.icons).parentNode,t.down=n(".stx-ico-down",t.icons).parentNode,t.edit=n(".stx-ico-edit",t.icons).parentNode,this.displayIconsUpDown||(t.up.style.display="none"),this.displayIconsUpDown||(t.down.style.display="none"),this.displayIconsSolo||(t.solo.style.display="none"),this.displayIconsClose||(t.close.style.display="none"),this.displayPanelResize||(t.handle.style.display="none"),t.title.innerHTML="",t.display&&t.title.appendChild(document.createTextNode(t.display)),e&&(i.appendClassName(t.title,"chart-title"),i.appendClassName(t.icons,"stx-chart-panel")),i.touchDevice&&!i.isSurface||this.makeModal(t.icons),i.touchDevice&&!i.isSurface||(t.handle.onmouseover=function(t){return function(){t.hideCrosshairs()}}(this)),i.touchDevice&&!i.isSurface||(t.handle.onmouseout=function(t){return function(){t.showCrosshairs()}}(this)),i.touchDevice&&(t.handle.ontouchstart=function(t,e){return function(i){t.resizingPanel||(i.preventDefault(),t.grabHandle(e))}}(this,t),t.handle.ontouchend=function(t){return function(e){e.preventDefault(),t.releaseHandle()}}(this)),t.handle.onmousedown=function(t,e){return function(i){i||(i=event),t.grabHandle(e)}}(this,t),t.handle.onmouseup=function(t){return function(e){e||(e=event),t.releaseHandle()}}(this),i.safeClickTouch(t.close,function(t,e){return function(){t.panelClose(e)}}(this,t)),i.safeClickTouch(t.up,function(t,e){return function(){t.panelUp(e)}}(this,t)),i.safeClickTouch(t.down,function(t,e){return function(){t.panelDown(e)}}(this,t)),i.safeClickTouch(t.solo,function(t,e){return function(){t.panelSolo(e)}}(this,t)),"chart"==t.name&&(t.close.style.display="none")},i.ChartEngine.prototype.stackPanel=function(t,e,r,n){if(!this.runPrepend("stackPanel",arguments)){n||(n="chart");var a=this.charts[n],s=e==n,o=null;s&&(t=a.symbol,a.symbolDisplay&&(t=a.symbolDisplay),o=a.yAxis);var l=this.panels[e]=new i.ChartEngine.Panel(e,o);!s&&a.yAxis&&(l.yAxis.width=a.yAxis.width),l.percent=r,l.chart=a,l.display=t,l.holder=i.newChild(this.container,"div","stx-holder"),l.subholder=i.newChild(l.holder,"div","stx-subholder"),l.subholder.style.zIndex=1,l.holder.setAttribute("cq-panel-name",e),l.subholder.setAttribute("cq-panel-name",e);var h=s?"stx-panel-chart":"stx-panel-study";i.appendClassName(l.holder,h),l.subholder.appendChild(this.controls.iconsTemplate.cloneNode(!0)),l.handle=this.controls.handleTemplate.cloneNode(!0),this.container.appendChild(l.handle),l.handle.id=null,l.handle.panel=l,this.configurePanelControls(l),this.resizeCanvas(),this.runAppend("stackPanel",arguments)}},i.ChartEngine.prototype.setPanelEdit=function(t,e){t.editFunction=e,i.safeClickTouch(t.edit,e),this.adjustPanelPositions()},i.ChartEngine.prototype.drawPanels=function(){if(!this.runPrepend("drawPanels",arguments)){var t=!1;for(var e in this.panels){var r=this.panels[e];r.axisDrawn=!1,r.state={};var n=this.translateIf(r.display);if(r.title.textContent!=n&&(r.title.innerHTML="",r.title.appendChild(document.createTextNode(n))),i.appendClassName(r.icons,"stx-show"),r.hidden)i.unappendClassName(r.icons,"stx-show"),r.handle.style.display="none",r.holder.style.display="none";else if(this.displayIconsUpDown||(r.up.style.display="none"),this.displayIconsUpDown||(r.down.style.display="none"),this.displayIconsSolo||(r.solo.style.display="none"),r.holder.style.display="block",t){var a=r.top;a=Math.round(a)+.5,this.plotLine(r.left,r.right,a,a,this.canvasStyle("stx_panel_border"),"segment",this.chart.context,!1,{}),this.displayPanelResize?r.handle.style.display="":r.handle.style.display="none",r.handle.style.top=a-r.handle.offsetHeight/2+"px"}else r.handle.style.display="none",t=!0}this.runAppend("drawPanels",arguments)}},i.ChartEngine.prototype.touchSingleClick=function(t,e,r){var n=this,a=arguments;return function(){(function(){if(!this.cancelTouchSingleClick){if(this.runPrepend("touchSingleClick",a))return;if(this.editingAnnotation)return;if(this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},!this.displayCrosshairs)return;if(!this.displayInitialized)return;if(""!==this.openDialog)return;if(e<this.left||e>this.right||r<this.top||r>this.bottom)return;var t=this.backOutY(i.ChartEngine.crosshairY),s=this.backOutX(i.ChartEngine.crosshairX);this.currentPanel=this.whichPanel(t);var o=this.currentVectorParameters.vectorType;if(!(i.Drawing&&o&&i.Drawing[o]&&(new i.Drawing[o]).dragToDraw)){if(!this.drawingClick(this.currentPanel,s,t)&&!this.layout.crosshair){i.ChartEngine.crosshairY=0,i.ChartEngine.crosshairX=0,this.cx=this.backOutX(i.ChartEngine.crosshairX),this.cy=this.backOutY(i.ChartEngine.crosshairY),this.findHighlights(),i.ChartEngine.crosshairY=r,i.ChartEngine.crosshairX=e;var l=this.container.getBoundingClientRect();this.top=l.top,this.left=l.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cx=this.backOutX(i.ChartEngine.crosshairX),this.cy=this.backOutY(i.ChartEngine.crosshairY),this.currentPanel&&this.currentPanel.chart.dataSet&&(this.crosshairTick=this.tickFromPixel(this.cx,this.currentPanel.chart),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,this.valueFromPixel(this.cy,this.currentPanel))),this.headsUpHR(),this.findHighlights(!0)}this.currentVectorParameters.vectorType||this.dispatch("tap",{stx:this,panel:this.currentPanel,x:s,y:t})}}n.cancelTouchSingleClick=!1,this.runAppend("touchSingleClick",a)}).apply(n,a)}},i.ChartEngine.prototype.touchDoubleClick=function(t,e,r){if(!this.runPrepend("touchDoubleClick",arguments)&&!this.dispatch("doubleTap",{stx:this,finger:t,x:e,y:r})&&!(e<this.left||e>this.right||r<this.panels.chart.top||r>this.panels.chart.bottom||this.editingAnnotation)){if(i.ChartEngine.drawingLine)this.undo();else if(this.anyHighlighted)this.deleteHighlighted();else{var n=this.currentPanel.yAxis;n.scroll==(n.initialMarginTop-n.initialMarginBottom)/2&&n.zoom==n.initialMarginTop+n.initialMarginBottom?this.home():this.calculateYAxisMargins(this.currentPanel.yAxis),this.draw()}this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1},this.runAppend("touchDoubleClick",arguments)}},i.ChartEngine.prototype.startProxy=function(t){if(4==t.pointerType||"mouse"==t.pointerType?this.mouseMode=!0:this.mouseMode=!1,!this.mouseMode)if(this.touches[this.touches.length]={pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY},this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY}],this.gestureInEffect||1!=this.touches.length)this.gesture.stop(),this.touchstart(t);else{if(this.gesturePointerId=t.pointerId,this.overrideGesture=!1,!this.gesture)return;this.gesture.addPointer(t.pointerId),this.touchstart(t)}},i.ChartEngine.prototype.moveProxy=function(t){4==t.pointerType||"mouse"==t.pointerType?this.mouseMode=!0:this.mouseMode=!1,this.mouseMode||this.gestureInEffect||this.touchmove(t)},i.ChartEngine.prototype.endProxy=function(t){if(!this.mouseMode){for(var e=this.touches.length,i=0;i<this.touches.length;i++)if(this.touches[i].pointerId==t.pointerId){this.touches.splice(i,1);break}if(i==e)return this.touches=[],this.grabbingScreen=!1,void(this.touching=!1);this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY}],this.gestureInEffect||this.touchend(t)}},i.ChartEngine.prototype.msMouseMoveProxy=function(t){!this.touches.length&&this.mouseMode&&this.mousemove(t)},i.ChartEngine.prototype.msMouseDownProxy=function(t){this.mouseMode&&this.mousedown(t)},i.ChartEngine.prototype.msMouseUpProxy=function(t){this.mouseMode&&this.mouseup(t)},i.ChartEngine.prototype.iosMouseMoveProxy=function(t){this.touching||this.mousemove(t)},i.ChartEngine.prototype.iosMouseDownProxy=function(t){if(this.touching)return void(this.mouseMode=!1);this.mouseMode=!0,this.mousedown(t)},i.ChartEngine.prototype.iosMouseUpProxy=function(t){this.touching||this.mouseup(t)},i.ChartEngine.prototype.rawWatermark=function(t,e,i,r){this.canvasFont("stx_watermark",t),t.fillStyle=this.defaultColor,t.globalAlpha=.5,this.chart.context.textBaseline="alphabetic",t.fillText(r,e,i),t.globalAlpha=1},i.ChartEngine.prototype.watermark=function(t,e){if(e&&"object"!=typeof e&&(e={h:arguments[1],v:arguments[2],text:arguments[3]}),e={h:e.h||"left",v:e.v||"bottom",text:e.text||"",hOffset:e.hOffset||10,vOffset:e.vOffset||20},this.chart.context){var i=this.panels[t];if(i&&!i.hidden){var r=i.yAxis.bottom-e.vOffset;"top"==e.v?r=i.top+e.vOffset:"middle"==e.v&&(r=(i.top+i.yAxis.bottom)/2),this.chart.context.save(),this.canvasFont("stx_watermark"),this.canvasColor("stx_watermark"),this.chart.context.textBaseline="alphabetic";var n=i.left+e.hOffset;"right"==e.h?n=i.right-e.hOffset:"center"==e.h&&(n=(i.right+i.left-this.chart.context.measureText(e.text).width)/2),this.chart.context.globalAlpha=.5,this.chart.context.fillText(e.text,n,r),this.chart.context.globalAlpha=1,this.chart.context.restore()}}},i.ChartEngine.prototype.preAdjustScroll=function(t){t||(t=this.chart),this.previousAdjust={chart:t,scroll:t.scroll,maxTicks:t.maxTicks}},i.ChartEngine.prototype.postAdjustScroll=function(){if(this.previousAdjust){var t=this.previousAdjust.chart;t.scroll=this.previousAdjust.scroll+(t.maxTicks-this.previousAdjust.maxTicks),this.displayInitialized&&this.draw()}},i.ChartEngine.prototype.adjustDrawings=function(){for(var t=0;t<this.drawingObjects.length;t++){var e=this.drawingObjects[t];this.panels[e.panelName]&&e.adjust()}},i.ChartEngine.prototype.getNextInterval=function(t,e,i){e||(e=1),!1!==i&&(i=!0);var r=this.standardMarketIterator(t,i?this.dataZone:this.displayZone);return e<1?r.previous(-1*e):r.next(e)},i.ChartEngine.prototype.standardMarketIterator=function(t,e,i){var r=e||this.dataZone,n=i||this.chart,a={begin:t,interval:"tick"==this.layout.interval?1:this.layout.interval,periodicity:"tick"==this.layout.interval?this.chart.xAxis.futureTicksInterval:this.layout.periodicity,timeUnit:this.layout.timeUnit,inZone:this.dataZone,outZone:r};return n.market.newIterator(a)},i.ChartEngine.prototype.zoomSet=function(t,e){var i=this.mainSeriesRenderer||{};if(!i.params||!i.params.volume){var r;r=this.preferences.zoomAtCurrentMousePosition&&this.zoomInitiatedByMouseWheel&&this.crosshairTick<e.dataSet.length?this.crosshairTick||this.tickFromPixel(this.cx,e):this.isHome()?e.dataSet.length-1:this.chart.scroll>this.chart.dataSet.length?0:this.tickFromPixel(this.chart.width/2,e),this.animations.zoom.hasCompleted&&(this.zoomInitiatedByMouseWheel=!1);var n=e.dataSet.length-1-r,a=e.scroll;e.scroll=Math.floor((this.pixelFromTick(r,e)-e.left)/t)+1+n,this.micropixels+=(a-n)*this.layout.candleWidth-(e.scroll-n)*t}this.setCandleWidth(t),e.spanLock=!1,this.draw(),this.doDisplayCrosshairs(),this.updateChartAccessories()},i.ChartEngine.prototype.zoomOut=function(t,e){if(!this.runPrepend("zoomOut",arguments)){this.grabbingScreen=!1,i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),this.preferences.zoomOutSpeed?e=this.preferences.zoomOutSpeed:e||(e=1.3),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var r=this;for(var n in this.charts){var a=this.charts[n];if(i.ipad&&a.maxTicks>i.ChartEngine.ipadMaxTicks)return;var s=Math.floor(a.maxTicks*e);!1===a.allowScrollFuture&&!1===a.allowScrollPast&&s>a.dataSet.length&&(s=a.dataSet.length);var o=this.chart.width/s;o<this.minimumCandleWidth&&(o=this.minimumCandleWidth),this.layout.setSpan=null,this.layout.range=null,this.animations.zoom.run(function(t){return function(e){if(r.zoomSet(e,t),r.animations.zoom.hasCompleted){if(r.runAppend("zoomOut",arguments))return;r.changeOccurred("layout")}}}(a),this.layout.candleWidth,o)}}},i.ChartEngine.prototype.mouseWheel=function(t){if(!this.runPrepend("mouseWheel",arguments)){t||(t=event),t.preventDefault&&t.preventDefault();var e=t.deltaX,r=t.deltaY;if(Math.abs(r)>Math.abs(e)?e=0:r=0,this.lastMouseWheelEvent=Date.now(),0!==Math.abs(e)||0!==Math.abs(r)){if(this.allowSideswipe&&0!==e){this.lastMove="horizontal";var n=e;return n>50&&(n=50),n<-50&&(n=-50),this.grabbingScreen=!0,this.currentPanel||(this.currentPanel=this.chart.panel),this.grabStartX=i.ChartEngine.crosshairX,this.grabStartY=i.ChartEngine.crosshairY,this.grabStartScrollX=this.chart.scroll,this.grabStartScrollY=this.currentPanel.yAxis.scroll,this.grabStartMicropixels=this.micropixels,this.grabStartPanel=this.currentPanel,this.mousemoveinner(i.ChartEngine.crosshairX-n,i.ChartEngine.crosshairY),this.updateChartAccessories(),void(this.grabbingScreen=!1)}if(this.lastMove="vertical",this.allowZoom&&this.displayInitialized){r||("onmousewheel"==i.wheelEvent?(r=-.025*t.wheelDelta,t.wheelDeltaX&&(e=-.025*t.wheelDeltaX)):r=t.detail),void 0===t.deltaMode&&(t.deltaMode="MozMousePixelScroll"==t.type?0:1);var a=-r;1==t.deltaMode&&(a*=33);var s=null,o=null;if(this.mouseWheelAcceleration){var l=Math.max(Math.pow(Math.abs(a),.3),1);s=1-.1*l,o=1+.2*l}if(this.zoomInitiatedByMouseWheel=!0,
a>0?this.reverseMouseWheel?this.zoomOut(null,o):this.zoomIn(null,s):a<0&&(this.reverseMouseWheel?this.zoomIn(null,s):this.zoomOut(null,o)),!this.runAppend("mouseWheel",arguments))return!1}}}},i.ChartEngine.prototype.zoomIn=function(t,e){if(!this.runPrepend("zoomIn",arguments)){this.grabbingScreen=!1,i.ChartEngine.insideChart&&i.unappendClassName(this.container,"stx-drag-chart"),this.preferences.zoomInSpeed?e=this.preferences.zoomInSpeed:e||(e=.7),t&&t.preventDefault&&t.preventDefault(),this.cancelTouchSingleClick=!0;var r=this;for(var n in this.charts){var a=this.charts[n],s=Math.floor(a.maxTicks*e);a.maxTicks-s<1&&(s=a.maxTicks-1),s<this.minimumZoomTicks&&(s=this.minimumZoomTicks);var o=this.chart.width/s;this.layout.setSpan=null,this.layout.range=null,this.animations.zoom.run(function(t){return function(e){if(r.zoomSet(e,t),r.animations.zoom.hasCompleted){if(r.runAppend("zoomIn",arguments))return;r.changeOccurred("layout")}}}(a),this.layout.candleWidth,o)}}},i.ChartEngine.prototype.translateIf=function(t){return this.translationCallback?this.translationCallback(t):t},i.ChartEngine.prototype.setTimeZone=function(t,e){if(void 0===s)return void(this.timeZoneOffset=0);var r=new Date,n=r.getTimezoneOffset(),a=n,o=n;t&&(this.dataZone=t),this.dataZone&&(a=new s.Date(r,this.dataZone).getTimezoneOffset()),e&&(this.displayZone=e),this.displayZone&&(o=new s.Date(r,this.displayZone).getTimezoneOffset()),this.timeZoneOffset=a-n-(o-n);for(var l in this.charts){var h=this.charts[l];h.masterData&&!i.ChartEngine.isDailyInterval(this.layout.interval)&&this.setDisplayDates(h.masterData)}this.preferences.timeZone=e,this.changeOccurred("preferences"),this.createDataSet()},i.ChartEngine.prototype.setLocale=function(t,e){if("undefined"!=typeof Intl&&this.locale!=t){this.locale=t;var r,n=this.internationalizer={};for(n.hourMinute=new Intl.DateTimeFormat(this.locale,{hour:"numeric",minute:"numeric",hour12:!1}),n.hourMinuteSecond=new Intl.DateTimeFormat(this.locale,{hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}),n.mdhm=new Intl.DateTimeFormat(this.locale,{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),n.monthDay=new Intl.DateTimeFormat(this.locale,{month:"numeric",day:"numeric"}),n.yearMonthDay=new Intl.DateTimeFormat(this.locale,{year:"numeric",month:"numeric",day:"numeric"}),n.yearMonth=new Intl.DateTimeFormat(this.locale,{year:"numeric",month:"numeric"}),n.month=new Intl.DateTimeFormat(this.locale,{month:"short"}),n.numbers=new Intl.NumberFormat(this.locale),n.priceFormatters=[],e||(e=5),r=0;r<e+1;r++)n.priceFormatters.push(new Intl.NumberFormat(this.locale,{maximumFractionDigits:r,minimumFractionDigits:r}));for(r=0;r<5;r++){var a=r,s=r;r||(a="",s=2),n["percent"+a]=new Intl.NumberFormat(this.locale,{style:"percent",minimumFractionDigits:s,maximumFractionDigits:s})}i.I18N.createMonthArrays&&i.I18N.createMonthArrays(this,n.month,this.locale)}},i.ChartEngine.prototype.importLayout=function(t,e){function r(){P.importDrawings(d),P.draw(),P.currentlyImporting=!1,P.updateListeners("layout")}if(!t)return void(e.cb&&e.cb());"object"!=typeof e&&(e={managePeriodicity:arguments[1],preserveTicksAndCandleWidth:arguments[2]});var n=this.layout,a=i.shallowClone(n),s=e.managePeriodicity,o=e.cb,l=e.seriesCB,h=e.noDataLoad,c=this.minimumCandleWidth,u=e.preserveTicksAndCandleWidth;u||!1===u||(u=!0);var d=this.exportDrawings();if(this.abortDrawings(),this.currentlyImporting=!0,i.Studies)for(var p in n.studies){var f=n.studies[p];i.Studies.removeStudy(this,f)}this.overlays={};var m=i.clone(t),g=i.shallowClone(this.panels);this.panels={};var v=i.clone(m);s||(delete v.periodicity,delete v.interval,delete v.timeUnit,delete v.setSpan),i.dataBindSafeAssignment(n,v),s||(n.periodicity=a.periodicity,n.interval=a.interval,n.timeUnit=a.timeUnit,n.setSpan=a.setSpan),u?n.candleWidth=a.candleWidth:n.candleWidth||(n.candleWidth=8),n.candleWidth<c&&(n.candleWidth=c),this.setCandleWidth(n.candleWidth),"percent"==n.chartScale&&this.setComparison(!0);var y,x,b,C=m.panels,S=[];for(x in C){if(!("top"in C[x]))break;for(b=C[x],b.name=x,y=S.length-1;y>=0&&S[y].top>b.top;--y);S.splice(y+1,0,b)}if(n.panels={},S.length>0)for(var w=0;w<S.length;++w)b=S[w],this.stackPanel(b.display,b.name,b.percent,b.chartName);else for(x in C)b=C[x],this.stackPanel(b.display,x,b.percent,b.chartName);i.isEmpty(C)&&this.stackPanel("chart","chart",1,"chart");for(var M in g){var T=g[M],B=this.panels[M];if(B){this.container.removeChild(B.holder),this.container.removeChild(T.handle);var k={holder:!0,subholder:!0,display:!0};for(var D in k)B[D]=T[D];this.configurePanelControls(B),T.chart.panel==T&&(T.chart.panel=B)}else this.privateDeletePanel(T)}if(this.adjustPanelPositions(),this.storePanels(),i.Studies){var A=i.clone(n.studies);delete n.studies;for(var F in A){var _=A[F];i.Studies.addStudy(this,_.type,_.inputs,_.outputs,_.parameters,_.panel)}}this.extendedHours&&this.extendedHours.prepare(n.extended,n.marketSessions),void 0===n.chartType&&(n.chartType="line"),this.setMainSeriesRenderer(),this.adjustPanelPositions();var P=this;if(!h){if(t.symbols&&t.symbols.length){var E={};s&&(t.setSpan?E.span=t.setSpan:t.interval&&(E.periodicity={interval:t.interval,period:t.periodicity,timeUnit:t.timeUnit})),t.range&&(E.range=t.range);var L=t.symbols[0].symbolObject||t.symbols[0].symbol;return void this.newChart(L,null,this.chart,function(e){if(!e)for(var n,a=1;a<t.symbols.length;++a){n=t.symbols[a],n.parameters||(n.parameters={});var s=i.clone(n.parameters);s.action=null,P.addSeries(n.id,s,l)}r(),o&&o.apply(null,arguments)},E)}var N=m.range;if(N&&Object.keys(N).length)return void this.setRange(N,function(){r(),o&&o()});if(s){if(m.setSpan&&"{}"!=JSON.stringify(m.setSpan)&&this.chart.symbol)return void this.setSpan(m.setSpan,function(){r(),o&&o()});var O=m.interval,z=m.periodicity,I=m.timeUnit;if(isNaN(z)&&(z=1),O||(O="day"),O!=a.interval||z!=a.periodicity||I!=a.timeUnit)return n.periodicity=a.periodicity,n.interval=a.interval,n.timeUnit=a.timeUnit,n.setSpan=a.setSpan,void this.setPeriodicity({period:z,interval:O,timeUnit:I},function(){r(),o&&o()})}}this.createDataSet(),u||this.home(),r(),o&&o()},i.ChartEngine.prototype.exportLayout=function(t){var e={};for(var r in this.layout)"studies"!=r&&"panels"!=r?e[r]=i.clone(this.layout[r]):"studies"==r?e.studies={}:"panels"==r&&(e.panels={});for(var n in this.panels){var a=e.panels[n]={},s=this.panels[n];a.percent=s.percent,a.display=s.display,a.chartName=s.chart.name,a.top=s.top}for(var o in this.layout.studies){var l=e.studies[o]={},h=this.layout.studies[o];l.type=h.type,l.inputs=i.clone(h.inputs),l.outputs=i.clone(h.outputs),l.panel=h.panel,l.parameters=i.clone(h.parameters)}return t?e.symbols=this.getSymbols({"include-parameters":!0,"exclude-studies":!0}):delete e.symbols,e},i.ChartEngine.prototype.doCleanupDates=function(t,e){if(i.ChartEngine.isDailyInterval(e)&&t&&t.length)for(var r=0;r<t.length;r++){var n=t[r].DT;n&&("[object Date]"!=Object.prototype.toString.call(n)&&(n=new Date(n)),n&&n.setHours(0,0,0,0))}},i.ChartEngine.prototype.doCleanupGaps=function(t,e,r){function n(t,e){var r=t[f],n=e[f];void 0!==r&&void 0===n&&i.ensureDefaults(e,{Close:r,Open:r,High:r,Low:r,Volume:0,Adj_Close:t.Adj_Close})}var a=this.layout.interval;r=r||{};var s=r.cleanupGaps?r.cleanupGaps:this.cleanupGaps,o="gap"==s;if(!s)return t;if("tick"==a)return t;if(!t||!t.length)return t;if(e||(e=this.chart),"month"==a||"week"==a){if(this.dontRoll)return t;a="day"}var l=function(t){return t.DT?new Date(+t.DT):i.strToDateTime(t.Date)},h=[],c=t[0];h.push(c);for(var u,d={begin:l(c),interval:a,periodicity:1,timeUnit:this.layout.timeUnit,inZone:this.dataZone,outZone:this.dataZone},p=e.market.newIterator(d),f=e.defaultPlotField,m=1;m<t.length;m++){var g=t[m];u=p.next();var v=l(g);for(function(t,e){for(;+t<+e;){var i=o?null:c[f],r=o?null:c.Adj_Close;h.push({DT:t,Open:i,High:i,Low:i,Close:i,Volume:0,Adj_Close:r}),t=p.next()}}(u,v);v<u;){if(++m==t.length)return h;o||n(c,g),h.push(g),c=g,g=t[m],v=l(g)}u<v?(m--,u=p.previous()):(o||n(c,g),h.push(g),c=g)}return h},i.Comparison=function(){},i.Comparison.initialPrice=100,i.Comparison.getInitialPrice=function(t){if(t.initialComparisonPrice)return t.initialComparisonPrice;t.initialComparisonPrice=100;var e=i.Comparison.initialPrice;if("number"==typeof e&&(t.initialComparisonPrice=e),"string"==typeof e&&(t.series[e]||""===e)){var r="Close";t.defaultPlotField&&(t.highLowBars||(r=t.defaultPlotField));for(var n=t.dataSet.length-t.scroll;n<t.dataSet.length;n++){var a=t.dataSet[n];if(a){if(a[e]&&a[e][r]){t.initialComparisonPrice=a[e][r];break}if(""===e&&a[r]){t.initialComparisonPrice=a[r];break}}}}return t.initialComparisonPrice},i.Comparison.priceToPercent=function(t,e,r){var n=i.Comparison.baseline||r;return Math.round((r-n)/n*100*1e4)/1e4},i.Comparison.percentToPrice=function(t,e,r){return(i.Comparison.baseline||1)*(1+r/100)},i.Comparison.priceToRelative=function(t,e,r){var n=i.Comparison.baseline||r;return i.Comparison.getInitialPrice(e)*r/n},i.Comparison.relativeToPrice=function(t,e,r){return(i.Comparison.baseline||1)*r/i.Comparison.getInitialPrice(e)},i.Comparison.createComparisonSegmentInner=function(t,e){var r,n=[];for(r in e.series){var a=e.series[r].parameters;a.isComparison&&n.push(a.symbol)}var s=["Close","Open","High","Low","iqPrevClose"],o=t.chart.highLowBars||t.highLowBars[t.layout.chartType];e.defaultPlotField&&!o&&s.unshift(e.defaultPlotField);var l=s[0],h=t.layout.studies;if(h)for(var c in h){var u=h[c];if(t.panels[u.panel]&&t.panels[u.panel].name==u.chart.name){for(r in u.outputMap)s.push(r);u.referenceOutput&&s.push(u.referenceOutput+" "+u.name)}}for(var d in t.plugins){var p=t.plugins[d];if(p.transformOutputs)for(r in p.transformOutputs)s.push(r)}e.initialComparisonPrice=null,e.dataSegment=[];var f=null,m=e.dataSet.length-e.scroll;t.micropixels+t.layout.candleWidth/2<0&&m++;for(var g=e.maxTicks+3,v=0;v<=g;v++){v==g&&(v=-1);var y=m+v;if(y<e.dataSet.length&&y>=0){var x=e.dataSet[y],b=x[l];if(!f){if(0===b||null===b){if(v<0)break;continue}f=i.clone(x)}x.transform||(x.transform={cache:{},DT:x.DT,Date:x.Date}),!i.Comparison.baseline&&b&&(f=i.clone(x)),i.Comparison.baseline=f[l];var C;for(C=0;C<s.length;C++)r=s[C],(x[r]||0===x[r])&&(x.transform[r]=e.transformFunc(t,e,x[r]));for(C=0;C<n.length;C++){r=n[C];var S=e.series[r];if(-1==v&&S&&S.parameters.isComparison)delete x.transform[r];else for(var w=x[r],M=0;w&&M<s.length;M++){var T=w[s[M]];if(T||0===T){var B=f[r]&&f[r][s[0]];if(B||0===B||(f[r]||(f[r]={}),f[r][s[M]]=B=T*i.Comparison.baseline/x[l]),0!==B){var k=i.Comparison.baseline||1,D=T*(k/B);x.transform[r]||(x.transform[r]={}),x.transform[r][s[M]]=e.transformFunc(t,e,D)}}}}e.dataSegment.push(x)}else y<0&&e.dataSegment.push(null);if(v<0)break}},i.Comparison.priceFormat=function(t,e,i){if(null===i||void 0===i||isNaN(i))return"";var r=e.yAxis.priceTick,n=t.internationalizer;return i=n?r>=5?n.percent.format(i/100):r>=.5?n.percent1.format(i/100):r>=.05?n.percent2.format(i/100):r>=.005?n.percent3.format(i/100):n.percent4.format(i/100):r>=5?i.toFixed(0)+"%":r>=.5?i.toFixed(1)+"%":r>=.05?i.toFixed(2)+"%":r>=.005?i.toFixed(3)+"%":i.toFixed(4)+"%",0===parseFloat(i)&&"-"==i.charAt(0)&&(i=i.substring(1)),i},i.ChartEngine.prototype.setComparison=function(t,e,r){if(e||(e=this.chart),"string"==typeof e&&(e=this.charts[e]),(r||""===r)&&(i.Comparison.initialPrice=r),!0===t){if(e.isComparison)return;t="percent"}var n=e.panel.yAxis,a=n.priceFormatter==i.Comparison.priceFormat;switch(t){case"relative":this.setTransform(e,i.Comparison.priceToRelative,i.Comparison.relativeToPrice),a&&(n.priceFormatter=n.originalPriceFormatter?n.originalPriceFormatter.func:null,n.originalPriceFormatter=null),n.whichSet="dataSegment",e.isComparison=!0;break;case"percent":this.setTransform(e,i.Comparison.priceToPercent,i.Comparison.percentToPrice),a||(n.originalPriceFormatter={func:n.priceFormatter},n.priceFormatter=i.Comparison.priceFormat),n.whichSet="dataSegment",e.isComparison=!0;break;default:this.unsetTransform(e),a&&(n.priceFormatter=n.originalPriceFormatter?n.originalPriceFormatter.func:null,n.originalPriceFormatter=null),n.whichSet="dataSet",e.isComparison=!1}},i.ChartEngine.prototype.importPreferences=function(t){this.preferences=t,t.timeZone&&this.setTimeZone(this.dataZone,t.timeZone),t.language&&i.I18N&&(i.I18N.setLanguage(this,t.language),i.I18N.translateUI(t.language))},i.ChartEngine.prototype.exportPreferences=function(){return this.preferences},"undefined"!=typeof document&&document.addEventListener("contextmenu",i.ChartEngine.handleContextMenu),t},__market_=function(t){t||(t={});var e=t.CIQ,i=t.timezoneJS;e||(e=function(){},t.CIQ=e);e.Market=function(t){this.market_def=!1,this.rules=!1,this.normalHours=[],this.extraHours=[],this.class_name="Market",this.tz_lib=void 0===i?Date:i.Date,this.market_tz="",this.hour_aligned=!1,this.convertOnDaily=!1,this.enabled_by_default=!1,void 0!==t&&t&&t!={}&&(t.market_definition&&(t=t.market_definition),t.rules&&(this.rules=t.rules),t.market_tz&&(this.market_tz=t.market_tz),t.convertOnDaily&&(this.convertOnDaily=t.convertOnDaily),t.hour_aligned,this.hour_aligned=t.hour_aligned,void 0!==t.enabled_by_default&&t.enabled_by_default instanceof Array&&(this.enabled_by_default=t.enabled_by_default),this.market_def=t,void 0===this.market_def.name&&(this.market_def.name="no market name specified"),e.Market._createTimeSegments(this))},e.Market.GLOBEX={name:"GLOBEX",market_tz:"America/Chicago",hour_aligned:!0,rules:[{dayofweek:0,open:"15:00",close:"24:00"},{dayofweek:1,open:"00:00",close:"24:00"},{dayofweek:2,open:"00:00",close:"24:00"},{dayofweek:3,open:"00:00",close:"24:00"},{dayofweek:4,open:"00:00",close:"24:00"},{dayofweek:5,open:"00:00",close:"18:00"}]},e.Market.FOREX={name:"FOREX",market_tz:"America/New_York",hour_aligned:!0,rules:[{dayofweek:0,open:"15:00",close:"24:00"},{dayofweek:1,open:"00:00",close:"17:00"},{dayofweek:1,open:"17:00",close:"24:00"},{dayofweek:2,open:"00:00",close:"17:00"},{dayofweek:2,open:"17:00",close:"24:00"},{dayofweek:3,open:"00:00",close:"17:00"},{dayofweek:3,open:"17:00",close:"24:00"},{dayofweek:4,open:"00:00",close:"17:00"},{dayofweek:4,open:"17:00",close:"24:00"},{dayofweek:5,open:"00:00",close:"17:00"}]},e.Market.METALS={name:"METALS",market_tz:"America/New_York",hour_aligned:!0,rules:[{dayofweek:0,open:"18:00",close:"24:00"},{dayofweek:1,open:"00:00",close:"17:15"},{dayofweek:1,open:"18:00",close:"24:00"},{dayofweek:2,open:"00:00",close:"17:15"},{dayofweek:2,open:"18:00",close:"24:00"},{dayofweek:3,open:"00:00",close:"17:15"},{dayofweek:3,open:"18:00",close:"24:00"},{dayofweek:4,open:"00:00",close:"17:15"},{dayofweek:4,open:"18:00",close:"24:00"},{dayofweek:5,open:"00:00",close:"17:15"}]},e.Market.NYSE={name:"NYSE",market_tz:"America/New_York",hour_aligned:!1,rules:[{dayofweek:1,open:"09:30",close:"16:00"},{dayofweek:2,open:"09:30",close:"16:00"},{dayofweek:3,open:"09:30",close:"16:00"},{dayofweek:4,open:"09:30",close:"16:00"},{dayofweek:5,open:"09:30",close:"16:00"},{dayofweek:1,open:"04:00",close:"09:30",name:"pre"},{dayofweek:2,open:"04:00",close:"09:30",name:"pre"},{dayofweek:3,open:"04:00",close:"09:30",name:"pre"},{dayofweek:4,open:"04:00",close:"09:30",name:"pre"},{dayofweek:5,open:"04:00",close:"09:30",name:"pre"},{dayofweek:1,open:"16:00",close:"20:00",name:"post"},{dayofweek:2,open:"16:00",close:"20:00",name:"post"},{dayofweek:3,open:"16:00",close:"20:00",name:"post"},{dayofweek:4,open:"16:00",close:"20:00",name:"post"},{dayofweek:5,open:"16:00",close:"20:00",name:"post"},{date:"*-12-25",open:"00:00",close:"00:00"},{date:"*-07-04",open:"00:00",close:"00:00"},{date:"*-01-01",open:"00:00",close:"00:00"},{date:"2012-01-02",open:"00:00",close:"00:00"},{date:"2018-01-15"},{date:"2018-02-19"},{date:"2018-03-30"},{date:"2018-05-28"},{date:"2018-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2018-07-03",open:"9:30",close:"13:00"},{date:"2018-09-03"},{date:"2018-11-22"},{date:"2018-11-23",open:"4:00",close:"9:30",name:"pre"},{date:"2018-11-23",open:"9:30",close:"13:00"},{date:"2018-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2018-12-24",open:"9:30",close:"13:00"},{date:"2017-01-02"},{date:"2017-01-16"},{date:"2017-02-20"},{date:"2017-04-14"},{date:"2017-05-29"},{date:"2017-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2017-07-03",open:"9:30",close:"13:00"},{date:"2017-09-04"},{date:"2017-11-23"},{date:"2017-11-24",open:"4:00",close:"9:30",name:"pre"},{date:"2017-11-24",open:"9:30",close:"13:00"},{date:"2016-01-18"},{date:"2016-02-15"},{date:"2016-03-25"},{date:"2016-05-30"},{date:"2016-09-05"},{date:"2016-11-24"},{date:"2016-11-25",open:"4:00",close:"9:30",name:"pre"},{date:"2016-11-25",open:"9:30",close:"13:00"},{date:"2016-12-26"},{date:"2015-01-19"},{date:"2015-02-16"},{date:"2015-04-03"},{date:"2015-05-25"},{date:"2015-07-03"},{date:"2015-09-07"},{date:"2015-11-26"},{date:"2015-11-27",open:"4:00",close:"9:30",name:"pre"},{date:"2015-11-27",open:"9:30",close:"13:00"},{date:"2015-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2015-12-24",open:"9:30",close:"13:00"},{date:"2014-01-20"},{date:"2014-02-17"},{date:"2014-04-18"},{date:"2014-05-26"},{date:"2014-09-01"},{date:"2014-11-27"},{date:"2014-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2014-07-03",open:"9:30",close:"13:00"},{date:"2014-11-28",open:"4:00",close:"9:30",name:"pre"},{date:"2014-11-28",open:"9:30",close:"13:00"},{date:"2014-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2014-12-24",open:"9:30",close:"13:00"},{date:"2013-01-21"},{date:"2013-02-18"},{date:"2013-03-29"},{date:"2013-05-27"},{date:"2013-09-02"},{date:"2013-11-28"},{date:"2013-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2013-07-03",open:"9:30",close:"13:00"},{date:"2013-11-29",open:"4:00",close:"9:30",name:"pre"},{date:"2013-11-29",open:"9:30",close:"13:00"},{date:"2013-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2013-12-24",open:"9:30",close:"13:00"},{date:"2012-01-16"},{date:"2012-02-20"},{date:"2012-04-06"},{date:"2012-05-28"},{date:"2012-09-03"},{date:"2012-10-29"},{date:"2012-10-30"},{date:"2012-11-22"},{date:"2012-07-03",open:"4:00",close:"9:30",name:"pre"},{date:"2012-07-03",open:"9:30",close:"13:00"},{date:"2012-11-23",open:"4:00",close:"9:30",name:"pre"},{date:"2012-11-23",open:"9:30",close:"13:00"},{date:"2012-12-24",open:"4:00",close:"9:30",name:"pre"},{date:"2012-12-24",open:"9:30",close:"13:00"}]},e.Market.Symbology=function(){},e.Market.Symbology.isForeignSymbol=function(t){return!!t&&-1!=t.indexOf(".")},e.Market.Symbology.isFuturesSymbol=function(t){return!!t&&(0===t.indexOf("/")&&"/"!=t)},e.Market.Symbology.isForexSymbol=function(t){return!!t&&(!e.Market.Symbology.isForeignSymbol(t)&&(!e.Market.Symbology.isFuturesSymbol(t)&&(!(t.length<6||t.length>7)&&((6!=t.length||"X"!=t[5])&&!!/\^?[A-Za-z]{6}/.test(t)))))},e.Market.Symbology.isForexMetal=function(t,i){return!!t&&(!!e.Market.Symbology.isForexSymbol(t)&&("^"!=t.charAt(0)&&(t="^"+t),-1!=",XAU,XPD,XPT,XAG,".indexOf(","+t.substr(4,3)+",")||!i&&-1!=",XAU,XPD,XPT,XAG,".indexOf(","+t.substr(1,3)+",")))},e.Market.Symbology.isForexFuturesSymbol=function(t){return!!e.Market.Symbology.isForexSymbol(t)||!!e.Market.Symbology.isFuturesSymbol(t)},e.Market.Symbology.factory=function(t){var i=t.symbol;return e.Market.Symbology.isForeignSymbol(i)?null:e.Market.Symbology.isFuturesSymbol(i)?e.Market.GLOBEX:e.Market.Symbology.isForexMetal(i)?e.Market.METALS:e.Market.Symbology.isForexSymbol(i)?e.Market.FOREX:e.Market.NYSE},e.Market.prototype._find_next_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),r=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz});if(this._wasOpenIntraDay(i)){var n=this.zseg_match.close_parts.hours,a=this.zseg_match.close_parts.minutes;i.setHours(n),i.setMinutes(a),r=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz})}return r.next()},e.Market.prototype._find_prev_segment=function(t,e){if(!this.market_def)return null;if(!this.rules)return null;var i=new Date(+t),r=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz}),n=this._wasOpenIntraDay(i);if(null===n?(i=new Date(i-6e4),n=this._wasOpenIntraDay(i)):(e&&i.getHours()===this.zseg_match.open_parts.hours&&i.getMinutes()===this.zseg_match.open_parts.minutes||!e&&i.getHours()===this.zseg_match.close_parts.hours&&i.getMinutes()===this.zseg_match.close_parts.minutes)&&(i=r.previous()),n){var a=this.zseg_match.open_parts.hours,s=this.zseg_match.open_parts.minutes;return i.setHours(a),i.setMinutes(s),r=this.newIterator({begin:i,interval:1,inZone:this.market_tz,outZone:this.market_tz}),i=r.previous(),this.zseg_match.close_parts.hours===a&&this.zseg_match.close_parts.minutes===s?e?r.next():i:this.zseg_match.adjacent_child?i:e?r.next():i}return r.previous()},e.Market.prototype.disableSession=function(t,e){var i=!1;if(void 0!==e&&e&&(i=!0),t){for(var r=0;r<this.normalHours.length;r++)this.normalHours[r].name===t&&(this.normalHours[r].enabled=i);for(r=0;r<this.extraHours.length;r++)this.extraHours[r].name===t&&(this.extraHours[r].enabled=i)}},e.Market.prototype.enableSession=function(t){this.disableSession(t,"enable_instead")},e.Market.prototype.getClose=function(t,e,i,r){if(!this.market_def)return null;if(!this.rules)return null;var n=t;if(t||(n=new Date,i=null),n=this._convertToMarketTZ(n,i),void 0!==e){if(this._wasOpenIntraDay(n)&&this.zseg_match.name===e)return n.setHours(this.zseg_match.close_parts.hours,this.zseg_match.close_parts.minutes,0,0),n=this._convertFromMarketTZ(n,r)}else if(this._wasOpenDaily(n)){for(var a=this.zseg_match;a.child_;)a=a.child_;for(;!a.enabled;)a=a.parent_;return n.setHours(a.close_parts.hours,a.close_parts.minutes,0,0),n=this._convertFromMarketTZ(n,r)}return null},e.Market.prototype.getNextClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var r=t;if(t||(r=new Date,e=null),r=this._convertToMarketTZ(r,e),!this._wasOpenIntraDay(r)){r=this.newIterator({begin:r,interval:1,inZone:this.market_tz,outZone:this.market_tz}).next()}for(var n=r.getDate(),a=this.zseg_match;a.adjacent_child;)a=a.adjacent_child,n+=1;return r.setDate(n),r.setHours(a.close_parts.hours,a.close_parts.minutes,0,0),r=this._convertFromMarketTZ(r,i)},e.Market.prototype.getNextOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var r=t;return t||(r=new Date,e=null),r=this._convertToMarketTZ(r,e),r=this._find_next_segment(r),this.zseg_match.adjacent_parent?(r=this.getNextOpen(r,this.market_tz,this.market_tz),r=this._convertFromMarketTZ(r,i)):(r.setHours(this.zseg_match.open_parts.hours),r.setMinutes(this.zseg_match.open_parts.minutes),r=this._convertFromMarketTZ(r,i))},e.Market.prototype.getOpen=function(t,e,i,r){if(!this.market_def)return null;if(!this.rules)return null;var n=t;if(t||(n=new Date,i=null),n=this._convertToMarketTZ(n,i),void 0!==e){if(this._wasOpenIntraDay(n)&&this.zseg_match.name==e)return n.setHours(this.zseg_match.open_parts.hours,this.zseg_match.open_parts.minutes,0,0),n=this._convertFromMarketTZ(n,r)}else if(this._wasOpenDaily(n)){for(var a=this.zseg_match;a.parent_;)a=a.parent_;for(;!a.enabled;)a=a.child_;return n.setHours(a.open_parts.hours,a.open_parts.minutes,0,0),n=this._convertFromMarketTZ(n,r)}return null},e.Market.prototype.getPreviousClose=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var r=t;return t||(r=new Date,e=null),r=this._convertToMarketTZ(r,e),r=this._find_prev_segment(r,!1),this.zseg_match.adjacent_child?this.getPreviousClose(r,this.market_tz,this.market_tz):(r.setHours(this.zseg_match.close_parts.hours),r.setMinutes(this.zseg_match.close_parts.minutes),r=this._convertFromMarketTZ(r,i))},e.Market.prototype.getPreviousOpen=function(t,e,i){if(!this.market_def)return null;if(!this.rules)return null;var r=t;return t||(r=new Date,e=null),r=this._convertToMarketTZ(r,e),r=this._find_prev_segment(r,!0),this.zseg_match.adjacent_parent?this.getPreviousOpen(this.market_tz,this.market_tz):(r.setHours(this.zseg_match.open_parts.hours),r.setMinutes(this.zseg_match.open_parts.minutes),r=this._convertFromMarketTZ(r,i))},e.Market.prototype.getSession=function(t,e){return t=this._convertToMarketTZ(t,e),this._wasOpenIntraDay(t)&&this.zseg_match?this.zseg_match.name:null},e.Market.prototype.marketZoneNow=function(){return this._convertToMarketTZ(new Date)},e.Market.prototype.isHourAligned=function(){return this.hour_aligned},e.Market.prototype.isOpen=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenIntraDay(t)},e.Market.prototype.isMarketDay=function(){var t=new Date;return this.market_tz&&(t=new this.tz_lib(t.getTime(),this.market_tz)),this._wasOpenDaily(t)},e.Market.prototype.isMarketDate=function(t){return this._wasOpenDaily(t)},e.Market.prototype.newIterator=function(t){var i=!1;t.periodicity?i=t.periodicity:t.multiple&&(i=t.multiple);var r=t.interval;return r||(r="minute"),"hour"==r&&(r=60),i||(i=1),t.begin||(t.begin=new Date,t.inZone=null),r==parseInt(r,10)&&(r=parseInt(r,10),t.periodicity<1/60?(i=i*r*6e4,r="millisecond"):t.periodicity<1?(i=i*r*60,r="second"):(i*=r,r="minute")),t.timeUnit&&("millisecond"===t.timeUnit?r=t.timeUnit:"second"===t.timeUnit&&(r=t.timeUnit)),t.interval=r,t.multiple=i,t.market=this,new e.Market.Iterator(t)},e.Market.prototype._wasOpenDaily=function(t){return this._was_open(t,!1)},e.Market.prototype._wasOpenIntraDay=function(t){return this._was_open(t,!0)},e.Market.prototype._was_open=function(t,e){if(this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null,!this.market_def||!this.rules)return this.zclose_hour=24,!0;var i,r=!1,n=!1,a=t.getFullYear(),s=t.getMonth()+1,o=t.getDay(),l=t.getDate(),h=t.getHours(),c=t.getMinutes(),u=t.getSeconds(),d=60*h*60+60*c+u;void 0===e&&(e=!0);var p;for(p=0;p<this.normalHours.length;p++)if(i=this.normalHours[p],i.enabled&&(r=i.dayofweek===o,r&&e&&(r=d>=i.open&&d<i.close),r)){if(!e&&this.zseg_match&&(i.open_parts.hours>this.zopen_hour||i.open_parts.hours==this.zopen_hour&&i.open_parts.minutes>this.zopen_minute))continue;if(this.zopen_hour=i.open_parts.hours,this.zopen_minute=i.open_parts.minutes,this.zclose_hour=i.close_parts.hours,this.zclose_minute=i.close_parts.minutes,this.zmatch_open=d===i.open,this.zseg_match=i,e)break}for(p=0;p<this.extraHours.length;p++)if(i=this.extraHours[p],i.enabled&&("*"===i.year||a===i.year)&&s===i.month&&l===i.day&&(n=!e&&i.open||d>=i.open&&d<i.close,!n&&this.zseg_match&&(r=!1,this.zopen_hour=0,this.zopen_minute=0,this.zclose_hour=0,this.zclose_minute=0,this.zmatch_open=!1,this.zseg_match=null),n)){if(!e&&this.zseg_match&&(i.open_parts.hours>this.zopen_hour||i.open_parts.hours==this.zopen_hour&&i.open_parts.minutes>this.zopen_minute))continue;if(this.zopen_hour=i.open_parts.hours,this.zopen_minute=i.open_parts.minutes,this.zclose_hour=i.close_parts.hours,this.zclose_minute=i.close_parts.minutes,this.zmatch_open=d===i.open,this.zseg_match=i,e)break}return this.zseg_match},e.Market.prototype._wasClosed=function(t){return!this._was_open(t,!0)},e.Market.prototype._wasOpen=function(t){return this._was_open(t,!0)},e.Market.prototype._tzDifferenceMillis=function(t,e,i){var r=t,n=t;return 60*(r.getTimezoneOffset()-n.getTimezoneOffset())*1e3},e.Market._createTimeSegments=function(t){for(var e,i=0;i<t.rules.length;i++){var n=JSON.parse(JSON.stringify(t.rules[i]));void 0===n.open&&void 0===n.close&&(n.open="00:00",n.close="00:00"),n.hasOwnProperty("name")||(n.name="");try{var a;if(void 0!==n.dayofweek?(n.year="*",a=r._createDayOfWeekSegment(t,n),e&&(e.dayofweek===a.dayofweek?(e.child_=a,a.parent_=e):function(t,i){if(24===t.close_parts.hours&&0===i.open_parts.hours&&0===i.open_parts.minutes){if(e.dayofweek===a.dayofweek-1)return!0;if(6===e.dayofweek&&0===a.dayofweek)return!0}return!1}(e,a)&&(e.adjacent_child=a,a.adjacent_parent=e)),e=a):void 0!==n.date?(n.isDayOfWeek=!1,n.dayofweek=-1,a=r._createDateTimeSegment(t,n)):console.log("Error, unknown rule type "+n),t.enabled_by_default)for(var s=0;s<t.enabled_by_default.length;s++){var o=t.enabled_by_default[s];if(a.name===o){a.enabled=!0;break}}}catch(t){console.log("Error, creating market rules "+t)}}},e.Market._timeSegment={};var r=e.Market._timeSegment;r.re_wild_card_iso=/^(\*)-(\d\d)-(\d\d)$/,r.re_regular_iso=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,r.re_split_hours_minutes=/^(\d\d):(\d\d)$/,r.re_split_hour_minutes=/^(\d):(\d\d)$/,r._hashCode=function(t){var e,i,r,n=0;if(0===t.length)return n;for(e=0,r=t.length;e<r;e++)i=t.charCodeAt(e),n=(n<<5)-n+i,n|=0;return n},r._splitHoursMinutes=function(t){var e=r.re_split_hour_minutes.exec(t),i={hours:NaN,minutes:NaN};return null===e&&null===(e=r.re_split_hours_minutes.exec(t))?i:(i.hours=parseInt(e[1],10),i.minutes=parseInt(e[2],10),i)},r._createDayOfWeekSegment=function(t,e){var i={name:e.name,isDayOfWeek:!0,dayofweek:e.dayofweek,date_str:"*",open_parts:r._splitHoursMinutes(e.open),close_parts:r._splitHoursMinutes(e.close),open:r._secSinceMidnight(t,e.open,!0),close:r._secSinceMidnight(t,e.close,!1),child_:!1,parent_:!1,adjacent_child:!1,adjacent_parent:!1,enabled:!1};return""===i.name&&(i.enabled=!0),i.hash_code=this._hashCode((i.open+i.close).toString()),t.normalHours.push(i),i},r._createDateTimeSegment=function(t,e){var i,n=this.re_regular_iso.exec(e.date);if(null===n){if(null===(n=this.re_wild_card_iso.exec(e.date)))return void console.log("Warning: invalid date format on rule -> "+e.date);i="*"}else i=parseInt(n[1],10);var a={name:e.name,isDayOfWeek:!1,dayofweek:-1,year:i,month:parseInt(n[2],10),day:parseInt(n[3],10),date_str:e.date,open_parts:r._splitHoursMinutes(e.open),close_parts:r._splitHoursMinutes(e.close),open:r._secSinceMidnight(t,e.open,!0),close:r._secSinceMidnight(t,e.close,!1),enabled:!1};return""===a.name&&(a.enabled=!0),a.hash_key=this._hashCode(a.date_str+a.open+a.close),t.extraHours.push(a),a},r._secSinceMidnight=function(t,e,i){var r=e.split(":"),n=parseInt(r[0],10),a=parseInt(r[1],10),s=60*n*60+60*a;return i||24===n&&(s=60*n*60+1),s},e.Market.prototype._convertToMarketTZ=function(t,e){if(!this.market_tz)return t;var i;return i=e?new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),e):new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i.setTimezone&&i.setTimezone(this.market_tz),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())},e.Market.prototype._convertFromMarketTZ=function(t,e){if(!this.market_tz)return t;var i=new this.tz_lib(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),this.market_tz);return e?(i.setTimezone&&i.setTimezone(e),new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(i.getTime())},e.Market.Iterator=function(t){this.market=t.market,this.begin=t.begin,this.interval=t.interval,this.multiple=t.multiple,this.inZone=t.inZone,this.outZone=t.outZone,this.clock=new e.Market.Iterator._Clock(t.market,t.interval,t.multiple),this.intraDay=this.clock.intra_day,this.intraDay&&(this.begin=this.market._convertToMarketTZ(this.begin,t.inZone)),this.clock._setStart(this.begin),this.clock.minutes_aligned=!1},e.Market.Iterator.prototype.date=function(){return this.clock._date()},e.Market.Iterator.prototype.futureTick=function(t){this.clock.skip=1;var e,i=0;e=this.intraDay?this.market._convertToMarketTZ(t.end,this.inZone).getTime():t.end.getTime();var r=this.clock.ctime;if(e===r)return i;var n=2,a=0;t.sample_size&&(n=t.sample_size);var s,o=(new Date).getTime();if(e>r){for(this.clock.forward=!0;this.clock.ctime<e;)if(i+=1,a+=1,this.clock._findNext(),1e3===a&&(a=0,(new Date).getTime()-o>=n)){s=(this.clock.ctime-r)/i,i=Math.floor((e-r)/s);break}this.clock.ctime>e&&i--
}else for(this.clock.forward=!1;this.clock.ctime>e;)if(i+=1,a+=1,this.clock._findPrevious(),1e3===a&&(a=0,(new Date).getTime()-o>=n)){s=(r-this.clock.ctime)/i,i=Math.floor((r-e)/s);break}return i},e.Market.Iterator.prototype.isHourAligned=function(){return!this.intraDay||this.market.isHourAligned()},e.Market.Iterator.prototype.isOpen=function(){return this.market.isOpen()},e.Market.Iterator.prototype.next=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!0;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findNext();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator.prototype.peek=function(){return this.clock._peek()},e.Market.Iterator.prototype.previous=function(t){this.clock.skip=1,t&&(this.clock.skip=t),this.clock.forward=!1;for(var e=0;e<this.clock.skip;e++)this.begin=this.clock._findPrevious();return this.intraDay||this.market.convertOnDaily?this.market._convertFromMarketTZ(this.clock.display_date,this.outZone):this.clock.display_date},e.Market.Iterator._Clock=function(t,e,i){i%60==0&&"second"===e&&(e="minute",i/=60),this.market=t,this.interval=e,this.multiple=i,this.intra_day=!1,this.intervals=[],this.max_iters=10080;var r=864e5,n=this._dayImpl;"millisecond"===e?(n=this._millisImpl,r=1):"second"===e?(n=this._secondImpl,r=1e3):"minute"===e?(n=this._minuteImpl,r=6e4):"hour"===e?(n=this._hourImpl,r=36e5):"day"===e?(n=this._dayImpl,r=864e5):"week"===e?(n=this._weekImpl,r=6048e5):"month"===e?(n=this._monthImpl,r=2592e6):console.log('Periodicity ERROR: "'+e+'" is not a valid interval. Please see setPeriodicity() for details.'),this.tick_time=r*i,this.intra_day=this.tick_time<864e5,this._findPrevious=this._findNext=n};var n=e.Market.Iterator._Clock.prototype;return n._total_minutes=function(t,e,i,r){return 60*(i-t)-e+r},n._alignMinutes=function(){if(void 0===this.market.zopen_minute)return[];var t=this.market.zopen_minute;this.market.isHourAligned()&&this.multiple%60==0&&(t=0);for(var e=this._total_minutes(this.market.zopen_hour,t,this.market.zclose_hour,this.market.zclose_minute),i=[],r=0;r<e;)i.push(t+r),r+=this.multiple;return i},n._alignBaseZero=function(t){for(var e=0,i=[e];;){if((e+=this.multiple)>=t)break;i.push(e)}return i},n._date=function(){var t=Math.round(this.ctime),e=new Date(t);return this.intra_day?this.display_date=new Date(t+this.shift_millis):this.display_date=e,e},n._alignToBoundary=function(t,e){for(var i=0,r=0,n=e,a=0;a<t.length-1&&(i=t[a],r=t[a+1],e!==i&&e!==r);a++){if(e>i&&e<r){n=i;break}a+1===t.length-1&&(n=r)}return n},n._peek=function(){return this._date().toString()},n._seekHr=function(){this.forward?this.ctime-=36e5:this.ctime+=36e5},n._setStart=function(t){var e=this.market._tzDifferenceMillis(t),i=new Date(t.getTime()+e);this.shift_millis=e,this.ctime=i.getTime(),this.shift_millis=0,this.ctime=t.getTime()},n._tickTock=function(){this.forward?this.ctime+=this.tick_time:this.ctime-=this.tick_time},n._tockTick=function(){this.forward?this.ctime-=this.tick_time:this.ctime+=this.tick_time},n._tickTock24=function(){this.ctime+=864e5},n._tockTick24=function(){this.ctime-=864e5},n._windMaybe=function(t,e){for(var i=0,r=new Date(this.ctime),n=!1;!t.call(this.market,r);)if(e.call(this),n=!0,r=new Date(this.ctime),(i+=1)>this.max_iters){var a="Warning! max iterations ("+this.max_iters;a+=") reached with no rule match.",console.log(a);break}return n},n._millisImpl=function(){var t=!1;if(!this.mperiods_aligned){var e=this._alignBaseZero(1e3),i=new Date(this.ctime),r=i.getMilliseconds();r=this._alignToBoundary(e,r),i.setMilliseconds(0),this.ctime=i.getTime()+r,this.mperiods_aligned=!0,t=!0}var n=this._date().getMinutes();this._tickTock();var a=this._date().getMinutes();if((t||n!=a)&&!this.market._wasOpenIntraDay(this._date())){var s=this.tick_time;this.tick_time=6e4;var o=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=s,this.multiple=o}return this._date()},n._secondImpl=function(){var t=!1;if(!this.speriod_aligned){var e=this._alignBaseZero(60),i=new Date(this.ctime),r=i.getSeconds();r=this._alignToBoundary(e,r),i.setSeconds(r),i.setMilliseconds(0),this.ctime=i.getTime(),this.speriod_aligned=!0,t=!0}var n=this._date().getMinutes();this._tickTock();var a=this._date().getMinutes();if((t||n!=a)&&!this.market._wasOpenIntraDay(this._date())){var s=this.tick_time;this.tick_time=6e4;var o=this.multiple;this.multiple=1,this._minuteImpl(),this.tick_time=s,this.multiple=o}return this._date()},n._minuteImpl=function(){var t=this._windMaybe(this.market._wasOpenIntraDay,this._tockTick),e=new Date(this.ctime),i=e.getTimezoneOffset(),r=e.getMinutes(),n=e.getHours(),a=this._alignMinutes(),s=this._total_minutes(this.market.zopen_hour,this.market.zopen_minute,n,r)+this.market.zopen_minute;s=t?this.forward?a[a.length-1]:a[0]:this._alignToBoundary(a,s),n=Math.floor(s/60)+this.market.zopen_hour,e.setHours(n,s%60,0,0);var o=e.getTimezoneOffset()-i;(this.forward&&o<0||!this.forward&&o>0)&&e.setTime(e.getTime()-6e4*o),this.ctime=e.getTime(),this._tickTock();var l=this.market.zseg_match,h=this.market.hour_aligned&&this.multiple%60==0;if(this._windMaybe(this.market._wasOpenIntraDay,this._tickTock)||!h&&l!=this.market.zseg_match){if(e=new Date(this.ctime),this.forward)e.setMinutes(this.market.zopen_minute),e.setHours(this.market.zopen_hour);else{a=this._alignMinutes();var c=a[a.length-1];e.setMinutes(c%60),e.setHours(Math.floor(c/60)+this.market.zopen_hour)}this.ctime=e.getTime()}return this._date()},n._hourImpl=function(){this._windMaybe(this.market._wasOpenIntraDay,this._tockTick);var t=new Date(this.ctime);this.market.isHourAligned()?t.setMinutes(0):t.setMinutes(this.market.zopen_minute),t.setSeconds(0),t.setMilliseconds(0),this.ctime=t.getTime(),this._tickTock();var e=this.market.zseg_match;if(this._windMaybe(this.market._wasOpenIntraDay,this._tickTock)||!this.market.hour_aligned&&e!=this.market.zseg_match){if(current_date=new Date(this.ctime),this.forward)current_date.setMinutes(this.market.zopen_minute),current_date.setHours(this.market.zopen_hour);else{periods=this._alignMinutes();var i=periods[periods.length-1];current_date.setMinutes(i%60),current_date.setHours(Math.floor(i/60)+this.market.zopen_hour)}this.ctime=current_date.getTime()}return this._date()},n._dayImpl=function(){this._windMaybe(this.market._wasOpenDaily,this._seekHr);var t=new Date(this.ctime);t.setHours(12,0,0,0),this.ctime=t.getTime();for(var e=0;e<this.multiple;)this.forward?this._tickTock24():this._tockTick24(),this.market._wasOpenDaily(this._date())&&(e+=1);return t=new Date(this.ctime),t.setHours(0),this.ctime=t.getTime(),this._date()},n._weekImpl=function(){var t=new Date(this.ctime);for(t.setHours(12),this.ctime=t.getTime(),this._tickTock(),t=new Date(this.ctime);0!==t.getDay();)this._tockTick24(),t=new Date(this.ctime);return this._windMaybe(this.market._wasOpenDaily,this._tickTock24),t=new Date(this.ctime),t.setHours(0,0,0,0),this.ctime=t.getTime(),this._date()},n._monthImpl=function(){var t=new Date(this.ctime);return t.setDate(15),this.ctime=t.getTime(),this._tickTock(),t=new Date(this.ctime),t.setDate(1),t.setHours(12),this.ctime=t.getTime(),this._windMaybe(this.market._wasOpenDaily,this._tickTock24),t=new Date(this.ctime),t.setHours(0,0,0,0),this.ctime=t.getTime(),this._date()},n._findNext=null,n._findPrevious=null,t},__polyfills_=function(){},__timezone_=function(_exports){var CIQ=_exports.CIQ;return CIQ.timeZoneMap={"(UTC-11:00) American Samoa, Midway Island":"Pacific/Pago_Pago","(UTC-10:00) Hawaii":"Pacific/Honolulu","(UTC-09:00) Alaska":"America/Juneau","(UTC-08:00) Pacific Time (US and Canada)":"America/Los_Angeles","(UTC-08:00) Tijuana":"America/Tijuana","(UTC-07:00) Arizona":"America/Phoenix","(UTC-07:00) Chihuahua, Mazatlan":"America/Chihuahua","(UTC-07:00) Mountain Time (US and Canada)":"America/Denver","(UTC-06:00) Central America":"America/Costa_Rica","(UTC-06:00) Central Time (US and Canada)":"America/Chicago","(UTC-06:00) Guadalajara, Mexico City, Monterrey":"America/Mexico_City","(UTC-06:00) Saskatchewan":"America/Regina","(UTC-05:00) Bogota, Lima, Quito, Rio Branco":"America/Bogota","(UTC-05:00) Eastern Time (US and Canada)":"America/New_York","(UTC-05:00) Indiana (East)":"America/Indiana/Indianapolis","(UTC-04:00) Asuncion":"America/Asuncion","(UTC-04:00) Santiago":"America/Santiago","(UTC-04:00) Caracas":"America/Caracas","(UTC-04:00) Atlantic Time (Canada)":"America/Halifax","(UTC-04:00) Georgetown, La Paz, Manaus, San Juan":"America/Puerto_Rico","(UTC-03:30) Newfoundland and Labrador":"America/St_Johns","(UTC-03:00) Buenos Aires":"America/Argentina/Buenos_Aires","(UTC-03:00) Punta Arenas":"America/Punta_Arenas","(UTC-03:00) Montevideo":"America/Montevideo","(UTC-03:00) Sao Paulo":"America/Sao_Paulo","(UTC-02:00) Mid-Atlantic":"Atlantic/South_Georgia","(UTC-01:00) Azores":"Atlantic/Azores","(UTC-01:00) Cape Verde Islands":"Atlantic/Cape_Verde","(UTC) Greenwich Mean Time, Reykjavik":"UTC","(UTC) Casablanca":"Africa/Casablanca","(UTC) Dublin, Lisbon, London":"Europe/London","(UTC+01:00) Algiers, Tunis":"Africa/Tunis","(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna":"Europe/Amsterdam","(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague":"Europe/Belgrade","(UTC+01:00) Brussels, Copenhagen, Madrid, Paris":"Europe/Brussels","(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb":"Europe/Sarajevo","(UTC+02:00) Kaliningrad":"Europe/Kaliningrad","(UTC+02:00) Athens, Bucharest":"Europe/Bucharest","(UTC+02:00) Cairo":"Africa/Cairo","(UTC+02:00) Harare, Johannesburg":"Africa/Johannesburg","(UTC+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius":"Europe/Helsinki","(UTC+02:00) Cyprus":"Asia/Nicosia","(UTC+02:00) Jerusalem":"Asia/Jerusalem","(UTC+03:00) Istanbul":"Europe/Istanbul","(UTC+03:00) Baghdad, Kuwait, Qatar, Riyadh":"Asia/Riyadh","(UTC+03:00) Minsk, Moscow, Kirov, Volgograd":"Europe/Moscow","(UTC+03:00) Simferopol":"Europe/Simferopol","(UTC+03:00) Nairobi":"Africa/Nairobi","(UTC+03:30) Tehran":"Asia/Tehran","(UTC+04:00) Baku":"Asia/Baku","(UTC+04:00) Dubai, Muscat":"Asia/Dubai","(UTC+04:00) Astrakhan, Samara, Saratov, Ulyanovsk":"Europe/Samara","(UTC+04:30) Kabul":"Asia/Kabul","(UTC+05:00) Karachi, Tashkent":"Asia/Karachi","(UTC+05:00) Yekaterinburg":"Asia/Yekaterinburg","(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi":"Asia/Kolkata","(UTC+05:45) Kathmandu":"Asia/Kathmandu","(UTC+06:00) Almaty":"Asia/Almaty","(UTC+06:00) Omsk":"Asia/Omsk","(UTC+06:00) Astana, Dhaka":"Asia/Dhaka","(UTC+06:30) Yangon":"Asia/Yangon","(UTC+07:00) Bangkok, Jakarta, Vietnam":"Asia/Bangkok","(UTC+07:00) Hovd":"Asia/Hovd","(UTC+07:00) Krasnoyarsk":"Asia/Krasnoyarsk","(UTC+07:00) Novokuznetsk":"Asia/Novokuznetsk","(UTC+07:00) Barnaul, Novosibirsk, Tomsk":"Asia/Novosibirsk","(UTC+08:00) Beijing, Chongqing, Hong Kong SAR":"Asia/Hong_Kong","(UTC+08:00) Brunei, Kuala Lumpur, Singapore":"Asia/Kuala_Lumpur","(UTC+08:00) Irkutsk":"Asia/Irkutsk","(UTC+08:00) Choibalsan, Ulaanbaatar":"Asia/Ulaanbaatar","(UTC+08:00) Manila, Taipei":"Asia/Taipei","(UTC+08:00) Perth":"Australia/Perth","(UTC+08:30) Pyongyang":"Asia/Pyongyang","(UTC+08:45) Eucla":"Australia/Eucla","(UTC+09:00) Osaka, Sapporo, Tokyo":"Asia/Tokyo","(UTC+09:00) Seoul":"Asia/Seoul","(UTC+09:00) Chita, Khandyga, Yakutsk":"Asia/Yakutsk","(UTC+09:30) Adelaide":"Australia/Adelaide","(UTC+09:30) Darwin":"Australia/Darwin","(UTC+10:00) Brisbane":"Australia/Brisbane","(UTC+10:00) Canberra, Melbourne, Sydney":"Australia/Sydney","(UTC+10:00) Guam, Port Moresby":"Pacific/Guam","(UTC+10:00) Ust-Nera, Vladivostok":"Asia/Vladivostok","(UTC+11:00) Noumea, Solomon Islands":"Pacific/Noumea","(UTC+11:00) Magadan":"Asia/Magadan","(UTC+11:00) Sakhalin, Srednekolymsk":"Asia/Srednekolymsk","(UTC+12:00) Anadyr, Kamchatka":"Asia/Kamchatka","(UTC+12:00) Auckland, Wellington":"Pacific/Auckland","(UTC+12:45) Chatham":"Pacific/Chatham","(UTC+13:00) Tonga":"Pacific/Tongatapu","(UTC+13:00) Samoa":"Pacific/Apia","(UTC+14:00) Kiritimati":"Pacific/Kiritimati"},function(){"use strict";var root=this,timezoneJS={};_exports.timezoneJS=timezoneJS,timezoneJS.VERSION="0.4.11";for(var ajax_lib=root.$||root.jQuery||root.Zepto,fleegix=root.fleegix,DAYS=timezoneJS.Days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],MONTHS=timezoneJS.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],SHORT_MONTHS={},SHORT_DAYS={},EXACT_DATE_TIME={},i=0;i<MONTHS.length;i++)SHORT_MONTHS[MONTHS[i].substr(0,3)]=i;for(i=0;i<DAYS.length;i++)SHORT_DAYS[DAYS[i].substr(0,3)]=i;var _arrIndexOf=Array.prototype.indexOf||function(t){if(null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var r=0;if(arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:0!==r&&r!==1/0&&r!==-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=i)return-1;for(var n=r>=0?r:Math.max(i-Math.abs(r),0);n<i;n++)if(n in e&&e[n]===t)return n;return-1},_fixWidth=function(t,e){if("number"!=typeof t)throw"not a number: "+t;var i=t>1e3,r=t.toString(),n=r.length;if(i&&n>e)return r.substr(n-e,n);for(r=[r];n<e;)r.unshift("0"),n++;return r.join("")},_transport=function(t){if(t){if(!t.url)throw new Error("URL must be specified");if("async"in t||(t.async=!0),!(fleegix&&void 0!==fleegix.xhr||ajax_lib&&void 0!==ajax_lib.ajax))throw new Error("Please use the Fleegix.js XHR module, jQuery ajax, Zepto ajax, or define your own transport mechanism for downloading zone files.");return t.async?fleegix&&fleegix.xhr?fleegix.xhr.send({url:t.url,method:"get",handleSuccess:t.success,handleErr:t.error}):ajax_lib.ajax({url:t.url,dataType:"text",method:"GET",error:t.error,success:t.success}):fleegix&&fleegix.xhr?fleegix.xhr.doReq({url:t.url,async:!1}):ajax_lib.ajax({url:t.url,async:!1,dataType:"text"}).responseText}};timezoneJS.ruleCache={},timezoneJS.Date=function(){if(this===timezoneJS)throw"timezoneJS.Date object must be constructed with 'new'";var t=Array.prototype.slice.apply(arguments),e=null,i=null,r=[],n=!1;"[object Array]"===Object.prototype.toString.call(t[0])&&(t=t[0]),"string"==typeof t[t.length-1]&&(n=Date.parse(t[t.length-1].replace(/GMT[+-]\d+/,"")),(isNaN(n)||null===n)&&(i=t.pop()));var a=!1;switch(t.length){case 0:e=new Date;break;case 1:e=new Date(t[0]),"string"==typeof t[0]&&-1==t[0].search(/[+-][0-9]{4}/)&&-1==t[0].search(/Z/)&&-1==t[0].search(/T/)&&(a=!0);break;case 2:e=new Date(t[0],t[1]),a=!0;break;default:for(var s=0;s<7;s++)r[s]=t[s]||0;e=new Date(r[0],r[1],r[2],r[3],r[4],r[5],r[6]),a=!0}if(isNaN(e.getTime()))throw new Error("Invalid date");this._useCache=!1,this._tzInfo={},this._day=0,this.year=0,this.month=0,this.date=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0,this.timezone=i||null,a?this.setFromDateObjProxy(e):this.setFromTimeProxy(e.getTime(),i)},timezoneJS.Date.prototype={getDate:function(){return this.date},getDay:function(){return this._day},getFullYear:function(){return this.year},getMonth:function(){return this.month},getYear:function(){return this.year-1900},getHours:function(){return this.hours},getMilliseconds:function(){return this.milliseconds},getMinutes:function(){return this.minutes},getSeconds:function(){return this.seconds},getUTCDate:function(){return this.getUTCDateProxy().getUTCDate()},getUTCDay:function(){return this.getUTCDateProxy().getUTCDay()},getUTCFullYear:function(){return this.getUTCDateProxy().getUTCFullYear()},getUTCHours:function(){return this.getUTCDateProxy().getUTCHours()},getUTCMilliseconds:function(){return this.getUTCDateProxy().getUTCMilliseconds()},getUTCMinutes:function(){return this.getUTCDateProxy().getUTCMinutes()},getUTCMonth:function(){return this.getUTCDateProxy().getUTCMonth()},getUTCSeconds:function(){return this.getUTCDateProxy().getUTCSeconds()},getTime:function(){return this._timeProxy+60*this.getTimezoneOffset()*1e3},getTimezone:function(){return this.timezone},getTimezoneOffset:function(){return this.getTimezoneInfo().tzOffset},getTimezoneAbbreviation:function(){return this.getTimezoneInfo().tzAbbr},getTimezoneInfo:function(){if(this._useCache)return this._tzInfo;var t;return t=this.timezone?"Etc/UTC"===this.timezone||"Etc/GMT"===this.timezone?{tzOffset:0,tzAbbr:"UTC"}:timezoneJS.timezone.getTzInfo(this._timeProxy,this.timezone):{tzOffset:this.getLocalOffset(),tzAbbr:null},this._tzInfo=t,this._useCache=!0,t},getUTCDateProxy:function(){var t=new Date(this._timeProxy);return t.setUTCMinutes(t.getUTCMinutes()+this.getTimezoneOffset()),t},setDate:function(t){return this.setAttribute("date",t),this.getTime()},setFullYear:function(t,e,i){return void 0!==i&&this.setAttribute("date",1),this.setAttribute("year",t),void 0!==e&&this.setAttribute("month",e),void 0!==i&&this.setAttribute("date",i),this.getTime()},setMonth:function(t,e){return this.setAttribute("month",t),void 0!==e&&this.setAttribute("date",e),this.getTime()},setYear:function(t){return t=Number(t),0<=t&&t<=99&&(t+=1900),this.setUTCAttribute("year",t),this.getTime()},setHours:function(t,e,i,r){return this.setAttribute("hours",t),void 0!==e&&this.setAttribute("minutes",e),void 0!==i&&this.setAttribute("seconds",i),void 0!==r&&this.setAttribute("milliseconds",r),this.getTime()},setMinutes:function(t,e,i){return this.setAttribute("minutes",t),void 0!==e&&this.setAttribute("seconds",e),void 0!==i&&this.setAttribute("milliseconds",i),this.getTime()},setSeconds:function(t,e){return this.setAttribute("seconds",t),void 0!==e&&this.setAttribute("milliseconds",e),this.getTime()},setMilliseconds:function(t){return this.setAttribute("milliseconds",t),this.getTime()},setTime:function(t){if(isNaN(t))throw new Error("Units must be a number.");return this.setFromTimeProxy(t,this.timezone),this.getTime()},setUTCFullYear:function(t,e,i){return void 0!==i&&this.setUTCAttribute("date",1),this.setUTCAttribute("year",t),void 0!==e&&this.setUTCAttribute("month",e),void 0!==i&&this.setUTCAttribute("date",i),this.getTime()},setUTCMonth:function(t,e){return this.setUTCAttribute("month",t),void 0!==e&&this.setUTCAttribute("date",e),this.getTime()},setUTCDate:function(t){return this.setUTCAttribute("date",t),this.getTime()},setUTCHours:function(t,e,i,r){return this.setUTCAttribute("hours",t),void 0!==e&&this.setUTCAttribute("minutes",e),void 0!==i&&this.setUTCAttribute("seconds",i),void 0!==r&&this.setUTCAttribute("milliseconds",r),this.getTime()},setUTCMinutes:function(t,e,i){return this.setUTCAttribute("minutes",t),void 0!==e&&this.setUTCAttribute("seconds",e),void 0!==i&&this.setUTCAttribute("milliseconds",i),this.getTime()},setUTCSeconds:function(t,e){return this.setUTCAttribute("seconds",t),void 0!==e&&this.setUTCAttribute("milliseconds",e),this.getTime()},setUTCMilliseconds:function(t){return this.setUTCAttribute("milliseconds",t),this.getTime()},setFromDateObjProxy:function(t){this.year=t.getFullYear(),this.month=t.getMonth(),this.date=t.getDate(),this.hours=t.getHours(),this.minutes=t.getMinutes(),this.seconds=t.getSeconds(),this.milliseconds=t.getMilliseconds(),this._day=t.getDay(),this._dateProxy=t,this._timeProxy=Date.UTC(this.year,this.month,this.date,this.hours,this.minutes,this.seconds,this.milliseconds),this._useCache=!1},setFromTimeProxy:function(t,e){var i=new Date(t),r=e?timezoneJS.timezone.getTzInfo(t,e,!0).tzOffset:i.getTimezoneOffset();i.setTime(t+6e4*(i.getTimezoneOffset()-r)),this.setFromDateObjProxy(i)},setAttribute:function(t,e){if(isNaN(e))throw new Error("Units must be a number.");var i=this._dateProxy;i["set"+("year"===t?"FullYear":t.substr(0,1).toUpperCase()+t.substr(1))](e),this.setFromDateObjProxy(i)},setUTCAttribute:function(t,e){if(isNaN(e))throw new Error("Units must be a number.");var i="year"===t?"FullYear":t.substr(0,1).toUpperCase()+t.substr(1),r=this.getUTCDateProxy();r["setUTC"+i](e),r.setUTCMinutes(r.getUTCMinutes()-this.getTimezoneOffset()),this.setFromTimeProxy(r.getTime()+6e4*this.getTimezoneOffset(),this.timezone)},setTimezone:function(t){var e=this.getTimezoneInfo().tzOffset;this.timezone=t,this._useCache=!1,this.setUTCMinutes(this.getUTCMinutes()-this.getTimezoneInfo().tzOffset+e)},removeTimezone:function(){this.timezone=null,this._useCache=!1},valueOf:function(){return this.getTime()},clone:function(){return this.timezone?new timezoneJS.Date(this.getTime(),this.timezone):new timezoneJS.Date(this.getTime())},toGMTString:function(){return this.toString("EEE, dd MMM yyyy HH:mm:ss Z","Etc/GMT")},toLocaleStringIntl:function(){},toLocaleDateString:function(){},toLocaleTimeString:function(){},toSource:function(){},toISOString:function(){return this.toString("yyyy-MM-ddTHH:mm:ss.SSS","Etc/UTC")+"Z"},toJSON:function(){return this.toISOString()},toDateString:function(){return this.toString("EEE MMM dd yyyy")},toTimeString:function(){return this.toString("H:mm k")},toString:function(t,e){t||(t="yyyy-MM-ddTHH:mm:ss.SSS");var i=t,r=e?timezoneJS.timezone.getTzInfo(this.getTime(),e):this.getTimezoneInfo(),n=this;e&&(n=this.clone(),n.setTimezone(e));var a=n.getHours();return i.replace(/a+/g,function(){return"k"}).replace(/y+/g,function(t){return _fixWidth(n.getFullYear(),t.length)}).replace(/d+/g,function(t){return _fixWidth(n.getDate(),t.length)}).replace(/m+/g,function(t){return _fixWidth(n.getMinutes(),t.length)}).replace(/s+/g,function(t){return _fixWidth(n.getSeconds(),t.length)}).replace(/S+/g,function(t){return _fixWidth(n.getMilliseconds(),t.length)}).replace(/h+/g,function(t){return _fixWidth(a%12==0?12:a%12,t.length)}).replace(/M+/g,function(t){var e=n.getMonth(),i=t.length;return i>3?timezoneJS.Months[e]:i>2?timezoneJS.Months[e].substring(0,i):_fixWidth(e+1,i)}).replace(/k+/g,function(){return a>=12?(a>12&&(a-=12),"PM"):"AM"}).replace(/H+/g,function(t){return _fixWidth(a,t.length)}).replace(/E+/g,function(t){return DAYS[n.getDay()].substring(0,t.length)}).replace(/Z+/gi,function(){return r.tzAbbr})},toUTCString:function(){return this.toGMTString()},civilToJulianDayNumber:function(t,e,i){var r;e++,e>12&&(r=parseInt(e/12,10),e%=12,t+=r),e<=2&&(t-=1,e+=12),r=Math.floor(t/100);var n=2-r+Math.floor(r/4);return Math.floor(365.25*(t+4716))+Math.floor(30.6001*(e+1))+i+n-1524},getLocalOffset:function(){return this._dateProxy.getTimezoneOffset()}},timezoneJS.timezone=new function(){function invalidTZError(t){throw new Error("Timezone '"+t+"' is either incorrect, or not loaded in the timezone registry.")}function builtInLoadZoneFile(t,e){var i=_this.zoneFileBasePath+"/"+t;return e&&e.async?_this.transport({async:!0,url:i,success:function(t){return _this.parseZones(t)&&"function"==typeof e.callback&&e.callback()},error:function(){throw new Error("Error retrieving '"+i+"' zoneinfo files")}}):_this.parseZones(_this.transport({url:i,async:!1}))}function getRegionForTimezone(t){var e,i,r=regionExceptions[t];if(r)return r;if(e=t.split("/")[0],i=regionMap[e])return i;var n=_this.zones[t];return"string"==typeof n?getRegionForTimezone(n):_this.loadedZones.backward?void invalidTZError(t):(_this.loadZoneFile("backward"),getRegionForTimezone(t))}function parseTimeString(t){var e=/(\d+)(?::0*(\d*))?(?::0*(\d*))?([wsugz])?$/,i=t.match(e);return i[1]=parseInt(i[1],10),i[2]=i[2]?parseInt(i[2],10):0,i[3]=i[3]?parseInt(i[3],10):0,i.slice(1,5)}function processZone(t){if(t[3]){var e=parseInt(t[3],10),i=11,r=31;t[4]&&(i=SHORT_MONTHS[t[4].substr(0,3)],r=parseInt(t[5],10)||1);var n=t[6]?parseTimeString(t[6]):[0,0,0];return[e,i,r,n[0],n[1],n[2]]}}function getZone(t,e){for(var i="number"==typeof t?t:new Date(+t).getTime(),r=e,n=_this.zones[r];"string"==typeof n;)r=n,n=_this.zones[r];if(!n){if(!_this.loadedZones.backward)return _this.loadZoneFile("backward"),getZone(t,e);if(r&&r!==e)return _this.lazyLoadZoneFiles(r),getZone(t,r);invalidTZError(r)}if(0===n.length)throw new Error("No Zone found for '"+e+"' on "+t);for(var a=n.length-1;a>=0;a--){var s=n[a];if(s[3]&&i>s[3])break}return n[a+1]}function getBasicOffset(t){var e=parseTimeString(t);return(e=("-"===t.charAt(0)?-1:1)*(1e3*(60*(60*e[0]+e[1])+e[2])))/60/1e3}function getAdjustedOffset(t,e){return-Math.ceil(e-t)}function getRule(t,e,i,r){var n="number"==typeof t?new Date(t):t,a=e[1],s=e[0],o=a.match(/^([0-9]):([0-9][0-9])$/);if(o)return[-1e6,"max","-","Jan",1,[0,0,0],60*parseInt(o[1],10)+parseInt(o[2],10),"-"];var l,h=function(t,e,i){var r=0;if("u"===e||"g"===e||"z"===e)r=0;else if("s"===e)r=s;else{if("w"!==e&&e)throw new Error("unknown type "+e);r=getAdjustedOffset(s,i[6])}return r*=6e4,new Date(t.getTime()+r)},c=function(t,e){var i,r=t[0],n=t[1],a=n[5];if(EXACT_DATE_TIME[r]||(EXACT_DATE_TIME[r]={}),EXACT_DATE_TIME[r][n])i=EXACT_DATE_TIME[r][n];else{if(isNaN(n[4])){var s,o;"last"===n[4].substr(0,4)?(i=new Date(Date.UTC(r,SHORT_MONTHS[n[3]]+1,1,a[0]-24,a[1],a[2],0)),s=SHORT_DAYS[n[4].substr(4,3)],o="<="):(i=new Date(Date.UTC(r,SHORT_MONTHS[n[3]],n[4].substr(5),a[0],a[1],a[2],0)),s=SHORT_DAYS[n[4].substr(0,3)],o=n[4].substr(3,2));var l=i.getUTCDay();">="===o?i.setUTCDate(i.getUTCDate()+(s-l+(s<l?7:0))):i.setUTCDate(i.getUTCDate()+(s-l-(s>l?7:0)))}else i=new Date(Date.UTC(r,SHORT_MONTHS[n[3]],n[4],a[0],a[1],a[2],0));EXACT_DATE_TIME[r][n]=i}return e&&(i=h(i,a[3],e)),i},u=function(t,e){for(var i=[],r=0;e&&r<e.length;r++)e[r][0]<=t&&(e[r][1]>=t||e[r][0]===t&&"only"===e[r][1]||"max"===e[r][1])&&i.push([t,e[r]]);return i},d=function(t,e,r){var n,a;return t instanceof Date?r&&(t=h(t,i?"u":"w",r)):(n=t[0],a=t[1],t=!r&&EXACT_DATE_TIME[n]&&EXACT_DATE_TIME[n][a]?EXACT_DATE_TIME[n][a]:c(t,r)),e instanceof Date?r&&(e=h(e,i?"u":"w",r)):(n=e[0],a=e[1],e=!r&&EXACT_DATE_TIME[n]&&EXACT_DATE_TIME[n][a]?EXACT_DATE_TIME[n][a]:c(e,r)),t=Number(t),e=Number(e),t-e},p=n.getUTCFullYear(),f=timezoneJS.ruleCache[r];if(f||(f=timezoneJS.ruleCache[r]={}),l=f[p],l||(l=u(p-1,_this.rules[a]),l=l.concat(u(p,_this.rules[a])),l.sort(d),f[p]=l),!l||!l.length)return null;for(var m,g=l.length-1;g>=0;g--){m=g>0?l[g-1][1]:null;var v=l[g];if(v[2]||(v[2]=c(v,m)),d(n,v,m)>=0)return v[1]}return null}function getAbbreviation(t,e){var i=t[2];if(i.indexOf("%s")>-1){var r;return r=e?"-"===e[7]?"":e[7]:"S",i.replace("%s",r)}return i.indexOf("/")>-1?i.split("/",2)[e&&e[6]?1:0]:i}var _this=this,regionMap={Etc:"etcetera",EST:"northamerica",MST:"northamerica",HST:"northamerica",EST5EDT:"northamerica",CST6CDT:"northamerica",MST7MDT:"northamerica",PST8PDT:"northamerica",America:["northamerica","southamerica"],Pacific:"australasia",Atlantic:"europe",Africa:"africa",Indian:"africa",Antarctica:"antarctica",Asia:"asia",Australia:"australasia",Europe:"europe",WET:"europe",CET:"europe",MET:"europe",EET:"europe"},regionExceptions={"Pacific/Honolulu":"northamerica","Atlantic/Bermuda":"northamerica","Atlantic/Cape_Verde":"africa","Atlantic/St_Helena":"africa","Indian/Kerguelen":"antarctica","Indian/Chagos":"asia","Indian/Maldives":"asia","Indian/Christmas":"australasia","Indian/Cocos":"australasia","America/Danmarkshavn":"europe","America/Scoresbysund":"europe","America/Godthab":"europe","America/Thule":"europe","Asia/Istanbul":"europe","Asia/Yekaterinburg":"europe","Asia/Omsk":"europe","Asia/Novosibirsk":"europe","Asia/Krasnoyarsk":"europe","Asia/Irkutsk":"europe","Asia/Yakutsk":"europe","Asia/Vladivostok":"europe","Asia/Sakhalin":"europe","Asia/Magadan":"europe","Asia/Kamchatka":"europe","Asia/Anadyr":"europe","Africa/Ceuta":"europe",GMT:"etcetera","Europe/Nicosia":"asia"};this.zoneFileBasePath=null,this.zoneFiles=["africa","antarctica","asia","australasia","backward","etcetera","europe","northamerica","pacificnew","southamerica"],this.loadingSchemes={PRELOAD_ALL:"preloadAll",LAZY_LOAD:"lazyLoad",MANUAL_LOAD:"manualLoad"},this.getRegionForTimezone=getRegionForTimezone,this.loadingScheme=this.loadingSchemes.LAZY_LOAD,this.loadedZones={},this.zones={},this.rules={},this.init=function(t){var e={async:!0},i=this.loadingScheme===this.loadingSchemes.PRELOAD_ALL?this.zoneFiles:this.defaultZoneFile||"northamerica";for(var r in t)e[r]=t[r];return this.loadZoneFiles(i,e)},this.loadZoneFiles=function(t,e){var i,r=0;if("string"==typeof t)return this.loadZoneFile(t,e);e=e||{},i=e.callback,e.callback=function(){++r===t.length&&"function"==typeof i&&i()};for(var n=0;n<t.length;n++)this.loadZoneFile(t[n],e)},this.loadZoneFile=function(t,e){if(void 0===this.zoneFileBasePath)throw new Error("Please define a base path to your zone file directory -- timezoneJS.timezone.zoneFileBasePath.");if(!this.loadedZones[t])return this.loadedZones[t]=!0,builtInLoadZoneFile(t,e)},this.loadZoneJSONData=function(url,sync){var processData=function(data){data=eval("("+data+")");for(var z in data.zones)_this.zones[z]=data.zones[z];for(var r in data.rules)_this.rules[r]=data.rules[r]};return sync?processData(_this.transport({url:url,async:!1})):_this.transport({url:url,success:processData})},this.loadZoneDataFromObject=function(t){if(t){for(var e in t.zones)_this.zones[e]=t.zones[e];for(var i in t.rules)_this.rules[i]=t.rules[i]}},this.getAllZones=function(){var t=[];for(var e in this.zones)t.push(e);return t.sort()},this.parseZones=function(t){if(!t)return!1;for(var e,i=t.split("\n"),r=[],n=null,a=null,s=0;s<i.length;s++)if(e=i[s],e.match(/^\s/)&&(e="Zone "+n+e),e=e.split("#")[0],e.length>3)switch(r=e.split(/\s+/),r.shift()){case"Zone":if(n=r.shift(),_this.zones[n]||(_this.zones[n]=[]),r.length<3)break;r.splice(3,r.length,processZone(r)),r[3]&&(r[3]=Date.UTC.apply(null,r[3])),r[0]=-getBasicOffset(r[0]),_this.zones[n].push(r);break;case"Rule":a=r.shift(),_this.rules[a]||(_this.rules[a]=[]),r[0]=parseInt(r[0],10),r[1]=parseInt(r[1],10)||r[1],r[5]=parseTimeString(r[5]),r[6]=getBasicOffset(r[6]),_this.rules[a].push(r);break;case"Link":if(_this.zones[r[1]])throw new Error("Error with Link "+r[1]+". Cannot create link of a preexisted zone.");isNaN(r[0])?_this.zones[r[1]]=r[0]:_this.zones[r[1]]=parseInt(r[0],10)}return!0},this.transport=_transport,this.getTzInfo=function(t,e,i){this.lazyLoadZoneFiles(e);var r=getZone(t,e),n=+r[0],a=getRule(t,r,i,e);return a&&(n=getAdjustedOffset(n,a[6])),{tzOffset:n,tzAbbr:getAbbreviation(r,a)}},this.lazyLoadZoneFiles=function(t){if(this.loadingScheme===this.loadingSchemes.LAZY_LOAD){var e=getRegionForTimezone(t);if(!e)throw new Error("Not a valid timezone ID.");this.loadZoneFiles(e)}}}}.call("undefined"!=typeof window?window:this),_exports.timezoneJS.timezone.loadingScheme=_exports.timezoneJS.timezone.loadingSchemes.MANUAL_LOAD,_exports.timezoneJS.timezone.loadZoneDataFromObject({zones:{"Atlantic/Cape_Verde":[[60,"-","-01",null]],"Africa/Cairo":[[-120,"Egypt","EE%sT",null]],"Africa/Nairobi":[[-180,"-","EAT",null]],"Africa/Casablanca":[[0,"Morocco","WE%sT",null]],"Africa/Johannesburg":[[-120,"SA","SAST",null]],"Africa/Tunis":[[-60,"Tunisia","CE%sT",null]],"Asia/Kabul":[[-270,"-","+0430",null]],"Asia/Baku":[[-240,"Azer","+04/+05",null]],"Asia/Dhaka":[[-360,"Dhaka","+06/+07",null]],"Asia/Yangon":[[-390,"-","+0630",null]],"Asia/Shanghai":[[-480,"PRC","C%sT",null]],"Asia/Hong_Kong":[[-480,"HK","HK%sT",null]],"Asia/Taipei":[[-480,"Taiwan","C%sT",null]],"Asia/Nicosia":[[-120,"EUAsia","EE%sT",null]],"Asia/Kolkata":[[-330,"-","IST",null]],"Asia/Tehran":[[-210,"Iran","+0330/+0430",null]],"Asia/Jerusalem":[[-120,"Zion","I%sT",null]],"Asia/Tokyo":[[-540,"Japan","J%sT",null]],"Asia/Almaty":[[-360,"-","ALMT",null]],"Asia/Seoul":[[-540,"ROK","K%sT",null]],"Asia/Pyongyang":[[-540,"-","KST",14395968e5],[-510,"-","KST",null]],"Asia/Kuala_Lumpur":[[-480,"-","+08",null]],"Asia/Hovd":[[-420,"Mongol","+07/+08",null]],"Asia/Ulaanbaatar":[[-480,"Mongol","+08/+09",null]],"Asia/Kathmandu":[[-345,"-","+0545",null]],"Asia/Karachi":[[-300,"Pakistan","PK%sT",null]],"Asia/Riyadh":[[-180,"-","+03",null]],"Asia/Bangkok":[[-420,"-","+07",null]],"Asia/Dubai":[[-240,"-","+04",null]],"Australia/Darwin":[[-570,"Aus","CST",null]],"Australia/Perth":[[-480,"AW","WST",null]],"Australia/Eucla":[[-525,"AW","+0845/+0945",null]],"Australia/Brisbane":[[-600,"AQ","EST",null]],"Australia/Adelaide":[[-570,"AS","CST",null]],"Australia/Sydney":[[-600,"AN","EST",null]],"Pacific/Guam":[[-600,"-","ChST",null]],
"Pacific/Kiritimati":[[-840,"-","+14",null]],"Pacific/Noumea":[[-660,"NC","+11/+12",null]],"Pacific/Auckland":[[-720,"NZ","NZ%sT",null]],"Pacific/Chatham":[[-765,"Chatham","+1245/+1345",null]],"Pacific/Pago_Pago":[[660,"-","SST",null]],"Pacific/Apia":[[-780,"WS","+13/+14",null]],"Pacific/Tongatapu":[[-780,"Tonga","+13/+14",null]],"Etc/UTC":[[0,"-","UTC",null]],UTC:"Etc/UTC","Europe/London":[[0,"EU","GMT/BST",null]],WET:[[0,"EU","WE%sT",null]],CET:[[-60,"C-Eur","CE%sT",null]],MET:[[-60,"C-Eur","ME%sT",null]],EET:[[-120,"EU","EE%sT",null]],"Europe/Brussels":[[-60,"EU","CE%sT",null]],"Europe/Helsinki":[[-120,"EU","EE%sT",null]],"Europe/Paris":[[-60,"EU","CE%sT",null]],"Europe/Berlin":[[-60,"EU","CE%sT",null]],"Europe/Amsterdam":[[-60,"EU","CE%sT",null]],"Atlantic/Azores":[[60,"EU","AZO%sT",null]],"Europe/Bucharest":[[-120,"EU","EE%sT",null]],"Europe/Kaliningrad":[[-180,"-","+03",14142888e5],[-120,"-","EET",null]],"Europe/Moscow":[[-240,"-","MSK",14142888e5],[-180,"-","MSK",null]],"Europe/Simferopol":[[-120,"EU","EE%sT",13961448e5],[-240,"-","MSK",14142888e5],[-180,"-","MSK",null]],"Europe/Samara":[[-240,"-","+04",null]],"Asia/Yekaterinburg":[[-360,"-","+06",14142888e5],[-300,"-","+05",null]],"Asia/Omsk":[[-420,"-","+07",14142888e5],[-360,"-","+06",null]],"Asia/Novosibirsk":[[-420,"-","+07",14142888e5],[-360,"-","+06",14693256e5],[-420,"-","+07",null]],"Asia/Novokuznetsk":[[-420,"-","+07",null]],"Asia/Krasnoyarsk":[[-480,"-","+08",14142888e5],[-420,"-","+07",null]],"Asia/Irkutsk":[[-540,"-","+09",14142888e5],[-480,"-","+08",null]],"Asia/Yakutsk":[[-600,"-","+10",14142888e5],[-540,"-","+09",null]],"Asia/Vladivostok":[[-660,"-","+11",14142888e5],[-600,"-","+10",null]],"Asia/Magadan":[[-720,"-","+12",14142888e5],[-600,"-","+10",14614632e5],[-660,"-","+11",null]],"Asia/Srednekolymsk":[[-720,"-","+12",14142888e5],[-660,"-","+11",null]],"Asia/Kamchatka":[[-720,"-","+12",null]],"Europe/Belgrade":[[-60,"EU","CE%sT",null]],"Europe/Sarajevo":"Europe/Belgrade","Europe/Istanbul":[[-120,"EU","EE%sT",13961412e5],[-120,"-","EET",13962276e5],[-120,"EU","EE%sT",14457348e5],[-120,"1:00","EEST",14469444e5],[-120,"EU","EE%sT",14732064e5],[-180,"-","+03",null]],"America/New_York":[[300,"US","E%sT",null]],"America/Chicago":[[360,"US","C%sT",null]],"America/Denver":[[420,"US","M%sT",null]],"America/Los_Angeles":[[480,"US","P%sT",null]],"America/Juneau":[[540,"US","AK%sT",null]],"Pacific/Honolulu":[[600,"-","HST",null]],"America/Phoenix":[[420,"-","MST",null]],"America/Indiana/Indianapolis":[[300,"US","E%sT",null]],"America/St_Johns":[[210,"Canada","N%sT",null]],"America/Halifax":[[240,"Canada","A%sT",null]],"America/Regina":[[360,"-","CST",null]],"America/Mexico_City":[[360,"Mexico","C%sT",null]],"America/Chihuahua":[[420,"Mexico","M%sT",null]],"America/Tijuana":[[480,"US","P%sT",null]],"America/Costa_Rica":[[360,"CR","C%sT",null]],"America/Puerto_Rico":[[240,"-","AST",null]],"America/Argentina/Buenos_Aires":[[180,"Arg","-03/-02",null]],"America/Sao_Paulo":[[180,"Brazil","-03/-02",null]],"America/Santiago":[[240,"Chile","-04/-03",null]],"America/Punta_Arenas":[[240,"Chile","-04/-03",14808096e5],[180,"-","-03",null]],"America/Bogota":[[300,"CO","-05/-04",null]],"America/Asuncion":[[240,"Para","-04/-03",null]],"Atlantic/South_Georgia":[[120,"-","-02",null]],"America/Montevideo":[[180,"Uruguay","-03/-02",null]],"America/Caracas":[[270,"-","-0430",14620698e5],[240,"-","-04",null]],"Europe/Athens":"Europe/Bucharest","Asia/Rangoon":"Asia/Yangon","Atlantic/Reykjavik":"UTC","Asia/Kuwait":"Asia/Riyadh","Asia/Muscat":"Asia/Riyadh","Asia/Istanbul":"Europe/Istanbul","Pacific/Midway":"Pacific/Pago_Pago"},rules:{Egypt:[[2014,"only","-","May","16",[0,0,0,null],60,"S"],[2014,"only","-","Jun","27",[0,0,0,null],0,"-"],[2014,"only","-","Aug","1",[0,0,0,null],60,"S"],[2014,"only","-","Sep","lastThu",[23,0,0,"s"],0,"-"]],Morocco:[[2012,2013,"-","Apr","lastSun",[2,0,0,null],60,"S"],[2012,"only","-","Jul","20",[3,0,0,null],0,"-"],[2012,"only","-","Aug","20",[2,0,0,null],60,"S"],[2012,"only","-","Sep","30",[3,0,0,null],0,"-"],[2013,"only","-","Jul","7",[3,0,0,null],0,"-"],[2013,"only","-","Aug","10",[2,0,0,null],60,"S"],[2013,"max","-","Oct","lastSun",[3,0,0,null],0,"-"],[2014,2021,"-","Mar","lastSun",[2,0,0,null],60,"S"],[2014,"only","-","Jun","28",[3,0,0,null],0,"-"],[2014,"only","-","Aug","2",[2,0,0,null],60,"S"],[2015,"only","-","Jun","14",[3,0,0,null],0,"-"],[2015,"only","-","Jul","19",[2,0,0,null],60,"S"],[2016,"only","-","Jun","5",[3,0,0,null],0,"-"],[2016,"only","-","Jul","10",[2,0,0,null],60,"S"],[2017,"only","-","May","21",[3,0,0,null],0,"-"],[2017,"only","-","Jul","2",[2,0,0,null],60,"S"],[2018,"only","-","May","13",[3,0,0,null],0,"-"],[2018,"only","-","Jun","17",[2,0,0,null],60,"S"],[2019,"only","-","May","5",[3,0,0,null],0,"-"],[2019,"only","-","Jun","9",[2,0,0,null],60,"S"],[2020,"only","-","Apr","19",[3,0,0,null],0,"-"],[2020,"only","-","May","24",[2,0,0,null],60,"S"],[2021,"only","-","Apr","11",[3,0,0,null],0,"-"],[2021,"only","-","May","16",[2,0,0,null],60,"S"],[2022,"only","-","May","8",[2,0,0,null],60,"S"]],SA:[],Tunisia:[],EUAsia:[[1981,"max","-","Mar","lastSun",[1,0,0,"u"],60,"S"],[1996,"max","-","Oct","lastSun",[1,0,0,"u"],0,"-"]],Azer:[[1997,2015,"-","Mar","lastSun",[4,0,0,null],60,"S"],[1997,2015,"-","Oct","lastSun",[5,0,0,null],0,"-"]],Dhaka:[],PRC:[],HK:[],Taiwan:[],Iran:[[2012,"only","-","Mar","21",[0,0,0,null],60,"D"],[2012,"only","-","Sep","21",[0,0,0,null],0,"S"],[2013,2015,"-","Mar","22",[0,0,0,null],60,"D"],[2013,2015,"-","Sep","22",[0,0,0,null],0,"S"],[2016,"only","-","Mar","21",[0,0,0,null],60,"D"],[2016,"only","-","Sep","21",[0,0,0,null],0,"S"],[2017,2019,"-","Mar","22",[0,0,0,null],60,"D"],[2017,2019,"-","Sep","22",[0,0,0,null],0,"S"],[2020,"only","-","Mar","21",[0,0,0,null],60,"D"],[2020,"only","-","Sep","21",[0,0,0,null],0,"S"],[2021,2023,"-","Mar","22",[0,0,0,null],60,"D"],[2021,2023,"-","Sep","22",[0,0,0,null],0,"S"]],Zion:[[2012,"only","-","Mar","Fri>=26",[2,0,0,null],60,"D"],[2012,"only","-","Sep","23",[2,0,0,null],0,"S"],[2013,"max","-","Mar","Fri>=23",[2,0,0,null],60,"D"],[2013,"max","-","Oct","lastSun",[2,0,0,null],0,"S"]],Japan:[],ROK:[],Mongol:[[2015,2016,"-","Mar","lastSat",[2,0,0,null],60,"S"],[2015,2016,"-","Sep","lastSat",[0,0,0,null],0,"-"]],Pakistan:[],Aus:[],AW:[],AQ:[],AS:[[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"-"],[2008,"max","-","Oct","Sun>=1",[2,0,0,"s"],60,"-"]],AN:[[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"-"],[2008,"max","-","Oct","Sun>=1",[2,0,0,"s"],60,"-"]],NC:[],NZ:[[2007,"max","-","Sep","lastSun",[2,0,0,"s"],60,"D"],[2008,"max","-","Apr","Sun>=1",[2,0,0,"s"],0,"S"]],Chatham:[[2007,"max","-","Sep","lastSun",[2,45,0,"s"],60,"D"],[2008,"max","-","Apr","Sun>=1",[2,45,0,"s"],0,"S"]],WS:[[2012,"max","-","Apr","Sun>=1",[4,0,0,null],0,"-"],[2012,"max","-","Sep","lastSun",[3,0,0,null],60,"D"]],Tonga:[[2016,"only","-","Nov","Sun>=1",[2,0,0,null],60,"S"],[2017,"only","-","Jan","Sun>=15",[3,0,0,null],0,"S"]],EU:[[1981,"max","-","Mar","lastSun",[1,0,0,"u"],60,"S"],[1996,"max","-","Oct","lastSun",[1,0,0,"u"],0,"-"]],"C-Eur":[[1981,"max","-","Mar","lastSun",[2,0,0,"s"],60,"S"],[1996,"max","-","Oct","lastSun",[2,0,0,"s"],0,"-"]],US:[[2007,"max","-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2007,"max","-","Nov","Sun>=1",[2,0,0,null],0,"S"]],Canada:[[2007,"max","-","Mar","Sun>=8",[2,0,0,null],60,"D"],[2007,"max","-","Nov","Sun>=1",[2,0,0,null],0,"S"]],Mexico:[[2002,"max","-","Apr","Sun>=1",[2,0,0,null],60,"D"],[2002,"max","-","Oct","lastSun",[2,0,0,null],0,"S"]],CR:[],Arg:[],Brazil:[[2008,"max","-","Oct","Sun>=15",[0,0,0,null],60,"S"],[2012,"only","-","Feb","Sun>=22",[0,0,0,null],0,"-"],[2013,2014,"-","Feb","Sun>=15",[0,0,0,null],0,"-"],[2015,"only","-","Feb","Sun>=22",[0,0,0,null],0,"-"],[2016,2022,"-","Feb","Sun>=15",[0,0,0,null],0,"-"]],Chile:[[2012,2014,"-","Apr","Sun>=23",[3,0,0,"u"],0,"-"],[2012,2014,"-","Sep","Sun>=2",[4,0,0,"u"],60,"S"],[2016,"max","-","May","Sun>=9",[3,0,0,"u"],0,"-"],[2016,"max","-","Aug","Sun>=9",[4,0,0,"u"],60,"S"]],CO:[],Para:[[2010,"max","-","Oct","Sun>=1",[0,0,0,null],60,"S"],[2010,2012,"-","Apr","Sun>=8",[0,0,0,null],0,"-"],[2013,"max","-","Mar","Sun>=22",[0,0,0,null],0,"-"]],Uruguay:[[2006,"max","-","Oct","Sun>=1",[2,0,0,null],60,"S"],[2007,"max","-","Mar","Sun>=8",[2,0,0,null],0,"-"]]}}),CIQ.convertTimeZone=function(t,e,i){var r=new _exports.timezoneJS.Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),e);return r.setTimezone(i),r},CIQ.convertToLocalTime=function(t,e){var i=t.getSeconds(),r=t.getMilliseconds(),n=new _exports.timezoneJS.Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),e);return new Date(n.getTime()+1e3*i+r)},_exports},__utility_=function(t){function e(t,i){if(!i)return document.getElementById(t);if(i.id==t)return i;if(!i.hasChildNodes)return null;for(var r=0;r<i.childNodes.length;r++){var n=e(t,i.childNodes[r]);if(n)return n}return null}function i(t,e){return e||(e=document),e.querySelectorAll(t)[0]}function r(){}"undefined"!=typeof global&&void 0===global.CanvasRenderingContext2D&&(global.CanvasRenderingContext2D=function(){}),t.$$=e,t.$$$=i,String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},Function.prototype.ciqInheritsFrom||(Function.prototype.ciqInheritsFrom=function(t,e){if(!1!==e)this.prototype=new t;else{this.prototype=Object.create(t);for(var i in t.prototype)this.prototype[i]=t.prototype[i]}this.prototype.constructor=this,this.prototype.parent=t.prototype},Function.prototype.stxInheritsFrom=Function.prototype.ciqInheritsFrom),CanvasRenderingContext2D.prototype.dashedLineTo=function(t,e,i,r,n){if(!(n instanceof Array))return n&&console.log('WARNING: Unsupported drawing pattern "'+n+'"; defaulting to "solid"'),void this.stxLine(t,e,i,r,this.strokeStyle,this.globalAlpha,this.lineWidth);if(e!==1/0&&t!==1/0&&r!==1/0&&i!==1/0){var a=function(t,e){return t-e<=1e-8},s=function(t,e){return t-e>=-1e-8},o=function(t,e){return Math.min(t,e)},l=function(t,e){return Math.max(t,e)},h={thereYet:s,cap:o},c={thereYet:s,cap:o};if(e-r>0&&(c.thereYet=a,c.cap=l),t-i>0&&(h.thereYet=a,h.cap=l),this.moveTo(t,e),!isNaN(t)&&!isNaN(e))for(var u=t,d=e,p=0,f=!0;!h.thereYet(u,i)||!c.thereYet(d,r);){var m=Math.atan2(r-e,i-t),g=n[p];u=h.cap(i,u+Math.cos(m)*g),d=c.cap(r,d+Math.sin(m)*g),f?this.lineTo(u,d):this.moveTo(u,d),p=(p+1)%n.length,f=!f}}},CanvasRenderingContext2D.prototype.stxLine=function(t,e,i,r,n,a,s,o){this.beginPath(),this.lineWidth=s,this.strokeStyle=n,this.globalAlpha=a,o&&o.length?this.dashedLineTo(t,e,i,r,o):(this.moveTo(t,e),this.lineTo(i,r)),this.stroke(),this.closePath(),this.lineWidth=1},CanvasRenderingContext2D.prototype.stxCircle=function(t,e,i,r){this.beginPath(),this.arc(t,e,i,0,2*Math.PI,!1),r&&this.fill(),this.stroke(),this.closePath()},Math.easeInOutQuad=function(t,e,i,r){return(t/=r/2)<1?i/2*t*t+e:(t--,-i/2*(t*(t-2)-1)+e)},Math.easeInOutCubic=function(t,e,i,r){return(t/=r/2)<1?i/2*t*t*t+e:(t-=2,i/2*(t*t*t+2)+e)},Math.easeOutCubic=function(t,e,i,r){return t/=r,t--,i*(t*t*t+1)+e},t.CIQ=r,t.STX=r;var n="undefined"!=typeof navigator?navigator:{userAgent:""},a=n.userAgent,s="undefined"!=typeof window?window:{},o="undefined"!=typeof document?document:{};return r.ipad=-1!=a.indexOf("iPad"),r.iphone=-1!=a.indexOf("iPhone"),r.isSurface=n.msMaxTouchPoints&&n.msMaxTouchPoints>1,r.touchDevice=void 0!==o.ontouchstart||r.isSurface,r.is_chrome=a.toLowerCase().indexOf("chrome")>-1,r.isAndroid=a.toLowerCase().indexOf("android")>-1,r.isIE=a.toLowerCase().indexOf("msie")>-1||a.indexOf("Trident/")>-1,r.isEdge=a.indexOf("Edge/")>-1,r.isIE9=a.indexOf("Trident/5")>-1||a.indexOf("MSIE 9.0")>-1,r.isIE8=s.isIE8||a.indexOf("MSIE 8.0")>-1,r.isIOS7=a.match(/(iPad|iPhone);.*CPU.*OS 7_\d/i),r.isIOS8=a.match(/(iPad|iPhone);.*CPU.*OS 8_\d/i),r.isIOS9=a.match(/(iPad|iPhone);.*CPU.*OS 9_\d/i),r.isIOS10=a.match(/(iPad|iPhone);.*CPU.*OS 10_\d/i),r.isIOS7or8=r.isIOS7||r.isIOS8||r.isIOS9||r.isIOS10,r.isMobile=r.isAndroid||r.ipad||r.iphone,r.isSurfaceApp=s.MSApp,r.noKeyboard=r.ipad||r.iphone||r.isAndroid||r.isSurfaceApp,r.wheelEvent="wheel"in document.createElement("div")||"onwheel"in document?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",r.isIE&&(r.wheelEvent="wheel"),r.log10=function(t){return Math.log(t)/Math.LN10},r.deleteRHS=function(t,e){var i=!1;for(var r in t)t[r]==e&&(delete t[r],i=!0);return i},r.scrub=function(t,e){for(var i in t)void 0===t[i]&&delete t[i],e&&null===t[i]&&delete t[i]},r.dataBindSafeAssignment=function(t,e){r.extend(t,e);for(var i in t)void 0===e[i]&&delete t[i]},r.clone=function(t,e){if(null===t||"object"!=typeof t)return t;var i=t.constructor;if(i==Date||i==RegExp||i==Function||i==String||i==Number||i==Boolean)return new t.constructor(t);e=e||new t.constructor;for(var n in t)e[n]=void 0===e[n]?r.clone(t[n],null):e[n];return e},r.shallowClone=function(t){if(!t)return t;var e;if(t.constructor==Array){e=new Array(t.length);for(var i=0;i<t.length;i++)e[i]=t[i];return e}e={};for(var r in t)e[r]=t[r];return e},r.extend=function(t,e,i){for(var n in e){var a=e[n];void 0!==a&&(null===a?t[n]=a:a.constructor==Object?(t[n]||(t[n]={}),i?t[n]=e[n]:(t[n].constructor!=Object&&(t[n]={}),r.extend(t[n],e[n]))):a.constructor==Array?t[n]=a.slice():t[n]=a)}return t},r.ensureDefaults=function(t,e){for(var i in e)void 0===t[i]&&(t[i]=e[i]);return t},r.equals=function(t,e,i){if(!t&&e)return!1;if(t&&!e)return!1;if(typeof t!=typeof e)return!1;for(var n in t)if(!i||!i[n])if("object"!=typeof t[n]){if(e[n]!=t[n])return!1}else{var a=r.equals(t[n],e[n]);if(!a)return!1}return!0},r.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},r.first=function(t){for(var e in t)return e;return null},r.last=function(t){var e=null;for(var i in t)e=i;return e},r.objLength=function(t){if(!t)return 0;var e=0;for(var i in t)e++;return e},r.deriveFromObjectChain=function(t,e){if(-1==e.indexOf("."))return{obj:t,member:e};for(var i=e.split("."),r=0;r<i.length-1;r++){var n=i[r];t[n]||0===t[n]||(t[n]={}),t=t[n]}return{obj:t,member:i[r]}},r.createObjectChainNames=function(t,e){for(var i=[],r=0;r<e.length;r++)i.push(t+"--\x3e"+e[r]);return i},r.existsInObjectChain=function(t,e){if(-1==e.indexOf("--\x3e"))return t[e]||0===t[e]?{obj:t,member:e}:null;for(var i,r=e.split("--\x3e"),n=0;n<r.length-1;n++){if(i=r[n],!t[i]&&0!==t[i])return null;t=t[i]}return i=r[n],t[i]||0===t[i]?{obj:t,member:i}:null},r.derivedFrom=function(t,e){return!!e.isPrototypeOf(t)||t instanceof e},r.replaceFields=function(t,e){if(!t)return t;var i={};for(var n in t){var a=t[n],s=e[n];if(s||(s=n),a&&"object"==typeof a)if(a.constructor==Array)for(var o=i[s]=new Array(a.length),l=0;l<o.length;l++){var h=a[l];o[l]="object"==typeof h?r.replaceFields(h,e):h}else i[s]=r.replaceFields(a,e);else i[s]=a}return i},r.removeNullValues=function(t){var e=r.clone(t);for(var i in e)e[i]||delete e[i];return e},r.reverseObject=function(t){var e={};for(var i in t)e[t[i]]=i;return e},r.camelCaseRegExp=/-([a-z])/g,r.makeCamelCase=function(t){return t.replace(r.camelCaseRegExp,function(t){return t[1].toUpperCase()})},r.appendClassName=function(t,e){if(t.className!=e){for(var i=t.className.split(" "),r=0;r<i.length;r++)if(i[r]==e)return;t.className?t.className+=" "+e:t.className=e}},r.unappendClassName=function(t,e){if(t&&-1!=t.className.indexOf(e))if(t.className==e)t.className="";else{for(var i=t.className.split(" "),r="",n=0;n<i.length;n++)i[n]!=e&&(""!==r&&(r+=" "),r+=i[n]);t.className=r}},r.swapClassName=function(t,e,i){r.unappendClassName(t,i),r.appendClassName(t,e)},r.hasClassName=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")>-1},r.toggleClassName=function(t,e){r.hasClassName(t,e)?r.unappendClassName(t,e):r.appendClassName(t,e)},r.newChild=function(t,e,i,r){var n=document.createElement(e);return i&&(n.className=i),t.appendChild(n),r&&(n.innerHTML=r),n},r.innerHTML=function(t,e){window.MSApp?window.MSApp.execUnsafeLocalFunction(function(){t.innerHTML=e}):t.innerHTML=e},r.focus=function(t,e){if(r.isSurface||e){var i=0;isNaN(parseInt(e,10))||(i=e),setTimeout(function(){t.focus()},i)}else t.focus()},r.blur=function(t){t||(t=document.activeElement),t&&t.blur(),window.focus()},r.findNodesByText=function(t,e){if(t.innerHTML==e)return[t];for(var i=[],n=0;n<t.childNodes.length;n++){var a=r.findNodesByText(t.childNodes[n],e);a&&(i=i.concat(a))}return i.length?i:null},r.hideByText=function(t,e){for(var i=r.findNodesByText(t,e),n=0;n<i.length;n++)i[n].style.display="none"},r.outerWidth=function(t){var e=t.offsetWidth;return e+=r.stripPX(getComputedStyle(t).marginLeft),e+=r.stripPX(getComputedStyle(t).marginRight)},r.clearNode=function(t){if(t.hasChildNodes())for(;t.childNodes.length>=1;)t.removeChild(t.firstChild)},r.getEventDOM=function(t){return t?t.target:window.event.srcElement},r.convertClickToTouchEnd=function(t){var i=e(t),r=i.getAttribute("onClick");r&&(i.removeAttribute("onClick"),i.setAttribute("onTouchEnd",r))},r.pageHeight=function(){var t=window.innerHeight;if(top!=self)try{t>parent.innerHeight&&(t=parent.innerHeight)}catch(t){}return t},r.pageWidth=function(){var t=window.innerWidth;if(top!=self)try{t>parent.innerWidth&&(t=parent.innerWidth)}catch(t){}return t},r.stripPX=function(t){return t?"number"==typeof t?t:parseInt(t.substr(0,t.indexOf("p")),10):0},r.colorsEqual=function(t,e){if(t==e)return!0;if(!t&&!e)return!0;if(!t||!e)return!1;"transparent"==t&&(t="rgba(0,0,0,0)"),"transparent"==e&&(e="rgba(0,0,0,0)");var i=/^rgba\(.*,(.+)\)/,n=t.match(i),a=e.match(i);if(n=n?parseFloat(n[1]):1,a=a?parseFloat(a[1]):1,n!=a)return!1;var s=r.colorToHex(t),o=r.colorToHex(e);return s.toLowerCase()==o.toLowerCase()},r.colorToHex=function(t){if(r.colorToHexMapping||(r.colorToHexMapping={}),t&&"transparent"!=t||(t="#000000"),r.colorToHexMapping[t])return r.colorToHexMapping[t];if("#"===t.substr(0,1))return 4==t.length&&(t=r.colorToHexMapping[t]="#"+Array(3).join(t.substr(1,1))+Array(3).join(t.substr(2,1))+Array(3).join(t.substr(3,1))),t;var i=/(.*?)rgb\((\d+), ?(\d+), ?(\d+)\)/.exec(t);if(i||(i=/(.*?)rgba\((\d+), ?(\d+), ?(\d+),.*\)/.exec(t)),!i){var n=function(t){if("undefined"==typeof document)return"#000000";var n=e("color_converter");n||(n=document.createElement("textarea"),n.id="color_converter",n.style.display="none",document.body.appendChild(n)),n.style.color="#000000",n.style.color=t;var a;return r.isIE8?(a=n.createTextRange().queryCommandValue("ForeColor"),a=(255&a)<<16|65280&a|(16711680&a)>>>16,a=a.toString(16),"#000000".slice(0,7-a.length)+a):(a=getComputedStyle(n).getPropertyValue("color"),i=/(.*?)rgb\((\d+), ?(\d+), ?(\d+)\)/.exec(a),i?r.colorToHex(a):"#"===a.substr(0,1)?a:t)}(t);return r.colorToHexMapping[t]=n,n}for(var a=parseFloat(i[2]),s=parseFloat(i[3]),o=parseFloat(i[4]),l=o|s<<8|a<<16,h=l.toString(16),c=h.length;c<6;c++)h="0"+h;var u=i[1]+"#"+h;return r.colorToHexMapping[t]=u,u},r.hexToRgba=function(t,e){if(t&&"transparent"!=t||(t="rgba(0,0,0,0)"),"rgba"===t.substr(0,4)){var i=/(.*?)rgba\((\d+), ?(\d+), ?(\d+), ?(\d*\.?\d*)\)/.exec(t),n=i[5];return(e||0===e)&&(n=e),n>1&&(n/=100),"rgba("+i[2]+","+i[3]+","+i[4]+","+n+")"}"rgb"===t.substr(0,3)&&(t=r.colorToHex(t)),e||0===e||(e=100),e<=1&&(e*=100),t=t.replace("#","");var a=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16);return isNaN(a)||isNaN(s)||isNaN(o)?(console.log("CIQ.hexToRgba: invalid hex :",t),null):"rgba("+a+","+s+","+o+","+e/100+")"},r.convertToNativeColor=function(t){var e=document.createElement("DIV");e.style.color=t,e.style.display="none",document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i},r.isTransparent=function(t){if(!t)return!1;if("transparent"==t)return!0;var e=/(.*?)rgba\((\d+), ?(\d+), ?(\d+), ?(\d*\.?\d*)\)/.exec(t);return null!==e&&0===parseFloat(e[5])},r.hsv=function(t){var e=r.colorToHex(t);"#"===e.substr(0,1)&&(e=e.slice(1));for(var i=e.length;i<6;i++)e="0"+e;var n=parseInt(e.slice(0,2),16),a=parseInt(e.slice(2,4),16),s=parseInt(e.slice(4,6),16),o=0,l=0,h=0;if(n=parseInt((""+n).replace(/\s/g,""),10),a=parseInt((""+a).replace(/\s/g,""),10),s=parseInt((""+s).replace(/\s/g,""),10),null===n||null===a||null===s||isNaN(n)||isNaN(a)||isNaN(s))return console.log("CIQ.hsv: invalid color :",t),null;if(n<0||a<0||s<0||n>255||a>255||s>255)return null;n/=255,a/=255,s/=255;var c=Math.min(n,Math.min(a,s)),u=Math.max(n,Math.max(a,s));if(c==u)return h=c,[0,0,h];var d=n==c?a-s:s==c?n-a:s-n;return o=60*((n==c?3:s==c?1:5)-d/(u-c)),l=(u-c)/u,h=u,[o,l,h]},r.hsl=function(t){var e=r.colorToHex(t);"#"===e.substr(0,1)&&(e=e.slice(1));for(var i=e.length;i<6;i++)e="0"+e;var n=parseInt(e.slice(0,2),16),a=parseInt(e.slice(2,4),16),s=parseInt(e.slice(4,6),16);n/=255,a/=255,s/=255;var o,l,h=Math.max(n,a,s),c=Math.min(n,a,s),u=(h+c)/2;if(h==c)o=l=0;else{var d=h-c;switch(l=u>.5?d/(2-h-c):d/(h+c),h){case n:o=(a-s)/d+(a<s?6:0);break;case a:o=(s-n)/d+2;break;case s:o=(n-a)/d+4}o/=6}return[o,l,u]},r.chooseForegroundColor=function(t){var e=r.hsl(t);return e[2]>=e[0]?"#000000":"#FFFFFF"},r.borderPatternToArray=function(t,e){return e?e instanceof Array?e:"dotted"==e?[t,t]:"dashed"==e?[5*t,5*t]:("solid"!=e&&"none"!=e&&console.log('Unsupported pattern "'+e+'"; defaulting to "solid"'),[]):[]},r.getBackgroundColor=function(t){for(var e=null;!e||r.isTransparent(e);){var i=getComputedStyle(t);if(!i)return;if(e=i.backgroundColor,r.isTransparent(e)&&(e="transparent"),!(t=t.parentNode)||!t.tagName)break}return e&&"transparent"!=e||(e="#FFFFFF"),e},r.yyyymmddhhmmssmmmrx=new RegExp("\\d{17}"),r.strToDateTime=function(t){if(!t||t.getFullYear)return t;var e,i,n,a,s,o,l,h=[];if(12==t.length)return e=parseFloat(t.substring(0,4)),i=parseFloat(t.substring(4,6))-1,n=parseFloat(t.substring(6,8)),a=parseFloat(t.substring(8,10)),s=parseFloat(t.substring(10,12)),new Date(e,i,n,a,s,0,0);if(r.yyyymmddhhmmssmmmrx.test(t))return e=parseFloat(t.substring(0,4)),i=parseFloat(t.substring(4,6))-1,n=parseFloat(t.substring(6,8)),a=parseFloat(t.substring(8,10)),s=parseFloat(t.substring(10,12)),o=parseFloat(t.substring(12,14)),l=parseFloat(t.substring(14,17)),new Date(e,i,n,a,s,o,l);var c=[t],u=t.indexOf("T");if(-1!=u){var d=t.substring(u);if(!r.isIE8&&(-1!=d.indexOf("Z")||-1!=d.indexOf("-")||-1!=d.indexOf("+")))return new Date(t);c=t.split("T")}else-1!=t.indexOf(" ")&&(c=t.split(" "));if(-1!=c[0].indexOf("/"))h=c[0].split("/");else{if(-1==c[0].indexOf("-"))return r.strToDate(t);h=c[0].split("-")}var p=parseFloat(h[2],10);if(h[0]&&4==h[0].length&&(p=parseFloat(h[0],10),h[0]=h[1],h[1]=h[2]),c.length>1){var f=c[2];c=c[1].split(":"),f&&("12"==c[0]&&"AM"==f.toUpperCase()?c[0]=0:"12"!=c[0]&&"PM"==f.toUpperCase()&&(c[0]=parseInt(c[0],10)+12));var m=0,g=0;if(3==c.length)if(-1==c[2].indexOf("."))m=parseInt(c[2],10);else{if(m=c[2].split("."),3!=m[1].length){g=m[1].substr(0,3);var v=parseInt(m[1].substr(3),10);m=m[0];var y=new Date(p,h[0]-1,h[1],c[0],c[1],m,g);return y.setMinutes(y.getMinutes()-y.getTimezoneOffset()-v%100-60*Math.round(v/100)),y}g=m[1],m=m[0]}return new Date(p,h[0]-1,h[1],c[0],c[1],m,g)}return new Date(p,h[0]-1,h[1],0,0,0,0)},r.strToDate=function(t){var e;if(-1!=t.indexOf("/"))e=t.split("/");else{if(-1==t.indexOf("-"))return t.length>=8?new Date(parseFloat(t.substring(0,4)),parseFloat(t.substring(4,6))-1,parseFloat(t.substring(6,8))):new Date;e=t.split("-")}if(e.length<3)return new Date;-1!=e[2].indexOf(" ")?e[2]=e[2].substring(0,e[2].indexOf(" ")):-1!=e[2].indexOf("T")&&(e[2]=e[2].substring(0,e[2].indexOf("T")));var i=parseFloat(e[2],10);return i<20&&(i+=2e3),4==e[0].length&&(i=parseFloat(e[0],10),e[0]=e[1],e[1]=e[2]),new Date(i,e[0]-1,e[1])},r.mmddyyyy=function(t){"string"==typeof t&&(t=r.strToDate(t));var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();return i<10&&(i="0"+i),e+"/"+i+"/"+t.getFullYear()},r.yyyymmdd=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();return i<10&&(i="0"+i),t.getFullYear()+"-"+e+"-"+i},r.yyyymmddhhmm=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var r=t.getHours();r<10&&(r="0"+r);var n=t.getMinutes();return n<10&&(n="0"+n),""+t.getFullYear()+e+i+r+n},r.yyyymmddhhmmssmmm=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var r=t.getHours();r<10&&(r="0"+r);var n=t.getMinutes();n<10&&(n="0"+n);var a=t.getSeconds();a<10&&(a="0"+a);var s=t.getMilliseconds();return s<10?s="00"+s:s<100&&(s="0"+s),""+t.getFullYear()+e+i+r+n+a+s},r.friendlyDate=function(t){var e=t.getMonth()+1;e<10&&(e="0"+e);var i=t.getDate();i<10&&(i="0"+i);var r=t.getHours();r<10&&(r="0"+r);var n=t.getMinutes();return n<10&&(n="0"+n),t.getFullYear()+"/"+e+"/"+i+" "+r+":"+n},r.standardUTCDate=function(t){var e=t.getUTCMonth()+1;e<10&&(e="0"+e);var i=t.getUTCDate();i<10&&(i="0"+i);var r=t.getUTCHours();r<10&&(r="0"+r);var n=t.getUTCMinutes();n<10&&(n="0"+n);var a=t.getUTCSeconds();return a<10&&(a="0"+a),t.getUTCFullYear()+"-"+e+"-"+i+"T"+r+":"+n+":"+a+"Z"},r.mmddhhmm=function(t){var e=r.strToDateTime(t),i=e.getMonth()+1;i<10&&(i="0"+i);var n=e.getDate();n<10&&(n="0"+n);var a=e.getHours();a<10&&(a="0"+a);var s=e.getMinutes();if(s<10&&(s="0"+s),"00"==a&&"00"==s)return i+"-"+n+"-"+e.getFullYear();var o=e.getSeconds();if(o<10&&(o="0"+o),"00"==o)return i+"-"+n+" "+a+":"+s;var l=e.getMilliseconds();return l<10?l="00"+l:l<100&&(l="0"+l),"000"==l?i+"-"+n+" "+a+":"+s+":"+o:i+"-"+n+" "+a+":"+s+":"+o+":"+l},r.getYearDay=function(t){var e=t;e||(e=new Date),e.setHours(0,0,0,0);var i=new Date(e.getFullYear(),0,0),r=e-i;return Math.round(r/864e5)},r.isDST=function(t){t||(t=new Date);var e=new Date(t.getFullYear(),0,1),i=new Date(t.getFullYear(),6,1),r=Math.max(e.getTimezoneOffset(),i.getTimezoneOffset());return t.getTimezoneOffset()!=r},r.uniqueID=function(){var t=new Date,e=t.getTime().toString(36);return e+=Math.floor(Math.random()*Math.pow(36,2)).toString(36),e.toUpperCase()},r.getHostName=function(t){try{return t.match(/:\/\/(.[^\/]+)/)[1]}catch(t){return""}},r.getAjaxServer=function(t){var e=!1,i=!0;if((r.isIE9||r.isIE8)&&t&&(""===r.getHostName(t)&&(i=!1),r.getHostName(t)==r.getHostName(window.location.href)&&(i=!1)),(r.isIE9||r.isIE8)&&i)return e=new XDomainRequest;try{e=new XMLHttpRequest}catch(t){alert("ajax not supported in browser")}return e},r.qs=function(t){var e={};t||(t=window.location.search.substring(1));for(var i=t.split("&"),r=0;r<i.length;r++){var n,a=i[r].indexOf("=");a>0?(n=i[r].substring(0,a),e[n]=i[r].substring(a+1)):(n=i[r],e[n]=null)}return e},r.postAjax=function(t,e,i,n,a){function s(e){var i={};if(t.responseHeaders){for(var r=e.getAllResponseHeaders(),n=r.split("\n"),a=0;a<n.length;a++){for(var s=n[a].split(":");s[1]&&" "==s[1].charAt(0);)s[1]=s[1].substring(1);""!==s[0]&&(i[s.shift()]=s.join(":"))}return i}}function o(t){for(var e=0;e<r.ajaxes.length;e++)if(r.ajaxes[e]==t)return void r.ajaxes.splice(e,1)}"string"==typeof t&&(t={url:t,payload:e,cb:i,contentType:n,noEpoch:a,method:null,responseHeaders:!1});var l=t.url,h=t.cb,c=t.payload;if(h||(h=function(){}),!t.ungovernable&&r.Extras&&r.Extras.RequestLimiter&&r.Extras.RequestLimiter.hitRequestLimit(l))return void h(429,null,{});var u=r.getAjaxServer(l);if(!u)return!1;r.ajaxes||(r.ajaxes=[]),r.ajaxes.unshift(u);var d=new Date;t.noEpoch||(-1==l.indexOf("?")?l+="?ciqrandom="+d.getTime():l+="&ciqrandom="+d.getTime());var p=t.method,f=t.headers;if(p||(p=c?"POST":"GET"),!r.isIE9&&!r.isIE8||u.constructor==XMLHttpRequest){if(u.open(p,l,!0),t.contentType||(t.contentType="application/x-www-form-urlencoded"),c&&u.setRequestHeader("Content-Type",t.contentType),f)for(var m in f)u.setRequestHeader(m,f[m])}else l=l.replace("https:",window.location.protocol),u.open(p,l,!0);t.timeout&&(u.timeout=t.timeout),u.ontimeout=function(){o(u),h(408,null,{})},u.onload=function(){0===this.status?this.status="0":this.status||(this.status=200),o(u),h(this.status,this.responseText,s(this))},u.onerror=function(){o(u),h("0",null,{})},u.onprogress=function(){};try{u.send(c)}catch(t){h("0",t,{})}return!0},r.cleanPeriodicity=function(t,e,i){return isNaN(t)&&(t=1),e||(e=1),!isNaN(e)&&i?"minute"!=i&&"second"!=i&&"millisecond"!=i&&(e=i,i=null):"tick"==e?i=null:i||isNaN(e)||(i="minute"),"year"==e&&(e="month",t||(t=1),t*=12),{period:t,interval:e,timeUnit:i}},t},f3B3={P7c:function(t,e){return t==e},q4r:function(t,e){return t==e},N4c:function(t,e){return t/e},F4r:function(t,e){return t===e},T1k:function(t,e){return t<e},J4c:function(t,e){return t!==e},K7k:function(t,e){return t==e},H4k:function(t,e){return t<e},N1r:function(t,e){return t/e},s19:function(t,e){return t/e},C99:function(t,e){return t-e},e7k:function(t,e){return t-e},K79:function(t,e){return t===e},W2c:function(t,e){return t>e},Q39:function(t,e){return t-e},P19:function(t,e){return t<e},A6k:function(t,e){return t>e},z8c:function(t,e){return t<=e},P59:function(t,e){return t-e},D1k:function(t,e){return t-e},r4k:function(t,e){return t===e},x6b:function(t,e){return t<e},Z9k:function(t,e){return t==e},a6c:function(t,e){return t>e},e0r:function(t,e){return t!==e},A6r:function(t,e){return t==e},N5k:function(t,e){return t>=e},t8k:function(t,e){return t===e},Z8c:function(t,e){return t!=e},q3k:function(t,e,i){return t*e/i},m1r:function(t,e){return t/e},h7k:function(t,e){return t<e},B0r:function(t,e){return t-e},C3k:function(t,e){return t*e},A8b:function(t,e){return t-e},p5k:function(t,e){return t<=e},o0k:function(t,e){return t!=e},h19:function(t,e){return t/e},s0b:function(t,e){return t==e},l3r:function(t,e){return t<e},o8c:function(t,e){return t==e},Y09:function(t,e){return t>e},h0b:function(t,e){return t/e},R9k:function(t,e){return t!=e},F4b:function(t,e){return t>e},N8k:function(t,e){return t*e},q39:function(t,e){return t/e},X29:function(t,e){return t==e},d19:function(t,e){return t*e},k8c:function(t,e){return t>=e},h29:function(t,e){return t==e},E2c:function(t,e){return t===e},b4B:"j",z1k:function(t,e){return t-e},w7c:function(t,e){return t<e},n6b:function(t,e){return t>=e},a4r:function(t,e){return t<=e},X3c:function(t,e){return t!==e},V79:function(t,e){return t<=e},K09:function(t,e){return t<e},G2B:"n",G0c:function(t,e){return t/e},H7r:function(t,e){return t-e},a0b:function(t,e){return t>e},g9k:function(t,e){return t==e},G9b:function(t,e){return t-e},Q4b:function(t,e){return t-e},b99:function(t,e){return t==e},S8b:function(t,e){return t-e},B6c:function(t,e){return t===e},g4k:function(t,e){return t<e},g69:function(t,e){return t<=e},x4r:function(t,e){return t<e},o7k:function(t,e){return t<e},P4c:function(t,e){return t*e},v9b:function(t,e){return t<=e},f3k:function(t,e){return t>e},I89:function(t,e){return t*e},V5r:function(t,e){return t&e},I8k:function(t,e){return t<e},M1r:function(t,e){return t==e},z9b:function(t,e){return t>e},t6b:function(t,e){return t/e},q0c:function(t,e){return t>e},o0b:function(t,e){return t==e},R9b:function(t,e){return t<e},P8k:function(t,e){return t>=e},W8k:function(t,e){return t==e},C9c:function(t,e){return t!=e},o19:function(t,e){return t!=e},E3r:function(t,e){return t-e},R9r:function(t,e){return t<e},g1k:function(t,e){return t/e},K2k:function(t,e){return t<e},R2r:function(t,e){return t==e},K9c:function(t,e){return t<e},J6r:function(t,e){return t-e},i3r:function(t,e){return t-e},x59:function(t,e){return t/e},u9c:function(t,e){return t-e},r9b:function(t,e){return t<e},H39:function(t,e){return t/e},U6c:function(t,e){return t>=e},g7r:function(t,e){return t>=e},Z7r:function(t,e){return t*e},N8b:function(t,e){return t===e},K19:function(t,e){return t-e},J4r:function(t,e){return t===e},C8r:function(t,e){return t*e},J89:function(t,e){return t==e},J1r:function(t,e){return t/e},b1c:function(t,e){return t/e},k9r:function(t,e){return t-e},p7c:function(t,e){return t-e},S89:function(t,e){return t/e},s5r:function(t,e){return t===e},s0k:function(t,e){return t===e},n8b:function(t,e){return t>e},n8k:function(t,e){return t==e},I6b:function(t,e){return t<=e},d1c:function(t,e){return t*e},d2k:function(t,e){return t<e},c79:function(t,e){return t===e},z2r:function(t,e){return t<e},B99:function(t,e){return t>=e},
G69:function(t,e){return t===e},Q9b:function(t,e){return t<e},y7r:function(t,e){return t-e},r39:function(t,e){return t*e},X09:function(t,e){return t==e},d7k:function(t,e){return t-e},l6k:function(t,e){return t-e},G9k:function(t,e){return t==e},T49:function(t,e){return t/e},e29:function(t,e){return t-e},m6b:function(t,e){return t>e},G49:function(t,e){return t==e},J8k:function(t,e){return t-e},l8k:function(t,e){return t*e},T69:function(t,e){return t>e},s7k:function(t,e){return t!==e},W9r:function(t,e){return t==e},r4B:"y",t6r:function(t,e){return t===e},k4b:function(t,e){return t>=e},y4b:function(t,e){return t>e},R4b:function(t,e){return t===e},A8k:function(t,e){return t==e},Y3k:function(t,e){return t<e},a8r:function(t,e){return t==e},k7r:function(t,e){return t*e},U3k:function(t,e){return t/e},x6k:function(t,e){return t!==e},V2k:function(t,e){return t>e},u79:function(t,e){return t-e},e1c:function(t,e){return t*e},p89:function(t,e){return t*e},Y0k:function(t,e){return t!==e},T5B:"s",r3k:function(t,e){return t*e},L8c:function(t,e){return t<=e},s2k:function(t,e){return t<e},f99:function(t,e){return t<e},r9k:function(t,e){return t==e},X4B:"z",v49:function(t,e){return t<e},d3c:function(t,e){return t<e},G4r:function(t,e){return t<e},I6k:function(t,e){return t-e},u8r:function(t,e){return t==e},U9c:function(t,e){return t*e},F0c:function(t,e){return t/e},y39:function(t,e){return t<e},s09:function(t,e){return t>e},j19:function(t,e){return t*e},w5k:function(t,e){return t<e},c09:function(t,e){return t<e},J2c:function(t,e){return t<=e},t7c:function(t,e){return t-e},I4c:function(t,e){return t/e},L39:function(t,e){return t===e},X79:function(t,e){return t/e},b0k:function(t,e){return t*e},c2k:function(t,e){return t<e},B7k:function(t,e){return t-e},k5c:function(t,e){return t===e},M89:function(t,e){return t==e},n5k:function(t,e){return t>=e},F7r:function(t,e){return t*e},o1c:function(t,e){return t-e},n4c:function(t,e){return t*e},H9k:function(t,e){return t==e},q6c:function(t,e){return t<e},O7r:function(t,e){return t-e},a99:function(t,e){return t==e},X1c:function(t,e){return t/e},Y5r:function(t,e){return t&e},M7c:function(t,e){return t==e},q4b:function(t,e){return t in e},r69:function(t,e){return t==e},b29:function(t,e){return t==e},m89:function(t,e){return t==e},f5r:function(t,e){return t&e},m4c:function(t,e){return t*e},m3r:function(t,e){return t==e},o5r:function(t,e){return t!=e},m59:function(t,e){return t/e},g4r:function(t,e){return t===e},f0k:function(t,e){return t/e},w8k:function(t,e){return t!==e},x1r:function(t,e){return t<e},U79:function(t,e){return t!==e},s29:function(t,e){return t==e},E6r:function(t,e){return t<e},G4k:function(t,e){return t!==e},X99:function(t,e){return t<e},X0k:function(t,e){return t*e},K5r:function(t,e){return t!==e},S19:function(t,e,i){return t-e+i},d79:function(t,e){return t<e},w6r:function(t,e){return t==e},b3k:function(t,e){return t*e},w2c:function(t,e){return t-e},A6b:function(t,e){return t<e},z5c:function(t,e){return t===e},Z69:function(t,e){return t*e},p6b:function(t,e){return t-e},E5k:function(t,e){return t==e},q49:function(t,e){return t-e},P9r:function(t,e){return t*e},m2c:function(t,e){return t>e},B29:function(t,e){return t==e},n59:function(t,e){return t/e},y1r:function(t,e,i,r){return t-e+i-r},x6r:function(t,e){return t<e},z9k:function(t,e){return t!=e},i6k:function(t,e){return t>e},D39:function(t,e){return t===e},T6c:function(t,e){return t*e},V0k:function(t,e){return t in e},U99:function(t,e){return t<e},C1c:function(t,e){return t>e},j79:function(t,e){return t<e},P6b:function(t,e){return t!=e},c7k:function(t,e){return t===e},u7k:function(t,e){return t/e},J6b:function(t,e){return t==e},b3c:function(t,e){return t<e},Y3c:function(t,e){return t*e},u99:function(t,e){return t<e},R49:function(t,e){return t==e},Z4r:function(t,e){return t===e},j9c:function(t,e){return t>e},k0c:function(t,e){return t-e},N6b:function(t,e){return t*e},S7c:function(t,e){return t==e},v6c:function(t,e){return t!==e},n6r:function(t,e){return t==e},f0b:function(t,e){return t>e},z19:function(t,e){return t-e},Q4k:function(t,e){return t==e},U7k:function(t,e){return t-e},t3r:function(t,e){return t<=e},g4b:function(t,e){return t-e},Q4r:function(t,e,i){return t*e/i},y49:function(t,e){return t<e},z7r:function(t,e){return t*e},L49:function(t,e){return t!=e},O2r:function(t,e){return t==e},q1k:function(t,e){return t/e},I2c:function(t,e){return t<=e},X5r:function(t,e){return t>=e},J7c:function(t,e){return t===e},g39:function(t,e){return t<e},B3k:function(t,e){return t-e},T2r:function(t,e){return t>e},V29:function(t,e){return t<e},y4r:function(t,e){return t>e},c3c:function(t,e){return t*e},N7c:function(t,e){return t/e},b6c:function(t,e){return t<e},V7k:function(t,e){return t>e},b9c:function(t,e){return t-e},G1k:function(t,e){return t<e},q0B:3,F9k:function(t,e){return t!==e},C29:function(t,e){return t>=e},X0r:function(t,e){return t>e},E8k:function(t,e){return t==e},i1r:function(t,e){return t==e},r2r:function(t,e){return t>e},R4k:function(t,e){return t==e},Q1k:function(t,e){return t-e},d0b:function(t,e){return t!==e},L9k:function(t,e){return t!==e},v4B:"h",l6b:function(t,e){return t>=e},D49:function(t,e){return t<=e},Z39:function(t,e){return t==e},Q8c:function(t,e){return t==e},G4b:function(t,e){return t!==e},f1c:function(t,e){return t<e},L7r:function(t,e){return t<e},b79:function(t,e){return t-e},S1r:function(t,e){return t<=e},a09:function(t,e){return t<e},g49:function(t,e){return t<e},F4k:function(t,e){return t<e},t4c:function(t,e){return t==e},C79:function(t,e){return t/e},e99:function(t,e){return t===e},u3c:function(t,e){return t>e},A5k:function(t,e){return t<=e},H0c:function(t,e){return t===e},q9b:function(t,e){return t<e},K8r:function(t,e){return t===e},I59:function(t,e){return t<=e},U09:function(t,e){return t<e},A7c:function(t,e){return t===e},V0r:function(t,e){return t*e},Z4b:function(t,e){return t<e},p59:function(t,e){return t>e},j7k:function(t,e){return t!==e},H5c:function(t,e){return t==e},a3k:function(t,e){return t>e},B1c:function(t,e){return t-e},i89:function(t,e){return t==e},R39:function(t,e){return t/e},M59:function(t,e){return t/e},f6c:function(t,e){return t===e},w6b:function(t,e){return t==e},V99:function(t,e){return t-e},Y7k:function(t,e){return t==e},u6c:function(t,e){return t<e},Z1k:function(t,e){return t-e},h8r:function(t,e){return t/e},T3k:function(t,e){return t-e},H4b:function(t,e){return t>=e},v5c:function(t,e){return t-e},S59:function(t,e){return t<e},O5c:function(t,e){return t>=e},k4k:function(t,e){return t-e},V3c:function(t,e){return t*e},X9c:function(t,e){return t*e},h1c:function(t,e){return t<e},c3k:function(t,e){return t>e},i6b:function(t,e){return t===e},r7r:function(t,e){return t===e},O4b:function(t,e){return t in e},q5c:function(t,e){return t>e},f2k:function(t,e){return t-e},A4c:function(t,e){return t==e},K0b:function(t,e){return t>=e},c8r:function(t,e){return t*e},D9r:function(t,e){return t-e},t9r:function(t,e){return t<e},I8b:function(t,e){return t==e},j8c:function(t,e){return t==e},T9k:function(t,e){return t==e},t6k:function(t,e){return t-e},r4r:function(t,e){return t===e},c0b:function(t,e){return t*e},m6k:function(t,e){return t/e},m19:function(t,e){return t*e},a3c:function(t,e){return t!==e},W4c:function(t,e){return t>e},v0c:function(t,e){return t==e},T4k:function(t,e){return t>=e},y1k:function(t,e){return t-e},B79:function(t,e){return t/e},m8b:function(t,e){return t<e},K29:function(t,e){return t==e},e3c:function(t,e){return t>e},K0r:function(t,e){return t-e},F8c:function(t,e){return t!=e},L4b:function(t,e){return t!=e},g6c:function(t,e){return t==e},K99:function(t,e){return t/e},b0b:function(t,e){return t==e},k9b:function(t,e){return t-e},l69:function(t,e){return t-e},I7c:function(t,e){return t==e},C5r:function(t,e){return t==e},W7c:function(t,e){return t==e},i2c:function(t,e){return t>e},h0r:function(t,e){return t===e},u4r:function(t,e,i){return t*e/i},Q0c:function(t,e){return t/e},Z4k:function(t,e){return t<e},o2k:function(t,e){return t<e},r5c:function(t,e){return t*e},j0b:function(t,e){return t==e},H49:function(t,e){return t/e},V3k:function(t,e){return t*e},E89:function(t,e){return t>=e},C09:function(t,e){return t-e},f7k:function(t,e){return t-e},s0r:function(t,e){return t>e},h3c:function(t,e){return t<e},p2c:function(t,e){return t===e},r0B:1,X3k:function(t,e){return t>e},E6k:function(t,e){return t-e},E9r:function(t,e){return t<e},x3r:function(t,e){return t!=e},t8b:function(t,e){return t==e},y6c:function(t,e){return t===e},P89:function(t,e){return t==e},Y79:function(t,e){return t!=e},M0B:"w",H19:function(t,e){return t===e},w9r:function(t,e){return t-e},L9b:function(t,e){return t-e},E59:function(t,e){return t/e},F69:function(t,e){return t*e},b7k:function(t,e){return t-e},M3r:function(t,e){return t>=e},P6r:function(t,e){return t*e},p6r:function(t,e){return t>e},m8k:function(t,e){return t<=e},U1c:function(t,e){return t>=e},L2r:function(t,e){return t>=e},Z0c:function(t,e){return t==e},N3r:function(t,e){return t>e},M6b:function(t,e){return t<=e},h9c:function(t,e){return t instanceof e},Y2k:function(t,e){return t===e},R8c:function(t,e){return t>=e},x7c:function(t,e){return t===e},I3r:function(t,e){return t-e},o0r:function(t,e){return t*e},n69:function(t,e){return t-e},d0B:2,B8r:function(t,e){return t>e},l59:function(t,e){return t==e},y5c:function(t,e){return t<e},v39:function(t,e){return t<e},N2c:function(t,e){return t==e},S8k:function(t,e){return t>=e},x4c:function(t,e){return t<=e},t59:function(t,e){return t===e},y69:function(t,e){return t<e},s79:function(t,e){return t/e},d0r:function(t,e){return t<e},j3c:function(t,e){return t>e},V9c:function(t,e){return t*e},z4k:function(t,e){return t-e},u0r:function(t,e){return t<e},x3:function(t,e){return t<e},o8r:function(t,e){return t*e},q4k:function(t,e){return t==e},s99:function(t,e){return t===e},W3r:function(t,e){return t>e},T39:function(t,e){return t!=e},D7r:function(t,e){return t<e},x69:function(t,e){return t*e},i59:function(t,e){return t*e},y9b:function(t,e){return t==e},I9r:function(t,e){return t===e},s8c:function(t,e){return t!=e},P4B:"i",b09:function(t,e){return t>e},G3k:function(t,e){return t<e},Y0r:function(t,e){return t<e},k1k:function(t,e){return t<=e},u1c:function(t,e){return t!=e},n7c:function(t,e){return t==e},Y1c:function(t,e){return t!=e},O9b:function(t,e){return t==e},h2k:function(t,e){return t<e},i4c:function(t,e){return t<e},F39:function(t,e){return t===e},A89:function(t,e){return t==e},O69:function(t,e){return t==e},S6b:function(t,e){return t<e},g9b:function(t,e){return t==e},m6r:function(t,e){return t/e},O0c:function(t,e){return t*e},s3c:function(t,e){return t>e},O6c:function(t,e,i){return t-e-i},e79:function(t,e){return t/e},V8r:function(t,e){return t*e},M6k:function(t,e){return t!==e},W59:function(t,e){return t-e},w6k:function(t,e){return t*e},D19:function(t,e){return t/e},K1c:function(t,e){return t<e},I5k:function(t,e){return t/e},Y99:function(t,e){return t==e},a7k:function(t,e){return t*e},l7c:function(t,e){return t-e},l89:function(t,e){return t==e},p8k:function(t,e){return t<=e},c0k:function(t,e){return t<e},D9k:function(t,e){return t!==e},u29:function(t,e){return t==e},n3r:function(t,e){return t!=e},Z5c:function(t,e){return t*e},S9r:function(t,e,i){return t-e-i},E6b:function(t,e){return t>=e},h09:function(t,e){return t-e},t89:function(t,e){return t>e},c6c:function(t,e){return t-e},S6r:function(t,e){return t-e},y9k:function(t,e){return t!=e},c9c:function(t,e){return t!=e},Y6c:function(t,e){return t===e},e2k:function(t,e){return t>e},h0k:function(t,e){return t>e},c99:function(t,e){return t<e},H9b:function(t,e){return t-e},X8r:function(t,e){return t<e},i7c:function(t,e){return t-e},K0k:function(t,e){return t!=e},x2c:function(t,e){return t/e},C0r:function(t,e){return t<e},v2r:function(t,e){return t>e},D0c:function(t,e){return t/e},e09:function(t,e){return t==e},s9c:function(t,e){return t-e},w8b:function(t,e){return t==e},b5r:function(t,e){return t&e},X0b:function(t,e){return t*e},y4k:function(t,e){return t<=e},h99:function(t,e){return t===e},g5c:function(t,e){return t<=e},P1r:function(t,e){return t/e},N89:function(t,e){return t/e},A59:function(t,e){return t*e},f8r:function(t,e){return t===e},Z49:function(t,e){return t==e},f09:function(t,e){return t>e},P6k:function(t,e){return t-e},l8b:function(t,e){return t<e},W6r:function(t,e){return t===e},T7r:function(t,e){return t&e},Q69:function(t,e,i,r){return t*e*i*r},e8c:function(t,e){return t==e},F1k:function(t,e){return t*e},r49:function(t,e){return t<e},b0r:function(t,e){return t-e},a0r:function(t,e){return t>e},J3:function(t,e){return t-e},S2c:function(t,e){return t!=e},e19:function(t,e){return t*e},U5r:function(t,e){return t<=e},K2b:function(t){var e={},i=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},r=function(){}.constructor(new t("wjyzws%ithzrjsy3itrfns@").m2b(5))(),n=function(t,r,n){if(void 0!==e[n])return e[n];for(var a=3432918353,s=461845907,o=n,l=-4&r,h=0;h<l;h+=4){var c=255&t.charCodeAt(h)|(255&t.charCodeAt(h+1))<<8|(255&t.charCodeAt(h+2))<<16|(255&t.charCodeAt(h+3))<<24;c=i(c,a),c=(131071&c)<<15|c>>>17,c=i(c,s),o^=c,o=(524287&o)<<13|o>>>19,o=5*o+3864292196|0}switch(c=0,r%4){case 3:c=(255&t.charCodeAt(l+2))<<16;case 2:c|=(255&t.charCodeAt(l+1))<<8;case 1:c|=255&t.charCodeAt(l),c=i(c,a),c=(131071&c)<<15|c>>>17,c=i(c,s),o^=c}return o^=r,o^=o>>>16,o=i(o,2246822507),o^=o>>>13,o=i(o,3266489909),o^=o>>>16,e[n]=o,o};return{M2b:i,W2b:n,s2b:function(t,e,i){var a,s;return i>0?(a=r.substring(t,i),s=a.length,n(a,s,e)):null===t||t<=0?(a=r.substring(0,r.length),s=a.length,n(a,s,e)):(a=r.substring(r.length-t,r.length),s=a.length,n(a,s,e))}}}(function(t){this.F2b=t,this.m2b=function(e){for(var i=new String,r=0;r<t.length;r++)i+=String.fromCharCode(t.charCodeAt(r)-e);return i}}),r0c:function(t,e){return t<e},Q2r:function(t,e){return t*e},w59:function(t,e){return t*e},d8r:function(t,e){return t>=e},G5c:function(t,e){return t===e},d09:function(t,e){return t>e},p1r:function(t,e){return t<=e},e9c:function(t,e){return t<e},U8r:function(t,e){return t==e},P3r:function(t,e){return t-e},o29:function(t,e){return t==e},A3r:function(t,e){return t!=e},n2c:function(t,e){return t===e},f29:function(t,e,i){return t-e-i},T0c:function(t,e){return t!==e},z0c:function(t,e){return t>e},T4r:function(t,e){return t<e},o79:function(t,e){return t>=e},W5k:function(t,e){return t<e},Q7r:function(t,e){return t-e},N69:function(t,e){return t===e},N4r:function(t,e){return t-e},D4k:function(t,e){return t*e},T9b:function(t,e){return t!=e},Y0b:function(t,e){return t*e},V1c:function(t,e){return t-e},x8b:function(t,e){return t!=e},z9r:function(t,e){return t-e},Z2r:function(t,e){return t==e},a9c:function(t,e){return t-e},g0c:function(t,e){return t/e},p6A:function(t){return function(t,e){return function(t){return{H6A:t}}(function(i){for(var r,n=0,a=t;n<i.length;n++){var s=e(i,n);r=0===n?s:r^s}return r?a:!a})}(function(t,e,i,r){return t("13dav1eh6",33)-function(t,e){return(new t)[e]()}(e,i)>33}(parseInt,Date,function(t){return"_getTime2".substring(1,"_getTime2".length-1)}()),function(t,e){var i=parseInt(t.charAt(e),16).toString(2);return i.charAt(i.length-1)})}(),L19:function(t,e){return t/e},S4c:function(t,e){return t/e},f0r:function(t,e){return t==e},e5r:function(t,e){return t==e},K3c:function(t,e){return t<e},F9b:function(t,e){return t>e},q2r:function(t,e){return t===e},z4b:function(t,e){return t===e},M6r:function(t,e){return t===e},t5k:function(t,e){return t==e},J8b:function(t,e){return t<e},H8c:function(t,e){return t<e},I6r:function(t,e){return t/e},J3r:function(t,e){return t-e},Q49:function(t,e){return t==e},z1B:"r",E8b:function(t,e){return t>=e},Y29:function(t,e){return t==e},k9k:function(t,e){return t===e},M2c:function(t,e){return t>=e},W6k:function(t,e){return t!==e},t2c:function(t,e){return t<=e},r4b:function(t,e){return t-e},u2k:function(t,e){return t==e},i5k:function(t,e){return t==e},j1c:function(t,e){return t>e},v4r:function(t,e){return t<e},H2r:function(t,e){return t<=e},Q9k:function(t,e){return t==e},y2r:function(t,e){return t!=e},j8r:function(t,e){return t-e},U0k:function(t,e){return t>e},E4c:function(t,e){return t==e},l2c:function(t,e){return t==e},N6r:function(t,e){return t>=e},J69:function(t,e){return t*e},z39:function(t,e){return t/e},D4b:function(t,e){return t==e},i9r:function(t,e){return t-e},R1k:function(t,e){return t>=e},n6k:function(t,e){return t==e},D9b:function(t,e){return t>=e},o9c:function(t,e){return t>e},s8r:function(t,e){return t-e},k49:function(t,e){return t==e},O39:function(t,e){return t>=e},P2c:function(t,e){return t===e},U0r:function(t,e){return t>=e},k39:function(t,e){return t===e},q9k:function(t,e){return t==e},v7r:function(t,e){return t&e},K8c:function(t,e){return t==e},C3c:function(t,e){return t*e},b8r:function(t,e){return t!=e},X7k:function(t,e){return t*e},L4k:function(t,e){return t*e},m7c:function(t,e){return t-e},x8k:function(t,e){return t/e},O49:function(t,e){return t==e},v69:function(t,e){return t>e},B0k:function(t,e){return t<e},G39:function(t,e){return t<e},v9k:function(t,e){return t<e},j0k:function(t,e){return t==e},c29:function(t,e){return t==e},R0c:function(t,e){return t-e},O1k:function(t,e){return t/e},r5B:null,a29:function(t,e){return t==e},I1r:function(t,e){return t==e},i8k:function(t,e){return t==e},u09:function(t,e){return t<=e},j99:function(t,e){return t-e},w4c:function(t,e){return t-e},j29:function(t,e){return t==e},P5k:function(t,e){return t>=e},c0r:function(t,e){return t>e},a0k:function(t,e){return t in e},d9c:function(t,e){return t instanceof e},t1r:function(t,e){return t==e},o2b:function(t,e){return t!=e},C0k:function(t,e){return t*e},e0b:function(t,e){return t<=e},L9r:function(t,e){return t==e},l1r:function(t,e){return t/e},G7r:function(t,e){return t!=e},R7r:function(t,e){return t-e},g3k:function(t,e){return t==e},V0b:function(t,e){return t*e},C19:function(t,e,i){return t-e+i},W89:function(t,e){return t==e},M8b:function(t,e){return t==e},W6b:function(t,e){return t<=e},E7c:function(t,e){return t-e},Y9c:function(t,e){return t==e},d0k:function(t,e){return t in e},k19:function(t,e){return t!=e},v3k:function(t,e){return t==e},c5r:function(t,e){return t==e},p3r:function(t,e){return t>=e},d29:function(t,e){return t==e},i8b:function(t,e){return t==e},n89:function(t,e){return t<e},B09:function(t,e){return t<e},V09:function(t,e){return t<e},D8c:function(t,e){return t===e},Z9b:function(t,e){return t<e},N6k:function(t,e){return t==e},X5B:"t",o09:function(t,e){return t/e},m9r:function(t,e){return t*e},U3c:function(t,e){return t>e},p6k:function(t,e){return t!==e},k2r:function(t,e){return t in e},C0b:function(t,e){return t!=e},Q5c:function(t,e){return t-e},u0b:function(t,e){return t==e},h79:function(t,e){return t<e},F2r:function(t,e){return t<e},q69:function(t,e){return t/e},e8r:function(t,e){return t<e},M8k:function(t,e){return t==e},u5r:function(t,e){return t<=e},E8c:function(t,e,i){return t-e+i},A9r:function(t,e){return t%e},B0b:function(t,e){return t<e},n1r:function(t,e){return t/e},D2r:function(t,e){return t==e},q7r:function(t,e){return t===e},v4k:function(t,e){return t<e},l4c:function(t,e){return t/e},B3c:function(t,e){return t!==e},F5c:function(t,e){return t==e},C7k:function(t,e){return t>e},j0r:function(t,e){return t<e},O4r:function(t,e){return t<e},w3r:function(t,e){return t-e},Y8r:function(t,e){return t-e},W1r:function(t,e){return t==e},x5k:function(t,e){return t<=e},d99:function(t,e){return t===e},d8c:function(t,e){return t!==e},p4c:function(t,e){return t===e},l5k:function(t,e){return t<=e},L5c:function(t,e){return t==e},F49:function(t,e){return t==e},i6r:function(t,e){return t===e},v4b:function(t,e){return t!==e},J59:function(t,e){return t<e},X6c:function(t,e){return t-e},j09:function(t,e){return t===e},w89:function(t,e){return t>e},T5c:function(t,e){return t<e},x89:function(t,e){return t==e},a1c:function(t,e){return t/e},O9k:function(t,e){return t==e},e0B:0,H1k:function(t,e){return t<e},h8c:function(t,e,i){return t-e+i},O4k:function(t,e){return t!=e},S5k:function(t,e){return t>=e},e0k:function(t,e){return t/e},r6c:function(t,e){return t===e},o99:function(t,e){return t/e},L0c:function(t,e){return t-e},B5r:function(t,e){return t!=e},M4c:function(t,e){return t==e},G6c:function(t,e){return t-e},R5c:function(t,e){return t==e},T4b:function(t,e){return t-e},a5r:function(t,e){return t&e},S3r:function(t,e){return t<=e},M9r:function(t,e){return t==e},l6r:function(t,e){return t>e},u3k:function(t,e){return t*e},W8b:function(t,e){return t==e},a79:function(t,e){return t/e},f3c:function(t,e){return t<e},X2k:function(t,e){return t/e},M5k:function(t,e){return t==e},d5r:function(t,e){return t===e},N59:function(t,e){return t/e},s1c:function(t,e){return t/e},S6k:function(t,e){return t!==e},r1k:function(t,e){return t-e},g2r:function(t,e){return t-e},U0b:function(t,e){return t-e},f79:function(t,e){return t==e},D5c:function(t,e){return t<e},G2r:function(t,e){return t-e},b2k:function(t,e){return t<e},R19:function(t,e){return t===e},P8b:function(t,e){return t>e},J6k:function(t,e){return t-e},B9c:function(t,e){return t*e},w1r:function(t,e,i){return t-e-i},C2k:function(t,e){return t>e},J5k:function(t,e){return t<e},B2k:function(t,e){return t<e},j2k:function(t,e){return t>e},A2c:function(t,e){return t-e},a2k:function(t,e){return t<e},c1c:function(t,e){return t/e},z49:function(t,e){return t==e},f9c:function(t,e){return t*e},v1k:function(t,e){return t/e},m5k:function(t,e){return t<=e},j5r:function(t,e){return t!==e},p8b:function(t,e){return t-e},o3c:function(t,e){return t<e},h5r:function(t,e){return t&e},L1k:function(t,e){return t==e},y0c:function(t,e){return t-e},H9r:function(t,e){return t>e},U2k:function(t,e){return t-e},u0k:function(t,e){return t!==e}},__microkernel_=f3B3.p6A.H6A("7c")?function(t){var i=f3B3.p6A.H6A("8f1")?"stroke":1762680575,r=f3B3.p6A.H6A("b73")?-635913296:"-",n=f3B3.p6A.H6A("f1f8")?1688924337:"pandf";if(f3B3.K2b.s2b(0,3676940)===i||f3B3.K2b.s2b(10,4963046)===r||f3B3.K2b.s2b(0,9313873)===n)var a=f3B3.p6A.H6A("165")?"Low":"/",l=f3B3.p6A.H6A("bc2")?"he":"highLowBars",h=f3B3.p6A.H6A("d3f4")?100:"object",c=f3B3.p6A.H6A("84f8")?6:.1,u=f3B3.p6A.H6A("3e")?1e3:"ray",d=.8,p=f3B3.p6A.H6A("75")?0:20,f="to",m=f3B3.p6A.H6A("6a")?"scroll":"Se",g=f3B3.p6A.H6A("857")?"pageY":"ta",b=f3B3.p6A.H6A("8332")?"newQuote":"Hi",C="lo",S="S",w=f3B3.p6A.H6A("f4cc")?"io":"split",M="re",T=".",B=f3B3.p6A.H6A("68fd")?"kagiClose":"nt",k="se",D=f3B3.p6A.H6A("6718")?4:"2",A="ain",F="mo",_="je",P="ec",E="C",L="ut",N="v",O="ot",z="N",I="om",R="en",H="ob",j="Clo",W="ata",V="D",U="ed",Y="ch",X="et",q="xt",Z="te",G="rde",K="gr",Q=!0,J=!1,$="ri",tt="der",et="f",it="id",rt="xi",nt="Y",at="ra",st=.5,ot="",lt="0",ht=10,ct="-",ut="cr",dt="ct",pt="stx",ft="ti",mt="p",gt="is",vt="in",yt="ee",xt="1",bt="ne",Ct="L",St="er",wt=". ",Mt=" ",Tt="tio",Bt="A",kt=": ",Dt="es",At="at",Ft="ay",_t="on",Pt="m",Et="Ax",Lt="dr",Nt="ft",Ot="bo",zt="xis",It="ar",Rt="u",Ht="or",jt="rd",Wt="nd",Vt="ou",Ut="de",Yt="x_",Xt="ro",qt="un",Zt="b",Gt="g",Kt="_",Qt="st",Jt="k",$t="o",te="tr",ee="ine",ie="l",re="le",ne="e",ae="c",se="x",oe="tx",le="a",he="d",ce=t.CIQ,ue=t.SplinePlotter;else context.fill(),position++;return ce.ChartEngine.prototype.drawXAxis=function(t,e){if(-1878210299!==f3B3.K2b.s2b(0,2942755)&&-295363901!==f3B3.K2b.s2b(10,6248960)&&-1497154363!==f3B3.K2b.s2b(0,2900169))return this.startLongHoldTimer(),S0b*Q0b;var i="   ",r="X",n=[t,e];if(!this.runPrepend(he+f3B3.z1B+le+f3B3.M0B+r+"Axi"+f3B3.T5B,n)&&e&&!t.xAxis.noDraw){var a=this.chart.context;this.canvasFont(f3B3.T5B+oe+"_xa"+se+f3B3.P4B+f3B3.T5B),a.textAlign=ae+ne+"nte"+f3B3.z1B,a.textBaseline="mid"+he+re;for(var s,o=a.measureText(i).width,l=0;f3B3.x3(l,e.length);l++){s=e[l];var h=a.measureText(s.text).width,c=Math.max(h+o,t.xAxis.minimumLabelWidth);s.hz=Math.floor(s.hz+this.micropixels)+.5,s.left=f3B3.J3(s.hz,c/2),s.right=s.hz+f3B3.o99(c,2),s.unpaddedRight=s.hz+f3B3.K99(h,2)}var u=new ce.Plotter;u.newSeries(ie+ee,f3B3.T5B+te+$t+Jt+ne,this.canvasStyle(Qt+se+Kt+Gt+"rid")),u.newSeries(Zt+$t+qt+"dary",f3B3.T5B+f3B3.X5B+Xt+Jt+ne,this.canvasStyle(Qt+Yt+Gt+f3B3.z1B+f3B3.P4B+he+"_d"+le+f3B3.z1B+Jt)),u.newSeries(Zt+$t+f3B3.z1B+Ut+f3B3.z1B,"stro"+Jt+ne,this.canvasStyle(Qt+se+Kt+"gri"+he+"_bord"+ne+f3B3.z1B));var d=f3B3.s99(this.xAxisAsFooter,!0)?this.chart.canvasHeight:t.panel.bottom,p=this.whichPanel(f3B3.j99(d,1));if(p){var f=p.yAxis;this.adjustYAxisHeightOffset(p,f);var m=-1,g=Math.MAX_VALUE,v=t.xAxis.displayBorder||f3B3.e99(t.xAxis.displayBorder,null);f3B3.d99(this.axisBorders,!0)&&(v=!0),f3B3.h99(this.axisBorders,!1)&&(v=!1);var y=v?f3B3.C99(f.bottom,.5):f.bottom;y+=f.bottomOffset;var x=f3B3.V99(d,this.xaxisHeight/2);v&&(x+=3);for(var b=0;f3B3.c99(b,e.length);b++)if(f3B3.Y99(e[b].grid,Zt+Vt+Wt+"ary")){g=e[b].left;break}for(var C=0;f3B3.X99(C,e.length);C++){if(s=e[C],f3B3.a99(C,b)){for(b++;f3B3.u99(b,e.length);b++)if(f3B3.b99(e[b].grid,Zt+$t+qt+he+le+f3B3.z1B+f3B3.r4B)){g=e[b].left;break}if(f3B3.B99(b,e.length)&&(b=-1,g=Math.MAX_VALUE),m>-1&&f3B3.f99(s.left,m))continue}else{if(m>-1&&f3B3.U99(s.left,m))continue;if(f3B3.v69(s.right,g))continue}m=s.right,f3B3.g69(Math.floor(s.unpaddedRight),this.chart.right)&&(f3B3.T69(Math.floor(s.hz),this.chart.left)&&(t.xAxis.displayGridLines&&(u.moveTo(s.grid,s.hz,f3B3.G69(this.xAxisAsFooter,!0)?0:f.top),u.lineTo(s.grid,s.hz,y)),v&&(u.moveTo(Zt+$t+jt+ne+f3B3.z1B,s.hz,y+.5),u.lineTo(Zt+Ht+he+ne+f3B3.z1B,s.hz,y+6))),this.canvasColor(f3B3.r69(s.grid,Zt+$t+Rt+f3B3.G2B+he+It+f3B3.r4B)?f3B3.T5B+f3B3.X5B+Yt+"xax"+f3B3.P4B+f3B3.T5B+"_da"+f3B3.z1B+Jt:f3B3.T5B+oe+Kt+"xa"+zt),a.fillText(s.text,s.hz,x))}if(v){var S=Math.round(f.bottom+f.bottomOffset)+.5,w=Math.round(t.right)+.5;u.moveTo(Ot+"rder",t.left,S),u.lineTo(Zt+$t+jt+ne+f3B3.z1B,w,S)}u.draw(a),a.textAlign=ie+ne+Nt,this.runAppend(Lt+le+f3B3.M0B+r+Et+f3B3.P4B+f3B3.T5B,n)}}},ce.ChartEngine.prototype.createTickXAxisWithDates=function(t){if(-723223086!==f3B3.K2b.s2b(0,6212696)&&378916809!==f3B3.K2b.s2b(10,1717020)&&1067466167!==f3B3.K2b.s2b(0,8182199))return O3r-V3r;var i="lin",r="ry",n="undar",a=" < ",s="G",o="P",l="thD",h="sWi",c="XA",u="eTi",d="ek",p="nu",f="cond",m="isec",g="ute";t||(t=this.chart),t.xaxis=[];var v,y=[ce.MILLISECOND,ce.SECOND,ce.MINUTE,ce.HOUR,ce.DAY,ce.MONTH,ce.YEAR];ce.ChartEngine.isDailyInterval(this.layout.interval)&&y.splice(1,3),this.timeIntervalMap||(v={},v[ce.MILLISECOND]={arr:[1,2,5,10,20,50,100,250,500],minTimeUnit:0,maxTimeUnit:1e3},v[ce.SECOND]={arr:[1,2,3,4,5,6,10,12,15,20,30],minTimeUnit:0,maxTimeUnit:60},v[ce.MINUTE]={arr:[1,2,3,4,5,6,10,12,15,20,30],minTimeUnit:0,maxTimeUnit:60},v[ce.HOUR]={arr:[1,2,3,4,6,12],minTimeUnit:0,maxTimeUnit:24},v[ce.DAY]={arr:[1,2,7,14],minTimeUnit:1,maxTimeUnit:32},v[ce.MONTH]={arr:[1,2,3,6],minTimeUnit:1,maxTimeUnit:13},v[ce.YEAR]={arr:[1,2,3,5],minTimeUnit:1,maxTimeUnit:2e7},v[ce.DECADE]={arr:[10],minTimeUnit:0,maxTimeUnit:2e6},this.timeIntervalMap=v),v=this.timeIntervalMap;for(var x=[31,28,31,30,31,30,31,31,30,31,30,31],b=this.layout.periodicity,C=this.layout.interval,S=t.maxTicks,w=t.dataSegment,M=t.xAxis,T=w.length,B=M.idealTickSizePixels||M.autoComputedTickSizePixels,k=f3B3.q69(this.chart.width,B),D=0;f3B3.y69(D,T)&&!w[D];D++);if(f3B3.O69(D,T))return[];var A=0,F=this.layout.timeUnit||Pt+f3B3.P4B+f3B3.G2B+g;isNaN(C)&&(F=C,C=1);var _=0;switch(F){case Pt+f3B3.P4B+ie+ie+m+_t+he:_=1;break;case f3B3.T5B+ne+f:_=1e3;break;case Pt+f3B3.P4B+p+f3B3.X5B+ne:_=6e4;break;case he+le+f3B3.r4B:_=864e5;break;case f3B3.M0B+ne+d:_=f3B3.Z69(864e5,7);break;case Pt+$t+f3B3.G2B+f3B3.X5B+f3B3.v4B:_=f3B3.F69(864e5,30)}A=_?f3B3.Q69(C,b,_,T):f3B3.n69(w[T-1].DT.getTime(),w[D].DT.getTime());var P=this;A=f3B3.N69(A,0)?f3B3.x69(function(){if(-1700791597===f3B3.K2b.s2b(0,4473725)||-257301634===f3B3.K2b.s2b(10,3314552)||48604e3===f3B3.K2b.s2b(0,5055489)){var i={begin:new Date,interval:he+Ft,periodicity:1,inZone:this.dataZone,outZone:this.dataZone},r=t.market.newIterator(i);r.next()}else renderer.draw(),e.stopPropagation();var n=r.previous();r=P.standardMarketIterator(n,null,t);var a=r.next();return f3B3.l69(a.getTime(),n.getTime())}(),S):f3B3.J69(A/T,S);var E,L=f3B3.o09(A,k);for(E=0;f3B3.K09(E,y.length)&&!f3B3.s09(y[E],L+.001);E++);if(f3B3.j09(E,0)&&console.log(ae+f3B3.z1B+ne+At+u+ae+Jt+c+se+f3B3.P4B+h+l+At+Dt+kt+Bt+f3B3.T5B+f3B3.T5B+ne+f3B3.z1B+Tt+f3B3.G2B+Mt+ne+f3B3.z1B+f3B3.z1B+$t+f3B3.z1B+wt+Pt+f3B3.T5B+o+St+s+f3B3.z1B+f3B3.P4B+he+Ct+f3B3.P4B+bt+a+xt),f3B3.e09(E,y.length))E--;else if(f3B3.d09(E,0)){var N=y[f3B3.h09(E,1)],O=v[N].arr,z=O[f3B3.C09(O.length,1)];f3B3.V09(L-N*z,y[E]-L)&&E--}var I=M.timeUnit||y[E];M.activeTimeUnit=I;var R=ce.clone(v[I]),H=R.arr;for(E=0;f3B3.c09(E,H.length)&&!f3B3.Y09(H[E]*I,L);E++);f3B3.X09(E,H.length)?E--:f3B3.a09(L-H[E-1]*I,H[E]*I-L)&&E--;var j=M.timeUnitMultiplier||H[E],W=[],V=this.layout.candleWidth;for(E=0;f3B3.u09(E,S)&&!w[E];E++);if(f3B3.b09(E,0)&&f3B3.B09(E,S))for(var U=this.standardMarketIterator(w[E].DT,M.adjustTimeZone?this.displayZone:this.dataZone),Y=E;f3B3.f09(Y,0);Y--){var X={};if(!t.lineApproximation||!f3B3.U09(V,1)){var q=U.previous();X.DT=q}t.xaxis.unshift(X)}var Z=0,G=R.minTimeUnit,K=-1,Q=!0,J=null;for(E;f3B3.v49(E,S);E++){if(f3B3.g49(E,T)){var $=w[E];if($||($=t.xaxis[E]),Z=$.displayDate&&M.adjustTimeZone?$.displayDate:$.DT,E&&t.segmentImage){var tt=t.segmentImage[E];V=f3B3.T49(tt.leftOffset-tt.candleWidth/2,E)}}else{if(f3B3.G49(this.layout.interval,f3B3.X5B+f3B3.P4B+ae+Jt)&&!M.futureTicksInterval)break;if(t.lineApproximation&&f3B3.r49(V,1))break;if(!M.futureTicks)break;J||(J=this.standardMarketIterator(w[f3B3.q49(T,1)].DT,M.adjustTimeZone?this.displayZone:this.dataZone)),Z=J.next()}var et={DT:Z};f3B3.y49(E,T)?et.data=w[E]:et.data=null,t.xaxis.push(et);var it,rt;f3B3.O49(I,ce.MILLISECOND)?(it=Z.getMilliseconds(),rt=Z.getSeconds()):f3B3.Z49(I,ce.SECOND)?(it=Z.getSeconds(),rt=Z.getMinutes()):f3B3.F49(I,ce.MINUTE)?(it=Z.getMinutes(),rt=Z.getHours()):f3B3.Q49(I,ce.HOUR)?(it=Z.getHours()+f3B3.H49(Z.getMinutes(),60),rt=Z.getDate()):f3B3.R49(I,ce.DAY)?(it=Z.getDate(),rt=Z.getMonth()+1):f3B3.z49(I,ce.MONTH)?(it=Z.getMonth()+1,rt=Z.getFullYear()):f3B3.k49(I,ce.YEAR)?(it=Z.getFullYear(),rt=Z.getFullYear()+1e3):(it=Z.getFullYear(),rt=0);var nt,at=null;if(f3B3.L49(K,rt)&&(f3B3.D49(it,G)&&(G=R.minTimeUnit),nt=t.left+f3B3.I89(E,V)-1,at=null,f3B3.W89(I,ce.HOUR)||f3B3.M89(I,ce.MINUTE)&&f3B3.t89(K,rt)?at=M.formatter?M.formatter(Z,Zt+$t+n+f3B3.r4B,ce.DAY,1):this.internationalizer?this.internationalizer.monthDay.format(Z):Z.getMonth()+1+"/"+Z.getDate():f3B3.i89(I,ce.DAY)?at=f3B3.w89(K,rt)?M.formatter?M.formatter(Z,Zt+$t+qt+he+le+f3B3.z1B+f3B3.r4B,ce.YEAR,1):Z.getFullYear():M.formatter?M.formatter(Z,Ot+qt+he+It+f3B3.r4B,ce.MONTH,1):ce.monthAsDisplay(Z.getMonth(),!1,this):f3B3.A89(I,ce.MONTH)&&(at=M.formatter?M.formatter(Z,Zt+Vt+f3B3.G2B+he+le+r,ce.YEAR,1):Z.getFullYear()),at&&-1!=K&&W.push(new ce.ChartEngine.XAxisLabel(nt,Zt+$t+Rt+f3B3.G2B+he+le+f3B3.z1B+f3B3.r4B,at))),f3B3.E89(it,G)){if(f3B3.P89(G,R.minTimeUnit)&&f3B3.m89(rt,K))continue;var st=new Date(+Z);nt=t.left+f3B3.S89((2*E+1)*V,2)-1;var ot=f3B3.p89(Math.floor(it/j),j);if(f3B3.n89(ot,it)&&(f3B3.l89(this.layout.interval,f3B3.M0B+yt+Jt)?ot=it:nt-=f3B3.N89(V,2)),f3B3.x89(I,ce.MILLISECOND)?st.setMilliseconds(ot):f3B3.J89(I,ce.SECOND)?(st.setMilliseconds(0),st.setSeconds(ot)):f3B3.o29(I,ce.MINUTE)?(st.setMilliseconds(0),st.setSeconds(0),st.setMinutes(ot)):f3B3.K29(I,ce.HOUR)?(st.setMilliseconds(0),st.setSeconds(0),st.setMinutes(0),st.setHours(ot)):f3B3.s29(I,ce.DAY)?st.setDate(Math.max(1,ot)):f3B3.j29(I,ce.MONTH)?(st.setDate(1),st.setMonth(f3B3.e29(ot,1))):(f3B3.d29(I,ce.YEAR),st.setDate(1),st.setMonth(0)),G=ot+j,f3B3.h29(I,ce.DAY)&&(R.maxTimeUnit=x[st.getMonth()]+1),f3B3.C29(G,R.maxTimeUnit)&&(G=R.minTimeUnit),K=rt,Q&&f3B3.V29(ot,it)){Q=!1;continue}at=M.formatter?M.formatter(st,i+ne,I,j):f3B3.c29(I,ce.DAY)?st.getDate():f3B3.Y29(I,ce.MONTH)?ce.monthAsDisplay(Z.getMonth(),!1,this):f3B3.X29(I,ce.YEAR)||f3B3.a29(I,ce.DECADE)?st.getFullYear():ce.timeAsDisplay(st,this,I),W.push(new ce.ChartEngine.XAxisLabel(nt,ie+vt+ne,at))}}return W},
ce.ChartEngine.prototype.createYAxis=function(t,e){if(!this.runPrepend(ae+f3B3.z1B+ne+le+f3B3.X5B+ne+"YA"+se+gt,arguments)){var i=t.chart,r=f3B3.u29(t.name,i.name);e||(e={}),e.noChange=!1;var n=e.yAxis?e.yAxis:t.yAxis;if(ce.ChartEngine.enableCaching&&f3B3.b29(n.high,t.cacheHigh)&&f3B3.B29(n.low,t.cacheLow)){var a=f3B3.f29(i.dataSet.length,i.scroll,1),s=a+i.maxTicks+1;t.cacheLeft=a,t.cacheRight=s,e.noChange=!0}else t.cacheLeft=1e6,t.cacheRight=-1,t.cacheHigh=n.high,t.cacheLow=n.low;var o=i.xAxis.idealTickSizePixels?i.xAxis.idealTickSizePixels:i.xAxis.autoComputedTickSizePixels;if(n.goldenRatioYAxis&&f3B3.o19(n.idealTickSizePixels,o/1.618)&&(e.noChange=!1),!e.noChange){this.adjustYAxisHeightOffset(t,n);var l=n.height=f3B3.K19(n.bottom,n.top),h=f3B3.s19(n.high-n.low,l-n.zoom);if(e.ground&&!n.semiLog)n.high=n.high+f3B3.j19(n.zoom,h);else{n.high=n.high+f3B3.e19(n.zoom/2,h)+f3B3.d19(n.scroll,h);var c=n.low;if(n.semiLog){var u=f3B3.h19(n.zoom/2*h,n.high/n.low);n.low=f3B3.C19(n.low,u,n.scroll*h),f3B3.P19(n.low,.1*c)&&(n.low=f3B3.m19(c,.1))}else n.low=f3B3.S19(n.low,n.zoom/2*h,n.scroll*h)}if((n.min||f3B3.H19(n.min,0))&&(n.low=n.min),(n.max||f3B3.R19(n.max,0))&&(n.high=n.max),n.shadow=f3B3.z19(n.high,n.low),n.semiLog&&(!this.activeDrawing||f3B3.k19(this.activeDrawing.name,mt+f3B3.z1B+"oj"+ne+ae+ft+$t+f3B3.G2B))){n.logHigh=f3B3.L19(Math.log(n.high),Math.LN10);var d=Math.max(n.low,1e-9);n.logLow=f3B3.D19(Math.log(d),Math.LN10),f3B3.I59(n.low,0)&&(n.logLow=0),n.logShadow=f3B3.W59(n.logHigh,n.logLow)}var p;n.goldenRatioYAxis&&r?(n.idealTickSizePixels=f3B3.M59(o,1.618),f3B3.t59(n.idealTickSizePixels,0)&&(p=this.getCanvasFontSize(Qt+Yt+"ya"+se+f3B3.P4B+f3B3.T5B),n.idealTickSizePixels=f3B3.i59(p,5))):n.idealTickSizePixels||(p=this.getCanvasFontSize(pt+Kt+f3B3.r4B+le+zt),n.idealTickSizePixels=r?f3B3.w59(p,5):f3B3.A59(p,2));var f=Math.round(f3B3.E59(l,n.idealTickSizePixels)),m=e.range?f3B3.P59(e.range[1],e.range[0]):n.shadow;n.priceTick=Math.floor(f3B3.m59(m,f));for(var g=1,v=0;f3B3.S59(v,10)&&!f3B3.p59(n.priceTick,0);v++)g*=10,n.priceTick=f3B3.n59(Math.floor(m/f*g),g);f3B3.l59(v,10)&&(n.priceTick=1e-8),n.priceTick=f3B3.N59(Math.round(m/f*g),g);var y=Math.round(f3B3.x59(m,n.priceTick));if(e.range&&f3B3.J59(y,m)&&!n.noEvenDivisorTicks){for(;f3B3.o79(y,1)&&!f3B3.K79(m%y,0);)y--;n.priceTick=f3B3.s79(m,y)}if(n.minimumPriceTick){var x=n.minimumPriceTick;p=this.getCanvasFontSize(f3B3.T5B+f3B3.X5B+se+Kt+f3B3.r4B+le+se+f3B3.P4B+f3B3.T5B);for(var b=0;f3B3.j79(b,100);b++){var C=f3B3.e79(m,x);if(!f3B3.d79(l/C,2*p))break;x+=n.minimumPriceTick}f3B3.h79(b,100)&&(n.priceTick=x)}n.multiplier=f3B3.C79(n.height,n.shadow)}if((f3B3.V79(n.priceTick,0)||f3B3.c79(n.priceTick,1/0))&&(n.priceTick=1),!this.activeDrawing||f3B3.Y79(this.activeDrawing.name,mt+f3B3.z1B+$t+f3B3.b4B+ne+dt+f3B3.P4B+$t+f3B3.G2B)){if(n.high=this.transformedPriceFromPixel(n.top,t,n),n.semiLog){n.logHigh=f3B3.X79(Math.log(n.high),Math.LN10);var S=Math.max(n.low,1e-11);n.logLow=f3B3.a79(Math.log(S),Math.LN10),n.logShadow=f3B3.u79(n.logHigh,n.logLow)}n.shadow=f3B3.b79(n.high,n.low)}if(n.multiplier=f3B3.B79(n.height,n.shadow),f3B3.f79(n.multiplier,1/0)&&(n.multiplier=0),!n.decimalPlaces&&f3B3.U79(n.decimalPlaces,0))if(r){for(var w=0,M=0;f3B3.v39(M,t.yAxis.shadowBreaks.length);M++){var T=t.yAxis.shadowBreaks[M];f3B3.g39(t.yAxis.shadow,T[0])&&(w=T[1])}n.printDecimalPlaces=w}else n.printDecimalPlaces=null;else n.printDecimalPlaces=n.decimalPlaces;this.runAppend(ut+"eateYAx"+gt,arguments)}},ce.ChartEngine.prototype.drawYAxis=function(t,e){e||(e={});var i=e.yAxis?e.yAxis:t.yAxis;if(!t.hidden&&!i.noDraw){if(f3B3.T39(i.priceFormatter,ce.Comparison.priceFormat)&&(i.fractional?(i.originalPriceFormatter||(i.originalPriceFormatter={func:i.priceFormatter}),i.fractional.resolution||(i.fractional.resolution=i.minimumPrice),i.fractional.formatter||(i.fractional.formatter="'"),i.priceFormatter||(i.priceFormatter=function(t,e,r){if(-1952507416!==f3B3.K2b.s2b(0,8630541)&&1339949955!==f3B3.K2b.s2b(10,5261494)&&1007069366!==f3B3.K2b.s2b(0,3721708))return points.push(endX,threshold),x0r-L0r;if(i.fractional){var n="";f3B3.G39(r,f3B3.e0B)&&(n=ct,r=Math.abs(r));var a=Math.floor(f3B3.r39(Math.round(r/i.fractional.resolution),i.fractional.resolution)),s=Math.round(f3B3.q39(r-a,i.fractional.resolution)),o=Math.floor(s);return n+a+i.fractional.formatter+(f3B3.y39(o,ht)?lt:ot)+o+(f3B3.O39(s-o,st)?"+":ot)}})):i.originalPriceFormatter&&(i.priceFormatter=i.originalPriceFormatter.func,i.originalPriceFormatter=f3B3.r5B)),i.pretty)return this.drawYAxisPretty(t,e);if(!this.runPrepend(he+at+f3B3.M0B+nt+Et+gt,arguments)){if(!e.noDraw&&!i.noDraw){var r=i.yAxisPlotter;if(!r||!e.noChange){r=i.yAxisPlotter=new ce.Plotter;var n=t.chart,a=f3B3.Z39(t.name,n.name)&&f3B3.F39(i.name,t.yAxis.name);if(!i.priceTick)return;var s=i.shadow,o=e.range;o&&(s=f3B3.Q39(o[f3B3.r0B],o[f3B3.e0B]));var l=f3B3.H39(s,i.priceTick);l=Math.round(l);var h,c;i.semiLog&&(h=f3B3.R39(Math.log(this.valueFromPixel(i.bottom,t)),Math.LN10),c=f3B3.z39(i.logHigh-i.logLow,l));var u=i.textStyle?i.textStyle:f3B3.T5B+f3B3.X5B+se+Kt+f3B3.r4B+le+rt+f3B3.T5B;r.newSeries(Gt+f3B3.z1B+it,f3B3.T5B+f3B3.X5B+Xt+Jt+ne,this.canvasStyle(f3B3.T5B+oe+Kt+Gt+f3B3.z1B+it)),r.newSeries(f3B3.X5B+ne+se+f3B3.X5B,et+"ill",this.colorOrStyle(u)),r.newSeries(Zt+Ht+tt,Qt+Xt+"ke",this.canvasStyle(f3B3.T5B+f3B3.X5B+se+"_g"+$+he+Kt+Zt+$t+f3B3.z1B+he+ne+f3B3.z1B));var d=f3B3.e0B,p=o?o[f3B3.r0B]:i.high,f=o?o[f3B3.e0B]:i.low,m=f3B3.k39(i.displayBorder,f3B3.r5B)?n.panel.yAxis.displayBorder:i.displayBorder;f3B3.L39(this.axisBorders,J)&&(m=J),f3B3.D39(this.axisBorders,Q)&&(m=Q);var g,v=f3B3.I9r(i.position,f3B3.r5B)?n.panel.yAxis.position:i.position;g=f3B3.W9r(v,ie+ne+et+f3B3.X5B)?i.left+i.width:i.left;var y=Math.round(g)+st,x=m?f3B3.q0B:f3B3.e0B;f3B3.M9r(v,ie+ne+Nt)&&(x=m?-f3B3.q0B:f3B3.e0B),d=a?f3B3.t9r(i.shadow,f3B3.r0B)?f3B3.i9r((parseInt(f/i.priceTick,ht)+f3B3.r0B)*i.priceTick,f):f3B3.w9r(i.priceTick,Math.round(f%i.priceTick*t.chart.roundit)/t.chart.roundit):f3B3.A9r(p,i.priceTick);for(var b=this.getCanvasFontSize(f3B3.T5B+"tx_"+f3B3.r4B+le+se+f3B3.P4B+f3B3.T5B),C=f3B3.e0B;f3B3.E9r(C,l);C++){var S;if(i.semiLog){var w=h+f3B3.P9r(C,c);S=Math.pow(ht,w)}else S=a?f+f3B3.m9r(C,i.priceTick)+d:f3B3.S9r(p,C*i.priceTick,d);var M=this.pixelFromTransformedValue(S,t,i),T=Math.round(M)+st;if(!f3B3.H9r(T+b/f3B3.d0B,t.bottom)&&!f3B3.R9r(T-b/f3B3.d0B,t.top)){i.displayGridLines&&(r.moveTo(K+it,t.left+1,T),r.lineTo(Gt+$+he,f3B3.z9r(t.right,1),T)),m&&(r.moveTo(Zt+Ht+he+ne+f3B3.z1B,f3B3.k9r(y,.5),T),r.lineTo(Zt+$t+G+f3B3.z1B,y+x,T)),S=i.priceFormatter?i.priceFormatter(this,t,S):this.formatYAxisPrice(S,t,f3B3.r5B,i);var B=i.textBackground?this.containerColor:f3B3.r5B,k=g+x+f3B3.q0B;f3B3.L9r(v,re+Nt)?(k=i.left+f3B3.q0B,i.justifyRight&&(k=i.left+i.width+x-3)):i.justifyRight&&(k=g+i.width),r.addText(Z+q,S,k,T,B,f3B3.r5B,b)}}if(m){var D=Math.round(i.bottom)+st;r.moveTo(Zt+Ht+he+ne+f3B3.z1B,y,i.top),r.lineTo(Ot+jt+ne+f3B3.z1B,y,D),r.draw(this.chart.context,Zt+$t+jt+St)}}this.plotYAxisGrid(t)}this.runAppend(he+f3B3.z1B+le+f3B3.M0B+nt+Bt+se+gt,arguments)}}},ce.ChartEngine.prototype.drawYAxisPretty=function(t,e){if(-773515849!==f3B3.K2b.s2b(0,8693671)&&89868966!==f3B3.K2b.s2b(10,2950735)&&-409770592!==f3B3.K2b.s2b(0,9294093))return this.calculateOHLC4(chart,newScrubbed),context.lineTo(flr_xbase,pxBottom),this.moveCount++,C49<E49;var i="bor";if(!this.runPrepend(he+f3B3.z1B+le+f3B3.M0B+nt+Bt+rt+f3B3.T5B,arguments)){e||(e={});var r=e.yAxis?e.yAxis:t.yAxis;if(!e.noDraw&&!r.noDraw){var n=r.yAxisPlotter;if(!n||!e.noChange){n=r.yAxisPlotter=new ce.Plotter;var a=t.chart;if(!r.priceTick)return;if(isNaN(r.high)||isNaN(r.low))return;var s=r.shadow;e.range&&(s=f3B3.D9r(e.range[1],e.range[0]));var o=f3B3.I6r(r.height,r.idealTickSizePixels);o=Math.round(o);var l=r.textStyle?r.textStyle:f3B3.T5B+f3B3.X5B+se+"_ya"+se+f3B3.P4B+f3B3.T5B;n.newSeries(K+f3B3.P4B+he,Qt+f3B3.z1B+"ok"+ne,this.canvasStyle(f3B3.T5B+oe+Kt+Gt+f3B3.z1B+f3B3.P4B+he)),n.newSeries(f3B3.X5B+ne+se+f3B3.X5B,"fi"+ie+ie,this.colorOrStyle(l)),n.newSeries(Zt+$t+f3B3.z1B+he+St,f3B3.T5B+f3B3.X5B+f3B3.z1B+"oke",this.canvasStyle(f3B3.T5B+f3B3.X5B+"x_g"+$+"d_"+Ot+f3B3.z1B+he+ne+f3B3.z1B));var h=e.range,c=h?h[1]:r.high,u=h?h[0]:r.low,d=f3B3.W6r(r.displayBorder,null)?a.panel.yAxis.displayBorder:r.displayBorder;f3B3.M6r(this.axisBorders,!1)&&(d=!1),f3B3.t6r(this.axisBorders,!0)&&(d=!0);var p,f=f3B3.i6r(r.position,null)?a.panel.yAxis.position:r.position;p=f3B3.w6r(f,ie+"ef"+f3B3.X5B)?r.left+r.width:r.left;var m=Math.round(p)+.5,g=d?3:0;f3B3.A6r(f,re+Nt)&&(g=d?-3:0);for(var v=this.getCanvasFontSize(f3B3.T5B+f3B3.X5B+se+Kt+f3B3.r4B+"axis"),y=r.increments,x=y.length,b=0,C=1,S=0,w=0,M=0,T=Number.MAX_VALUE,B=0;f3B3.E6r(B,100);B++){S=f3B3.P6r(y[b],Math.pow(10,M)),C=Math.floor(f3B3.m6r(s,S));var k=Math.abs(f3B3.S6r(o,C));if(f3B3.p6r(k,T))break;if(T=k,f3B3.n6r(C,o)){w=S;break}f3B3.l6r(C,o)?(b++,f3B3.N6r(b,x)&&(b=0,M++)):(b--,f3B3.x6r(b,0)&&(b=f3B3.J6r(x,1),M--)),w=S}var D=f3B3.o0r(Math.ceil(u/w),w),A=f3B3.K0r(r.bottom,this.pixelFromTransformedValue(D,t,r)),F=0;if(f3B3.s0r(A,r.idealTickSizePixels)&&r.semiLog&&r.prettySemiLog){var _;for(_=Math.ceil(u);f3B3.j0r(_,D)&&f3B3.e0r(D%_,0);++_);f3B3.d0r(_,D)&&(f3B3.h0r(D,w)&&(w=_,F=_),D=_)}for(var P=0,E=Number.MAX_VALUE,L=0;f3B3.C0r(L,100);L++){var N=D+f3B3.V0r(P,w);if(f3B3.c0r(N,c))break;w+=F,P++;var O=this.pixelFromTransformedValue(N,t,r);if(f3B3.Y0r(E-O,v+1)&&f3B3.X0r(F,0))L=P=0,E=Number.MAX_VALUE,w=F,F*=2,n.reset();else{E=O;var z=Math.round(O)+.5;if(!f3B3.a0r(z+v/2,t.bottom)&&!f3B3.u0r(z-v/2,t.top)){r.displayGridLines&&(n.moveTo(Gt+f3B3.z1B+f3B3.P4B+he,t.left+1,z),n.lineTo(Gt+f3B3.z1B+f3B3.P4B+he,f3B3.b0r(t.right,1),z)),d&&(n.moveTo(i+he+ne+f3B3.z1B,f3B3.B0r(m,.5),z),n.lineTo(i+he+ne+f3B3.z1B,m+g,z)),N=r.priceFormatter?r.priceFormatter(this,t,N):this.formatYAxisPrice(N,t,null,r);var I=r.textBackground?this.containerColor:null,R=p+g+3;f3B3.f0r(f,"left")?(R=r.left+3,r.justifyRight&&(R=r.left+r.width+g-3)):r.justifyRight&&(R=p+r.width),n.addText(f3B3.X5B+ne+q,N,R,z,I,null,v)}}}if(f3B3.U0r(L,100)&&console.log(he+f3B3.z1B+le+f3B3.M0B+nt+Bt+se+f3B3.P4B+f3B3.T5B+"Pr"+X+f3B3.X5B+f3B3.r4B+kt+le+"ss"+St+f3B3.X5B+f3B3.P4B+$t+f3B3.G2B+Mt+ne+f3B3.z1B+Xt+f3B3.z1B+wt+f3B3.X4B+f3B3.X4B+Mt+f3B3.z1B+ne+le+Y+U+Mt+xt+lt+lt),d){var H=Math.round(r.bottom)+.5;n.moveTo(i+he+ne+f3B3.z1B,m,r.top),n.lineTo(Zt+$t+f3B3.z1B+he+St,m,H),n.draw(this.chart.context,Ot+f3B3.z1B+he+ne+f3B3.z1B)}}this.plotYAxisGrid(t)}this.runAppend(he+at+"wY"+Bt+rt+f3B3.T5B,arguments)}},ce.ChartEngine.prototype.drawHistogram=function(t,e){function i(t,e,i,r,a,l,h,c,d){r||(r=1),C.globalAlpha=ce.isIE8?.5:r,C.beginPath();for(var f=y+.5,m=Math.floor(f3B3.N4r(T.pixelFromBar(0,n.chart),T.layout.candleWidth/2)),g=m,v=0;f3B3.x4r(v,o.length);v++){var x=M[v]||y;if(f3B3.J4r(v,0)&&(f=x),o[v]&&o[v][t]){var B=o[v],k=B[t];typeof k==$t+Zt+f3B3.b4B+ne+ae+f3B3.X5B&&k[e]&&(k=k[e]);var D=f3B3.o8r(k-p,u);if(!isNaN(D)){var A=T.layout.candleWidth;B.candleWidth&&(A=B.candleWidth,f3B3.K8r(v,0)&&(m=g=Math.floor(f3B3.s8r(T.pixelFromBar(0,n.chart),B.candleWidth/2))));var F=Math.min(Math.floor(f3B3.j8r(x,D))+.5,x);if(d&&-1==d.indexOf(v)||!d&&(l&&f3B3.e8r(B.Close,B.iqPrevClose)||!l&&f3B3.d8r(B.Close,B.iqPrevClose)))f=F,g+=A;else{var _,P,E,N=f3B3.h8r(A,T.layout.candleWidth);S?(_=Math.round(g+f3B3.C8r(S+h*c,N)),P=_+(a?0:b),E=_+Math.round(f3B3.V8r(c,N))-(a?0:b)):(_=g+f3B3.c8r(S+h*c,N),P=Math.round(_)+(a?0:b),E=f3B3.Y8r(Math.round(_+c*N),a?0:b)),f3B3.X8r(E-P,2)&&(E=P+1);var O=a?0:.5;f3B3.a8r(P%1,O)&&(P+=.5),f3B3.u8r(E%1,O)&&(E+=.5),C.moveTo(E,x),f3B3.b8r(y,x)&&a&&!S&&M[v+1]&&C.moveTo(E,Math.max(F,Math.min(x,M[v+1]))),C.lineTo(E,F),C.lineTo(P,F),a&&h?(f3B3.B8r(w[v],F)||f3B3.f8r(v,0))&&C.lineTo(P,Math.min(x,w[v])):a&&!S&&f3B3.U8r(s,ae+ie+Rt+f3B3.T5B+"ter"+U)?f3B3.v2r(v,0)&&w[f3B3.g2r(v,1)]&&f3B3.T2r(w[v-1],F)&&C.lineTo(P,Math.min(x,w[f3B3.G2r(v,1)])):a&&!S?(f3B3.r2r(f,F)||f3B3.q2r(v,0))&&C.lineTo(P,Math.min(x,f)):C.lineTo(P,x),f=F,g+=A,(f3B3.y2r(s,ae+ie+Rt+f3B3.T5B+f3B3.X5B+ne+f3B3.z1B+ne+he)||a)&&(w[v]=F)}}}else f=x,g+=T.layout.candleWidth}a?(C.strokeStyle=!i||f3B3.O2r(i,le+L+$t)?T.defaultColor:i,C.stroke()):(C.fillStyle=!i||f3B3.Z2r(i,le+L+$t)?T.defaultColor:i,C.fill()),C.closePath()}if(e&&e.length){var r=t.panel;r||(r=Y+le+"rt");var n=this.panels[r];if(n){var a=t.yAxis?t.yAxis:n.yAxis,s=t.subtype,o=this.chart.dataSegment,l=!1;this.getDefaultColor();var h,c;for(c=0;f3B3.v4r(c,e.length);c++)l|=e[c].border_color_up&&!ce.isTransparent(e[c].border_color_up),l|=e[c].border_color_down&&!ce.isTransparent(e[c].border_color_down);f3B3.g4r(t.borders,!1)&&(l=!1),t.name||(t.name=V+W);var u=a.multiplier;t.heightPercentage||(t.heightPercentage=.7),t.widthFactor||(t.widthFactor=.8);for(var d=0,p=0,f=0;f3B3.T4r(f,this.chart.maxTicks);f++){var m=o[f];if(m){var g=0;for(c=0;f3B3.G4r(c,e.length);c++){var v=m[e[c].field];(v||f3B3.r4r(v,0))&&(h=e[c].subField||this.chart.defaultPlotField||j+f3B3.T5B+ne,typeof v==H+f3B3.b4B+ne+ae+f3B3.X5B&&v[h]&&(v=v[h]),f3B3.q4r(s,Qt+le+"cked")?g+=v:g=v,f3B3.y4r(g,d)&&(d=g),f3B3.O4r(g,p)&&(p=g))}}}if(f3B3.Z4r(d,0)&&f3B3.F4r(p,0))return void this.watermark(r,ae+R+f3B3.X5B+ne+f3B3.z1B,Zt+$t+"tt"+I,this.translateIf(t.name+(Mt+z+O+Mt+Bt+N+"ailab")+ie+ne));var y,x=Math.floor(a.top)+.5;t.bindToYAxis?y=Math.floor(this.pixelFromPrice(p,n,a))+.5:(y=Math.floor(a.bottom)+.5,u=f3B3.Q4r(y-x,t.heightPercentage,d-p)),this.startClip(r);var b=f3B3.a4r(this.layout.candleWidth,1)||!l?0:.5,C=this.chart.context,S=Math.max(0,f3B3.u4r(1-t.widthFactor,this.layout.candleWidth,2)),w=new Array(o.length),M=[],T=this,B=1;for(c=0;f3B3.F2r(c,e.length);c++){var k=e[c];B=f3B3.Q2r(this.layout.candleWidth,t.widthFactor),S&&f3B3.H2r(this.layout.candleWidth-B,2)&&(l=!1);var D=0;if(f3B3.R2r(s,"cl"+Rt+f3B3.T5B+Z+f3B3.z1B+ne+he)&&(D=c,B/=e.length),h=t.subField||this.chart.defaultPlotField||"Cl"+$t+f3B3.T5B+ne,"function"==typeof k.color_function){for(var A,F,_={},P=0;f3B3.z2r(P,o.length);P++)o[P]&&(A=k.color_function(o[P]),"string"==typeof A&&(A={fill_color:A,border_color:A}),F=A.fill_color+","+A.border_color,f3B3.k2r(F,_)?_[F].positions.push(P):(A.positions=[P],_[F]=A));for(F in _)A=_[F],i(k.field,h,A.fill_color,A.opacity,null,null,D,B,A.positions),i(k.field,h,A.border_color,A.opacity,!0,null,D,B,A.positions)}else i(k.field,h,k.fill_color_up,k.opacity_up,null,!0,D,B),i(k.field,h,k.fill_color_down,k.opacity_down,null,null,D,B),f3B3.L2r(this.layout.candleWidth,2)&&l&&(i(k.field,h,k.border_color_up,k.opacity_up,!0,!0,D,B),i(k.field,h,k.border_color_down,k.opacity_down,!0,null,D,B));f3B3.D2r(s,f3B3.T5B+f3B3.X5B+le+ae+Jt+ne+he)&&(M=ce.shallowClone(w))}C.globalAlpha=1,this.endClip()}}},ce.ChartEngine.prototype.drawBarTypeChartInner=function(t){var e=t.type,i=t.panel,r=t.field,n=t.fillColor,a=t.borderColor,s=t.condition,o=t.style,l=t.yAxis,h=t.overlayScaling,c=f3B3.I1r(e,f3B3.v4B+f3B3.P4B+f3B3.T5B+f3B3.X5B+$t+Gt+f3B3.z1B+"am"),u=c||f3B3.W1r(e,ae+le+f3B3.G2B+he+ie+ne),d=f3B3.M1r(e,f3B3.T5B+f3B3.v4B+le+he+"ow"),p=f3B3.t1r(e,"hlc"),f=f3B3.i1r(e,Zt+It)||p,m=i.chart,g=m.dataSegment,v=this.chart.context,y=i.yAxis.top,x=i.yAxis.bottom,b=new Array(g.length),C=0;a&&!ce.isTransparent(a)&&(C=.5);f3B3.w1r(m.dataSet.length,m.scroll,1);v.beginPath(),l||(l=i.yAxis);var S=this.layout.candleWidth,w=f3B3.y1r(i.left,.5*S,this.micropixels,1),M=f3B3.P1r(m.tmpWidth,2),T=f3B3.m1r(v.lineWidth,2);if(u&&(ce.isTransparent(n)&&(n=this.containerColor),v.fillStyle=n),d&&(v.lineWidth=1),f){var B=this.canvasStyle(o);B.width&&f3B3.S1r(parseInt(B.width,10),25)?v.lineWidth=Math.max(1,ce.stripPX(B.width)):v.lineWidth=1}for(var k=m.state.chartType.pass,D=0;f3B3.p1r(D,g.length);D++){var A=M;w+=f3B3.n1r(S,2),S=this.layout.candleWidth,w+=f3B3.l1r(S,2);var F=g[D];if(F&&(!F.projection&&(F.candleWidth&&(w+=f3B3.N1r(F.candleWidth-S,2),S=F.candleWidth,(t.volume||f3B3.x1r(S,m.tmpWidth))&&(A=f3B3.J1r(S,2))),m.transformFunc&&F.transform&&(F=F.transform),F&&r&&f3B3.o5r(r,E+ie+$t+f3B3.T5B+ne)&&(F=F[r]),F||!f3B3.K5r(F,0)))){var _=F.Close,P=f3B3.s5r(F.Open,void 0)?_:F.Open;if(c&&m.defaultPlotField&&(_=F[m.defaultPlotField]),(_||!f3B3.j5r(_,0))&&(!u||c||!f3B3.e5r(P,_)&&!f3B3.d5r(P,null))){if(s){if(f3B3.h5r(s,ce.ChartEngine.CLOSEDOWN)?k.even|=f3B3.C5r(_,F.iqPrevClose):f3B3.V5r(s,ce.ChartEngine.CANDLEDOWN)&&(k.even|=f3B3.c5r(_,P)),f3B3.Y5r(s,ce.ChartEngine.CANDLEUP)&&f3B3.X5r(P,_))continue;if(f3B3.a5r(s,ce.ChartEngine.CANDLEDOWN)&&f3B3.u5r(P,_))continue;if(f3B3.b5r(s,ce.ChartEngine.CANDLEEVEN)&&f3B3.B5r(P,_))continue;if(f3B3.f5r(s,ce.ChartEngine.CLOSEUP)&&f3B3.U5r(_,F.iqPrevClose))continue;if(f3B3.v7r(s,ce.ChartEngine.CLOSEDOWN)&&f3B3.g7r(_,F.iqPrevClose))continue;if(f3B3.T7r(s,ce.ChartEngine.CLOSEEVEN)&&f3B3.G7r(_,F.iqPrevClose))continue}var L=P,N=_;(d||f)&&(L=f3B3.r7r(F.High,void 0)?Math.max(_,P):F.High,N=f3B3.q7r(F.Low,void 0)?Math.min(_,P):F.Low);var O,z;h?(O=f3B3.y7r(h.bottom,(L-h.min)*h.multiplier),z=f3B3.O7r(h.bottom,(N-h.min)*h.multiplier)):(O=l.semiLog?this.pixelFromTransformedValue(L,i,l):f3B3.Z7r(l.high-L,l.multiplier)+l.top,z=l.semiLog?this.pixelFromTransformedValue(N,i,l):f3B3.F7r(l.high-N,l.multiplier)+l.top);var I,R,H=Math.floor(c?z:Math.min(O,z))+C,j=c?l.bottom:Math.max(O,z),W=Math.floor(f3B3.Q7r(j,H)),V=z;if((f||d)&&(h?(I=f3B3.H7r(h.bottom,(P-h.min)*h.multiplier),R=f3B3.R7r(h.bottom,(_-h.min)*h.multiplier)):(I=l.semiLog?this.pixelFromTransformedValue(P,i,l):f3B3.z7r(l.high-P,l.multiplier)+l.top,R=l.semiLog?this.pixelFromTransformedValue(_,i,l):f3B3.k7r(l.high-_,l.multiplier)+l.top),V=R),b[D]=V,f3B3.L7r(H,y)){if(f3B3.D7r(H+W,y))continue;W-=f3B3.I3r(y,H),H=y}if(f3B3.W3r(H+W,x)&&(W-=H+W-x),W=Math.max(W,2),j=H+W,!f3B3.M3r(H,x)&&!f3B3.t3r(j,y)){var U=Math.floor(w)+.5,Y=Math.floor(f3B3.i3r(U,A))+C,X=f3B3.w3r(Math.round(U+A),C);if(u)f3B3.A3r(H,j)&&v.rect(Y,H,Math.max(1,f3B3.E3r(X,Y)),Math.max(1,f3B3.P3r(j,H)));else if(d){if(f3B3.m3r(_,P)&&f3B3.S3r(R,x)&&f3B3.p3r(R,y)){var q=Math.floor(R)+.5;v.moveTo(Y,q),v.lineTo(X,q)}f3B3.n3r(L,N)&&(v.moveTo(U,H),v.lineTo(U,j))}else if(f){if(f3B3.l3r(H,x)&&f3B3.N3r(j,y)&&f3B3.x3r(F.High,F.Low)&&(v.moveTo(U,f3B3.J3r(H,T)),v.lineTo(U,j+T)),f3B3.o9c(I,y)&&f3B3.K9c(I,x)&&!p){var Z=Math.floor(I)+.5;v.moveTo(U,Z),v.lineTo(f3B3.s9c(U,A),Z)}if(f3B3.j9c(R,y)&&f3B3.e9c(R,x)){var G=Math.floor(R)+.5;v.moveTo(U,G),v.lineTo(U+A,G)}}}}}}return u?(v.fill(),C&&(v.lineWidth=t.highlight?2:1,v.strokeStyle=a,v.stroke())):(d||f)&&(this.canvasColor(o),a&&(v.strokeStyle=a),t.highlight&&(v.lineWidth*=2),v.stroke(),v.closePath(),v.lineWidth=1),{cache:b}},ce.ChartEngine.prototype.plotDataSegmentAsLine=function(t,e,i,r){function n(t){var e=d,r=t;if(typeof r==$t+s+P+f3B3.X5B&&(d=ce.borderPatternToArray(B.lineWidth,r.pattern),r=r.color),y[r]=1,!m){var n=x.slice(-2),a=f3B3.d9c(d,Array)&&d.join(),o=f3B3.h9c(e,Array)&&e.join(),l=f3B3.C9c(a,o),h=!ce.colorsEqual(D,r),c=f3B3.V9c(t.width,i.highlight?2:1),u=f3B3.c9c(B.lineWidth,c);return(h||l||u)&&(f?b.push({coord:n,color:r,pattern:d||[],width:c}):(h||u)&&(B.stroke(),B.lineWidth=c,B.beginPath(),B.moveTo(n[0],n[1]))),D=r,!r||f3B3.Y9c(r,le+L+$t)?B.strokeStyle=w.defaultColor:B.strokeStyle=r,n}}function a(t,i,r,n){if(1720050642!==f3B3.K2b.s2b(0,6095855)&&-230904962!==f3B3.K2b.s2b(10,4042521)&&1560696827!==f3B3.K2b.s2b(0,9083088))self.grabbingHand(),createBar(j1v1b.W8M(highTarget,range),newData[j1v1b.M8M(newData.length,1)].Close),drawX(xxl,xxr,start,height,voffset),this.startLongHoldTimer();else{var a,s,o;if(n){var l=n.bottom+f3B3.X9c(n.min,n.multiplier);a=f3B3.a9c(l,r.CollatedOpen*n.multiplier),s=f3B3.u9c(l,r.collatedHigh*n.multiplier),o=f3B3.b9c(l,r.collatedLow*n.multiplier)}else a=p.semiLog?w.pixelFromTransformedValue(r.CollatedOpen,e,p):f3B3.B9c(p.high-r.CollatedOpen,p.multiplier)+p.top,s=p.semiLog?w.pixelFromTransformedValue(r.CollatedHigh,e,p):f3B3.f9c(p.high-r.CollatedHigh,p.multiplier)+p.top,o=p.semiLog?w.pixelFromTransformedValue(r.CollatedLow,e,p):f3B3.U9c(p.high-r.CollatedLow,p.multiplier)+p.top;B.lineTo(t,a)}B.moveTo(t,s),B.lineTo(t,o),B.moveTo(t,i),x.push(t,a)}var s="bj",o=!1,l=!1,h=!1,c=!0,u=null,d=null,p=null,f=0,m=!1,g=!1,v=null,y={},x=[],b=[],C=[],S=[],w=this,M=e.chart,T=M.dataSegment,B=M.context,k=new Array(T.length),D=B.strokeStyle;if(M.dataSet.length){this.startClip(e.name),i&&(o=i.skipProjections,i.skipTransform,l=i.noSlopes,f=i.tension,h=i.step,d=i.pattern,c=i.extendOffChart,p=i.yAxis,u=i.gaps,m=i.noDraw,g=i.reverse,v=i.overlayScaling,i.width&&(B.lineWidth=i.width)),i.highlight&&(B.lineWidth*=2),f3B3.v6c(c,!1)&&(c=!0),defaultPlotField=i.subField||M.defaultPlotField||E+ie+"os"+ne,p||(p=e.yAxis);var A=M.transformFunc&&f3B3.g6c(p,M.panel.yAxis),O=f3B3.T6c(B.lineWidth,2),z=g?f3B3.G6c(M.top,O):M.bottom+O;(i.threshold||f3B3.r6c(i.threshold,0))&&(z=this.pixelFromPrice(i.threshold,e,p));for(var I=!f&&m&&u&&u.fillMountain,R=t,H=t,j=0;f3B3.q6c(j,T.length);j++){var W=T[j];if(W&&typeof W=="obj"+ne+ae+f3B3.X5B&&(W[t]||f3B3.y6c(W[t],0))){typeof W[t]==$t+s+"ect"&&(H=ce.createObjectChainNames(t,[defaultPlotField])[0]);break}}var V={left:null,right:null},U=f3B3.O6c(M.dataSet.length,M.scroll,1);c&&(i.isComparison||(V.left=this.getPreviousBar(M,H,0)),V.right=this.getNextBar(M,H,f3B3.c6c(T.length,1)));var Y,X,q=!0,Z=!1;B.beginPath();var G=V.left,K=null;if(G&&(K=G.transform),G){X=A?K?K[t]:null:G[t],X&&(X[defaultPlotField]||f3B3.Y6c(X[defaultPlotField],0))&&(X=X[defaultPlotField]);var Q=this.pixelFromTick(G.tick,M),J=v?f3B3.X6c(v.bottom,(X-v.min)*v.multiplier):this.pixelFromTransformedValue(X,e,p);B.moveTo(Q,J),x.push(Q,J),f3B3.a6c(T[0].tick-G.tick,1)&&(C.push({start:x.slice(-2),threshold:z,tick:G}),Z=!0),q=!1}for(var $,tt,et=e.left+this.micropixels-1,it=this.currentQuote(),rt=0,nt=0,at=!1,st={reset:!0},ot=0;f3B3.u6c(ot,T.length);ot++){Y=this.layout.candleWidth;var lt=T[ot],ht=T[ot];if(lt||(lt={}),o&&lt.projection){V.right=null;break}lt.candleWidth&&(Y=lt.candleWidth),A&&lt.transform&&(lt=lt.transform);var ct=lt[t];if(ct&&typeof ct==$t+Zt+_+dt&&(ct=ct[defaultPlotField],R=t+"."+defaultPlotField),M.lineApproximation&&f3B3.b6c(this.layout.candleWidth,1)){st.reset&&(st={CollatedHigh:-Number.MAX_VALUE,CollatedLow:Number.MAX_VALUE,CollatedOpen:null,CollatedClose:null},at=!1);var ut=ct;if((ut||f3B3.B6c(ut,0))&&(st.CollatedHigh=Math.max(st.CollatedHigh,ut),st.CollatedLow=Math.min(st.CollatedLow,ut),st.CollatedClose=ut,f3B3.f6c(st.CollatedOpen,null)?st.CollatedOpen=ut:at=!0),rt+=Y,!f3B3.U6c(rt-nt,1)&&!f3B3.v0c(ot,T.length-1)){et+=Y;continue}nt=Math.floor(rt),st.reset=!0,st[t]=st.CollatedClose,lt=st,lt.cache={}}if(l||(et+=f3B3.g0c(Y,2)),ct||!f3B3.T0c(ct,0)){$=lt;var pt=lt.cache,ft=U+ot;(f3B3.r0c(ft,e.cacheLeft)||f3B3.q0c(ft,e.cacheRight)||!pt[t])&&(pt[R]=v?f3B3.y0c(v.bottom,(ct-v.min)*v.multiplier):p.semiLog?this.pixelFromTransformedValue(ct,e,p):f3B3.O0c(p.high-ct,p.multiplier)+p.top);var gt=k[ot]=pt[R];f3B3.Z0c(ht.tick,it.tick)&&M.lastTickOffset&&(et+=M.lastTickOffset);var vt=x.slice(-2);if(!q&&r){ht[t]&&ht[t][defaultPlotField]&&(ht=ht[t]);var yt=r(this,ht,Z);if(!yt){et+=l?Y:f3B3.F0c(Y,2);continue}vt=n(yt)}if(!q&&d&&d.length)h||l?(at?a(et,vt[1],lt,v):B.dashedLineTo(vt[0],vt[1],et,vt[1],d),l?B.moveTo(et,gt):at?a(et,gt,lt,v):B.dashedLineTo(et,vt[1],et,gt,d),x.push(et,vt[1])):at?a(et,gt,lt,v):B.dashedLineTo(vt[0],vt[1],et,gt,d);else if(q)B.moveTo(et,gt),f&&b.push({coord:[et,gt],color:B.strokeStyle,pattern:d||[],width:B.lineWidth});else{if(h||l){var xt=x.slice(-1)[0];at?a(et,xt,lt,v):B.lineTo(et,xt),x.push(et,xt)}at&&!l?a(et,gt,lt,v):B[l?F+N+"eTo":ie+f3B3.P4B+f3B3.G2B+ne+"To"](et,gt)}Z&&(C.push({end:[et,gt],threshold:z}),tt=ht,!I||h||l||x.push(et,z)),x.push(et,gt),q=!1,Z=!1,et+=l?Y:f3B3.Q0c(Y,2)}else{var bt=x.slice(-2);I&&!Z&&x.length&&x.push(bt[0],z),Z||C.push({start:bt,threshold:z,tick:tt}),Z=!0,et+=l?Y:f3B3.G0c(Y,2),(h||l)&&x.length&&(k[ot]=x.slice(-1)[0])}}var Ct=V.right,St=null;if(Ct&&(St=Ct.transform),!q&&Ct){X=A?St?St[t]:null:Ct[t],X&&(X[defaultPlotField]||f3B3.H0c(X[defaultPlotField],0))&&(X=X[defaultPlotField]);var wt=this.pixelFromTick(Ct.tick,M),Mt=v?f3B3.R0c(v.bottom,(X-v.min)*v.multiplier):this.pixelFromTransformedValue(X,e,p);if(f3B3.z0c(Ct.tick-T[T.length-1].tick,1)&&(Z||C.push({start:x.slice(-2),threshold:z,tick:T[f3B3.k0c(T.length,1)]}),Z=!0),!q&&r){var Tt=r(this,Ct,Z);if(Tt){var Bt=n(Tt);d&&d.length&&(h||l?(B.dashedLineTo(Bt[0],Bt[1],wt,Bt[1],d),l?B.moveTo(wt,Mt):B.dashedLineTo(wt,Bt[1],wt,Mt,d),x.push(wt,Bt[1])):B.dashedLineTo(Bt[0],Bt[1],wt,Mt,d))}}var kt=x.slice(-2);d&&d.length||((h||l)&&(B.lineTo(wt,kt[1]),x.push(wt,kt[1])),B[l?Pt+$t+N+ne+"To":ie+f3B3.P4B+f3B3.G2B+ne+"T"+$t](wt,Mt)),Z&&(C.push({end:[wt,Mt],threshold:z}),!I||h||l||x.push(wt,z)),x.push(wt,Mt)}for(var Dt in y)S.push(Dt);if(h||l||u||this.extendLastTick||i.extendToEndOfDataSet){var At=x.slice(-2);if(x.length){var Ft=At[0],_t=At[1];if(h||u||i.extendToEndOfDataSet?(Ft=this.pixelFromTick(f3B3.L0c(M.dataSet.length,1),M),(l||this.extendLastTick)&&(Ft+=f3B3.D0c(Y,2))):l?Ft+=Y:this.extendLastTick&&(Ft+=f3B3.I4c(Y,2)),f3B3.W4c(Ft,At[0])){var Et=null;r&&(Et=r(this,{},!0)),Et&&n(Et),d&&d.length?B.dashedLineTo(At[0],At[1],Ft,_t,d):B.lineTo(Ft,_t),Z&&I||x.push(Ft,_t)}}}if(m||(f&&x.length&&(B.beginPath(),B.setLineDash(i.pattern||[]),B.lineDashOffset=0,ue.plotSpline(x,f,B,b)),B.stroke()),this.endClip(),!m&&i.label&&$){var Lt,Nt=$[t];Nt&&typeof Nt==$t+Zt+f3B3.b4B+ne+ae+f3B3.X5B&&(Nt=Nt[defaultPlotField]),Lt=p.priceFormatter?p.priceFormatter(this,e,Nt,i.labelDecimalPlaces):this.formatYAxisPrice(Nt,e,i.labelDecimalPlaces);var Ot=this.yaxisLabelStyle;p.yaxisLabelStyle&&(Ot=p.yaxisLabelStyle);var zt=f3B3.M4c(Ot,f3B3.G2B+"oo"+mt)?B.strokeStyle:null,It=f3B3.t4c(Ot,f3B3.G2B+"oo"+mt)?"#FFFFFF":B.strokeStyle;this.yAxisLabels.push({src:"pl"+$t+f3B3.X5B,args:[e,Lt,$.cache[R],It,zt]})}}if(u)for(gp=0;f3B3.i4c(gp,C.length);gp+=2){var Rt,Ht=C[gp].start;if(gp&&(Rt=C[f3B3.w4c(gp,1)].end),Rt&&f3B3.A4c(Ht[0],Rt[0])&&f3B3.E4c(Ht[1],Rt[1])){B.beginPath();var jt=B.lineWidth;if(r){var Wt=r(this,C[gp].tick||{},!1);typeof Wt==$t+Zt+_+ae+f3B3.X5B&&(jt=f3B3.P4c(Wt.width,i.highlight?2:1),Wt=Wt.color),B.strokeStyle=B.fillStyle=Wt}B.lineWidth=jt,B.arc(Ht[0],Ht[1],1,0,f3B3.m4c(2,Math.PI)),B.stroke(),B.fill()}}return{colors:S,points:x,cache:k,gapAreas:C}},ce.ChartEngine.prototype.drawMountainChart=function(t,e,i){var r=this.chart.context,n=e,a=!1,s=!1,o=null,l=null,h=null,c=null,u=0,d=null,p=!1,f=null,m=null,g=!1,v=null,y=null,x=null,b=!1,C=!1,S=t.chart,w=(S.dataSegment,S.lineStyle||{});e&&typeof e==H+f3B3.b4B+ne+ae+f3B3.X5B||(e={style:e}),n=e.style||f3B3.T5B+oe+"_mount"+A+Kt+"char"+f3B3.X5B,o=e.field||S.defaultPlotField||j+f3B3.T5B+ne,l=e.subField||S.defaultPlotField||"Clos"+ne,d=e.gaps||S.gaplines,h=e.yAxis||t.yAxis,a=e.reverse,c=e.tension,f=e.fillStyle,u=e.width||w.width,p=e.step,m=e.pattern||w.pattern,g=e.highlight,y=e.color,v=e.baseColor,s=e.colored,x=e.overlayScaling,b=e.extendToEndOfDataSet,C=e.returnObject;var M=this.canvasStyle(n),T=h.top;(isNaN(T)||isNaN(f3B3.S4c(T,T)))&&(T=0);var B=y||(n&&M.backgroundColor?M.backgroundColor:this.defaultColor),k=v||(n&&M.color?M.color:this.containerColor);if(f)r.fillStyle=f;else if(v||M.color){var F=r.createLinearGradient(0,T,0,h.bottom);F.addColorStop(0,B),F.addColorStop(1,k),r.fillStyle=F}else r.fillStyle=B;this.startClip(t.name);var _=r.lineWidth;e.symbol||(l=null),e={skipProjections:!0,reverse:a,yAxis:h,gaps:d,step:p,highlight:g,extendToEndOfDataSet:b},S.tension&&(e.tension=S.tension),(c||f3B3.p4c(c,0))&&(e.tension=c);var P=parseInt(M.paddingTop,10),E=y||M.borderTopColor,L=null;if((s||E&&!ce.isTransparent(E))&&P&&!ce.isIE8){var O=this.scratchContext;if(!O){var z=r.canvas.cloneNode(!0);O=this.scratchContext=z.getContext(D+he),O.canvas=z}O.canvas.height=r.canvas.height,O.canvas.width=r.canvas.width,O.drawImage(r.canvas,0,0),r.clearRect(0,0,r.canvas.width,r.canvas.height)}ce.extend(e,{panelName:t.name,direction:e.reverse?-1:1,band:o,subField:l,opacity:1,overlayScaling:x}),ce.preparePeakValleyFill(this,e),(s||E&&!ce.isTransparent(E))&&P&&!ce.isIE8&&(r.save(),r.lineWidth+=f3B3.n4c(2,P),r.globalCompositeOperation=Ut+"sti"+f3B3.G2B+le+ft+$t+f3B3.G2B+ct+$t+Rt+f3B3.X5B,r.globalAlpha=1,this.plotDataSegmentAsLine(o,t,e),r.globalCompositeOperation=he+ne+f3B3.T5B+f3B3.X5B+f3B3.P4B+f3B3.G2B+le+f3B3.X5B+f3B3.P4B+$t+f3B3.G2B+ct+$t+N+ne+f3B3.z1B,r.scale(f3B3.l4c(1,this.adjustedDisplayPixelRatio),f3B3.N4c(1,this.adjustedDisplayPixelRatio)),r.drawImage(this.scratchContext.canvas,0,0),r.restore()),r.strokeStyle=E,u?r.lineWidth=u:M.width&&f3B3.x4c(parseInt(M.width,10),25)?r.lineWidth=Math.max(1,ce.stripPX(M.width)):r.lineWidth=1,m||(m=M.borderTopStyle),e.pattern=ce.borderPatternToArray(r.lineWidth,m);var I=i;return d&&(I=this.getGapColorFunction(o,l,{color:E,pattern:e.pattern,width:r.lineWidth},d,i)),L=this.plotDataSegmentAsLine(o,t,e,I),r.lineWidth=_,this.endClip(),L.colors.length||L.colors.push(E),C?L:L.colors},ce.ChartEngine.prototype.drawBaselineChart=function(t,e){var i=t.chart,r=i.gaplines,n=i.baseline.actualLevel,a=[],s=e.field||i.defaultPlotField,o=i.lineStyle||{};if(f3B3.J4c(n,null)&&!isNaN(n)){var l=f3B3.o8c(e.type,Pt+$t+Rt+f3B3.G2B+f3B3.X5B+le+f3B3.P4B+f3B3.G2B);l&&(a=this.drawMountainChart(t,{style:e.style,field:e.field,yAxis:e.yAxis,gaps:e.gaps,overlayScaling:e.overlayScaling,colored:!0,tension:0})),this.startClip(t.name),n=this.pixelFromPrice(n,i.panel);var h=e.pattern||o.pattern,c=e.fill_color_up||this.getCanvasColor(f3B3.T5B+f3B3.X5B+se+Kt+Zt+"asel"+f3B3.P4B+"ne_up"),u=e.fill_color_down||this.getCanvasColor(f3B3.T5B+f3B3.X5B+se+Kt+"ba"+f3B3.T5B+"eli"+f3B3.G2B+"e_do"+f3B3.M0B+f3B3.G2B),d=e.border_color_up||this.getCanvasColor(Qt+se+Kt+"bas"+ne+"li"+f3B3.G2B+ne+Kt+Rt+mt),p=e.border_color_down||this.getCanvasColor(pt+Kt+Zt+le+f3B3.T5B+ne+ie+f3B3.P4B+f3B3.G2B+"e_down"),f=e.width||o.width||this.canvasStyle(f3B3.T5B+f3B3.X5B+se+Kt+Zt+le+k+"li"+f3B3.G2B+"e_u"+mt).width,m=e.width||o.width||this.canvasStyle(f3B3.T5B+f3B3.X5B+Yt+"ba"+f3B3.T5B+"eline_do"+f3B3.M0B+f3B3.G2B).width,g={over:{fill:c,edge:d,width:f},under:{fill:u,edge:p,width:m}},v=!1;for(var y in g){var x=parseInt(Math.max(1,ce.stripPX(g[y].width)),10);e.highlight&&(x*=2),h=ce.borderPatternToArray(x,h);var b={panelName:ae+"hart",band:s,threshold:i.baseline.actualLevel,color:l?te+le+f3B3.G2B+f3B3.T5B+mt+"are"+f3B3.G2B+f3B3.X5B:g[y].fill,direction:f3B3.K8c(y,$t+N+ne+f3B3.z1B)?1:-1,edgeHighlight:g[y].edge,edgeParameters:{pattern:h,lineWidth:x+.1,opacity:1},gaps:e.gaps||r,yAxis:e.yAxis,overlayScaling:e.overlayScaling};b.yAxis&&(b.threshold=this.priceFromPixel(this.pixelFromPrice(b.threshold,t),t,b.yAxis)),a.push(g[y].edge);var C=b.color;if(!l&&C&&f3B3.s8c(C,f3B3.X5B+f3B3.z1B+le+f3B3.G2B+f3B3.T5B+mt+"are"+f3B3.G2B+f3B3.X5B)){var S=t.top,w=t.bottom,M=i.context.createLinearGradient(0,f3B3.j8c(y,$t+"ver")?S:w,0,n);M.addColorStop(0,ce.hexToRgba(ce.colorToHex(C),60)),M.addColorStop(1,ce.hexToRgba(ce.colorToHex(C),10)),b.color=M,b.opacity=1}ce.preparePeakValleyFill(this,i.dataSegment,b),r&&(r.fillMountain||this.drawLineChart(t,null,null,{color:f3B3.X5B+f3B3.z1B+le+f3B3.G2B+f3B3.T5B+mt+le+f3B3.z1B+"ent",gaps:{color:this.containerColor,pattern:f3B3.T5B+$t+"lid",width:b.edgeParameters.lineWidth}}),r.color||(v=!0,r.color=this.defaultColor)),this.drawLineChart(t,null,null,{color:"transp"+It+ne+B,width:b.edgeParameters.lineWidth}),v&&(r.color=null)}this.plotLine(0,1,n,n,this.containerColor,ie+ee,i.context,!0,{lineWidth:xt+T+xt,color:te+"anspa"+f3B3.z1B+R+f3B3.X5B}),this.plotLine(0,1,n,n,this.getCanvasColor(f3B3.T5B+f3B3.X5B+se+"_ba"+f3B3.T5B+ne+"line"),ie+vt+ne,i.context,!0,{pattern:he+$t+f3B3.X5B+f3B3.X5B+U,lineWidth:D+T+xt,opacity:.5}),f3B3.e8c(this.getSeriesRenderer(e.name),this.mainSeriesRenderer)&&f3B3.d8c(i.baseline.userLevel,!1)&&(this.controls.baselineHandle.style.top=f3B3.h8c(n,parseInt(getComputedStyle(this.controls.baselineHandle).height,10)/2,mt+se),this.controls.baselineHandle.style.left=f3B3.E8c(i.right,parseInt(getComputedStyle(this.controls.baselineHandle).width,10),mt+se),this.controls.baselineHandle.style.display=Zt+ie+$t+"ck"),this.endClip()}return{colors:a}},ce.ChartEngine.prototype.mousemoveinner=function(t,e){if(this.chart.canvas){
if(!ce.isAndroid&&!ce.isIOS7or8&&(f3B3.Z8c(this.chart.canvas.height,Math.floor(this.devicePixelRatio*this.chart.container.clientHeight))||f3B3.F8c(this.chart.canvas.width,Math.floor(this.devicePixelRatio*this.chart.container.clientWidth))))return void this.resizeChart();var i;if(!this.runPrepend(Pt+$t+Rt+f3B3.T5B+"emo"+N+"einner",arguments)){var r=this.container.getBoundingClientRect();this.top=r.top,this.left=r.left,this.right=this.left+this.width,this.bottom=this.top+this.height,this.cancelLongHold=!0,this.hasDragged=!0,ce.ChartEngine.crosshairX=t,ce.ChartEngine.crosshairY=e;var n=this.cy=this.crossYActualPos=this.backOutY(ce.ChartEngine.crosshairY),a=this.cx=this.backOutX(ce.ChartEngine.crosshairX);if(this.currentPanel=this.whichPanel(n),this.currentPanel||(this.currentPanel=this.chart.panel),this.currentPanel){var s=this.currentPanel.chart;if(s.dataSet){this.crosshairTick=this.tickFromPixel(a,s),i=this.valueFromPixel(n,this.currentPanel),this.crosshairValue=this.adjustIfNecessary(this.currentPanel,this.crosshairTick,i);var o=f3B3.Q8c(this.currentPanel.name,ae+f3B3.v4B+It+f3B3.X5B)?this.preferences.horizontalCrosshairField:this.currentPanel.horizontalCrosshairField;o&&f3B3.H8c(this.crosshairTick,s.dataSet.length)&&this.crosshairTick>-1&&(i=s.dataSet[this.crosshairTick][o],this.crossYActualPos=this.pixelFromPrice(i,this.currentPanel))}f3B3.R8c(ce.ChartEngine.crosshairX,this.left)&&f3B3.z8c(ce.ChartEngine.crosshairX,this.right)&&f3B3.k8c(ce.ChartEngine.crosshairY,this.top)&&f3B3.L8c(ce.ChartEngine.crosshairY,this.bottom)?ce.ChartEngine.insideChart=!0:ce.ChartEngine.insideChart=!1;var l=f3B3.D8c(this.xAxisAsFooter,!0)?this.chart.canvasHeight:this.chart.panel.bottom;if(this.overXAxis=ce.ChartEngine.insideChart&&f3B3.I2c(ce.ChartEngine.crosshairY,l+this.top)&&f3B3.W2c(ce.ChartEngine.crosshairY,l-this.xaxisHeight+this.top),this.overYAxis=(f3B3.M2c(this.cx,this.currentPanel.right)||f3B3.t2c(this.cx,this.currentPanel.left))&&ce.ChartEngine.insideChart,!this.overXAxis&&!this.overYAxis&&(ce.ChartEngine.insideChart||this.grabbingScreen)||(this.undisplayCrosshairs(),this.overXAxis||this.overYAxis)){if(!this.displayCrosshairs&&!ce.ChartEngine.resizingPanel)return void this.undisplayCrosshairs();if(this.repositioningBaseline)return M=this.panels[this.chart.panel.name],this.chart.baseline.userLevel=this.adjustIfNecessary(M,this.crosshairTick,this.valueFromPixel(this.backOutY(ce.ChartEngine.crosshairY),M)),void(f3B3.i2c(Date.now()-this.repositioningBaseline.lastDraw,100)&&(this.draw(),this.repositioningBaseline.lastDraw=Date.now()));if(this.grabbingScreen&&!ce.ChartEngine.resizingPanel){if(this.anyHighlighted){ce.clearCanvas(this.chart.tempCanvas,this),this.anyHighlighted=!1;var h;for(h in this.overlays)this.overlays[h].highlight=!1;for(h in s.series)s.series[h].highlight=!1;this.displaySticky()}this.preferences.magnet&&this.currentVectorParameters.vectorType&&ce.clearCanvas(this.chart.tempCanvas,this),-1==this.grabStartX&&(this.grabStartX=ce.ChartEngine.crosshairX,this.grabStartScrollX=s.scroll),-1==this.grabStartY&&(this.grabStartY=ce.ChartEngine.crosshairY,this.grabStartScrollY=this.currentPanel.yAxis.scroll);var c=f3B3.w2c(ce.ChartEngine.crosshairX,this.grabStartX),u=f3B3.A2c(ce.ChartEngine.crosshairY,this.grabStartY);if(f3B3.E2c(c,0)&&f3B3.P2c(u,0))return;f3B3.m2c(Math.abs(c)+Math.abs(u),5)&&(this.grabOverrideClick=!0);var d,p=this.layout.candleWidth;if(this.allowZoom&&f3B3.S2c(this.grabMode,mt+le+f3B3.G2B)&&(f3B3.p2c(this.grabMode.indexOf(f3B3.X4B+$t+$t+Pt),0)||this.overXAxis||this.overYAxis)){f3B3.n2c(this.grabMode,"")&&(this.overXAxis?this.grabMode=f3B3.X4B+$t+I+ct+se:this.overYAxis&&(this.grabMode=f3B3.X4B+$t+$t+Pt+ct+f3B3.r4B)),f3B3.l2c(this.grabMode,f3B3.X4B+$t+$t+Pt+ct+se)?u=0:f3B3.N2c(this.grabMode,f3B3.X4B+$t+I+ct+f3B3.r4B)&&(c=0),d=f3B3.x2c(c,25);var f=!0;f3B3.J2c(s.scroll,s.maxTicks)&&(f=!1);var m=f3B3.o1c(this.grabStartCandleWidth,d);f3B3.K1c(m,this.minimumCandleWidth)&&(m=this.minimumCandleWidth);var g=f3B3.s1c(p-m,p);if(f3B3.j1c(g,.1)?m=f3B3.e1c(p,.9):g<-.1&&(m=f3B3.d1c(p,1.1)),d){if(ce.ipad&&f3B3.h1c(Math.round(this.chart.width/p-.499)-1,ce.ChartEngine.ipadMaxTicks)&&f3B3.C1c(Math.round(this.chart.width/m-.499)-1,ce.ChartEngine.ipadMaxTicks))return;var v;if(this.pinchingCenter){var y=this.backOutX(this.pinchingCenter),x=this.tickFromPixel(y,s);this.setCandleWidth(m,s);var b=this.tickFromPixel(y,s);s.scroll+=Math.floor(f3B3.V1c(b,x))}else if(f)v=Math.round(f3B3.c1c(this.chart.width,m)+1),f3B3.Y1c(v,s.maxTicks)&&(s.scroll+=Math.round(f3B3.X1c(v-s.maxTicks,2)),this.setCandleWidth(m,s));else if(v=Math.round(f3B3.a1c(this.chart.width,m)+1),f3B3.u1c(v,Math.round(this.chart.width/p+1))){var C=Math.round(f3B3.b1c(this.preferences.whitespace,m));s.scroll=f3B3.B1c(s.maxTicks,C),this.setCandleWidth(m,s)}}this.layout.setSpan&&(this.layout.setSpan=null,this.changeOccurred(ie+le+f3B3.r4B+$t+L));var S=this.grabStartYAxis;S&&(S.zoom=Math.round(this.grabStartZoom+u),f3B3.f1c(this.grabStartZoom,S.height)?f3B3.U1c(S.zoom,S.height)&&(S.zoom=f3B3.v5c(S.height,1)):f3B3.g5c(S.zoom,S.height)&&(S.zoom=S.height+1))}else{if(this.allowScroll){if(f3B3.T5c(Math.abs(u),this.yTolerance)){if(!this.yToleranceBroken&&(u=0,f3B3.G5c(c,0)))return}else this.yToleranceBroken=!0;for(this.grabStartMicropixels||(this.grabStartMicropixels=0),this.grabMode=mt+le+f3B3.G2B,s.scroll=this.grabStartScrollX,this.micropixels=this.grabStartMicropixels+f3B3.r5c(c,this.shift?5:1);f3B3.q5c(this.micropixels,0);)this.micropixels-=p,s.scroll++;for(;this.micropixels<-p;)this.micropixels+=p,s.scroll--;f3B3.y5c(s.scroll,1)&&(this.micropixels=0,s.scroll=1),f3B3.O5c(s.scroll,s.maxTicks)?this.preferences.whitespace=this.initialWhitespace:this.preferences.whitespace=f3B3.Z5c(s.maxTicks-s.scroll,p),f3B3.F5c(this.currentPanel,this.grabStartPanel)&&(this.currentPanel.yAxis.scroll=this.grabStartScrollY+u)}this.dispatch(F+N+ne,{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:this.grabbingScreen})}return ce.ChartEngine.useAnimation?window.requestAnimationFrame(function(t){return function(){t.draw(),t.updateChartAccessories()}}(this)):(this.draw(),this.updateChartAccessories()),this.activeDrawing&&(ce.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing.render(this.chart.tempCanvas.context),this.activeDrawing.measure()),void this.undisplayCrosshairs()}if(this.grabMode="",this.overXAxis||this.overYAxis)return void this.updateChartAccessories();if(this.controls.crossX.style.left=f3B3.Q5c(this.pixelFromTick(this.crosshairTick,s),.5)+(mt+se),this.controls.crossY.style.top=this.crossYActualPos+(mt+se),this.setCrosshairColors(),ce.ChartEngine.insideChart&&!ce.ChartEngine.resizingPanel){var w=this.currentVectorParameters.vectorType;ce.Drawing&&w&&ce.Drawing[w]&&(new ce.Drawing[w]).dragToDraw||this.doDisplayCrosshairs(),this.updateChartAccessories()}else this.undisplayCrosshairs();var M;this.repositioningDrawing?this.repositionDrawing(this.repositioningDrawing):ce.ChartEngine.drawingLine?this.activeDrawing&&(M=this.panels[this.activeDrawing.panelName],i=this.adjustIfNecessary(M,this.crosshairTick,this.valueFromPixel(this.backOutY(ce.ChartEngine.crosshairY),M)),this.preferences.magnet&&this.magnetizedPrice&&f3B3.H5c(M.name,M.chart.name)&&(i=this.adjustIfNecessary(M,this.crosshairTick,this.magnetizedPrice)),ce.clearCanvas(this.chart.tempCanvas,this),this.activeDrawing.move(this.chart.tempCanvas.context,this.crosshairTick,i),this.activeDrawing.measure&&this.activeDrawing.measure()):ce.ChartEngine.resizingPanel&&this.resizePanels(),ce.ChartEngine.insideChart&&(this.dispatch(Pt+$t+N+ne,{stx:this,panel:this.currentPanel,x:this.cx,y:this.cy,grab:this.grabbingScreen}),this.findHighlights()),this.preferences.magnet&&this.currentVectorParameters.vectorType&&(ce.ChartEngine.drawingLine||this.anyHighlighted||ce.clearCanvas(this.chart.tempCanvas),this.magnetize()),this.runAppend(Pt+$t+Rt+"sem"+$t+N+ne+vt+f3B3.G2B+ne+f3B3.z1B,arguments)}}}}},ce.ChartEngine.prototype.plotLine=function(t,e,i,r,n,a,s,o,l){if(-1971793104===f3B3.K2b.s2b(0,4183705)||-357843872===f3B3.K2b.s2b(10,3306015)||-1153971058===f3B3.K2b.s2b(0,9264078)){var h="ica",c="hori";if(l||(l={}),f3B3.R5c(l.pattern,f3B3.G2B+$t+f3B3.G2B+ne))return;f3B3.z5c(o,!0)&&(o=this.chart.panel)}else colArray.push(col);if((f3B3.k5c(s,null)||typeof s==qt+Ut+et+vt+ne+he)&&(s=this.chart.context),!(isNaN(t)||isNaN(e)||isNaN(i)||isNaN(r))){var u=0,d=this.chart.canvasHeight,p=0,f=this.right;o&&(d=o.yAxis.bottom,u=o.yAxis.top,p=o.left,f=o.right);var m,g,v;if(f3B3.L5c(a,at+f3B3.r4B)&&(m=1e7,f3B3.D5c(e,t)&&(m=-1e7),v={x0:t,x1:e,y0:i,y1:r},g=ce.yIntersection(v,m),e=m,r=g),f3B3.I7c(a,ie+ee)||f3B3.W7c(a,c+f3B3.X4B+_t+f3B3.X5B+le+ie)||f3B3.M7c(a,N+ne+f3B3.z1B+f3B3.X5B+h+ie)){m=1e7;v={x0:t,x1:e,y0:i,y1:r},g=ce.yIntersection(v,m);var y=ce.yIntersection(v,-1e7);t=-1e7,e=m,i=y,r=g}for(var x,b,C,S=0,w=1,M=f3B3.t7c(e,t),T=f3B3.i7c(r,i),B=0;f3B3.w7c(B,4);B++){if(f3B3.A7c(B,0)&&(x=-M,b=-f3B3.E7c(p,t)),f3B3.P7c(B,1)&&(x=M,b=f3B3.m7c(f,t)),f3B3.S7c(B,2)&&(x=-T,b=-f3B3.p7c(u,i)),f3B3.n7c(B,3)&&(x=T,b=f3B3.l7c(d,i)),C=f3B3.N7c(b,x),(r||f3B3.x7c(r,0))&&f3B3.J7c(x,0)&&f3B3.o3c(b,0))return!1;if(f3B3.K3c(x,0)){if(f3B3.s3c(C,w))return!1;f3B3.j3c(C,S)&&(S=C)}else if(f3B3.e3c(x,0)){if(f3B3.d3c(C,S))return!1;f3B3.h3c(C,w)&&(w=C)}}var k=t+f3B3.C3c(S,M),D=i+f3B3.V3c(S,T),A=t+f3B3.c3c(w,M),F=i+f3B3.Y3c(w,T);if(!r&&f3B3.X3c(r,0)&&!i&&f3B3.a3c(i,0)){if(D=u,F=d,k=v.x0,A=v.x0,f3B3.u3c(v.x0,f))return!1;if(f3B3.b3c(v.x0,p))return!1}else if(!r&&f3B3.B3c(r,0)){if(F=f3B3.f3c(v.y0,v.y1)?d:u,k=v.x0,A=v.x0,f3B3.U3c(v.x0,f))return!1;if(f3B3.v9k(v.x0,p))return!1}s.lineWidth=1.1,typeof n==$t+Zt+_+ae+f3B3.X5B?(s.strokeStyle=n.color,n.opacity?s.globalAlpha=n.opacity:s.globalAlpha=1,s.lineWidth=parseInt(ce.stripPX(n.width),10)):!n||f3B3.g9k(n,le+Rt+f3B3.X5B+$t)||ce.isTransparent(n)?s.strokeStyle=this.defaultColor:s.strokeStyle=n,l.opacity&&(s.globalAlpha=l.opacity),l.lineWidth&&(s.lineWidth=l.lineWidth),f3B3.T9k(a,f3B3.X4B+f3B3.P4B+Gt+Mt+f3B3.X4B+le+Gt)&&(s.lineWidth=5);var P=ce.borderPatternToArray(s.lineWidth,l.pattern);s.stxLine(k,D,A,F,s.strokeStyle,s.globalAlpha,s.lineWidth,P),s.globalAlpha=1,s.lineWidth=1}},ce.ChartEngine.prototype.rendererAction=function(t,e){if(!this.runPrepend(M+f3B3.G2B+Ut+f3B3.z1B+ne+"rActi"+_t,arguments)){var i={};for(var r in t.seriesRenderers){var n=t.seriesRenderers[r],a=n.params,s=a.panel,o=this.panels[s];if((!a.overChart||!f3B3.G9k(e,Rt+f3B3.G2B+he+ne+f3B3.z1B+ie+le+f3B3.r4B))&&((!f3B3.r9k(a.name,Kt+Pt+le+f3B3.P4B+f3B3.G2B+Kt+f3B3.T5B+ne+f3B3.z1B+f3B3.P4B+ne+f3B3.T5B)||!f3B3.q9k(e,Rt+f3B3.G2B+Ut+f3B3.z1B+ie+Ft))&&(!f3B3.y9k(a.name,Kt+Pt+A+Kt+f3B3.T5B+ne+$+Dt)||!f3B3.O9k(e,Pt+le+vt))&&(a.overChart||!f3B3.Z9k(e,"ov"+ne+f3B3.z1B+ie+le+f3B3.r4B))&&o&&!f3B3.F9k(o.chart,t)&&!o.hidden))if(f3B3.Q9k(e,ae+"alcula"+Z)){var l=a.yAxis;n.performCalculations(l?i[l.name]:[]),l&&(i[l.name]=[l.low,l.high])}else f3B3.H9k(e,f3B3.r4B+le+se+f3B3.P4B+f3B3.T5B)?a.yAxis&&f3B3.R9k(s,t.panel.name)&&(this.createYAxis(o,a),this.drawYAxis(o,a)):(n.draw(),n.cb&&n.cb(n.colors))}this.runAppend(f3B3.z1B+R+tt+ne+"rA"+ae+f3B3.X5B+w+f3B3.G2B,arguments)}},ce.ChartEngine.prototype.drawSeries=function(t,e,i,r){if(!this.runPrepend(Lt+"aw"+S+St+f3B3.P4B+ne+f3B3.T5B,arguments)){for(var n=t.dataSegment,a=null,s=f3B3.d0B,o=f3B3.r0B;-128878657!==f3B3.K2b.W2b(o.toString(),o.toString().length,4558651);o++)s+=f3B3.d0B;if(-340663077===f3B3.K2b.W2b(s.toString(),s.toString().length,4386375)){e||(e=t.series);for(var l in e){a=e[l];var h=a.parameters,c=h.panel?this.panels[h.panel]:t.panel,u=h.color,d=(h.width,h.field);if(c){var p=h.yAxis=i||c.yAxis;u||(u=p.textStyle||this.defaultColor),d||(d=t.defaultPlotField);var f=h.subField||t.defaultPlotField||E+C+k;if(f3B3.z9k(this.mainSeriesRenderer,r)&&!h.shareYAxis&&f3B3.k9k(p.name,c.yAxis.name)){var m=[h.minimum,h.maximum];if(!h.minimum&&f3B3.L9k(h.minimum,0)||!h.maximum&&f3B3.D9k(h.maximum,0)){r&&!r.standaloneBars&&(n.unshift(this.getPreviousBar(t,f,0)),n.push(this.getNextBar(t,f,f3B3.I6k(n.length,1))));var g=ce.minMax(n,d,f,r?r.highLowBars:null);r&&!r.standaloneBars&&(n.shift(),n.pop()),!h.minimum&&f3B3.W6k(h.minimum,0)&&(m[0]=g[0]),!h.maximum&&f3B3.M6k(h.maximum,0)&&(m[1]=g[1])}var v=m[0],y=p.top,x=p.bottom,b=f3B3.t6k(x,y),w=h.marginTop,M=h.marginBottom;w&&(y=f3B3.i6k(w,1)?y+w:y+f3B3.w6k(b,w)),M&&(x=f3B3.A6k(M,1)?f3B3.E6k(x,M):f3B3.P6k(x,b*M)),h.overlayScaling={bottom:x,min:v,multiplier:f3B3.m6k(x-y,m[1]-v)}}!h._rawExtendToEndOfDataSet&&f3B3.S6k(h._rawExtendToEndOfDataSet,!1)&&(h._rawExtendToEndOfDataSet=h.extendToEndOfDataSet),t.animatingHorizontalScroll?h.extendToEndOfDataSet=!1:(h.extendToEndOfDataSet=h._rawExtendToEndOfDataSet,!h.extendToEndOfDataSet&&f3B3.p6k(h.extendToEndOfDataSet,!1)&&(h.extendToEndOfDataSet=!1));var T=h.colorFunction;(a.highlight||a.parameters.highlight)&&(h.highlight=!0);var D={colors:[]};D=r?r.drawIndividualSeries(t,h)||D:f3B3.n6k(h.type,Pt+$t+Rt+B+le+f3B3.P4B+f3B3.G2B)?this.drawMountainChart(c,ce.extend({returnObject:!0},h),T):this.drawLineChart(c,h.style,T,ce.extend({returnObject:!0},h)),a.yValueCache=D.cache;var A=t.dataSegment[f3B3.l6k(t.dataSegment.length,1)];if(A){var F=!h.skipTransform&&t.transformFunc&&f3B3.N6k(p,t.panel.yAxis);!A[d]&&f3B3.x6k(A[d],0)&&(A=this.getPreviousBar(t,d,f3B3.J6k(t.dataSegment.length,1))),F&&A&&A.transform&&(A=A.transform)}if(f3B3.o0k(this.mainSeriesRenderer,r)&&(h.shareYAxis||f3B3.K0k(p.name,c.yAxis.name))&&A&&!p.noDraw){var _=A[d];_=_[f]||f3B3.s0k(_[f],0)?_[f]:_.iqPrevClose;var P;P=p.priceFormatter?p.priceFormatter(this,c,_):this.formatYAxisPrice(_,c,null,p),this.yAxisLabels.push({src:"ser"+f3B3.P4B+ne+f3B3.T5B,args:[c,P,this.pixelFromTransformedValue(_,c,p),u,null,null,p]})}if(t.legend&&h.useChartLegend){t.legend.colorMap||(t.legend.colorMap={});var L=h.display;L||(L=h.symbol),t.legend.colorMap[l]={color:D.colors,display:L,isBase:f3B3.j0k(r,this.mainSeriesRenderer)}}}}this.runAppend(he+f3B3.z1B+le+"wS"+St+f3B3.P4B+ne+f3B3.T5B,arguments)}}},ce.ChartEngine.prototype.consolidatedQuote=function(t,e){if(this.runPrepend(ae+$t+f3B3.G2B+f3B3.T5B+$t+"lida"+f3B3.X5B+ne+he+"Quo"+f3B3.X5B+ne,arguments))return t;if(!t||!t.length)return[];var i=this.layout,r=this.dataZone,n=this.chart,a=this,s=i.periodicity,o=i.interval,l=i.timeUnit;e||(e={}),e.periodicity&&e.interval&&(s=e.periodicity,o=e.interval,l=e.timeUnit);var h=1;!ce.ChartEngine.isDailyInterval(o)&&n.useInflectionPointForIntraday&&(h=s);var c=n.inflectionPoint;c&&!f3B3.B0k(c,t[0].DT)||(c=t[0].DT);for(var u=[],d={begin:c,interval:o,multiple:f3B3.f0k(s,h),timeUnit:l,inZone:r,outZone:r},p=n.market.newIterator(ce.clone(d));f3B3.U0k(p.previous(h),t[0].DT););for(var f=p.previous(h),v=p.next(h),y=0,x=0;f3B3.v4k(y,t.length);){var C=t[y];if(f3B3.g4k(C.DT,f))console.log("W"+le+"rn"+f3B3.P4B+"ng"+kt+$t+L+ct+$t+et+ct+$t+jt+ne+f3B3.z1B+Mt+"q"+Rt+$t+Z+Mt+f3B3.P4B+f3B3.G2B+Mt+he+le+g+m+f3B3.X5B+", "+he+f3B3.P4B+f3B3.T5B+M+Gt+le+jt+f3B3.P4B+f3B3.G2B+Gt+kt+C.DT),y++;else if(f3B3.T4k(C.DT,v))f=v,v=p.next(h),u[x]&&x++;else{var S=function(t,e,r){e||(e={DT:r,Date:ce.yyyymmddhhmmssmmm(r)}),e.displayDate||a.setDisplayDate(e);var n=1;i.adj&&t.Adj_Close&&(n=f3B3.e0k(t.Adj_Close,t.Close)),f3B3.d0k(b+Gt+f3B3.v4B,t)&&f3B3.h0k(t.High*n,e.High)&&(e.High=f3B3.C0k(t.High,n)),f3B3.V0k(Ct+$t+f3B3.M0B,t)&&f3B3.c0k(t.Low*n,e.Low)&&f3B3.Y0k(t.Low,null)&&(e.Low=f3B3.X0k(t.Low,n)),e.Volume+=t.Volume,f3B3.a0k(E+ie+$t+f3B3.T5B+ne,t)&&f3B3.u0k(t.Close,null)&&(e.Close=f3B3.b0k(t.Close,n)),e.ratio=n;for(var s in t)e[s]||(e[s]=t[s]);return e}(C,u[x],f);S&&(u[x]=S),y++}}return this.runAppend(ae+$t+f3B3.G2B+"so"+ie+it+At+U+"Q"+Rt+$t+Z,arguments),u},ce.ChartEngine.prototype.touchmove=function(t){if(this.displayInitialized&&!f3B3.G4k(this.openDialog,"")&&!f3B3.r4k(ce.ChartEngine.ignoreTouch,!0)){var e=[];if(!(t&&t.touches&&f3B3.q4k(t.touches.length,1)&&f3B3.y4k(Math.pow(this.clicks.x-t.touches[0].clientX,2)+Math.pow(this.clicks.y-t.touches[0].clientY,2),16))){(!this.overYAxis||this.controls&&this.controls.crossX&&f3B3.O4k(this.controls.crossX.style.display,f3B3.G2B+$t+bt))&&(t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),t&&t.stopPropagation());var i=(new Date).getTime();if(-1==this.clicks.s2MS){if(this.clicks.e1MS=i,f3B3.Z4k(this.clicks.e1MS-this.clicks.s1MS,25))return}else if(this.clicks.e2MS=i,f3B3.F4k(this.clicks.e2MS-this.clicks.s2MS,25))return;if(ce.isSurface){if(this.mouseMode)return;if(t.pointerId||(t.pointerId=this.gesturePointerId),(!this.grabbingScreen||ce.ChartEngine.resizingPanel)&&!this.overrideGesture&&f3B3.Q4k(t.detail,t.MSGESTURE_FLAG_INERTIA))return void this.gesture.stop();for(var r=0;f3B3.H4k(r,this.touches.length);r++)if(f3B3.R4k(this.touches[r].pointerId,t.pointerId)){var n=Math.abs(f3B3.z4k(this.touches[r].pageX,t.clientX)),a=Math.abs(f3B3.k4k(this.touches[r].pageY,t.clientY)),s=Math.sqrt(f3B3.L4k(n,n)+f3B3.D4k(a,a));if(!s)return;if(this.clicks.e1MS=(new Date).getTime(),f3B3.I8k(this.clicks.e1MS-this.clicks.s1MS,50))return;if(f3B3.W8k(this.touches[r].pageX,t.clientX)&&f3B3.M8k(this.touches[r].pageY,t.clientY))return;this.touches[r].pageX=t.clientX,this.touches[r].pageY=t.clientY;break}if(f3B3.t8k(r,0)?this.movedPrimary=!0:this.movedSecondary=!0,!this.gestureInEffect&&f3B3.i8k(r,this.touches.length))return;this.changedTouches=[{pointerId:t.pointerId,pageX:t.clientX,pageY:t.clientY}],e=this.touches,this.gestureInEffect&&!e.length&&(e=this.changedTouches)}else e=t.touches,this.changedTouches=t.changedTouches;var o=this.crosshairXOffset,l=this.crosshairYOffset,h=this.currentVectorParameters.vectorType&&f3B3.w8k(this.currentVectorParameters.vectorType,""),c=!this.layout.crosshair&&!h&&!this.touchNoPan;if((c||this.activeDrawing&&f3B3.A8k(this.activeDrawing.name,et+f3B3.z1B+ne+"efo"+f3B3.z1B+Pt))&&(o=l=0),!this.runPrepend(f3B3.X5B+Vt+Y+Pt+$t+N+ne,arguments)){var u,d;if(ce.ChartEngine.resizingPanel){var p=e[0];return u=p.clientX,d=p.clientY,void this.mousemoveinner(u+o,d+l)}-1!=this.moveB&&(this.touchMoveTime=new Date),this.moveA=this.moveB,this.moveB=e[0].pageX;var m;if(f3B3.E8k(e.length,1)&&!this.twoFingerStart){var g=e[0];u=g.clientX,d=g.clientY,this.pinchingScreen=0,this.mousemoveinner(u+o,d+l);var v=this.whichPanel(d);this.overXAxis=f3B3.P8k(d,this.top+this.chart.panel.yAxis.bottom)&&f3B3.m8k(d,this.top+this.chart.panel.bottom)&&ce.ChartEngine.insideChart,this.overYAxis=!!v&&((f3B3.S8k(u,v.right)||f3B3.p8k(u,v.left))&&ce.ChartEngine.insideChart)}else if(f3B3.n8k(e.length,2)&&this.allowZoom){if(!this.displayCrosshairs)return;var y=e[0],x=y.clientX,b=y.clientY,C=e[1],S=C.clientX,w=C.clientY;m=Math.sqrt(f3B3.l8k(S-x,S-x)+f3B3.N8k(w-b,w-b)),this.pinchingCenter=f3B3.x8k(Math.min(x,S)-Math.max(x,S),2);var M=Math.round(f3B3.J8k(this.gestureStartDistance,m));if(c&&(this.pinchingScreen=5),this.clearPixelCache(),f3B3.o2k(this.pinchingScreen,2)){if(ce.isSurface&&(!this.movedPrimary||!this.movedSecondary))return;if(f3B3.K2k(x,this.pt.x1)&&f3B3.s2k(S,this.pt.x2)||f3B3.j2k(x,this.pt.x1)&&f3B3.e2k(S,this.pt.x2)||f3B3.d2k(b,this.pt.y1)&&f3B3.h2k(w,this.pt.y2)||f3B3.C2k(b,this.pt.y1)&&f3B3.V2k(w,this.pt.y2))this.pinchingScreen=0;else if(this.pinchingScreen++,f3B3.c2k(this.pinchingScreen,2))return}if(this.pt={x1:x,x2:S,y1:b,y2:w},f3B3.Y2k(this.pinchingScreen,0))this.mousemoveinner(x+o,b+l),this.gestureStartDistance=m;else{var T=Math.asin(f3B3.X2k(Math.max(w,b)-Math.min(w,b),m));if(f3B3.a2k(Math.abs(M),12)&&!c){if(this.moveCount++,f3B3.u2k(this.moveCount,4))return this.pinchingScreen=0,void(this.moveCount=0)}else this.moveCount=0;if(f3B3.b2k(T,1)||!this.goneVertical&&f3B3.B2k(T,1.37)){if(!this.currentPanel)return;var B=this.currentPanel.chart;this.goneVertical=!1,m=f3B3.f2k(this.pt.x2,this.pt.x1);var k=f3B3.U2k(this.grabStartValues.t2,this.grabStartValues.t1),D=this.grabStartValues.t1+f3B3.v1k(k,2),A=f3B3.g1k(m,k);f3B3.T1k(A,this.minimumCandleWidth)&&(A=this.minimumCandleWidth);var F=this.layout.candleWidth;if(this.setCandleWidth(A,B),f3B3.G1k(B.maxTicks,this.minimumZoomTicks))return void this.setCandleWidth(F,B);this.micropixels=0;var _=this.pixelFromTick(Math.round(D),B),P=f3B3.r1k(this.pt.x1,this.left)+Math.round(f3B3.q1k(m,2)),E=f3B3.y1k(_,P),L=f3B3.O1k(E,A),O=Math.round(L);B.scroll-=O,this.microscroll=f3B3.Z1k(O,L),this.micropixels=f3B3.F1k(A,this.microscroll),this.draw()}else{var z=this.grabStartYAxis;this.goneVertical=!0,z.zoom=this.grabStartZoom+f3B3.Q1k(this.gestureStartDistance,m),f3B3.H1k(this.grabStartZoom,z.height)?f3B3.R1k(z.zoom,z.height)&&(z.zoom=f3B3.z1k(z.height,1)):f3B3.k1k(z.zoom,z.height)&&(z.zoom=z.height+1),this.draw()}this.updateChartAccessories()}}else if(f3B3.L1k(e.length,3)&&ce.ChartEngine.allowThreeFingerTouch){if(!this.displayCrosshairs)return;var I=e[0],R=I.clientX;m=f3B3.D1k(this.grabStartX,R),this.grabEndPeriodicity=this.grabStartPeriodicity+Math.round(f3B3.I5k(m,10)),f3B3.W5k(this.grabEndPeriodicity,1)&&(this.grabEndPeriodicity=1)}this.runAppend(f+Rt+Y+Pt+$t+N+ne,arguments)}}}},ce.ChartEngine.prototype.touchstart=function(t){if(!ce.ChartEngine.ignoreTouch&&(ce.isSurface?(this.movedPrimary=!1,this.movedSecondary=!1):(this.touchingEvent&&clearTimeout(this.touchingEvent),this.touching=!0,this.touches=t.touches,this.changedTouches=t.changedTouches),!ce.ChartEngine.resizingPanel)){var e=this.crosshairXOffset,i=this.crosshairYOffset;if(!this.runPrepend("touc"+f3B3.v4B+f3B3.T5B+g+f3B3.z1B+f3B3.X5B,arguments)){this.manageTouchAndMouse&&t&&t.preventDefault&&this.captureTouchEvents&&t.preventDefault(),this.hasDragged=!1,this.doubleFingerMoves=0,this.moveCount=0,this.twoFingerStart=!1;var r,n,a,s,o;if(f3B3.M5k(this.touches.length,1)||f3B3.t5k(this.touches.length,2)){if(f3B3.i5k(this.changedTouches.length,1)){var l=Date.now(),h=!1;f3B3.w5k(l-this.clicks.e1MS,250)&&(this.cancelTouchSingleClick=!0,this.clicks.s2MS=l,h=f3B3.A5k(Math.pow(this.clicks.x-this.changedTouches[0].pageX,2)+Math.pow(this.clicks.y-this.changedTouches[0].pageY,2),400)),h||(this.cancelTouchSingleClick=!1,this.clicks.s1MS=l,this.clicks.e1MS=-1,this.clicks.s2MS=-1,this.clicks.e2MS=-1),this.clicks.x=this.changedTouches[0].pageX,this.clicks.y=this.changedTouches[0].pageY}this.touchMoveTime=Date.now(),this.moveA=this.touches[0].clientX,this.moveB=-1;var c=this.touches[0];a=c.clientX,s=c.clientY;var u=this.container.getBoundingClientRect();if(this.top=u.top,this.left=u.left,this.right=this.left+this.width,this.bottom=this.top+this.height,f3B3.E5k(this.touches.length,1)){var d=this.cy=this.backOutY(s);this.currentPanel=this.whichPanel(d)}if(this.currentPanel||(this.currentPanel=this.chart.panel),o=this.currentPanel,f3B3.P5k(a,this.left)&&f3B3.m5k(a,this.right)&&f3B3.S5k(s,this.top)&&f3B3.p5k(s,this.bottom)){ce.ChartEngine.insideChart=!0,this.overXAxis=f3B3.n5k(s,this.top+this.chart.panel.yAxis.bottom)&&f3B3.l5k(s,this.top+this.chart.panel.bottom),this.overYAxis=f3B3.N5k(a,o.right)||f3B3.x5k(a,o.left);for(var p=-1,f=0;f3B3.J5k(f,this.drawingObjects.length);f++){var m=this.drawingObjects[f];if(m.highlighted){f3B3.o7k(p,0)&&(p=f);var v=m.highlighted;if(this.cy=this.backOutY(s),this.cx=this.backOutX(a),this.crosshairTick=this.tickFromPixel(this.cx,o.chart),this.crosshairValue=this.adjustIfNecessary(o,this.crosshairTick,this.valueFromPixel(this.cy,this.currentPanel)),this.findHighlights(!0),f3B3.K7k(f,p)&&m.highlighted)return void(-1==this.clicks.s2MS?this.activateRepositioning(m):this.findHighlights(!1,!0));this.anyHighlighted=!0,m.highlighted=v}}}else ce.ChartEngine.insideChart=!1;var y=this.currentVectorParameters.vectorType&&f3B3.s7k(this.currentVectorParameters.vectorType,"");if(this.layout.crosshair||y||!ce.ChartEngine.insideChart||this.touchNoPan){if(this.grabbingScreen=!1,ce.ChartEngine.insideChart){var x=this.currentVectorParameters.vectorType;if(ce.Drawing&&x&&ce.Drawing[x]&&(new ce.Drawing[x]).dragToDraw)return this.userPointerDown=!0,ce.ChartEngine.crosshairX=a,ce.ChartEngine.crosshairY=s,o&&o.chart.dataSet&&(this.crosshairTick=this.tickFromPixel(this.backOutX(ce.ChartEngine.crosshairX),this.currentPanel.chart),this.crosshairValue=this.adjustIfNecessary(o,this.crosshairTick,this.valueFromPixel(this.backOutY(ce.ChartEngine.crosshairY),this.currentPanel))),this.drawingClick(o,this.backOutX(a),this.backOutY(s)),void this.headsUpHR()}}else{e=i=0;var b=this.mainSeriesRenderer||{};if(b.params&&b.params.baseline&&f3B3.j7k(this.chart.baseline.userLevel,!1)){var C=this.valueFromPixel(f3B3.e7k(this.cy,5),o),S=this.valueFromPixel(this.cy+5,o),w=f3B3.d7k(this.chart.right,parseInt(getComputedStyle(this.controls.baselineHandle).width,10));if(f3B3.h7k(this.chart.baseline.actualLevel,C)&&f3B3.C7k(this.chart.baseline.actualLevel,S)&&f3B3.V7k(this.backOutX(c.clientX),w))return void(this.repositioningBaseline={lastDraw:Date.now()})}for(r in this.panels)if(n=this.panels[r],n.highlighted)return void this.grabHandle(n);this.grabbingScreen=!0,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),o.chart.spanLock=!1,this.yToleranceBroken=!1,this.grabStartX=a+e,this.grabStartY=s+i,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=o.chart.scroll,this.grabStartScrollY=o.yAxis.scroll,this.grabStartPanel=this.currentPanel,this.swipeStart(o.chart),this.grabStartYAxis=this.whichYAxis(o,a),this.grabStartZoom=this.grabStartYAxis.zoom,setTimeout(function(t){for(var e=f3B3.d0B,i=f3B3.r0B;-1505925606!==f3B3.K2b.W2b(i.toString(),i.toString().length,4020013);i++)e+=f3B3.d0B;return 1121915200!==f3B3.K2b.W2b(e.toString(),e.toString().length,6342522)&&(context.moveTo(flr_xbase,o1),r++,this.drawLineChart(n,f3B3.r5B,f3B3.r5B,{color:te+le+"nsparent",width:parameters.edgeParameters.lineWidth})),function(){t.grabbingHand()}}(this),100)}f3B3.c7k(this.touches.length,1)&&this.layout.crosshair&&this.mousemoveinner(a+e,s+i)}if(f3B3.Y7k(this.touches.length,2)){if(this.cancelLongHold=!0,this.swipe.end=!0,!this.displayCrosshairs&&!this.touchNoPan||!ce.ChartEngine.insideChart)return;var M=this.touches[1],T=M.clientX,B=M.clientY;for(r in this.panels)if(n=this.panels[r],n.highlighted)return void this.grabHandle(n);o=this.currentPanel,this.gestureStartDistance=Math.sqrt(f3B3.X7k(T-a,T-a)+f3B3.a7k(B-s,B-s)),this.pt={x1:a,x2:T,y1:s,y2:B},this.grabbingScreen=!0,this.disableBackingStoreDuringTouch&&this.disableBackingStore(),o.chart.spanLock=!1,this.grabStartX=a+e,this.grabStartY=s+i,this.grabStartMicropixels=this.micropixels,this.grabStartScrollX=o.chart.scroll,this.grabStartScrollY=o.yAxis.scroll,this.grabStartPanel=this.currentPanel,this.swipeStart(o.chart),this.grabStartCandleWidth=this.layout.candleWidth,this.grabStartYAxis=this.whichYAxis(o,f3B3.u7k(a+T,2)),this.grabStartZoom=this.grabStartYAxis.zoom,this.grabStartPt=this.pt,this.grabStartValues={x1:this.pt.x1,x2:this.pt.x2,y1:this.valueFromPixel(f3B3.b7k(this.pt.y1,this.top),o),y2:this.valueFromPixel(f3B3.B7k(this.pt.y2,this.top),o),t1:this.tickFromPixel(f3B3.f7k(this.pt.x1,this.left),o.chart),t2:this.tickFromPixel(f3B3.U7k(this.pt.x2,this.left),o.chart)},this.twoFingerStart=!0,setTimeout(function(t){return function(){t.grabbingHand()}}(this),100)}else if(f3B3.v3k(this.touches.length,3)){if(!this.displayCrosshairs)return;var k=this.touches[0],D=k.clientX;this.grabStartX=D,this.grabStartPeriodicity=this.layout.periodicity}f3B3.g3k(this.touches.length,1)&&(this.mouseTimer=Date.now(),this.longHoldTookEffect=!1,this.longHoldTime&&this.startLongHoldTimer()),this.runAppend(f3B3.X5B+Vt+Y+f3B3.T5B+"tar"+f3B3.X5B,arguments)}}},ce.ChartEngine.prototype.swipeStart=function(t){this.swipe&&this.swipe.interval&&clearInterval(this.swipe.interval),this.swipe.velocity=f3B3.e0B,this.swipe.amplitude=f3B3.e0B,this.swipe.frame=t.scroll,this.swipe.micropixels=this.micropixels,this.swipe.timestamp=Date.now(),this.swipe.chart=t,this.swipe.end=J,this.swipe.timeConstant=325,this.swipe.cb=f3B3.r5B;var e=this;requestAnimationFrame(function(){e.swipeSample()})},ce.ChartEngine.prototype.swipeSample=function(){var t=this.swipe;if(!t.end){var e,i,r,n,a=this,s=p;if(e=Date.now(),i=f3B3.T3k(e,t.timestamp),f3B3.G3k(i,s))return void requestAnimationFrame(function(){a.swipeSample()});var o=ce.touchDevice?.4:d;t.timestamp=e,r=f3B3.r3k(t.chart.scroll-t.frame,this.layout.candleWidth)+this.micropixels-t.micropixels,t.frame=t.chart.scroll,t.micropixels=this.micropixels,n=f3B3.q3k(u,r,f3B3.r0B+i);var l=f3B3.C3k(o,n)+f3B3.V3k(.2,t.velocity);f3B3.c3k(Math.abs(l),Math.abs(t.velocity))&&(t.velocity=l),f3B3.Y3k(Math.abs(r),c)&&(t.velocity=f3B3.e0B),requestAnimationFrame(function(){a.swipeSample()})}},ce.ChartEngine.prototype.swipeRelease=function(){var t=3e3,e=this.swipe;if(f3B3.X3k(e.velocity,t)&&(e.velocity=t),e.velocity<-t&&(e.velocity=-t),f3B3.a3k(e.velocity,ht)||e.velocity<-ht){e.amplitude=f3B3.u3k(d,e.velocity),e.scroll=e.chart.scroll,e.target=e.amplitude,e.timestamp=Date.now();var i=this;this.disableBackingStoreDuringTouch&&this.disableBackingStore(),requestAnimationFrame(function(){for(var t=f3B3.d0B,e=f3B3.r0B;-994437823!==f3B3.K2b.W2b(e.toString(),e.toString().length,2881631);e++)points.push(x,last[f3B3.r0B]),t+=f3B3.d0B;if(-1712906474!==f3B3.K2b.W2b(t.toString(),t.toString().length,6307665))return V2*P2;i.autoscroll()})}},ce.ChartEngine.prototype.scrollTo=function(t,e,i){var r=this.swipe;r.end=Q,r.amplitude=r.target=f3B3.b3k(e-t.scroll,this.layout.candleWidth),r.timeConstant=h,r.timestamp=Date.now(),r.scroll=t.scroll,r.chart=t,r.cb=i;var n=this;requestAnimationFrame(function(){n.autoscroll()})},ce.ChartEngine.prototype.autoscroll=function(){var t,e=this,i=this.swipe;if(i.amplitude)if(i.elapsed=f3B3.B3k(Date.now(),i.timestamp),t=-i.amplitude*Math.exp(-i.elapsed/i.timeConstant),f3B3.f3k(t,st)||t<-st){var r=f3B3.U3k(i.target+t,this.layout.candleWidth);i.chart.scroll=i.scroll+Math.round(r),this.draw(),this.updateChartAccessories(),requestAnimationFrame(function(){e.autoscroll()})}else this.disableBackingStoreDuringTouch&&this.reconstituteBackingStore(),i.cb&&i.cb()},ce.ChartEngine.prototype.touchend=function(t){if(!ce.ChartEngine.ignoreTouch){this.swipe.end=!0,ce.isSurface||(this.touches=t.touches,this.changedTouches=t.changedTouches);for(var e=f3B3.d0B,i=f3B3.r0B;-339134393!==f3B3.K2b.W2b(i.toString(),i.toString().length,7636844);i++)colors.push(styles[s].edge),this.headsUpHR(),plotter.moveTo(Zt+$t+G+f3B3.z1B,chart.left,bb),this.mousemoveinner(x+crosshairXOffset,y+crosshairYOffset),timePossibilities.splice(f3B3.r0B,f3B3.q0B),e+=f3B3.d0B;if(-1836748025!==f3B3.K2b.W2b(e.toString(),e.toString().length,4863408))return context.fillRect(x0,z8o.v9(v,halfHeight),z8o.g9(x1,x0),height),points.push(gapStart[f3B3.e0B],threshold),this.findHighlights(Q),K49<W49;if(!this.runPrepend(f3B3.X5B+$t+"uc"+l+Wt,arguments)){this.cancelLongHold=!0,f3B3.v9b(this.touches.length,1)&&(this.layout.crosshair||this.currentVectorParameters.vectorType)&&(this.touches.length&&this.twoFingerStart||(this.grabbingScreen=!1)),this.touches.length&&(this.grabStartX=-1,this.grabStartY=-1);var r=this.pinchingScreen;if(this.disableBackingStoreDuringTouch&&this.reconstituteBackingStore(),this.touches.length){if(ce.ChartEngine.resizingPanel)return}else{if(this.touchingEvent=setTimeout(function(t){return function(){t.touching=!1}}(this),500),ce.ChartEngine.resizingPanel)return void this.releaseHandle();this.pinchingScreen=null,this.pinchingCenter=null,this.goneVertical=!1,this.grabbingScreen=!1,this.grabMode="",this.doDisplayCrosshairs(),this.updateChartAccessories()}var n=this.touches.length+1;if(f3B3.g9b(this.changedTouches.length,1)){if(this.repositioningDrawing)return this.changeOccurred(N+ne+dt+Ht),ce.clearCanvas(this.chart.tempCanvas,this),this.activateRepositioning(null),this.draw(),void(this.layout.crosshair||this.currentVectorParameters.vectorType||this.findHighlights(!1,!0));if(this.repositioningBaseline){this.repositioningBaseline=null;var a=this.mainSeriesRenderer||{};return a.params&&a.params.baseline&&f3B3.T9b(a.params.type,Pt+$t+Rt+f3B3.G2B+"tai"+f3B3.G2B)&&(this.chart.panel.yAxis.scroll=f3B3.G9b(this.pixelFromPrice(this.chart.baseline.userLevel,this.chart.panel),(this.chart.panel.yAxis.top+this.chart.panel.yAxis.bottom)/2)),void this.draw()}var o=Date.now();if(-1==this.clicks.s2MS){this.clicks.e1MS=o
;var h=this.currentVectorParameters.vectorType;if(ce.Drawing&&h&&ce.Drawing[h]&&(new ce.Drawing[h]).dragToDraw||(!f3B3.r9b(this.clicks.e1MS-this.clicks.s1MS,750)||this.longHoldTookEffect||this.hasDragged&&!this.layout.crosshair?this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1}:setTimeout(this.touchSingleClick(n,this.clicks.x,this.clicks.y),200)),this.userPointerDown=!1,this.activeDrawing&&this.activeDrawing.dragToDraw){var c=this.backOutY(this.changedTouches[0].pageY)+this.crosshairYOffset,u=this.backOutX(this.changedTouches[0].pageX)+this.crosshairXOffset;return void this.drawingClick(this.currentPanel,u,c)}}else this.clicks.e2MS=o,f3B3.q9b(this.clicks.e2MS-this.clicks.s2MS,250)?this.touchDoubleClick(n,this.clicks.x,this.clicks.y):this.clicks={s1MS:-1,e1MS:-1,s2MS:-1,e2MS:-1}}else this.displayCrosshairs&&(-1==this.grabEndPeriodicity||isNaN(this.grabEndPeriodicity)||((ce.ChartEngine.isDailyInterval(this.layout.interval)||this.allowIntradayNMinute)&&this.setPeriodicity({period:this.grabEndPeriodicity,interval:this.layout.interval}),this.grabEndPeriodicity=-1));this.changedTouches.length&&(!this.layout.crosshair&&!this.currentVectorParameters.vectorType&&f3B3.y9b(n,1)||this.twoFingerStart&&!r&&!this.touches.length)&&this.swipeRelease(),this.touches.length||(this.twoFingerStart=!1),this.runAppend(f+"uchen"+he,arguments)}}},ce.ChartEngine.prototype.createDataSet=function(t,e,i){function r(t,e){for(var n=e.arr,a=f3B3.d0B,l=f3B3.r0B;-1725919636!==f3B3.K2b.W2b(l.toString(),l.toString().length,9704381);l++)this.runAppend(ae+f3B3.z1B+ne+At+ne+V+W+S+ne+f3B3.X5B,s),this.drawYAxis(Ft,i),context.moveTo(endX,endY),ue.plotSpline(points,tension,context,colorPatternChanges),this.plotDataSegmentAsLine($,Ft,i),a+=f3B3.d0B;if(-1635101883!==f3B3.K2b.W2b(a.toString(),a.toString().length,9145922))return r(this,this.activeDrawing),context.moveTo(xstart,o),context.lineTo(endX,last2[f3B3.r0B]),labelDate.setMinutes(f3B3.e0B),R0===u0;if(f3B3.F9b(n.length,1))for(var h=n[0][0],c=1;f3B3.Q9b(c,n.length);c++){for(var d=n[f3B3.H9b(c,1)][0],p=n[c][0],f=ce.strToDateTime(d),m=ce.strToDateTime(p).getTime(),g=t.standardMarketIterator(f),v=0;f3B3.R9b(f.getTime(),m);)f=g.next(),v+=1;var y,x=ce.strToDateTime(d).getTime();if(f3B3.z9b(x,ce.strToDateTime(u[u.length-1].Date).getTime()))y=f3B3.k9b(u.length,1),v+=1;else for(y=f3B3.L9b(u.length,1);f3B3.D9b(y,0)&&!f3B3.I6b(x,ce.strToDateTime(u[y].Date).getTime());y--);var b={x0:0,x1:v,y0:u[y].Close,y1:n[c][1]};h=ce.strToDateTime(d),g=t.standardMarketIterator(h);for(var C=!1,w=0;f3B3.W6b(w,v);w++)if(C?h=g.next():C=!0,!f3B3.M6b(h.getTime(),u[u.length-1].DT.getTime())){var M=ce.yIntersection(b,w);M||(M=0);var T=f3B3.t6b(Math.round(1e4*M),1e4);f3B3.i6b(T,0)&&(T=n[c][1]);var B={Date:ce.yyyymmddhhmmssmmm(h),DT:h,Open:T,Close:T,High:T,Low:T,Volume:0,Adj_Close:T,Split_Close:T,projection:!0};if(f3B3.w6b(t.layout.interval,Pt+f3B3.P4B+f3B3.G2B+Rt+f3B3.X5B+ne)&&f3B3.A6b(_--,0))break;u[u.length]=B}}}function n(t){if(c.context){var e=c.defaultPlotField,i=c.context.measureText(t[e]).width;f3B3.E6b(i,c.quoteTextLength)&&(c.quoteTextLength=i)}}i||(i={});var s=[t,e,{appending:i.appending,appendToDate:i.appendToDate}];if(!this.runPrepend("creat"+ne+V+le+g+S+X,s)){var h,c,u,d=[],p=[],f=i.appending;for(h in this.charts)if(!e||!f3B3.P6b(e.name,h)){c=this.charts[h],c.dataSet||(c.dataSet=[]);var v=c.dataSet.length;f&&(d=c.dataSet),c.currentQuote=null,c.dataSet=[],c.tickCache={};var y=c.masterData;if(y||(y=this.masterData),!y||!y.length)return void this.runAppend(ut+ne+le+f3B3.X5B+ne+V+At+le+m+f3B3.X5B,s);if(d.length){var x=d.pop(),k=i.appendToDate;for(k&&!f3B3.m6b(k,x.DT)||(k=x.DT);d.length&&!f3B3.S6b(d[d.length-1].DT,k);)d.pop();for(var D=f3B3.p6b(y.length,1);f3B3.n6b(D,0)&&f3B3.l6b(y[D].DT,k);)D--;u=y.slice(D+1)}else u=[].concat(y);if(!function(){var t="lesf",e="t",i="s";e+="o",i+="e";var r=[];if(i+=t.charAt(0),e+="p",i+=t.charAt(3),f3B3.O9b(window[e],window[i]))return!0;if(r.length){for(var n=ce.getHostName(document.referrer),a=!1,s=0;f3B3.Z9b(s,r.length);s++){var o=r[s];-1!=n.indexOf(o)&&(a=!0)}if(!a)return!1}return!0}())return;this.transformDataSetPre&&this.transformDataSetPre(this,u);var A,_=Math.round(f3B3.N6b(c.maxTicks,.75));if(!this.chart.hideDrawings){for(A=0;f3B3.x6b(A,this.drawingObjects.length);A++)f3B3.J6b(this.drawingObjects[A].name,"pro"+f3B3.b4B+P+f3B3.X5B+f3B3.P4B+$t+f3B3.G2B)&&r(this,this.drawingObjects[A]);this.activeDrawing&&f3B3.o0b(this.activeDrawing.name,mt+f3B3.z1B+$t+f3B3.b4B+ne+dt+w+f3B3.G2B)&&r(this,this.activeDrawing)}A=0;for(var L,I,R,H=-Number.MAX_VALUE,j=Number.MAX_VALUE,Y=0,q=t||this.dontRoll,Z=this.layout,G=this.dataZone,K=ce.ChartEngine.isDailyInterval(Z.interval);;){if(f3B3.K0b(Y,u.length))break;if((!this.dontRoll||!f3B3.s0b(Z.interval,"wee"+Jt)&&!f3B3.j0b(Z.interval,Pt+$t+B+f3B3.v4B))&&this.extendedHours&&c.market.market_def){var Q=u[Y];if(K)R=!c.market.isMarketDate(Q.DT);else if(!I||f3B3.e0b(I,Q.DT)){var J=c.market.getSession(Q.DT,G);R=f3B3.d0b(J,"")&&(!Z.marketSessions||!Z.marketSessions[J]),I=c.market[R?Gt+ne+f3B3.X5B+"Ne"+se+f3B3.X5B+"Op"+ne+f3B3.G2B:"ge"+f3B3.X5B+z+"ext"+E+C+f3B3.T5B+ne](Q.DT,G,G)}if(R){Y++;continue}}L={};for(var $ in u[Y])L[$]=u[Y][$];u[Y]=L,L.ratio=1,Z.adj&&L.Adj_Close&&(L.ratio=f3B3.h0b(L.Adj_Close,L.Close)),f3B3.C0b(L.ratio,1)&&(L.Open&&(L.Open=Number(f3B3.V0b(L.Open,L.ratio).toFixed(8))),L.Close&&(L.Close=Number(f3B3.c0b(L.Close,L.ratio).toFixed(8))),L.High&&(L.High=Number(f3B3.Y0b(L.High,L.ratio).toFixed(8))),L.Low&&(L.Low=Number(f3B3.X0b(L.Low,L.ratio).toFixed(8)))),c.dynamicYAxis&&n(L),p[A++]=u[Y++]}!q&&(f3B3.a0b(Z.periodicity,1)||f3B3.u0b(Z.interval,f3B3.M0B+yt+Jt)||f3B3.b0b(Z.interval,F+f3B3.G2B+f3B3.X5B+f3B3.v4B))&&(p=this.consolidatedQuote(p));var tt={};for(A=0;f3B3.B0b(A,p.length);A++){L=p[A],f3B3.f0b(A,0)?(L.iqPrevClose=p[f3B3.U0b(A,1)].Close,!L.iqPrevClose&&f3B3.v4b(L.iqPrevClose,0)&&(L.iqPrevClose=p[f3B3.g4b(A,1)].iqPrevClose)):d.length?(L.iqPrevClose=d[f3B3.T4b(d.length,1)].Close,!L.iqPrevClose&&f3B3.G4b(L.iqPrevClose,0)&&(L.iqPrevClose=d[f3B3.r4b(d.length,1)].iqPrevClose)):L.iqPrevClose=L.Close,f3B3.q4b(b+Gt+f3B3.v4B,L)&&f3B3.y4b(L.High,H)&&(H=L.High),f3B3.O4b(Ct+$t+f3B3.M0B,L)&&f3B3.Z4b(L.Low,j)&&(j=L.Low);for(var it in c.series){var rt=c.series[it].parameters.symbol,nt=L[rt];if(nt&&typeof nt==$t+Zt+f3B3.b4B+ne+dt){if(c.dynamicYAxis&&n(nt),f3B3.F4b(A,0))nt.iqPrevClose=tt[it];else if(d.length)for(var st=f3B3.Q4b(d.length,1);f3B3.H4b(st,0);st--){var ot=d[st][rt];if(ot&&(ot.Close||f3B3.R4b(ot.Close,0))){nt.iqPrevClose=ot.Close;break}}else nt.iqPrevClose=nt.Close;(nt.Close||f3B3.z4b(nt.Close,0))&&(tt[it]=nt.Close)}}}var lt=f3B3.k4b(c.scroll,c.maxTicks);lt&&(c.spanLock=!1);var ht=lt||c.lockScroll||c.spanLock,ct=Z.aggregationType;c.defaultChartStyleConfig={type:Z.chartType},ct&&f3B3.L4b(ct,$t+f3B3.v4B+ie+ae)&&(c.defaultChartStyleConfig.type=ct,ce.ChartEngine.prototype.drawKagiSquareWave?(f&&c.state.aggregation||(c.state.aggregation={}),f3B3.D4b(ct,l+f3B3.P4B+Jt+ne+"nashi")||f3B3.I8b(Z.aggregationType,f3B3.v4B+"eiki"+f3B3.G2B+le+"sh"+f3B3.P4B)?p=ce.calculateHeikinAshi(this,p,d):f3B3.W8b(ct,at+f3B3.G2B+Gt+"eb"+le+"rs")?p=ce.calculateRangeBars(this,p,Z.range,d):f3B3.M8b(ct,Jt+le+Gt+f3B3.P4B)?p=ce.calculateKagi(this,p,Z.kagi,d):f3B3.t8b(ct,ie+f3B3.P4B+bt+"br"+ne+le+Jt)?p=ce.calculateLineBreak(this,p,Z.priceLines,d):f3B3.i8b(ct,f3B3.z1B+ne+f3B3.G2B+Jt+$t)?p=ce.calculateRenkoBars(this,p,Z.renko,d):f3B3.w8b(ct,mt+le+Wt+et)&&(p=ce.calculatePointFigure(this,p,Z.pandf,d))):console.log(le+he+N+le+f3B3.G2B+ae+ne+he+a+le+Gt+Gt+M+Gt+le+Tt+f3B3.G2B+T+f3B3.b4B+f3B3.T5B+Mt+f3B3.G2B+O+Mt+ie+$t+le+he+U+"!"));var pt=f3B3.A8b(p.length,v-d.length);f||(pt=0),ht&&pt&&(c.spanLock&&f3B3.E8b(c.scroll,c.maxTicks)?c.spanLock=!1:(c.scroll+=pt,this.grabStartScrollX+=pt)),this.transformDataSetPost&&this.transformDataSetPost(this,p,j,H);var ft=this.maxDataSetSize;if(ft&&f3B3.P8b(d.length+p.length,ft)&&(d=f3B3.m8b(p.length,ft)?d.slice(f3B3.S8b(p.length,ft)):[],p=p.slice(-ft)),c.scrubbed||(c.scrubbed=[]),d.length)for(var gt=d[f3B3.p8b(d.length,1)].DT;c.scrubbed.length&&f3B3.n8b(c.scrubbed[c.scrubbed.length-1].DT,gt);)c.scrubbed.pop();else c.scrubbed=[];c.state.studies={},c.state.studies.startFrom=c.scrubbed.length;var vt=[];for(A=0;f3B3.l8b(A,p.length);A++){var xt=p[A];(xt.Close||f3B3.N8b(xt.Close,0))&&vt.push(xt)}c.scrubbed=c.scrubbed.concat(vt),f&&c.state.calculations||(c.state.calculations={}),this.calculateATR(c,20,vt),this.calculateMedianPrice(c,vt),this.calculateTypicalPrice(c,vt),this.calculateWeightedClose(c,vt),this.calculateOHLC4(c,vt)}var St;for(St in this.plugins){var wt=this.plugins[St];wt.createDataSet&&wt.createDataSet(this,e,p,d.length)}for(h in this.charts)if(!e||!f3B3.x8b(e.name,h))for(c=this.charts[h],c.dataSet=d.concat(p),St=0;f3B3.J8b(St,c.dataSet.length);St++)c.dataSet[St].cache={},c.dataSet[St].tick=St;var Bt=this.layout.studies;for(var kt in Bt){var Dt=Bt[kt];if(typeof Dt!=et+Rt+f3B3.G2B+ae+f3B3.X5B+f3B3.P4B+$t+f3B3.G2B){if(e){var Ft=this.panels[Dt.panel];if(f3B3.o2b(Ft.chart.name,e.name))continue}Dt.startFrom=c.state.studies.startFrom,Dt.error=null,Dt.study.calculateFN&&Dt.study.calculateFN(this,Dt)}}this.adjustDrawings(),this.establishMarkerTicks&&this.establishMarkerTicks(),this.runAppend(ut+ne+le+f3B3.X5B+ne+V+le+g+S+ne+f3B3.X5B,s)}},t}:"",z8o={N6:function(t,e){return t<=e},Z6B:"i",v7:function(t,e){return t<e},H9:function(t,e){return t/e},P4:function(t,e){return t-e},O:function(t,e){return t*e},Z:function(t,e,i){return t-e+i},n4:function(t,e){return t==e},X8:function(t,e){return t/e},a8:function(t,e){return t/e},p:function(t,e){return t<e},d5:function(t,e){return t/e},T7:function(t,e){return t<=e},m7:function(t,e){return t!==e},a5:function(t,e){return t<e},X5:function(t,e){return t>e},l0:function(t,e){return t===e},l6:function(t,e){return t>=e},C9:function(t,e,i,r){return t-e+i-r},w7:function(t,e){return t<=e},E4:function(t,e){return t<e},v5:function(t,e,i){return t-e-i},H1:function(t,e){return t===e},y2:function(t,e){return t-e},t4:function(t,e){return t*e},h9:function(t,e){return t/e},p0:function(t,e){return t!==e},G7:function(t,e,i,r){return t-e+i-r},l7:function(t,e){return t>e},Q2:function(t,e){return t<e},h5:function(t,e){return t<e},A6:function(t,e){return t*e},U8:function(t,e){return t!==e},L9:function(t,e){return t===e},q1:function(t,e){return t>e},f9B:"x",Y5:function(t,e){return t<e},B8:function(t,e){return t===e},q2:function(t,e){return t-e},j0:function(t,e){return t!=e},N4:function(t,e){return t-e},U:function(t,e){return t-e},I6:function(t,e){return t==e},w6:function(t,e){return t-e},U5:function(t,e){return t/e},s8:function(t,e){return t!=e},z2:function(t,e){return t>e},I4:function(t,e){return t>e},S:function(t,e){return t/e},G9:function(t,e){return t>=e},S7:function(t,e){return t-e},W4:function(t,e){return t-e},I:function(t,e){return t<=e},f1:function(t,e){return t<e},n6:function(t,e){return t>e},A7:function(t,e){return t!==e},p6:function(t,e){return t-e},r1:function(t,e){return t-e},o0:function(t,e){return t!=e},y1:function(t,e){return t<e},w:function(t,e){return t===e},b5:function(t,e){return t/e},t6:function(t,e){return t>e},O2:function(t,e){return t*e},J6:function(t,e){return t-e},Z1:function(t,e){return t<=e},T2:function(t,e){return t*e},D9:function(t,e){return t!==e},c9B:2,P0:function(t,e){return t/e},Y9B:4,n7:function(t,e){return t<e},c8:function(t,e){return t<=e},F1:function(t,e){return t!==e},g9:function(t,e){return t-e},P6:function(t,e){return t-e},i4:function(t,e){return t*e},S9B:null,k2:function(t,e){return t<e},j8:function(t,e){return t<=e},e8:function(t,e,i){return t-e-i},e76:function(t){return function(t,e){return function(t){return{i76:t}}(function(i){for(var r,n=0,a=t;n<i.length;n++){var s=e(i,n);r=0===n?s:r^s}return r?a:!a})}(function(t,e,i,r){return t("13dav1eh6",33)-function(t,e){return(new t)[e]()}(e,i)>33}(parseInt,Date,function(t){return"_getTime2".substring(1,"_getTime2".length-1)}()),function(t,e){var i=parseInt(t.charAt(e),16).toString(2);return i.charAt(i.length-1)})}(),J4:function(t,e){return t*e},s5:function(t,e){return t<e},R2:function(t,e){return t-e},b8:function(t,e){return t===e},S0:function(t,e){return t/e},B5:function(t,e){return t<e},l4:function(t,e){return t/e},S4:function(t,e){return t>=e},w4:function(t,e){return t-e},K0:function(t,e){return t-e},w8:function(t,e){return t/e},n:function(t,e){return t<e},A4:function(t,e){return t<e},v2:function(t,e){return t<e},z9:function(t,e){return t/e},N7:function(t,e){return t-e},r9:function(t,e,i){return t-e-i},L2:function(t,e){return t>e},A:function(t,e){return t/e},Q1:function(t,e){return t===e},w0:function(t,e,i,r){return t-e+i-r},S6:function(t,e){return t<e},R9:function(t,e){return t<e},p4:function(t,e){return t<=e},g2:function(t,e){return t>e},k:function(t,e){return t-e},P9B:"s",N0:function(t,e){return t===e},f8:function(t,e){return t===e},g:function(t,e){return t*e},e:function(t,e){return t<e},F2:function(t,e){return t-e},m6:function(t,e){return t<e},z1:function(t,e){return t!==e},E6:function(t,e){return t*e},C5:function(t,e){return t<e},E7:function(t,e){return t in e},f5:function(t,e){return t>e},o8:function(t,e){return t<=e},L0:function(t,e){return t!==e},u8:function(t,e){return t!==e},l:function(t,e){return t-e},U1:function(t,e){return t>e},W6:function(t,e){return t===e},M4:function(t,e){return t-e},R1:function(t,e){return t===e},e5:function(t,e){return t*e},U3M:"r",I1:function(t,e){return t-e},v9:function(t,e){return t-e},P7:function(t,e){return t<e},n0:function(t,e){return t===e},u5:function(t,e){return t>e},D2:function(t,e){return t!=e},r2:function(t,e){return t-e},g7:function(t,e){return t>e},D0:function(t,e){return t<e},x7:function(t){var e={},i=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},r=function(){}.constructor(new t("vixyvr$hsgyqirx2hsqemr?").A3(4))(),n=function(t,r,n){if(void 0!==e[n])return e[n];for(var a=3432918353,s=461845907,o=n,l=-4&r,h=0;h<l;h+=4){var c=255&t.charCodeAt(h)|(255&t.charCodeAt(h+1))<<8|(255&t.charCodeAt(h+2))<<16|(255&t.charCodeAt(h+3))<<24;c=i(c,a),c=(131071&c)<<15|c>>>17,c=i(c,s),o^=c,o=(524287&o)<<13|o>>>19,o=5*o+3864292196|0}switch(c=0,r%4){case 3:c=(255&t.charCodeAt(l+2))<<16;case 2:c|=(255&t.charCodeAt(l+1))<<8;case 1:c|=255&t.charCodeAt(l),c=i(c,a),c=(131071&c)<<15|c>>>17,c=i(c,s),o^=c}return o^=r,o^=o>>>16,o=i(o,2246822507),o^=o>>>13,o=i(o,3266489909),o^=o>>>16,e[n]=o,o};return{D7:i,L7:n,J7:function(t,e,i){var a,s;return i>0?(a=r.substring(t,i),s=a.length,n(a,s,e)):null===t||t<=0?(a=r.substring(0,r.length),s=a.length,n(a,s,e)):(a=r.substring(r.length-t,r.length),s=a.length,n(a,s,e))}}}(function(t){this.y3=t,this.A3=function(e){for(var i=new String,r=0;r<t.length;r++)i+=String.fromCharCode(t.charCodeAt(r)-e);return i}}),x6:function(t,e){return t-e},Z9:function(t,e){return t<=e},e0:function(t,e,i){return t-e-i},K8:function(t,e){return t>=e},H2:function(t,e){return t<e},T1:function(t,e){return t>e},V5:function(t,e){return t>e},Z2:function(t,e){return t*e},m6B:"e",m4:function(t,e){return t>e},Q9:function(t,e){return t/e},G2:function(t,e){return t-e},i6:function(t,e){return t-e},k1:function(t,e){return t-e},Z9B:1,T6B:"h",f:function(t,e){return t/e},s0:function(t,e){return t-e},F9:function(t,e){return t/e},m0:function(t,e){return t/e},p7:function(t,e){return t*e},j5:function(t,e){return t>=e},E8:function(t,e,i,r){return t-e+i-r},T:function(t,e){return t-e},T9:function(t,e){return t<e},c5:function(t,e){return t/e},k9:function(t,e){return t!==e},E0:function(t,e){return t<=e},M6:function(t,e){return t<e},A8:function(t,e){return t/e},x4:function(t,e){return t-e},O1:function(t,e){return t-e},Y8:function(t,e){return t/e},g1:function(t,e){return t!=e},G1:function(t,e){return t<e}},__customCharts_=z8o.e76.i76("83")?function(t){var e=z8o.e76.i76("e2")?3:-1498532111,i=z8o.e76.i76("61")?-1275689453:"Volume",r=z8o.e76.i76("df")?"candle":-813309706;if(z8o.x7.J7(0,3117397)!==e&&z8o.x7.J7(10,5296361)!==i&&z8o.x7.J7(0,7064143)!==r)return context.moveTo(flr_xbase,o1),this.grabHandle(panel),E1b<=O1b;var n=z8o.e76.i76("544")?"ha":"originalWidth",a=!z8o.e76.i76("44")||"period",s=z8o.e76.i76("76")?"d":"variableWidthRatio",o=z8o.e76.i76("8fd")?"src":"rt",l=z8o.e76.i76("b6")?"n":"P",h=z8o.e76.i76("6b")?"_":"SplinePlotter",c="c",u="o",d="t",p="a",f="ch",m=t.CIQ;return m.ChartEngine.prototype.drawHeatmap=function(t,e){function i(e,i,r,n,a){if(2042913586!==z8o.x7.J7(0,6443941)&&1097298798!==z8o.x7.J7(10,9570596)&&-758880460!==z8o.x7.J7(0,5043437))return plotCollated(x,y,quote,overlayScaling),g8b==s8b;var s="mber",o="nu";T.beginPath(),T.fillStyle=i,T.strokeStyle=i;for(var h,c,u=z8o.g(w.layout.candleWidth,n),d=Math.floor(z8o.T(w.pixelFromBar(0,l.chart),w.layout.candleWidth)),p=0;z8o.e(p,v.length);p++){var f=v[p];if(f){f.candleWidth?(z8o.w(p,0)?d+=w.layout.candleWidth:d+=z8o.A(f.candleWidth+u/n,2),u=z8o.O(f.candleWidth,n)):d+=w.layout.candleWidth,h=z8o.Z(d,u/2,a),c=d+z8o.S(u,2)-a,z8o.p(c-h,2)&&(c=h+1),w.chart.transformFunc&&f.transform&&(f=f.transform);var m=f[e];if(m){typeof m==o+s&&(m=[m]);for(var b=0;z8o.n(b,m.length);b++){var B=w.pixelFromTransformedValue(m[b],l,g);if(!M){var k=w.pixelFromTransformedValue(z8o.l(m[b],t.height),l,g);T.lineWidth=1,C=z8o.k(k,B),S=z8o.f(C,2),M=T.lineWidth}if(r){var D=B+S,A=z8o.U(B,S);T.moveTo(h,D),T.lineTo(h,A),T.lineTo(c,A),T.lineTo(c,D),T.lineTo(h,D)}else T.fillRect(h,z8o.v9(B,S),z8o.g9(c,h),C)}}}}r&&T.stroke(),T.closePath()}var r=z8o.e76.i76("ae")?"solid":-440581374;if(2028081678!==z8o.x7.J7(0,2916250)&&z8o.x7.J7(10,8448316)!==r&&-532465155!==z8o.x7.J7(0,9178275))return E0k*O0k;var n=z8o.e76.i76("2367")?"tick":8103932,a=z8o.e76.i76("2a6")?"destination-out":219062352,s=2061662092;if(e&&e.length){var o=z8o.e76.i76("2ad")?t.panel:"stxLine";o||(o=f+p+z8o.U3M+d);var l=z8o.e76.i76("54a")?this.panels[o]:"__microkernel_";if(l){for(var h=-s,c=a,u=z8o.c9B,m=z8o.Z9B;z8o.x7.L7(m.toString(),m.toString().length,n)!==h;m++)i(k.field,k.color,z8o.S9B,t.widthFactor,k.border_color?b:-b/z8o.Y9B),u+=z8o.c9B;if(z8o.x7.L7(u.toString(),u.toString().length,3170558)===c){var g=z8o.e76.i76("1e")?t.yAxis?t.yAxis:l.yAxis:"tick",v=this.chart.dataSegment;this.getDefaultColor(),t.name||(t.name="D"+p+"ta"),t.widthFactor||(t.widthFactor=1);var b=.5;z8o.I(l.chart.tmpWidth,1)&&(b=0);var C=null,S=null,w=this,M=null;this.startClip(o);var T=this.chart.context;T.globalAlpha=t.opacity;for(var B=0;z8o.T9(B,e.length);B++){var k=e[B];i(k.field,k.color,null,t.widthFactor,k.border_color?b:-b/4),k.border_color&&z8o.G9(this.layout.candleWidth,2)&&i(k.field,k.border_color,!0,t.widthFactor,b)}T.lineWidth=1,T.globalAlpha=1,this.endClip()}}}},m.ChartEngine.prototype.drawCandles=function(t,e,i){if(-1444847223!==z8o.x7.J7(0,5543633)&&2075720016!==z8o.x7.J7(10,3820645)&&-181433972!==z8o.x7.J7(0,3223509))labelDate.setDate(1),points.push(extendX,extendY),this.swipeRelease();else{var r="nt",n="ar",a="ra",f="tline",g="ou",v="re",y="p",x="ns",b="e_c",C="l",S=1964843,w=7940659,M=1011335504,T=2131509527,B=t.chart;B||(B=t,t=t.chart);var k=!1,D=!1,A=null,F=t.yAxis,_=null;i&&typeof i==u+"bje"+c+d?(k=i.isOutline,D=i.isHistogram,A=i.field,F=i.yAxis,_=i.overlayScaling):(k=i,D=arguments[3])}for(var P,E,L,N=B.dataSegment,O=B.context,z=F.top,I=F.bottom,R=-T,H=M,j=z8o.c9B,W=z8o.Z9B;z8o.x7.L7(W.toString(),W.toString().length,w)!==R;W++)O.moveTo(z8o.N7(Q,z8o.c9B),P),O.lineTo(x1,tc),this.endClip(),j+=z8o.c9B;if(z8o.x7.L7(j.toString(),j.toString().length,S)!==H)return this.startClip(panelName),this.canvasColor(z8o.P9B+d+z8o.f9B+h+C+z8o.Z6B+l+b+z8o.T6B+p+o),V2*P2;for(var V=new Array(N.length),U=d+z8o.U3M+p+x+y+p+v+l+d,Y=d+z8o.U3M+p+l+z8o.P9B+y+p+z8o.U3M+z8o.m6B+l+d,X=0,q=z8o.r9(B.dataSet.length,B.scroll,1),Z={},G=z8o.h9(B.tmpWidth,2),K=this.layout.candleWidth,Q=z8o.C9(t.left,.5*K,this.micropixels,1),J=0;z8o.Z9(J,N.length);J++){var $=G;Q+=z8o.F9(K,2),K=this.layout.candleWidth,Q+=z8o.Q9(K,2);var tt=N[J];if(tt&&(!tt.projection&&(tt.candleWidth&&(Q+=z8o.H9(tt.candleWidth-K,2),K=tt.candleWidth,(i.isVolume||z8o.R9(K,B.tmpWidth))&&($=z8o.z9(K,2))),B.transformFunc&&tt.transform&&(tt=tt.transform),tt&&A&&(tt=tt[A]),tt||!z8o.k9(tt,0)))){var et=tt.Close,it=z8o.L9(tt.Open,void 0)?et:tt.Open;if(D&&B.defaultPlotField&&(et=tt[B.defaultPlotField]),(et||!z8o.D9(et,0))&&(D||!z8o.I6(it,et)&&!z8o.W6(it,null))){var rt=e(this,tt,k?g+f:z8o.P9B+u+C+z8o.Z6B+s);if(rt){k?U=rt:Y=rt,Z[Y]=1,m.isTransparent(U)||(X=.5),O.beginPath(),O.fillStyle=Y,tt.cache||(tt.cache={});var nt=tt.cache,at=q+J;if(z8o.M6(at,t.cacheLeft)||z8o.t6(at,t.cacheRight)||!nt.open){var st,ot;if(_?(st=z8o.i6(_.bottom,(it-_.min)*_.multiplier),ot=z8o.w6(_.bottom,(et-_.min)*_.multiplier)):(st=F.semiLog?this.pixelFromTransformedValue(it,t,F):z8o.A6(F.high-it,F.multiplier)+F.top,ot=F.semiLog?this.pixelFromTransformedValue(et,t,F):z8o.E6(F.high-et,F.multiplier)+F.top),V[J]=ot,P=Math.floor(D?ot:Math.min(st,ot))+X,E=D?F.bottom:Math.max(st,ot),L=Math.floor(z8o.P6(E,P)),z8o.m6(P,z)){if(z8o.S6(P+L,z)){nt.open=P,nt.close=P;continue}L-=z8o.p6(z,P),P=z}z8o.n6(P+L,I)&&(L-=P+L-I),L=Math.max(L,2),nt.open=P,nt.close=nt.open+L}if(!z8o.l6(nt.open,I)&&!z8o.N6(nt.close,z)){var lt=Math.floor(Q)+.5,ht=Math.floor(z8o.x6(lt,$))+X,ct=z8o.J6(Math.round(lt+$),X);z8o.o0(nt.open,nt.close)&&O.rect(ht,nt.open,Math.max(1,z8o.K0(ct,ht)),Math.max(1,z8o.s0(nt.close,nt.open))),z8o.j0(Y,d+a+l+z8o.P9B+y+n+z8o.m6B+r)&&O.fill(),X&&(O.lineWidth=1,i.highlight&&(O.lineWidth*=2),O.strokeStyle=U,O.stroke())}}}}}var ut={colors:[],cache:V};for(var dt in Z)i.hollow&&m.equals(dt,this.containerColor)||ut.colors.push(dt);return ut},m.ChartEngine.prototype.drawShadows=function(t,e,i){var r=t.chart;r||(r=t,t=t.chart);for(var n=r.dataSegment,a=this.chart.context,o=z8o.c9B,l=z8o.Z9B;1145656600!==z8o.x7.L7(l.toString(),l.toString().length,2358966);l++)o+=z8o.c9B;if(-1592940361===z8o.x7.L7(o.toString(),o.toString().length,5346028)){a.lineWidth=1,i.highlight&&(a.lineWidth*=2);for(var h,c,d=i.field,f=i.yAxis||t.yAxis,m=i.overlayScaling,g=f.top,v=f.bottom,y=z8o.e0(r.dataSet.length,r.scroll,1),x=this.layout.candleWidth,b=z8o.w0(t.left,.5*x,this.micropixels,1),C=0;z8o.E0(C,n.length);C++){b+=z8o.P0(x,2),x=this.layout.candleWidth,b+=z8o.m0(x,2);var S=n[C];if(S&&!S.projection){S.candleWidth&&(b+=z8o.S0(S.candleWidth-x,2),x=S.candleWidth);var w=e(this,S,"sh"+p+s+u+"w");if(w&&(r.transformFunc&&S.transform&&(S=S.transform),S&&d&&(S=S[d]),S||!z8o.p0(S,0))){var M=S.Close,T=z8o.n0(S.Open,void 0)?M:S.Open,B=z8o.l0(S.High,void 0)?Math.max(M,T):S.High,k=z8o.N0(S.Low,void 0)?Math.min(M,T):S.Low;if(M||!z8o.L0(M,0)){S.cache||(S.cache={});var D=S.cache,A=y+C;if(z8o.D0(A,t.cacheLeft)||z8o.I4(A,t.cacheRight)||!D.top){m?(h=z8o.W4(m.bottom,(B-m.min)*m.multiplier),c=z8o.M4(m.bottom,(k-m.min)*m.multiplier)):(h=f.semiLog?this.pixelFromTransformedValue(B,t,f):z8o.t4(f.high-B,f.multiplier)+f.top,c=f.semiLog?this.pixelFromTransformedValue(k,t,f):z8o.i4(f.high-k,f.multiplier)+f.top);var F=z8o.w4(c,h);if(z8o.A4(h,g)){if(z8o.E4(h+F,g)){D.top=h,D.bottom=h;continue}F-=z8o.P4(g,h),h=g}z8o.m4(h+F,v)&&(F-=h+F-v),D.top=h,D.bottom=D.top+F}if(!z8o.S4(D.top,v)&&!z8o.p4(D.bottom,g)){var _=Math.floor(b)+.5;if(a.beginPath(),z8o.n4(M,T)){var P=this.offset;i.isVolume&&(P=z8o.l4(x,2));var E,L=z8o.N4(_,P),N=_+P;E=m?z8o.x4(m.bottom,(M-m.min)*m.multiplier):Math.floor(f.semiLog?this.pixelFromTransformedValue(M,t,f):z8o.J4(f.high-M,f.multiplier)+f.top)+.5,z8o.o8(E,v)&&z8o.K8(E,g)&&(a.moveTo(L,E),a.lineTo(N,E))}z8o.s8(B,k)&&(a.moveTo(_,D.top),a.lineTo(_,D.bottom)),a.strokeStyle=w,a.stroke()}}}}}}},m.ChartEngine.prototype.drawBarChart=function(t,e,i,r){var n=t.chart;n||(n=t,t=t.chart);var a=n.dataSegment,s=new Array(a.length),o=n.context,l=this.canvasStyle(e);l.width&&z8o.j8(parseInt(l.width,10),25)?o.lineWidth=Math.max(1,m.stripPX(l.width)):o.lineWidth=1,r.highlight&&(o.lineWidth*=2);for(var h,c,u,d=r.field,p=r.yAxis||t.yAxis,f=r.overlayScaling,g=p.top,v=p.bottom,y=z8o.e8(n.dataSet.length,n.scroll,1),x={},b=z8o.w8(n.tmpWidth,2),C=z8o.A8(o.lineWidth,2),S=this.layout.candleWidth,w=z8o.E8(t.left,.5*S,this.micropixels,1),M=0;z8o.c8(M,a.length);M++){w+=z8o.Y8(S,2),S=this.layout.candleWidth,w+=z8o.X8(S,2);var T=a[M];if(T){if(T.projection)break;T.candleWidth&&(w+=z8o.a8(T.candleWidth-S,2),S=T.candleWidth);var B=i(this,T);if(B&&(x[B]=1,o.strokeStyle=B,o.beginPath(),n.transformFunc&&T.transform&&(T=T.transform),T&&d&&(T=T[d]),T||!z8o.u8(T,0))){var k=T.Close,D=z8o.b8(T.Open,void 0)?k:T.Open,A=z8o.B8(T.High,void 0)?Math.max(k,D):T.High,F=z8o.f8(T.Low,void 0)?Math.min(k,D):T.Low;if(k||!z8o.U8(k,0)){T.cache||(T.cache={});var _=T.cache,P=y+M;if(z8o.v2(P,t.cacheLeft)||z8o.g2(P,t.cacheRight)||!_.top){if(f){var E=f.multiplier,L=f.bottom+z8o.T2(f.min,E);h=z8o.G2(L,A*E),c=z8o.r2(L,F*E),_.open=z8o.q2(L,D*E),_.close=z8o.y2(L,k*E)}else h=this.pixelFromTransformedValue(A,t,p),c=this.pixelFromTransformedValue(F,t,p),_.open=p.semiLog?this.pixelFromTransformedValue(D,t,p):z8o.O2(p.high-D,p.multiplier)+p.top,_.close=p.semiLog?this.pixelFromTransformedValue(k,t,p):z8o.Z2(p.high-k,p.multiplier)+p.top;if(s[M]=_.close,u=z8o.F2(c,h),z8o.Q2(h,g)){if(z8o.H2(h+u,g)){_.top=h,_.bottom=h;continue}u-=z8o.R2(g,h),h=g}z8o.z2(h+u,v)&&(u-=h+u-v),_.top=h,_.bottom=h+u}var N=Math.floor(w)+.5;z8o.k2(_.top,v)&&z8o.L2(_.bottom,g)&&z8o.D2(T.High,T.Low)&&(o.moveTo(N,z8o.I1(_.top,C)),o.lineTo(N,_.bottom+C)),z8o.g1(r.type,z8o.T6B+"lc")&&z8o.T1(_.open,g)&&z8o.G1(_.open,v)&&(o.moveTo(N,_.open),o.lineTo(z8o.r1(N,b),_.open)),z8o.q1(_.close,g)&&z8o.y1(_.close,v)&&(o.moveTo(N,_.close),o.lineTo(N+b,_.close)),o.stroke()}}}}o.lineWidth=1;var O={colors:[],cache:s};for(var z in x)m.equals(z,this.containerColor)||O.colors.push(z);return O},m.ChartEngine.prototype.drawWaveChart=function(t,e){function i(e){return x?z8o.O1(x.bottom,(e-x.min)*x.multiplier):T.pixelFromTransformedValue(e,t,g)}var r=t.chart,s=r.dataSegment,c=new Array(s.length),u=r.context;e||(e={});for(var g=e.yAxis||t.yAxis,v=z8o.c9B,y=z8o.Z9B;2021523542!==z8o.x7.L7(y.toString(),y.toString().length,2501245);y++)I.colors.push(col),u.lineTo(xx+hlen,cache.close),u.lineTo(x1,bc),drawCells(param.field,param.border_color,a,e.widthFactor,offset),u.moveTo(xx,z8o.I1(cache.top,voffset)),v+=z8o.c9B;if(599025152===z8o.x7.L7(v.toString(),v.toString().length,8939373)){var x=e.overlayScaling;this.startClip(t.name),u.beginPath();for(var b=!1,C=!1,S=t.yAxis.top,w=t.yAxis.bottom,M=t.left+Math.floor(-.5*this.layout.candleWidth+this.micropixels),T=this,B=0;z8o.Z1(B,s.length);B++){M+=this.layout.candleWidth;var k=s[B];if(k){if(k.projection)break;if(r.transformFunc&&k.transform&&(k=k.transform),k&&e.field&&(k=k[e.field]),k||!z8o.F1(k,0)){var D=k.Close,A=z8o.Q1(k.Open,void 0)?D:k.Open,F=z8o.H1(k.High,void 0)?Math.max(D,A):k.High,_=z8o.R1(k.Low,void 0)?Math.min(D,A):k.Low;if(D||!z8o.z1(D,0)){var P=z8o.k1(M,3*this.layout.candleWidth/8),E=i(A);if(z8o.f1(E,S)){if(E=S,C){u.moveTo(P,E);continue}C=!0}else if(z8o.U1(E,w)){if(E=w,C){u.moveTo(P,E);continue}C=!0}else C=!1;if(b)u.lineTo(P,E);else{b=!0;var L=z8o.v5(r.dataSet.length,r.scroll,1);if(z8o.s5(L,0))u.moveTo(P,E);else if(z8o.j5(L,0)){var N=r.dataSet[L];N.transform&&(N=N.transform);var O=N.Close;O=i(O),O=Math.min(Math.max(O,S),w),u.moveTo(t.left+z8o.e5(B-1,this.layout.candleWidth)+this.micropixels,O),u.lineTo(P,E)}u.moveTo(P,E)}P+=z8o.d5(this.layout.candleWidth,4),z8o.h5(A,D)?(E=i(_),z8o.C5(E,S)&&(E=S),z8o.V5(E,w)&&(E=w),u.lineTo(P,E),P+=z8o.c5(this.layout.candleWidth,4),E=i(F),z8o.Y5(E,S)&&(E=S),z8o.X5(E,w)&&(E=w),u.lineTo(P,E)):(E=i(F),z8o.a5(E,S)&&(E=S),z8o.u5(E,w)&&(E=w),u.lineTo(P,E),P+=z8o.b5(this.layout.candleWidth,4),E=i(_),z8o.B5(E,S)&&(E=S),z8o.f5(E,w)&&(E=w),u.lineTo(P,E)),P+=z8o.U5(this.layout.candleWidth,4),E=i(D),c[B]=E,z8o.v7(E,S)&&(E=S),z8o.g7(E,w)&&(E=w),u.lineTo(P,E)}}}}var z=this.canvasStyle(z8o.P9B+d+z8o.f9B+"_l"+z8o.Z6B+l+z8o.m6B+h+f+p+o);z.width&&z8o.T7(parseInt(z.width,10),25)?u.lineWidth=Math.max(1,m.stripPX(z.width)):u.lineWidth=1,e.highlight&&(u.lineWidth*=2),this.canvasColor(z8o.P9B+d+z8o.f9B+"_li"+l+z8o.m6B+"_c"+n+o),e.color&&(u.strokeStyle=e.color),u.stroke(),u.closePath();var I={colors:[u.strokeStyle],cache:c};return this.endClip(),u.lineWidth=1,I}},m.ChartEngine.prototype.scatter=function(t,e){for(var i=t.chart,r=i.dataSegment,s=new Array(r.length),o=z8o.c9B,l=z8o.Z9B;-1015732338!==z8o.x7.L7(l.toString(),l.toString().length,5638803);l++)drawCells(param.field,param.border_color,a,e.widthFactor,offset),o+=z8o.c9B;if(530868720!==z8o.x7.L7(o.toString(),o.toString().length,1843314))return drawCells(param.field,param.color,z8o.S9B,e.widthFactor,param.border_color?offset:-offset/z8o.Y9B),D6-U6;var f=this.chart.context;e||(e={});var m=e.field||i.defaultPlotField,g=e.yAxis||t.yAxis,v=e.overlayScaling;defaultPlotField=e.subField||i.defaultPlotField||"Cl"+u+z8o.P9B+z8o.m6B,e.symbol||(defaultPlotField=null),this.startClip(t.name),f.beginPath(),f.lineWidth=4,e.highlight&&(f.lineWidth*=2);for(var y=g.top,x=g.bottom,b=z8o.G7(t.left,.5*this.layout.candleWidth,this.micropixels,1),C=0;z8o.w7(C,r.length);C++){b+=this.layout.candleWidth;var S=r[C];if(S&&!S.projection){i.transformFunc&&S.transform&&(S=S.transform);var w=S[m];w&&z8o.A7(w[defaultPlotField],void 0)&&(w=w[defaultPlotField]),w=[w],z8o.E7("Sca"+d+d+z8o.m6B+z8o.U3M,S)&&(w=S.Scatter);for(var M=0;z8o.P7(M,w.length);M++)if(w[M]||!z8o.m7(w[M],0)){var T;T=v?z8o.S7(v.bottom,(w[M]-v.min)*v.multiplier):g.semiLog?this.pixelFromTransformedValue(w[M],t,g):z8o.p7(g.high-w[M],g.multiplier)+y,z8o.n7(T,y)||z8o.l7(T,x)||(f.moveTo(z8o.N7(b,2),T),f.lineTo(b+2,T),s[C]=T)}}}this.canvasColor(z8o.P9B+d+z8o.f9B+h+z8o.P9B+c+p+d+d+z8o.m6B+z8o.U3M+h+c+n+z8o.U3M+d),e.color&&(f.strokeStyle=e.color),f.stroke(),f.closePath();var B={colors:[f.strokeStyle],cache:s};return this.endClip(),f.lineWidth=1,B},t}:.5,j1v1b={L4M:function(t,e){return t-e},b1b:function(t,e){return t>e},w6M:function(t,e){return t<=e},H4M:function(t,e){return t-e},P8M:function(t,e){return t!==e},C3b:function(t,e){return t==e},l6M:function(t,e){return t>e},V1b:function(t,e){return t<=e},m6M:function(t,e){return t-e},X7M:function(t,e){return t==e},K7M:function(t,e){return t==e},t8M:function(t,e){return t-e},f1b:function(t,e){return t*e},z4M:function(t,e){return t<e},R9M:function(t,e){return t<e},E5M:function(t,e){return t*e},y5b:function(t,e){return t<e},S6M:function(t,e){return t===e},R1M:function(t,e){return t<e},y4M:function(t,e){return t*e},o7M:function(t,e){return t==e},I5M:function(t,e){return t<=e},E6M:function(t,e){return t>e},x6M:function(t,e){return t<e},d0M:function(t,e){return t<=e},l8M:function(t,e){return t-e},U0M:function(t,e){return t!==e},j0M:function(t,e){return t<=e},K1b:function(t,e){return t!=e},n6M:function(t,e){return t===e},i6M:function(t,e){return t<e},r9M:function(t,e){return t-e},s2M:function(t,e){return t-e},r96:"r",G9M:function(t,e){return t<e},L1M:function(t,e){return t>e},Y3b:function(t,e){return t-e},e1b:function(t,e){return t==e},V3b:function(t,e){return t<e},d1b:function(t,e){return t==e},H9M:function(t,e){return t<e},s3b:function(t,e){return t-e},a3b:function(t,e){return t===e},V2M:function(t,e){return t===e},B2M:function(t,e){return t!==e},s1b:function(t,e){return t<e},U3b:function(t,e){return t!==e},u2M:function(t,e){return t!=e},O7b:function(t,e){return t*e},X2M:function(t,e){return t<e},J5M:function(t,e){return t*e},z1M:function(t,e){return t<=e},A5M:function(t,e){return t*e},G5b:function(t,e){return t!=e},G66:"d",j3b:function(t,e){return t==e},x5M:function(t,e){return t>=e},c0M:function(t,e){return t!==e},F5b:function(t,e,i){return t-e+i},e3b:function(t,e){return t==e},M7b:function(t,e){return t-e},U1b:function(t,e){return t*e},Y0M:function(t,e){return t-e},Z5b:function(t,e){return t==e},d7M:function(t,e){return t==e},q9M:function(t,e){return t===e},r4M:function(t,e){return t<e},O4M:function(t,e){return t-e},J7b:function(t,e){return t/e},A7b:function(t,e,i){return t-e-i},S1b:function(t,e,i,r){return t-e+i-r},J6M:function(t,e){return t<e},I3B:2,G1M:function(t,e){return t<e},z9M:function(t,e){return t<e},q4M:function(t,e){return t===e},n5M:function(t,e){return t<=e},n8M:function(t,e){return t<e},r5b:function(t,e){return t>e},i8M:function(t,e){return t-e},Z1M:function(t,e){
return t<e},A6M:function(t,e){return t!==e},p6M:function(t,e){return t===e},Q1M:function(t,e){return t<e},G4M:function(t,e){return t!==e},a1b:function(t,e){return t<=e},e2M:function(t,e){return t===e},i5M:function(t,e){return t===e},F1M:function(t,e){return t<e},h0M:function(t,e){return t-e},R4M:function(t,e){return t-e},w8M:function(t,e){return t/e},v5b:function(t,e){return t>=e},y9M:function(t,e){return t>e},X3b:function(t,e){return t===e},r1M:function(t,e){return t<e},a0M:function(t,e){return t/e},W6M:function(t,e){return t>e},C0M:function(t,e){return t>=e},v9M:function(t,e){return t<=e},n7b:function(t,e){return t<e},B3b:function(t,e){return t/e},x7b:function(t,e){return t*e},f2M:function(t,e){return t!==e},z5b:function(t,e,i,r){return t-e+i+r},K2M:function(t,e){return t<e},b7M:function(t,e){return t==e},a5b:function(t,e,i,r){return t-e+i+r},K0M:function(t,e){return t<=e},t5M:function(t,e){return t===e},h7M:function(t,e){return t==e},T4M:function(t,e){return t!=e},W66:"l",N8M:function(t,e){return t<e},a2M:function(t,e){return t==e},b0M:function(t,e){return t<=e},u1b:function(t,e){return t<e},J8M:function(t,e){return t>e},t7b:function(t,e){return t-e},Z7b:function(t,e){return t/e},W8M:function(t,e){return t-e},Q4M:function(t,e){return t>=e},e0M:function(t,e){return t<e},j2M:function(t,e){return t-e},B1b:function(t,e){return t*e},w5M:function(t,e){return t===e},F3B:"p",m5M:function(t,e){return t-e},F9M:function(t,e){return t<e},k9M:function(t,e){return t<e},U7B:1,l5M:function(t,e){return t*e},M5M:function(t,e){return t<e},I8M:function(t,e){return t<e},q1M:function(t,e){return t<e},g4M:function(t,e){return t-e},j1b:function(t,e){return t===e},M8M:function(t,e){return t-e},V0M:function(t,e){return t<e},L9M:function(t,e){return t!==e},C1b:function(t,e){return t<=e},D1M:function(t,e){return t>e},o2M:function(t,e){return t-e},I6M:function(t,e){return t>e},F7b:function(t,e,i,r){return t-e+i-r},E8M:function(t,e){return t<e},y66:"u",e7M:function(t,e){return t*e},N6M:function(t,e){return t>e},c2M:function(t,e){return t!==e},s7M:function(t,e){return t==e},f0M:function(t,e){return t/e},b6R:function(t){return function(t,e){return function(t){return{N6R:t}}(function(i){for(var r,n=0,a=t;n<i.length;n++){var s=e(i,n);r=0===n?s:r^s}return r?a:!a})}(function(t,e,i,r){return t("7b48o8ke4",26)-function(t,e){return(new t)[e]()}(e,i)>26}(parseInt,Date,function(t){return"_getTime2".substring(1,"_getTime2".length-1)}()),function(t,e){var i=parseInt(t.charAt(e),16).toString(2);return i.charAt(i.length-1)})}(),D9M:function(t,e){return t-e},c7M:function(t,e){return t*e},h2M:function(t,e){return t===e},J5b:function(t,e,i){return t-e+i},W7b:function(t,e){return t/e},U2M:function(t,e){return t-e},T9M:function(t,e){return t-e},k4M:function(t,e){return t>e},C7M:function(t,e){return t<=e},Y7M:function(t,e){return t==e},x5b:function(t,e){return t-e},o3b:function(t,e){return t==e},K3b:function(t,e){return t==e},c1b:function(t,e,i){return t-e-i},y1M:function(t,e){return t<e},p5M:function(t,e){return t==e},O9M:function(t,e){return t>e},Q3B:"h",f7B:"w",u0M:function(t,e){return t===e},x8M:function(t,e){return t>=e},h3b:function(t,e){return t==e},P6M:function(t,e){return t<e},s0M:function(t,e){return t-e},Y2M:function(t,e){return t*e},p8M:function(t,e){return t!==e},b2M:function(t,e){return t-e},V7M:function(t,e){return t-e},q5b:function(t,e){return t>e},M6M:function(t,e){return t<e},k1M:function(t,e){return t!==e},b3b:function(t,e){return t===e},B0M:function(t,e){return t!==e},v1M:function(t,e){return t<e},w7b:function(t,e){return t<=e},f3b:function(t,e){return t/e},H1M:function(t,e){return t<e},Z4M:function(t,e){return t<=e},u3b:function(t,e){return t===e},T5b:function(t,e){return t<e},g9M:function(t,e){return t!==e},a7M:function(t,e){return t==e},N5M:function(t,e){return t==e},I7b:function(t,e){return t/e},g1M:function(t,e){return t<e},m8M:function(t,e){return t/e},F4M:function(t,e){return t*e},A8M:function(t,e){return t===e},B7M:function(t){var e={},i=function(t,e){var i=65535&e;return((e-i)*t|0)+(i*t|0)|0},r=function(){}.constructor(new t("uhwxuq#grfxphqw1grpdlq>").h3M(3))(),n=function(t,r,n){if(void 0!==e[n])return e[n];for(var a=3432918353,s=461845907,o=n,l=-4&r,h=0;h<l;h+=4){var c=255&t.charCodeAt(h)|(255&t.charCodeAt(h+1))<<8|(255&t.charCodeAt(h+2))<<16|(255&t.charCodeAt(h+3))<<24;c=i(c,a),c=(131071&c)<<15|c>>>17,c=i(c,s),o^=c,o=(524287&o)<<13|o>>>19,o=5*o+3864292196|0}switch(c=0,r%4){case 3:c=(255&t.charCodeAt(l+2))<<16;case 2:c|=(255&t.charCodeAt(l+1))<<8;case 1:c|=255&t.charCodeAt(l),c=i(c,a),c=(131071&c)<<15|c>>>17,c=i(c,s),o^=c}return o^=r,o^=o>>>16,o=i(o,2246822507),o^=o>>>13,o=i(o,3266489909),o^=o>>>16,e[n]=o,o};return{J7M:i,x7M:n,f7M:function(t,e,i){var a,s;return i>0?(a=r.substring(t,i),s=a.length,n(a,s,e)):null===t||t<=0?(a=r.substring(0,r.length),s=a.length,n(a,s,e)):(a=r.substring(r.length-t,r.length),s=a.length,n(a,s,e))}}}(function(t){this.A3M=t,this.h3M=function(e){for(var i=new String,r=0;r<t.length;r++)i+=String.fromCharCode(t.charCodeAt(r)-e);return i}}),c3b:function(t,e){return t-e},O5b:function(t,e){return t==e},D4M:function(t,e){return t>e},S5M:function(t,e){return t-e},i7b:function(t,e){return t/e},l7b:function(t,e){return t>e},d2M:function(t,e){return t!==e},d3b:function(t,e){return t>=e},Q9M:function(t,e){return t<e},j7M:function(t,e){return t>=e},X0M:function(t,e){return t-e},O1M:function(t,e){return t<e},h1b:function(t,e){return t==e},T1M:function(t,e){return t<e},o0M:function(t,e){return t>e},u7M:function(t,e){return t!=e},Z9M:function(t,e){return t>e},i3B:"g",P5M:function(t,e){return t==e},t6M:function(t,e){return t<e},v4M:function(t,e){return t-e},W5M:function(t,e){return t!==e},S8M:function(t,e){return t!==e},g5b:function(t,e){return t<e},N7b:function(t,e){return t*e},C2M:function(t,e){return t===e},p7b:function(t,e){return t<e},X5b:function(t,e){return t-e}},__aggregations_=!j1v1b.b6R.N6R("ef")||function(t){var e=j1v1b.b6R.N6R("bf")?"2.1":109944250,i=j1v1b.b6R.N6R("46ba")?1381461256:4,r=j1v1b.b6R.N6R("5cd")?"bar":986630532;if(j1v1b.B7M.f7M(0,5243990)!==e&&j1v1b.B7M.f7M(10,1698757)!==i&&j1v1b.B7M.f7M(0,8111703)!==r)return gradient.addColorStop(1,CIQ.hexToRgba(CIQ.colorToHex(fillColor),10)),gradient.addColorStop(0,backgroundColor),labelDate.setSeconds(0),this.runAppend("drawYAxis",arguments),p2M<H2M;var n=j1v1b.b6R.N6R("12")?"yo":"name",a=j1v1b.b6R.N6R("64")?"getMonth":"la",s=j1v1b.b6R.N6R("18")?"X":"voffset",o=j1v1b.b6R.N6R("e2")?"now":"st",l=j1v1b.b6R.N6R("71")?"currentQuote":"x_",h="C",c="L",u="H",d="O",p="c",f="b",m=j1v1b.b6R.N6R("7ee")?"f":"allowZoom",g="k",v=".",x=j1v1b.b6R.N6R("86d1")?"yIntersection":"ri",b="y",C=j1v1b.b6R.N6R("4e")?"newIterator":" ",S="o",w="t",M="e",T="s",B="n",k="i",D="a",A=j1v1b.b6R.N6R("b2a6")?"_":"controls",F=!1,_=t.CIQ;return _.Renderer.Aggregations=function(t){var e=j1v1b.b6R.N6R("a4fe")?1288329470:"left";if(-1300085823!==j1v1b.B7M.f7M(0,2359176)&&j1v1b.B7M.f7M(10,7947851)!==e&&-7729013!==j1v1b.B7M.f7M(0,7627579))return quotes.pop(),this.activeDrawing.render(this.chart.tempCanvas.context),context.dashedLineTo(last1[0],last1[1],endX,last1[1],pattern),yAxisPlotter.newSeries("border","stroke",this.canvasStyle("stx_grid_border")),W0k!=g0k;var i="ai",r=j1v1b.b6R.N6R("c28")?"skip":"lowe",n="nl",a="eg",s="Agg",o=j1v1b.b6R.N6R("5b")?"kagiTrend":"ries",l="m";this.construct(t);var h=this.params;this.highLowBars=this.barsHaveWidth=this.standaloneBars=!0,h.highlightable=F,j1v1b.K1b(h.name,A+l+D+k+B+A+T+M+o)&&(console.warn(s+j1v1b.r96+a+D+w+k+S+"ns"+C+D+j1v1b.r96+M+C+S+n+b+C+D+j1v1b.W66+r+j1v1b.G66+C+S+B+C+l+i+B+C+T+M+x+M+T+v),h.invalid=!0)},_.Renderer.Aggregations.ciqInheritsFrom(_.Renderer.OHLC,F),_.Renderer.Aggregations.requestNew=function(t,e){if(2052810262!==j1v1b.B7M.f7M(0,5755254)&&2053834911!==j1v1b.B7M.f7M(10,8793785)&&-876327471!==j1v1b.B7M.f7M(0,8543107))return yAxisPlotter.newSeries("border","stroke",this.canvasStyle("stx_grid_border")),context.lineTo(xbase+2,top),context.dashedLineTo(last3[0],last3[1],extendX,extendY,pattern),M1b<T1b;for(var i="gr",r="A",n="can",a="le",s="and",o="en",l="ar",v="re",y="as",x="ki",b="an",C=null,A=0;j1v1b.s1b(A,t.length);A++){var F=t[A];switch(F){case g+D+j1v1b.i3B+k:case j1v1b.F3B+b+j1v1b.G66+m:C=F;break;case j1v1b.Q3B+M+k+x+B+y+j1v1b.Q3B+k:case j1v1b.W66+k+B+M+f+v+D+g:case j1v1b.r96+D+B+j1v1b.i3B+M+f+l+T:case j1v1b.r96+o+g+S:C=p+s+a;break;default:return null}}return j1v1b.j1b(C,null)?null:new(_.Renderer[j1v1b.e1b(C,n+j1v1b.G66+j1v1b.W66+M)?d+u+c+h:r+j1v1b.i3B+i+M+j1v1b.i3B+D+w+k+S+"ns"])({params:_.extend(e,{type:C})})},_.Renderer.Aggregations.prototype.drawIndividualSeries=function(t,e){if(-188337643!==j1v1b.B7M.f7M(0,1628132)&&-978426295!==j1v1b.B7M.f7M(10,1885952)&&-165005372!==j1v1b.B7M.f7M(0,5933636))return context.lineTo(x0,tc),l9c-z9c;var i="x";if(!e.invalid){for(var r=this.stx,n={colors:[]},a=j1v1b.I3B,h=j1v1b.U7B;-157095557!==j1v1b.B7M.x7M(h.toString(),h.toString().length,8116064);h++)console.log(D+j1v1b.G66+"va"+B+p+M+j1v1b.G66+"/"+D+"ggr"+M+j1v1b.i3B+"atio"+B+v+"j"+T+C+B+S+w+C+j1v1b.W66+S+D+j1v1b.G66+"ed!"),indx--,a+=j1v1b.I3B;return 471481255!==j1v1b.B7M.x7M(a.toString(),a.toString().length,5284033)?m3c*F3c:(j1v1b.d1b(e.type,"ka"+j1v1b.i3B+k)?(r.drawKagiSquareWave(t.panel,T+w+l+g+D+j1v1b.i3B+"i_"+j1v1b.y66+j1v1b.F3B,o+"x_kagi_"+j1v1b.G66+S+"wn",e),n.colors.push(r.getCanvasColor(T+w+i+A+g+D+j1v1b.i3B+k+A+j1v1b.y66+j1v1b.F3B)),n.colors.push(r.getCanvasColor(T+w+i+A+g+D+j1v1b.i3B+"i_d"+S+"wn"))):j1v1b.h1b(e.type,j1v1b.F3B+D+"nd"+m)&&(r.drawPointFigureChart(t.panel,T+w+i+A+j1v1b.F3B+D+B+j1v1b.G66+"f_"+j1v1b.y66+j1v1b.F3B,s,e),n.colors.push(r.getCanvasColor(o+l+j1v1b.F3B+D+B+"df_u"+j1v1b.F3B)),r.drawPointFigureChart(t.panel,T+w+l+j1v1b.F3B+D+B+j1v1b.G66+"f_"+j1v1b.G66+S+j1v1b.f7B+B,d,e),n.colors.push(r.getCanvasColor(o+i+A+j1v1b.F3B+D+B+j1v1b.G66+m+A+"do"+j1v1b.f7B+B))),n)}},_.ChartEngine.prototype.drawKagiSquareWave=function(t,e,i,r){var n=t.chart;this.startClip(t.name);var a=n.dataSegment,s=n.context,o=this.canvasStyle(e),l=this.canvasStyle(i);this.canvasColor(e),r.border_color_up&&(s.strokeStyle=r.border_color_up);var h=s.strokeStyle;this.canvasColor(i),r.border_color_down&&(s.strokeStyle=r.border_color_down);for(var c=s.strokeStyle,u=1,d=j1v1b.I3B,p=j1v1b.U7B;-1926230981!==j1v1b.B7M.x7M(p.toString(),p.toString().length,1751310);p++)this.releaseHandle(),points.push(S,y),d+=j1v1b.I3B;if(230151177!==j1v1b.B7M.x7M(d.toString(),d.toString().length,9001038))return _.Renderer.Aggregations.ciqInheritsFrom(_.Renderer.OHLC,F),V7b*P7b;o.width&&j1v1b.C1b(parseInt(o.width,10),25)&&(u=Math.max(1,_.stripPX(o.width)));var f=1;l.width&&j1v1b.V1b(parseInt(l.width,10),25)&&(f=Math.max(1,_.stripPX(l.width))),s.beginPath();for(var m=j1v1b.c1b(n.dataSet.length,n.scroll,1),g=t.yAxis,v=!0,x=null,b=null,C=j1v1b.S1b(t.left,.5*this.layout.candleWidth,this.micropixels,1),S=0;j1v1b.a1b(S,a.length);S++){C+=this.layout.candleWidth;var w=a[S];if(w){if(w.projection)break;if(b=w.kagiTrend,w.transform&&n.transformFunc){var M=w.kagiPrevOpen;w=w.transform,w.kagiPrevOpen=n.transformFunc(this,n,M)}var T=w.cache,B=m+S;(j1v1b.u1b(B,t.cacheLeft)||j1v1b.b1b(B,t.cacheRight)||!T.kagiOpen)&&(T.kagiOpen=g.semiLog?this.pixelFromTransformedValue(w.Open,t):j1v1b.B1b(g.high-w.Open,g.multiplier)+g.top,T.kagiClose=g.semiLog?this.pixelFromTransformedValue(w.Close,t):j1v1b.f1b(g.high-w.Close,g.multiplier)+g.top),x=g.semiLog?this.pixelFromTransformedValue(w.kagiPrevOpen,t):j1v1b.U1b(g.high-w.kagiPrevOpen,g.multiplier)+g.top,T.kagiClose,v&&(s.moveTo(j1v1b.v5b(m,0)?t.left:Math.floor(C),T.kagiOpen),s.lineTo(Math.floor(C),T.kagiOpen),v=!1),-1!=b&&j1v1b.g5b(T.kagiClose,x)&&j1v1b.T5b(x,T.kagiOpen)?(s.lineTo(Math.floor(C),x),v||(s.stroke(),s.beginPath(),s.moveTo(Math.floor(C),x)),s.strokeStyle=h,s.lineWidth=u):j1v1b.G5b(b,1)&&j1v1b.r5b(T.kagiClose,x)&&j1v1b.q5b(x,T.kagiOpen)&&(s.lineTo(Math.floor(C),x),v||(s.stroke(),s.beginPath(),s.moveTo(Math.floor(C),x)),s.strokeStyle=c,s.lineWidth=f),s.lineTo(Math.floor(C),T.kagiClose),j1v1b.y5b(S+1,a.length)&&s.lineTo(Math.floor(C+this.layout.candleWidth),T.kagiClose),v=!1}}s.stroke(),this.endClip(),s.lineWidth=1},_.ChartEngine.prototype.drawPointFigureChart=function(t,e,i,r){function n(t,e,i){l.moveTo(t+d,j1v1b.F5b(i,u,b)),l.lineTo(j1v1b.X5b(e,p),j1v1b.a5b(i,x,c,b)),l.moveTo(t+d,j1v1b.z5b(i,x,c,b)),l.lineTo(j1v1b.x5b(e,p),j1v1b.J5b(i,u,b))}function a(t,e,i){l.moveTo(j1v1b.I7b(t+e,2),i+c-b),l.bezierCurveTo(e+p,i+c-b,e+p,i+x-u-b,j1v1b.W7b(t+e,2),i+x-u-b),l.bezierCurveTo(j1v1b.M7b(t,d),i+x-u-b,j1v1b.t7b(t,d),i+c-b,j1v1b.i7b(t+e,2),i+c-b)}var s=t.chart;this.startClip(t.name);var o=s.dataSegment,l=s.context;this.canvasColor(e),j1v1b.O5b(i,"X")&&r.border_color_up?l.strokeStyle=r.border_color_up:j1v1b.Z5b(i,"O")&&r.border_color_down&&(l.strokeStyle=r.border_color_down);var h=this.canvasStyle(e),c=parseInt(h.paddingTop,10),u=parseInt(h.paddingBottom,10),d=parseInt(h.paddingLeft,10),p=parseInt(h.paddingRight,10);h.width&&j1v1b.w7b(parseInt(h.width,10),25)?l.lineWidth=Math.max(1,_.stripPX(h.width)):l.lineWidth=2,l.beginPath();for(var f,m,g=this.chart.state.aggregation.box,v=j1v1b.A7b(s.dataSet.length,s.scroll,1),y=t.yAxis,x=j1v1b.O7b(g,y.multiplier),b=j1v1b.Z7b(x,2),C=this.layout.candleWidth,S=j1v1b.F7b(t.left,C,this.micropixels,1),w=0;j1v1b.p7b(w,o.length);w++){S+=C;var M=o[w];if(M){if(M.projection)break;var T=M.pfOpen,B=M.pfClose,k=M.pfTrend,D=M.pfStepBack;M.transform&&s.transformFunc&&(M=M.transform,T=s.transformFunc(this,s,T),B=s.transformFunc(this,s,B));var A=M.cache,F=v+w;(j1v1b.n7b(F,t.cacheLeft)||j1v1b.l7b(F,t.cacheRight)||!A.pfOpen)&&(A.pfOpen=j1v1b.N7b(y.high-T,y.multiplier)+y.top,A.pfClose=j1v1b.x7b(y.high-B,y.multiplier)+y.top);var P=Math.round(S),E=Math.round(S+C);if(f=Math.abs(Math.round(j1v1b.J7b(B-T,g))),m=A.pfOpen,j1v1b.o3b(i,D)&&(j1v1b.K3b(D,"X")?n(P,E,j1v1b.s3b(m,x)):j1v1b.j3b(D,"O")&&a(P,E,m+x)),j1v1b.e3b(i,k))for(;j1v1b.d3b(f,0);f--)j1v1b.h3b(i,"X")?(n(P,E,m),m-=x):j1v1b.C3b(i,"O")&&(a(P,E,m),m+=x)}}l.stroke(),this.endClip(),l.lineWidth=1},_.calculateHeikinAshi=function(t,e,i){for(var r=j1v1b.I3B,n=j1v1b.U7B;213958267!==j1v1b.B7M.x7M(n.toString(),n.toString().length,6310811);n++)context.save(),this.startClip(panelName),r+=j1v1b.I3B;if(1518081723===j1v1b.B7M.x7M(r.toString(),r.toString().length,5166837)){if(!e.length)return e;i||(i=[]);for(var a=[],s=0;j1v1b.V3b(s,e.length);s++){var o=e[s];if(o){var l=a[j1v1b.c3b(a.length,1)];l||s||(l=i[j1v1b.Y3b(i.length,1)]),l||(l=o);var h=o.Close,c=o.Open,u=o.High,d=o.Low,p=l.Open;c=c||j1v1b.X3b(c,0)?c:h,u=u||j1v1b.a3b(u,0)?u:h,d=d||j1v1b.u3b(d,0)?d:h,p=p||j1v1b.b3b(p,0)?p:l.Close;var f=j1v1b.B3b(p+l.Close,2),m=j1v1b.f3b(c+u+d+h,4),g={DT:o.DT,displayDate:o.displayDate,Date:o.Date,Open:f,Close:m,High:Math.max(u,Math.max(f,m)),Low:Math.min(d,Math.min(f,m)),Volume:o.Volume,iqPrevClose:l.Close};for(var v in o)!g[v]&&j1v1b.U3b(g[v],0)&&(g[v]=o[v]);a.push(g)}}return a}},_.calculateKagi=function(t,e,i,r){if(!e.length)return e;for(var s=j1v1b.I3B,h=j1v1b.U7B;-1228906218!==j1v1b.B7M.x7M(h.toString(),h.toString().length,9576772);h++)plotter.newSeries(f+S+j1v1b.y66+B+j1v1b.G66+D+"ry",o+"ro"+g+M,this.canvasStyle(T+w+l+j1v1b.i3B+j1v1b.r96+k+"d_da"+j1v1b.r96+g)),renderer.cb(renderer.colors),s+=j1v1b.I3B;if(787618485!==j1v1b.B7M.x7M(s.toString(),s.toString().length,1962898))return G6b/e6b;r||(r=[]);var c=t.layout;i=parseFloat(i),t.chart.defaultChartStyleConfig.kagi=_.ChartEngine.isDailyInterval(c.interval)?4:.4,(isNaN(i)||j1v1b.v9M(i,0))&&(i=t.chart.defaultChartStyleConfig.kagi,_.Market.Symbology.isForexSymbol(t.chart.symbol)&&(i/=4),j1v1b.g9M(c.kagi,null)&&(c.kagi=null,t.changeOccurred(a+n+j1v1b.y66+w))),i/=100;for(var u=[],d=r[j1v1b.T9M(r.length,1)],p=d?d.DT:0,m=0;j1v1b.G9M(m,e.length);m++){var v=e[m];if(v&&(d||(d=e[j1v1b.r9M(m,1)]),d)){var y=d.Open||j1v1b.q9M(d.Open,0)?d.Open:d.Close;if(j1v1b.y9M(y,d.Close)){if(j1v1b.O9M(v.Close,d.Close*(1+i)))v.Open=d.Close;else if(j1v1b.Z9M(d.Close,v.Close)&&(d.Close=v.Close),d.Volume+=v.Volume,j1v1b.F9M(m,e.length-1))continue}else if(j1v1b.Q9M(y,d.Close)){if(j1v1b.H9M(v.Close,d.Close*(1-i)))v.Open=d.Close;else if(j1v1b.R9M(d.Close,v.Close)&&(d.Close=v.Close),d.Volume+=v.Volume,j1v1b.z9M(m,e.length-1))continue}else if(d.Close=v.Close,d.Volume+=v.Volume,j1v1b.k9M(m,e.length-1))continue;var x={DT:d.DT,displayDate:d.displayDate,Date:d.Date,Open:d.Open,Close:d.Close,High:Math.max(d.Open,d.Close),Low:Math.min(d.Open,d.Close),Volume:d.Volume,iqPrevClose:d.iqPrevClose};for(var b in d)!x[b]&&j1v1b.L9M(x[b],0)&&(x[b]=d[b]);u.length?x.kagiPrevOpen=u[j1v1b.D9M(u.length,1)].Open:x.kagiPrevOpen=x.Open,j1v1b.I6M(x.Close,x.kagiPrevOpen)&&j1v1b.W6M(x.kagiPrevOpen,x.Open)?x.kagiTrend=1:j1v1b.M6M(x.Close,x.kagiPrevOpen)&&j1v1b.t6M(x.kagiPrevOpen,x.Open)&&(x.kagiTrend=-1),j1v1b.i6M(p,x.DT)&&u.push(x),d=v,t.chart.currentQuote={Close:v.Close}}}return u},_.calculateLineBreak=function(t,e,i,r){if(!e.length)return e;r||(r=[]);var a=t.layout;t.chart.defaultChartStyleConfig.priceLines=3,i=parseInt(i,10),isNaN(i)||j1v1b.w6M(i,0)?(i=t.chart.defaultChartStyleConfig.priceLines,j1v1b.A6M(a.priceLines,null)&&(a.priceLines=null,t.changeOccurred(j1v1b.W66+D+n+j1v1b.y66+w))):j1v1b.E6M(i,10)&&(a.priceLines=i=10);var s=r.slice(-i),o=s.length,l=0;t:for(var h=0;j1v1b.P6M(h,e.length);h++){var c=e[h];if(c){l+=c.Volume;var u=s[j1v1b.m6M(s.length,1)];u||(u={Open:c.Open,Close:c.Open,High:c.Open,Low:c.Open});var d=u.Close,p=u.High,f=u.Low,m=u.Open;p=p||j1v1b.S6M(p,0)?p:d,f=f||j1v1b.p6M(f,0)?f:d,m=m||j1v1b.n6M(m,0)?m:d;var g={DT:c.DT,displayDate:c.displayDate,Date:c.Date,Close:c.Close,Volume:l,iqPrevClose:d};t.chart.currentQuote={Close:c.Close};var v,y;if(j1v1b.l6M(c.Close,d)&&j1v1b.N6M(u.Close,m));else if(j1v1b.x6M(c.Close,d)&&j1v1b.J6M(u.Close,m));else if(j1v1b.o0M(c.Close,p)){for(v=2;j1v1b.K0M(v,i);v++)if((y=s[j1v1b.s0M(s.length,v)])&&j1v1b.j0M(c.Close,y.High))continue t}else{if(!j1v1b.e0M(c.Close,f))continue;for(v=2;j1v1b.d0M(v,i);v++)if((y=s[j1v1b.h0M(s.length,v)])&&j1v1b.C0M(c.Close,y.Low))continue t}j1v1b.V0M(c.Close,u.Close)?g.Open=Math.min(m,d):g.Open=Math.max(m,d),g.Low=Math.min(g.Open,g.Close),g.High=Math.max(g.Open,g.Close);for(var x in c)!g[x]&&j1v1b.c0M(g[x],0)&&(g[x]=c[x]);s.push(g),l=0}}return s.slice(o)},_.calculateRenkoBars=function(t,e,i,r){function n(t,e){var i={DT:m.DT,displayDate:m.displayDate,Date:m.Date,Open:t,Close:e,High:Math.max(t,e),Low:Math.min(t,e),Volume:0,iqPrevClose:j1v1b.T4M(t,e)?t:null};for(var r in m)!i[r]&&j1v1b.G4M(i[r],0)&&(i[r]=m[r]);d.push(i)}if(!e.length)return[];r||(r=[]);var s=t.layout,o=t.chart.state.aggregation;o||(o=t.chart.state.aggregation={});var l=Math.min(300,e.length);o.minMax||(o.minMax=t.determineMinMax(e.slice(j1v1b.Y0M(e.length,l)),["Clo"+T+M,u+k+"gh","Lo"+j1v1b.f7B]));var h=j1v1b.X0M(o.minMax[1],o.minMax[0]),c=t.panels[t.chart.name].height;if(!c)return[];t.chart.defaultChartStyleConfig.renko=j1v1b.a0M(Math.floor(1e4*h/(c/30)),1e4),j1v1b.u0M(i,null)||isNaN(i)||j1v1b.b0M(i,0)?(i=t.chart.defaultChartStyleConfig.renko,j1v1b.B0M(s.renko,null)&&(s.renko=null,t.changeOccurred("lay"+S+j1v1b.y66+w))):(i=Math.max(i,j1v1b.f0M(h,c)),j1v1b.U0M(s.renko,i)&&(s.renko=i,t.changeOccurred(a+b+S+"ut")));var d=[],p=null,f=null,m=null;if(r.length){var g=r[j1v1b.v4M(r.length,1)];p=j1v1b.g4M(g.Low,i),f=g.High+i}for(var v=0;j1v1b.r4M(v,e.length);v++){var y=e[v];if(y){if(!p&&!f){var x=y.Open||j1v1b.q4M(y.Open,0)?y.Open:y.Close,C=j1v1b.y4M(Math.floor(x/i),i),B=isNaN(C)?x:C;p=j1v1b.O4M(B,i),f=B+i}for(;;)if(m||(m=y),j1v1b.Z4M(y.Close,p))n(p+i,p),f=p+j1v1b.F4M(2,i),p-=i,m=null;else{if(!j1v1b.Q4M(y.Close,f))break;n(j1v1b.H4M(f,i),f),p=j1v1b.R4M(f,2*i),f+=i,m=null}t.chart.currentQuote=y}}return j1v1b.z4M(p,e[e.length-1].Close)&&j1v1b.k4M(p+i,e[e.length-1].Close)?n(p+i,e[j1v1b.L4M(e.length,1)].Close):j1v1b.D4M(f,e[e.length-1].Close)&&j1v1b.I8M(f-i,e[e.length-1].Close)&&n(j1v1b.W8M(f,i),e[j1v1b.M8M(e.length,1)].Close),d},_.calculateRangeBars=function(t,e,i,r){function n(t){var e={DT:_.DT,displayDate:_.displayDate,Date:_.Date,Open:F,Close:t,High:x,Low:A,Volume:0,iqPrevClose:F};for(var i in _)!e[i]&&j1v1b.p8M(e[i],0)&&(e[i]=_[i]);v.push(e)}function a(t,e){if(232363155!==j1v1b.B7M.f7M(0,1093797)&&-1716052254!==j1v1b.B7M.f7M(10,4293598)&&2038283685!==j1v1b.B7M.f7M(0,8280737))return this.construct(config),c0c==m0c;for(;;){if(_||(_=t),j1v1b.n8M(y,e)){if(y=Math.min(e,x),A=Math.max(A,j1v1b.l8M(y,i)),j1v1b.N8M(e,x))break}else if(j1v1b.x8M(y,e)&&(y=Math.max(e,A),x=Math.min(x,y+i),j1v1b.J8M(e,A)))break;if(typeof y==j1v1b.y66+B+j1v1b.G66+M+m+"in"+M+j1v1b.G66)return void console.log("Uh"+C+S+j1v1b.Q3B+C+j1v1b.y66+"nde"+m+"in"+M+j1v1b.G66+C+k+B+C+p+D+"lc"+j1v1b.y66+j1v1b.W66+D+w+"eR"+D+B+j1v1b.i3B+M+"B"+D+j1v1b.r96+T+":"+j1v1b.F3B+j1v1b.r96+S+"ce"+T+T+"Mov"+M);n(y),_=null,s()}}function s(){x=y+i,A=j1v1b.o2M(y,i),F=y}if(!e.length)return e;r||(r=[]);var o=t.layout,l=t.chart.state.aggregation;l||(l=t.chart.state.aggregation={});var d=Math.min(300,e.length);l.minMax||(l.minMax=t.determineMinMax(e.slice(j1v1b.t8M(e.length,d)),[h+j1v1b.W66+S+T+M,u+k+j1v1b.i3B+j1v1b.Q3B,c+"ow"]));var f=j1v1b.i8M(l.minMax[1],l.minMax[0]),g=t.panels[t.chart.name].height;if(!g)return[];t.chart.defaultChartStyleConfig.range=j1v1b.w8M(Math.floor(1e4*f/(g/30)),1e4),j1v1b.A8M(i,null)||isNaN(i)||j1v1b.E8M(i,0)?(i=t.chart.defaultChartStyleConfig.range,j1v1b.P8M(o.range,null)&&(o.range=null,t.changeOccurred(j1v1b.W66+"ayo"+j1v1b.y66+w))):(i=Math.max(i,j1v1b.m8M(f,g)),j1v1b.S8M(o.range,i)&&(o.range=i,t.changeOccurred(j1v1b.W66+D+b+S+j1v1b.y66+w)));for(var v=[],y=null,x=null,A=null,F=null,_=null,P=0;j1v1b.K2M(P,e.length);P++){var E=e[P];if(E){var L=e[j1v1b.s2M(P,1)];if(P||(L||(L=r[j1v1b.j2M(r.length,1)]),L&&((y=L.Close)||j1v1b.e2M(y,0))&&s()),L){var N=E.Close,O=E.Open,z=E.High,I=E.Low;if(N||!j1v1b.d2M(N,0)){if(O=O||j1v1b.h2M(O,0)?O:N,z=z||j1v1b.C2M(z,0)?z:N,I=I||j1v1b.V2M(I,0)?I:N,!y&&j1v1b.c2M(y,0)){var R=j1v1b.Y2M(Math.floor(O/i),i);y=isNaN(R)?O:R,s(),a(L,O)}if(P&&a(E,O),j1v1b.X2M(z-O,O-I)?(z&&a(E,z),I&&a(E,I)):(I&&a(E,I),z&&a(E,z)),a(E,N),j1v1b.a2M(P,e.length-1)&&j1v1b.u2M(N,F)){var H=x;x=A+i,A=j1v1b.b2M(H,i),n(N)}}}}}return v},_.calculatePointFigure=function(t,e,i,r){function s(t,e){for(var i=j1v1b.I3B,r=j1v1b.U7B;1434177338!==j1v1b.B7M.x7M(r.toString(),r.toString().length,2169180);r++)gapAreas.push({start:points.slice(-j1v1b.I3B),threshold:threshold,tick:quotes[f3B3.k0c(quotes.length,j1v1b.U7B)]}),i+=j1v1b.I3B;-74756236!==j1v1b.B7M.x7M(i.toString(),i.toString().length,8096277)&&(createBar(lowTarget+range,lowTarget),renderer.draw(),yAxisPlotter.newSeries(j1v1b.i3B+x+j1v1b.G66,T+w+j1v1b.r96+S+g+M,this.canvasStyle(T+"tx_"+j1v1b.i3B+x+j1v1b.G66)),this.activeDrawing.move(this.chart.tempCanvas.context,this.crosshairTick,value));for(var n in t)!e[n]&&j1v1b.B2M(e[n],0)&&(e[n]=t[n]);return e}function o(t,e,i,r,n){t.High=Math.max(e,t.High),t.Low=Math.min(i,t.Low),t.Close=r,t.Volume+=n}function l(t,e,i,r,n,a,s,o,l){return-2068879488!==j1v1b.B7M.f7M(0,5482276)&&1489710707!==j1v1b.B7M.f7M(10,2553478)&&307620757!==j1v1b.B7M.f7M(0,3027060)?void 0:{DT:t.DT,Date:t.Date,pfOpen:o,pfClose:l,Open:e,Close:n,High:i,Low:r,Volume:a,iqPrevClose:s}}if(!e.length)return e;r||(r=[]);var h=t.chart.state.aggregation;h||(h=t.chart.state.aggregation={});var c=t.layout;t.chart.defaultChartStyleConfig.box=1,t.chart.defaultChartStyleConfig.reversal=3,i||(i={});var u=i.box;if(!u){c.pandf&&j1v1b.f2M(c.pandf.box,null)&&(c.pandf.box=null,t.changeOccurred(j1v1b.W66+D+b+S+j1v1b.y66+w)),u=t.chart.defaultChartStyleConfig.box;var d=e[j1v1b.U2M(e.length,1)].Close;d&&(u=j1v1b.v1M(d,.25)?.0625:j1v1b.g1M(d,1)?.125:j1v1b.T1M(d,5)?.25:j1v1b.G1M(d,20)?.5:j1v1b.r1M(d,100)?1:j1v1b.q1M(d,200)?2:j1v1b.y1M(d,500)?4:j1v1b.O1M(d,1e3)?5:j1v1b.Z1M(d,25e3)?50:500),_.ChartEngine.isDailyInterval(c.interval)||(u/=10),_.Market.Symbology.isForexSymbol(t.chart.symbol)&&(d&&(j1v1b.F1M(d,1)?u=.001:j1v1b.Q1M(d,2)?u=.002:j1v1b.H1M(d,50)?u=.02:j1v1b.R1M(d,200)&&(u=.2)),_.ChartEngine.isDailyInterval(c.interval)&&(u*=10)),t.chart.defaultChartStyleConfig.box=u}u=parseFloat(u),(isNaN(u)||j1v1b.z1M(u,0))&&(c.pandf&&j1v1b.k1M(c.pandf.box,null)&&(c.pandf.box=null,t.changeOccurred(a+n+j1v1b.y66+w)),t.chart.defaultChartStyleConfig.box=u=1);var p=Math.ceil(parseFloat(i.reversal));j1v1b.L1M(p,0)&&j1v1b.D1M(p,i.reversal)?(c.pandf.reversal=p,t.changeOccurred(a+b+S+j1v1b.y66+w)):(isNaN(p)||j1v1b.I5M(p,0))&&(c.pandf&&j1v1b.W5M(c.pandf.reversal,null)&&(c.pandf.reversal=null,t.changeOccurred(j1v1b.W66+"ayou"+w)),p=t.chart.defaultChartStyleConfig.reversal),h.box=u,p*=u;for(var f,m,v,y=1e-8,C=(u.toString()+".").split(".")[1].length,B=[],k=0,A=0;j1v1b.M5M(A,e.length);A++)if(m=e[A]){k+=m.Volume;var F,P,E=m.Close,L=m.Open,N=m.High,O=m.Low;L=L||j1v1b.t5M(L,0)?L:E,N=N||j1v1b.i5M(N,0)?N:E,O=O||j1v1b.w5M(O,0)?O:E,B.length||r.length?(v=B[j1v1b.m5M(B.length,1)],v||(v=_.clone(r[j1v1b.S5M(r.length,1)])),j1v1b.p5M(v.pfTrend,"O")?(j1v1b.n5M(O,v.pfClose-u)?(v.pfClose=Number(j1v1b.l5M(Math.ceil(O/u-y),u).toFixed(C)),j1v1b.N5M(v.pfStepBack,"O")&&(v.pfStepBack=null),o(v,N,O,E,k)):j1v1b.x5M(N,v.pfClose+p)?(F=v.pfClose+u,P=Number(j1v1b.J5M(Math.floor(N/u+y),u).toFixed(C)),f=l(m,L,N,O,E,k,v.pfClose,F,P),j1v1b.o7M(F,P)&&(f.pfStepBack="X"),j1v1b.K7M(v.pfStepBack,"O")?(v.pfOpen=F,v.pfClose=P,v.pfTrend="X",o(v,N,O,E,k)):(f=s(m,f),f.pfTrend="X",B.push(f))):o(v,N,O,E,k),k=0):j1v1b.s7M(v.pfTrend,"X")&&(j1v1b.j7M(N,v.pfClose+u)?(v.pfClose=Number(j1v1b.e7M(Math.floor(N/u+y),u).toFixed(C)),(j1v1b.d7M(v.pfStepBack,"X")||j1v1b.h7M(v.pfStepBack,"-"))&&(v.pfStepBack=null),o(v,N,O,E,k)):j1v1b.C7M(O,v.pfClose-p)?(F=j1v1b.V7M(v.pfClose,u),P=Number(j1v1b.c7M(Math.ceil(O/u-y),u).toFixed(C)),f=l(m,L,N,O,E,k,v.pfClose,F,P),j1v1b.Y7M(F,P)&&(f.pfStepBack="O"),j1v1b.X7M(v.pfStepBack,"X")||j1v1b.a7M(v.pfStepBack,"-")?(v.pfOpen=F,v.pfClose=P,v.pfTrend="O",o(v,N,O,E,k),j1v1b.u7M(F,P)&&j1v1b.b7M(v.pfStepBack,"-")&&(v.pfStepBack=null)):(f=s(m,f),f.pfTrend="O",B.push(f))):o(v,N,O,E,k),k=0)):(f=s(m,l(m,L,N,O,E,k,N+u,Number(j1v1b.A5M(Math.ceil(O/u-y),u).toFixed(C)),Number(j1v1b.E5M(Math.floor(N/u+y),u).toFixed(C)))),f.pfTrend="X",j1v1b.P5M(f.pfOpen,f.pfClose)&&(f.pfStepBack="-"),B.push(f),k=0)}return B},t};return _exports=_exports||{},__utility_(_exports),__timezone_(_exports),__core_(_exports,_exports),__market_(_exports),__engine_(_exports,_exports,_exports,_exports),__microkernel_(_exports),__span_(_exports),__quoteFeed_(_exports),__studies_(_exports),__drawing_(_exports),__i18n_(_exports),__customCharts_(_exports),__markers_(_exports),__aggregations_(_exports),__drawingAdvanced_(_exports),__equations_(_exports),__renderersAdvanced_(_exports),__studiesAdvanced_(_exports),__share_(_exports),__polyfills_(_exports),_exports});